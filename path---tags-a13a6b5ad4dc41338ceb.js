webpackJsonp([55702396619907],{489:function(n,s){n.exports={pathContext:{postsByTags:{"Functional Programming":[{excerpt:"책 링크 일단 자바스크립트 초급자가 읽기 좋은 책은 아니다. 하지만 자바스크립트를 좀 다루면서, Redux 나 RxJS 같은 라이브러리를 접해본 사람들이\n'왜 이런 방식으로 코드를 작성해야하는지' 단서를 얻을 수도 있고, 더 나아가서 함수형 프로그래밍의 기본 개념을 자신에게 익숙한 자바스크립트로 익힐 수 있다. 특히…",html:'<p><img src="https://cl.ly/0w3j30140G45/functional-javascript-cover.jpg" alt="Functional Javascript Cover"></p>\n<p><a href="http://aladin.kr/p/rUEvd">책 링크</a></p>\n<p>일단 자바스크립트 초급자가 읽기 좋은 책은 아니다. 하지만 자바스크립트를 좀 다루면서, Redux 나 RxJS 같은 라이브러리를 접해본 사람들이\n\'왜 이런 방식으로 코드를 작성해야하는지\' 단서를 얻을 수도 있고, 더 나아가서 함수형 프로그래밍의 기본 개념을 자신에게 익숙한 자바스크립트로 익힐 수 있다.</p>\n<p>특히 5 장 때문에 이 책을 활용한 단기 스터디를 진행했는데, 확실히 팀원에게 내가 생각하는 함수 분할 및 조합에 대한 생각을 공유하고 이해시키는데 많은 도움이 되었다.</p>\n<p>번역은 자잘한 오타와 바로 이해가 되기 어려운 내용이 일부 있지만, 최근에 본 다른 책의 번역에 비하면 훨씬 나은 편이다.</p>\n<p>개인적으로 국내 저서 \'함수형 자바스크립트 프로그래밍(유인동 저)\' 보다는 이 책을 먼저 추천하고 싶다.\n국내 저서도 충분히 기본적인 내용을 소개하고 직접 유틸리티 함수를 구현해보는 방식의 접근을 취하고 있지만,\n2017 년에 나오는 책이 ES6 문법을 메인으로 채택하고 있지 않는 이유를 모르겠다.\n또한 정말 본질적으로 궁금했던 Functor 와 Monad 의 개념 및 활용법, 그리고 비동기 함수를 다루는 방법에 대해서는 명시적으로 드러내고 있지 않아서 약간 아쉬웠다.</p>\n<p>다행히도 이 책은 아쉬웠던 부분을 어느 정도 다루고 있기 때문에 나처럼 국내 저서에 그닥 만족스럽지 못했던 사람에게는 그래도 조금 더 나은 책이 될 것이다.</p>\n<hr>\n<p>(2018–03–22 추가) 국내 저서 ‘함수형 자바스크립트 프로그래밍’ 의 저자 유인동님이 지금 읽고 계시는 리뷰에 대해  <a href="http://bit.ly/2HYKHC4">답변을 달아주셨습니다</a>. 꼭 읽어보시길 권합니다. 또한 인동님이 최근에 <a href="https://github.com/Functional-JavaScript/functional.es">Github 에 ES6 에 초점을 맞춘 내용으로 다른 글을 작성하고 계시니</a>  참고하시면 많은 도움이 되리라 생각합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2018-03-14-functional-javascript-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-03-14",path:"/posts/functional-javascript-review",title:"함수형 자바스크립트(루이스 아텐시오 저) 리뷰",tags:["Functional Programming","Javascript"],category:"Javascript"}},{excerpt:"이 포스트는  Nicholas Kariniemi 의  Fear, trust and JavaScript: When types and functional programming fail…",html:'<ul>\n<li>이 포스트는 <a href="https://twitter.com/nkariniemi">Nicholas Kariniemi</a>의 <a href="https://www.reaktor.com/blog/fear-trust-and-javascript/">Fear, trust and JavaScript: When types and functional programming fail</a>를 번역한 글입니다</li>\n<li>번역에 관한 피드백과 내용에 관한 토론은 환영합니다. 댓글로 남겨주세요 :)</li>\n</ul>\n<hr>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/02/reaktor-javascript-reaktor-hero-2800x0-c-default.png"></p>\n<p>개발자로서 우리는 코드 실패에 대한 두려움을 줄이고 코드가 잘 작동한다는 믿음을 더 높이고 싶을 겁니다. 자바스크립트를 사용하는 많은 개발자는 함수형 프로그래밍 및 강타입(Strongly-typed) 언어에서 유용한 아이디어를 빌려 개발자의 도구와 코드로 신뢰를 얻으면서 두려움을 줄입니다. 선택적 타입과, 함수를 통한 변환 및 불변성과 같은 아이디어는 모두 더 나은 자바스크립트 코드 작성에 도움이 될 수 있습니다. 그러나 이러한 아이디어를 자바스크립트로 가져올 때 상충하는 개념 때문에 제대로 맞물려 작동하지 않으며, 궁극적으로 ‘개발자가 코드와 도구로 (코드가 잘 작동한다는) 믿음을 표현한다’는 목표를 달성하지 못합니다.</p>\n<p>이 아이디어를 설명하기 위해 자바스크립트에서 데이터를 처리하는 방법을 두 가지 관점에서 살펴보겠습니다. 하나는 데이터의 모양을 이해하는 것이고, 나머지 하나는 데이터를 변경하는 것입니다.</p>\n<h2 id="데이터의-형태와-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%ED%98%95%ED%83%9C%EC%99%80-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터의 형태와 두려움</h2>\n<p>자바스크립트같은 동적 언어에서는 데이터가 어떤 모양을 가지고 있는지 알기 어렵습니다. 기본적인 접근 방식은 규약(convention)에 의지하는 겁니다. 다른 개발자나 다른 시스템이 서로 동의한 형식으로 올바른 데이터를 제공하고 코드 내의 특정 규범을 따른다고 믿어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 name이 있을 거야</span>\n</code></pre>\n      </div>\n<p>저는 이 방식을 “내가 원하는 것인 척” 하는 접근 방식이라고 말하고 싶습니다. 상호 신뢰가 높은 환경에서는 이 방법이 충분히 유효합니다.</p>\n<p>하지만 실제로는 여기저기 두려움이 가득 차 있습니다. 코드가 복잡해지면서 여러분은 서로 다른 규칙을 따르는 개발자의 코드와 씨름합니다. 잘못된 형식으로 날아오지만 현재 계층에서는 손댈 수 없는 데이터를 수신하며, 널 포인터(null pointer) 오류가 발생하기 시작합니다. 코드에 대한 신뢰가 깨지고 데이터에 대한 의문을 가질 때 자신감보다는 불안감이 일어나기 시작합니다.</p>\n<ul>\n<li>이 데이터가 정말 가지고 있는 값이 뭐지?</li>\n<li>이 값을 지우면 어디 다른데서 터지지 않을까?</li>\n<li>이 데이터를 저 함수에다 넘겨도 될까?</li>\n</ul>\n<p>위의 두려움을 이런 방식의 코드 베이스에서 발견할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>\'자기 자신의 코드가 더 이상 기대되는 데이터를 적절하게 전달해주지 못한다’며 믿음을 잃을 때 이렇게 방어적인 프로그래밍을 하게 됩니다. 여러분의 아름다운 코드는 방어적인 체크 때문에 어수선해지고, 가독성을 잃으며, 유지보수하기 어려워집니다. 두려움이 커지면서 점점 코드가 제대로 동작하는지 믿기 어려워집니다.</p>\n<h3 id="선택적-타입optional-types으로-빡세게-확인하는-척하기"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85optional-types%EC%9C%BC%EB%A1%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%ED%99%95%EC%9D%B8%ED%95%98%EB%8A%94-%EC%B2%99%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입(Optional types)으로 빡세게 확인하는 척하기</h3>\n<p>두려움을 사전에 차단하는 방법 중 하나는 <a href="https://www.typescriptlang.org">Typescript</a>나 <a href="https://flow.org">Flow</a>의 선택적 타입을 도입하는 겁니다. 사용자를 수신할 때 <code class="language-text">User</code> 타입을 사전에 선언해두고, 이후에 <code class="language-text">User</code> 객체로 다루는 방식입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>이는 정말 ‘빡세게 확인하는 척’ 하는 겁니다. 당신은 코드에 대한 신뢰를 확인하는 부분을 바꿔 놓았습니다. 여전히 다른 시스템이 올바른 모양의 데이터를 제공한다고 믿지만, 코드 안에서 데이터에 부여한 타입을 믿고 해당 데이터를 잘못 사용하면 컴파일러에서 오류가 나게 됩니다. 개발자가 데이터의 모양을 알고 적절하게 사용하는 것을 믿는 대신 개발자가 올바른 타입을 작성하고 관리하리라 믿고, ‘컴파일러가 해당 형식에 대해 거짓말을 하지 않는다’고 믿게 되었습니다. 이 이야기는 나중에 더 하겠습니다.</p>\n<p>위의 예제에 타입을 추가해도 근본적인 문제는 해결되지 않습니다. 데이터가 일관성있게 사용되도록 보장함으로써 코드의 신뢰도는 향상되었지만 외부로부터 받은 데이터에 대해서는 아무런 말을 하지 않습니다.</p>\n<h3 id="유효성-검사-믿지만-검사는-해볼게"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC-%EB%AF%BF%EC%A7%80%EB%A7%8C-%EA%B2%80%EC%82%AC%EB%8A%94-%ED%95%B4%EB%B3%BC%EA%B2%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사: 믿지만 검사는 해볼게</h3>\n<p>신뢰도가 낮은 환경에서는 여러 지점에서 데이터의 유효성 검사를 해야 할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 이름이 있다</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 직접 작성할 수도 있지만 임시 방편에다 다루기도 어렵고 오류가 나기도 쉽습니다. 아니면 <a href="http://json-schema.org">JSON schema</a> 정의를 작성해서 데이터가 스키마에 맞는지 확인하거나, <a href="https://github.com/epoberezkin/ajv">ajv</a>같은 도구로 유효성 검사를 할 수도 있습니다. 이렇게 하면 임시 방편처럼 보이지도 않고 문서화 등을 할 때 유용하게 쓸 수 있겠지만, 여전히 여러분이 이렇게 직접 스키마를 작성해야 하기 때문에 오류가 날 가능성이 있으며 번거로운 작업이 될 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"User"</span><span class="token punctuation">,</span>\n  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>\n  <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="선택적-타입--유효성-검사"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85--%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입 + 유효성 검사</h3>\n<p>아니면 타입과 유효성 검사를 함께 사용할 수도 있습니다. 타입을 이용해서 코드 속의 두려움을 걷어내고, 유효성 검사를 통해서 외부로부터 들어오는 데이터를 믿을 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭠마 난 널 믿었는데\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>선택적 타입과 유효성 검사에 같은 정의를 하는 번거로운 작업을 피하기 위해서 Typescript 와 Flow 컴파일러를 직접 라이브러리로서 사용하거나(역주: 어떻게 하는지 방법은 모르겠습니다), <a href="https://github.com/pelotom/runtypes">runtypes(TS)</a>, <a href="https://github.com/seanhess/runtime-types">runtime-types(Flow)</a>, <a href="https://github.com/YousefED/typescript-json-schema">typescript-json-schema(TS)</a> 같은 별도의 라이브러리를 사용할 수도 있습니다. 몇 개의 장애물을 넘고 나면 여러분의 데이터를 더 믿을 수 있게 됩니다. 하지만 더 깊은 곳에 깔린 문제가 있습니다. 조금 뒤에 살펴보겠습니다.</p>\n<h2 id="데이터-변경의-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%80%EA%B2%BD%EC%9D%98-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 변경의 두려움</h2>\n<p>데이터가 바뀔 때는 어떨까요? 기본적으로 자바스크립트에서 데이터는 아무렇게나(willy-nilly) 바뀔 수 있습니다. 예를 들어 여기 문서를 받는 함수가 있는데 이 함수는 문서의 필드를 적절하게 손보고 새 필드를 삽입합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 스타일의 코드는 따라가기도 어렵고 곳곳에 두려움이 도사리고 있습니다. 내 데이터가 다른데서 사용된다면? 이미 다른 곳에서 변경되었다면? 이 시점에서 내 데이터가 가지고 있어야 하는 값이 뭐더라? 내가 지금 가지고 있는 데이터와 내가 실제 사용할 때의 데이터가 어떻게 같은 데이터라고 믿을 수 있지? 위의 예는 아주 작은 부분에 불과하지만 높은 동시성이 요구되는 시스템이나 커다란 코드 베이스에서는 훨씬 큰 문제를 야기할 겁니다.</p>\n<p>선택적 타입을 사용해보지만 별로 도움은 되지 않습니다. Typescript 와 Flow 에서 아래 두 함수는 같은 타입을 가리킵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> String<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-flow"><code class="language-flow"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> <span class="token type tag">String</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token type tag">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token type tag">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n  child_process<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"sudo rm -rf /"</span><span class="token punctuation">)</span>\n  <span class="token function">launchRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이 중 하나는 여러분이 원하는 기능을 수행하지만 나머지 하나는 서비스를 불바다로 만들어버릴 겁니다. 타입 시스템을 통해 바라보면 이 함수는 아무것도 안하는 것이나 마찬가지입니다(역주: 리턴 값이 <code class="language-text">void</code> 라서 그럴까요?).</p>\n<h3 id="불변성을-가장한-규약"><a href="#%EB%B6%88%EB%B3%80%EC%84%B1%EC%9D%84-%EA%B0%80%EC%9E%A5%ED%95%9C-%EA%B7%9C%EC%95%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>불변성을 가장한 규약</h3>\n<p>이제 여러분은 자바스크립트를 더 잘 다룰 수 있고, 팀 안에서 합의를 이루어서 명시적이고(explicit) 묵시적(implicit)으로 불변성을 가지도록 코드를 작성하기 시작합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    creationDate<span class="token punctuation">:</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    source<span class="token punctuation">:</span> source<span class="token punctuation">,</span>\n    text<span class="token punctuation">:</span> doc<span class="token punctuation">.</span>text\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 데이터 변경하지 않기</span>\n  <span class="token comment">// 루트 폴더 지우지 않기</span>\n  <span class="token comment">// 로켓 쏘지 않기</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> date <span class="token operator">?</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>점점 <code class="language-text">var</code> 보단 <code class="language-text">const</code> 를 선호하며 값을 직접 변경하기 보다 새로운 값을 리턴하도록 만들기 시작합니다. <code class="language-text">let</code> 은 변경될 수 있는 값을 가리킬 때만 사용하고, 더 짧은 코드를 작성하기 위해 삼항연산자(ternary operator)를 사용하여 <code class="language-text">if</code> 문을 기능적으로 대체할 수 있다는 사실을 새로이 발견했습니다. <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 나 다른 함수를 사용하여 기존의 데이터를 직접 변경하지 않는 새로운 자료구조를 사용하기도 합니다.</p>\n<p>규약에 다른 불변성은 편리하고 자연스러운 자바스크립트 코드를 만들어냅니다. 그리고 자바스크립트 에코시스템과도 잘 맞아떨어집니다. 하지만 이 방식은 개발자의 신뢰와 훈련(discipline)에 크게 의존합니다. 여러분은 객체의 직접 변경을 피하고 어디서 변경이 일어나는지 정확히 표현하는 등의 규약을 개발자들이 잘 따른다고 믿어야 합니다. 이쯤 오면 더 강한 규약이 필요하다 생각하게 됩니다.</p>\n<h3 id="라이브러리를-사용해서-빡세게-강제하는-척-하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%EA%B0%95%EC%A0%9C%ED%95%98%EB%8A%94-%EC%B2%99-%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리를 사용해서 빡세게 강제하는 척 하기</h3>\n<p>여러분은 데이터 변경이나 불변 자료구조를 위해 라이브러리를 도입해서 오롯이 개발자만 믿어야 하는 부분 일부를 도구 사용에 대한 믿음으로 옮겨올 수 있습니다. 광범위하게 <a href="http://ramdajs.com">Ramda</a>같은 ‘함수형 올인원 팩’ 같은 라이브러리를 도입할 수도 있고 <a href="https://github.com/calmm-js/partial.lenses">partial.lenses</a>, <a href="https://github.com/gcanti/monocle-ts">monocle-ts</a> 같은 렌즈 라이브러리를 도입할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> R <span class="token keyword">from</span> <span class="token string">\'ramda\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// 새 데이터를 만들어 반환한다</span>\n  <span class="token keyword">return</span> R<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 종류의 라이브러리의 기본 개념 중 하나는 사용하는 데이터를 마치 불변 데이터인 것 처럼 다룬다는 겁니다. 실제로는 그렇지 않은데도요. <a href="http://ramdajs.com/docs/#assoc">Ramda 는 얕은 복사(shallow clone)만 합니다.</a> 하지만 불변 데이터에 대한 규약이 충분히 강력하다면 모두들 ‘불변 데이터인 척’ 다루게 됩니다. 약간 퍼포먼스 손해를 보긴 하겠지만 일정 수준의 코드 신뢰도는 얻었습니다. 라이브러리를 광범위하게 사용하고 규약이 잘 잡혀있으면 최상의 효과를 발휘하겠지요.</p>\n<p>진정한 불변성을 강제하고 데이터 변경 시 퍼포먼스 손해를 최소화하려면 <a href="https://github.com/facebook/immutable-js">Immutable.js</a>, <a href="https://github.com/rtfeldman/seamless-immutable">seamless-immutable</a>, <a href="http://swannodette.github.io/mori/">Mori</a> 같은 불변 자료구조를 활용할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> I <span class="token keyword">from</span> <span class="token string">\'immutablejs\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// doc은 직접 수정할 수 없다</span>\n  <span class="token keyword">return</span> doc<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 데이터를 직접 변경할 수 없게 되며 외부로 드러난 인터페이스로만 변경할 수 있게 됩니다. 하지만 라이브러리에서 제공하는 특정 자료구조에서만 적용되는 데이터에만 한정됩니다. 대부분의 자바스크립트 코드는 기본적인 자바스크립트 자료구조에 의존하기 때문에, 결국에는 이리저리 데이터를 변환하게 되고(역주: ImmutableJS 의 <code class="language-text">toJS</code> 를 떠올려보세요) 기본적인 자료구조를 사용할 때마다 기껏 확보한 믿음을 잃어버리게 됩니다.</p>\n<p>규약을 거는 것과 불변 자료구조를 강제하는 방법 모두 한계가 있지만, 제일 큰 문제는 선택적 타입 시스템과 잘 맞지 않는다는 겁니다.</p>\n<h2 id="자바스크립트를-믿기"><a href="#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EB%AF%BF%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자바스크립트를 믿기</h2>\n<p>앞서 소개한 예시들은 선택적 타입, 함수를 통한 변형, 불변 데이터 등 더 효과적인 자바스크립트를 작성하기 위한 도구를 꺼내 본 것입니다. 하지만 자바스크립트를 쓰면서 이런 도구들을 도입 할 때 여러가지 한계점이 있으며, 같이 사용하기도 어렵습니다.</p>\n<h3 id="선택적-타입은-잘못된-보안-의식을-제공한다"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85%EC%9D%80-%EC%9E%98%EB%AA%BB%EB%90%9C-%EB%B3%B4%EC%95%88-%EC%9D%98%EC%8B%9D%EC%9D%84-%EC%A0%9C%EA%B3%B5%ED%95%9C%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입은 잘못된 보안 의식을 제공한다</h3>\n<p>선택적 타입은 말 그대로 자바스크립트에 선택적으로 도입할 수 있도록 설계되었습니다. 말인즉슨 모든 요소가 타입으로 정의된게 아니기 때문에 모두 유효한 타입을 가지고 있다고 믿는게 불가능합니다. Flow 는 타입이 불분명하며(unsound) Typescript 는 <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html">의도적으로 불분명하게(deliberately unsound)</a> 사용할 수 있습니다. 불분명하다는 의미는 여러 상황에서 타입이 타입이 맞지 않는데도 컴파일러가 알아채지 못하는 것을 뜻합니다.</p>\n<p>자바스크립트에서 선택적 타입을 사용 할 때 다른 이유로 맞지 않는 경우도 있습니다. 자바스크립트로 작성된 것들 중 일부는 Typescript 나 Flow 로 타입을 정의하기 어렵거나 심지어 불가능하기도 합니다.</p>\n<ul>\n<li>\n<p>고차 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#call"><code class="language-text">call</code></a>, <a href="http://ramdajs.com/docs/#compose"><code class="language-text">compose</code></a>, <a href="http://ramdajs.com/docs/#chain"><code class="language-text">chain</code></a>, <a href="http://ramdajs.com/docs/#lift"><code class="language-text">lift</code></a>, <a href="http://ramdajs.com/docs/#lens"><code class="language-text">lense</code></a> 계열 함수들</li>\n<li>partial.lenses 의 <a href="https://github.com/calmm-js/partial.lenses/issues/55">함수들</a></li>\n</ul>\n</li>\n<li>\n<p>동적 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#invert"><code class="language-text">invert</code></a>, <a href="http://ramdajs.com/docs/#dissoc"><code class="language-text">dissoc</code></a>, <a href="http://ramdajs.com/docs/#mergeWith"><code class="language-text">mergeWith</code></a></li>\n<li>ImmutableJS 의 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">거의 대부분의 함수</a></li>\n</ul>\n</li>\n<li>\n<p>몽키패칭</p>\n<ul>\n<li>AWS SDK 클라이언트의 <a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/using-promises.html#w2ab1c17c15c14c17">Promise</a></li>\n<li>Bluebird 의 <a href="http://bluebirdjs.com/docs/api/promisification.html">프로미스화 API 들</a></li>\n</ul>\n</li>\n<li>\n<p>아주 동적인 자료구조</p>\n<ul>\n<li>ElasticSearch <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-get">스키마</a></li>\n<li>winston <a href="https://github.com/winstonjs/winston#creating-your-own-logger">커스텀 로거</a></li>\n</ul>\n</li>\n</ul>\n<p>위의 것들을 Typescript 나 Flow 로 타입을 매기려면 여러분들은 아래 요소들 중 한개 이상은 희생해야 합니다.</p>\n<ol>\n<li><strong>타입을 쓰는 이유인 ‘타입 안정성’ 을 희생한다:</strong> <code class="language-text">any</code> 타입을 매겨서 모든 값을 허용하고 타입 체커가 <code class="language-text">any</code> 가 들어가는 경로에 있는 값을 확인하지 않게 만듭니다.</li>\n<li><strong>재사용성을 희생한다:</strong> 더 특정하고 정확한 타입을 제공하는 대신 함수의 재사용성을 낮춥니다.</li>\n<li><strong>다른 개발자의 시간을 희생한다:</strong> 함수를 사용하는 사람들에게 정확한 타입을 제공하도록 만듭니다. 예를 들자면 이렇게요.</li>\n</ol>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript">R<span class="token punctuation">.</span>pipe<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>선택지에 따라 라이브러리를 추가할 때 들쭉날쭉한 정확도를 가진 타입 정의도 함께 추가하게 됩니다. 이 때 라이브러리의 개발자를 향한 믿음 일부를 라이브러리의 ‘타입 정의’를 한 개발자에 대한 믿음으로 옮겨가게 됩니다. 대부분 이런 라이브러리는 <code class="language-text">any</code> 타입 정의를 포함하고 있고, 이렇게 정의 된 함수를 호출하면 자기도 모르는 새 맞지 않는 타입을 믿는다고 말하는 것이나 다름없습니다. 게다가 Flow 는 <code class="language-text">@flow</code> 어노테이션이 들어있지 않은 파일을 조용히 무시합니다.</p>\n<p>암시적이고 명시적으로 <code class="language-text">any</code> 타입을 허용하지 않도록 하면서, 타입 정의를 광범위하게 적용하고 타입 정의가 없는 파일은 린터가 오류를 뿜어내도록 설정하여 타입 신뢰성 문제를 해결할 수도 있습니다.</p>\n<p>하지만 이는 물이 새는 배의 구멍을 막는 것이나 마찬가지입니다. 진짜 문제는 여러분이 구축한 시스템의 타입 시스템을 믿지 못하는 것이 아니라 <strong>타입 시스템을 믿을 수 있다고 생각하는 겁니다.</strong> 타입에 기대어 뭔가 변화가 일어날 때 어디가 잘못되었는지 알려주도록 만들어보려 하지만, <code class="language-text">any</code> 타입 때문에 조용히 지나가거나, 라이브러리 사용 방법 혹은 타입의 정확성 문제 때문에 제대로 이루어지지 못합니다. 자바스크립트에 타입을 적용하는 것은 다른 언어에 적용되어있는 타입과는 다릅니다. 똑같은 수준의 신뢰를 기대할 수 없다는 뜻입니다.</p>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/01/types_and_js2-768x883.png"></p>\n<p>궁극적으로 여러분이 정의한 타입의 강점은 타입을 적용하는 팀의 지식 수준과 신념에 달려 있습니다. 팀이 타입에 대해 높은 수준의 믿음과 지식을 보유하고 있다면, 시스템에 대해 높은 신뢰를 이끌어낼 수 있습니다. 그러나 일정 수준의 신뢰도를 유지하기 위한 팀의 관심과 규율에 의존해야 하며, 두려움은 여러 가지 형태로 그 믿음을 망칠 수 있습니다.</p>\n<h3 id="함수형-프로그래밍-타입-자바스크립트---이-중-두개를-고르세요"><a href="#%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%ED%83%80%EC%9E%85-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8---%EC%9D%B4-%EC%A4%91-%EB%91%90%EA%B0%9C%EB%A5%BC-%EA%B3%A0%EB%A5%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수형 프로그래밍, 타입, 자바스크립트 - 이 중 두개를 고르세요</h3>\n<p>선택적 타입과 <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 를 활용한 기본적인 함수형 프로그래밍은 자바스크립트와 잘 작동합니다. 하지만 더 깊이 들어가려 하면 문제에 봉착하게 됩니다. 두 가지 예를 보여드리죠.</p>\n<p><a href="https://github.com/facebook/immutable-js">ImmutableJS</a>는 자바스크립트를 위한 영속적인 불변 자료구조 라이브러리입니다. 이 라이브러리는 내부 데이터 수정에 의존하지 않는 공용 자료구조를 제공합니다. <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">Typescript</a>와 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/immutable.js.flow">Flow</a>를 위한 타입 정의도 포함되어 있습니다만 한번 살펴보시면 타입 체킹을 무효화하는 <code class="language-text">any</code> 타입이 한가득 들어있습니다. 게다가 어떤 타입은 사용자가 정확한 타입을 제공하도록 책임을 떠넘기기도 합니다. 결과적으로 라이브러리를 사용할 때마다 타입을 도입하지 않을 수도 있고 타입을 도입하기 위해 추가적인 노력을 들일 수도 있습니다. 그러다보면 함수형 프로그래밍을 도입하기 어려워집니다.</p>\n<p>Ramda 는 자바스크립트를 위한 함수형 유틸리티 라이브러리입니다. 타입 정의는 <a href="https://github.com/types/npm-ramda#status">여기</a>에서 보실 수 있는데, 아래의 코멘트와 함께 제공됩니다. (중요한 부분은 강조했습니다)</p>\n<blockquote>\n<p>유의사항: Ramda 의 많은 함수들은 주로 부분 함수(partial application), 커링(currying), 조합(composition)을 중심으로 하는 문제들 때문에 정확한 타입을 제공하기 어렵습니다. 특히 제네릭이 있을 때 그렇습니다. <strong>그리고 네, 아마 여러분들이 Ramda 를 처음 사용하고자 했던 이유는 이런 기능을 사용하기 위해서겠지요.</strong> 특히 타입스크립트로 Ramda 의 타입을 적용하고자 할 때 문제가 됩니다. TS 에 관련 된 몇가지 이슈는 아래의 링크에서 확인하실 수 있습니다(역주: 링크가 실제 원하는 곳으로 연결되지 않아서 배제했습니다)</p>\n</blockquote>\n<p><a href="https://github.com/gcanti">Giulio Canti</a>같은 분의 엄청난 작업에도 불구하고, 매번 조금이라도 불변 자료구조나 함수 합성, 커링같은 고급 함수형 프로그래밍 기법을 도입하려고 하면 타입 체커를 비활성화하거나 타입이 제대로 동작하도록 만들기 위해 추가로 노력을 들여야 합니다. 여전히 함수형 프로그래밍을 도입하기 어렵게 만드는 요소입니다.</p>\n<h3 id="왜-우리는-자바스크립트로-고급진-개념을-사용할-수-없는가"><a href="#%EC%99%9C-%EC%9A%B0%EB%A6%AC%EB%8A%94-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A1%9C-%EA%B3%A0%EA%B8%89%EC%A7%84-%EA%B0%9C%EB%85%90%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 우리는 자바스크립트로 고급진 개념을 사용할 수 없는가</h3>\n<p>불변성은 코드에 골고루 사용될 때 가장 유용합니다. 하지만 자바스크립트라는 언어와 에코시스템 자체가 데이터를 변경하도록 설계되어있고, <a href="http://tagide.com/blog/research/constraints/">라이브러리 수준에서 불변성을 강제할 수 없습니다.</a> 또한 선택적 타입을 도입한다 한들 라이브러리로 불변성을 다룰 때 표현력이 떨어집니다.</p>\n<p>타입도 마찬가지로 골고루 사용될 때 최고의 효과를 발휘합니다. 하지만 자바스크립트에 타입을 사용하는 것은 어디까지나 선택적으로 사용할 수 있도록 설계되었으며, 자바스크립트와의 호환성을 유지하기 위해 극단적인 절충안(역주: <code class="language-text">any</code> 타입 같은 것?)을 취하여 표현력과 유용성을 제한하였습니다.</p>\n<p>타입, 불변성, 그리고 함수형 프로그래밍은 다른 언어에서도 사용되는 것 처럼 서로를 뒷받침할 수 있습니다. 기반 자료구조가 가변적이거나 런타임에는 (타입이) 존재하지 않더라도 타입이 불변성을 강제하는데 사용될 수 있습니다. 타입은 다른 개발자들이 렌즈를 사용하여 함수 합성을 하거나 데이터를 변형할 때 함수들을 제대로 연결하도록 도울 수 있습니다. 함수를 사용한 변형은 타입과 함께 사용할 때 이해하고 유지보수하기 쉬운데다 기반 자료구조가 불변성을 가지고 있는지 알 수 있을 때 더욱 유용합니다.</p>\n<h2 id="두려움을-가지고-코드를-작성하는-법-배우기"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EA%B3%A0-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%8A%94-%EB%B2%95-%EB%B0%B0%EC%9A%B0%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지고 코드를 작성하는 법 배우기</h2>\n<p>그렇다면 어떻게 두려움을 가지고 코드를 작성하는 법을 배울 수 있을까요? 더 나은 자바스크립트 코드를 작성하는 겁니다. 여러분 자신의 코드를 거의 믿을 수 없다는 기본 가정에서 시작하여 함수형 자바스크립트를 작성하고 언어 자체의 나쁜 부분을 피하는 수 많은 기술을 배울 수 있습니다. 필요한 부분에는 타입 유효성 검사를 사용하고 꼭 필요한 경우거나 규약으로 명확히 강제할 때 불변 데이터를 사용합니다. 합당한 이유가 있을 때 선택적 타입을 도입하되, 함수형으로 데이터를 다루거나 불변 데이터를 사용하는 것이 더 나은 이득을 제공한다고 판단되면 타입 사용을 포기합니다. 함수 합성이나 렌즈를 사용하기 위해 의도적으로 타입 체킹을 비활성화 할 수 있습니다.</p>\n<p>아니면 아예 <a href="http://www.purescript.org/">PureScript</a>, <a href="https://bucklescript.github.io/">ReasonML</a>, <a href="http://elm-lang.org/">Elm</a>, <a href="https://clojurescript.org/">ClojureScript</a> 등을 사용하여 다른 물에서 노는 방법이 있습니다. 이 언어들은 오늘날 실존하며 실제 프로덕션 앱이 동작하고 있습니다. 필요하다면 자바스크립트 에코시스템과 함께 동작할 수 있습니다. 불변성, 함수형 프로그래밍, 타입(해당되는 경우)이 기본적으로 잘 작동하고, 이 요소들이 함께 작동하는 환경에서 보다 높은 수준의 신뢰를 제공합니다.</p>\n<p>이런 언어들 중 하나를 선택한다고 모든 문제를 해결할 수는 없습니다. 각자의 언어는 또 문제를 가지고 있습니다. 하지만 기본적으로 자바스크립트에 비해 더 높은 신뢰성이 있으며 필요에 따라 그 신뢰 수준을 끌어올리거나 낮추는 더 나은 도구를 제공합니다. 다음 포스트에서 PureScript 를 활용하여 이런 아이디어가 어떻게 적용되는지 이야기해보겠습니다.</p>\n<p><strong><em>하지만 자바스크립트를 쓰는 한, 두려움은 언제나 여러분과 함께합니다</em>.</strong></p>',
id:"/home/circleci/repo/src/pages/posts/2018-03-04-fear-trust-and-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-03-04",path:"/posts/fear-trust-and-javascript-kr",title:"[번역] 두려움, 믿음, 그리고 자바스크립트 - 언제 타입 시스템과 함수형 프로그래밍이 먹히지 않는가",tags:["Functional Programming","Javascript","Typescript"],category:"Javascript"}},{excerpt:"제가 요즘 프론트엔드 개발을 하면서 주로 관심을 가지고 있는 분야는 CSS로 레이아웃을 더 잘 잡아보기 (without Grid, Flex - 하위호환 때문에…) + 더 사용자 친화적인 UI…",html:'<p>제가 요즘 프론트엔드 개발을 하면서 주로 관심을 가지고 있는 분야는</p>\n<ul>\n<li>CSS로 레이아웃을 더 잘 잡아보기 (without Grid, Flex - 하위호환 때문에…) + 더 사용자 친화적인 UI 고려하기</li>\n<li>타입스크립트의 타입 시스템을 적극적으로 활용해보기</li>\n<li>타입스크립트 뿐 아니라 자바스크립트의 기초에 소홀히 하지 않기</li>\n<li>다양한 프로그래밍 패러다임과 이론을 익히면서 실무에 접목하기 -> 더욱 간결하고 유지보수가 용이한 코드 작성하기</li>\n<li><a href="/posts/what-is-testing-javascript-kr">테스팅</a></li>\n</ul>\n<p>이 정도로 나열해 볼 수 있습니다.</p>\n<p>오늘은 이 중 세 번째와 네 번째 주제에 대해 아주 가벼운 이야기를 해 보려고 합니다. 최근에 자바스크립트 개발과 관련된 담론에서 많이 거론되는 용어가 있습니다. <strong><a href="https://www.reactivemanifesto.org/ko">Reactive Programming</a> - 이 선언에 기반한 RxJS 등의 라이브러리</strong>, <strong>Functional Programming(함수형 프로그래밍)</strong> 입니다. 사실 이 용어들이 등장한 것은 꽤 오래 전 일이라고 합니다만.. 저는 요즘에서야 눈을 돌리게 되었네요.</p>\n<p>그렇게 함수형 프로그래밍에 관심을 가지면서 책이나 강연 등을 살펴보고, 얼마 전에는 함수를 적극적으로 활용하여 CSS 파일을 압축(minify)하는 아주 간단한 함수를 만들었습니다. 이 압축 함수를 만들면서 제가 조금이나마 익힌 함수형 프로그래밍의 개념을 어떻게 활용했는지, 어떻게 발전시킬 수 있을지 함께 고민하는 시간을 마련해보고자 합니다.</p>\n<p>앞으로 제가 선보일 내용은 아주 기초적인데다 심지어 틀릴 수도 있으니 이상한 점이나 잘못된 점이 있다면 댓글이나 메일로 피드백 주시면 대단히 고맙겠습니다.</p>\n<h2 id="함수형-프로그래밍이란"><a href="#%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수형 프로그래밍이란</h2>\n<p>제가 아는 한에서 여러가지로 장황하게 설명을 해 보려고 했으나, 다음 번역 글이 아주 좋은 설명을 하고 있다고 생각하여 링크로 대신하고자 합니다.</p>\n<ul>\n<li><a href="https://medium.com/@jooyunghan/%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80-fab4e960d263">(번역) 함수형 프로그래밍이란 무엇인가? – Jooyung Han (한주영) – Medium</a></li>\n<li><a href="https://medium.com/@jooyunghan/%EC%96%B4%EB%96%A4-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%96%B8%EC%96%B4%EB%93%A4%EC%9D%B4-%ED%95%A8%EC%88%98%ED%98%95%EC%9D%B8%EA%B0%80-fec1e941c47f">(번역) 어떤 프로그래밍 언어들이 함수형인가? – Jooyung Han (한주영) – Medium</a></li>\n</ul>\n<p>제 나름의 정의를 내리자면 “더 안정적인 프로그램을 만들기 위해 입력과 출력이 철저히 통제된 순수 함수 및 부수 효과(Side-effect)를 최소화한 함수 위주로 프로그래밍 하는 것. 이를 통해 간결하고 가독성 높은 프로그램을 작성할 수 있으며 동시성 작업을 더 안전하게 구현할 수 있다.” 라고 말씀드릴 수 있겠습니다. 여기서 한마디 더 얹어보자면 <strong>함수를 특별하게 취급하지 않는 프로그래밍 패러다임</strong> 이라고 말씀드릴 수 있겠습니다.</p>\n<p>사실 자바스크립트는 <strong>함수형 프로그래밍 언어가 아닙니다.</strong> 이 점은 반드시 인지하고 계셔야 합니다. 단순히 자바스크립트에서 함수가 일급 객체(First Class Citizen)이기 때문에 함수형 프로그래밍 언어인 것은 아닙니다. 함수형 프로그래밍이 가능한 정도입니다. 아마 이 주제 때문에 글 하나가 더 나오겠지만.. 언젠가 제가 더 확고한 기반지식을 쌓고 작성할 기회가 있으리라 생각합니다. (사실 이미 다른 분들의 훌륭한 글이나 번역이 많아서요)</p>\n<h2 id="css-압축-함수-만들기---초기-버전"><a href="#css-%EC%95%95%EC%B6%95-%ED%95%A8%EC%88%98-%EB%A7%8C%EB%93%A4%EA%B8%B0---%EC%B4%88%EA%B8%B0-%EB%B2%84%EC%A0%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 압축 함수 만들기 - 초기 버전</h2>\n<p>리액트 프로젝트를 하면서 외부 CSS나 미리 설정된 CSS를 HTML 헤더에 삽입할 일이 있는데, 저는 이 CSS 파일이 고스란히 노출되기보다 최소한 공백이나 개행 등을 제거하여 용량을 줄이고, 사용자가 조금이라도 빠르게 컨텐츠를 볼 수 있기를 원했습니다. 예를 들면 최상단에 페이지의 기본 설정을 위해 다음과 같은 CSS를 설정하였습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* page-setup.css */</span>\n<span class="token selector">html</span> <span class="token punctuation">{</span>\n  <span class="token property">font-size</span><span class="token punctuation">:</span> 62.5%<span class="token punctuation">;</span>\n  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">html, body</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">div, p, h1, h2, h3, h4, h5, h6, ul, ol, li, dl, dt, dd,\ntable, th, td, form, fieldset, legend, input, textarea, blockquote, button</span> <span class="token punctuation">{</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">*, *:before, *:after</span> <span class="token punctuation">{</span>\n  <span class="token property">box-sizing</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">li</span> <span class="token punctuation">{</span>\n  <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>사실 CSS는 중괄호(<code class="language-text">{}</code>) 만 제대로 열고 닫히고, 세미콜론을 지켜주는 등 기본적인 문법 요소만 충족하면 정상적으로 동작합니다. 다만 <code class="language-text">margin: 0 auto;</code>  같이 작성되어 있을 때는 <code class="language-text">0</code> 과 <code class="language-text">auto</code> 사이의 공백은 유지해야합니다. 그래서 제가 만들려는 함수의 필요 구현 조건은 이랬습니다.</p>\n<ul>\n<li>CSS 파일 앞 뒤에 불필요한 공백과 개행이 없어야한다.</li>\n<li>CSS 파일 내부에도 개행이 없어야한다.</li>\n<li>CSS 파일 내부에서 다음 문자 주위의 공백은 불필요하다 -> <code class="language-text">,</code>, <code class="language-text">;</code>, <code class="language-text">:</code>, <code class="language-text">{</code>, <code class="language-text">}</code></li>\n</ul>\n<p>그래서 CSS파일 자체를 문자열로 읽어들여서 이를 <code class="language-text">string#trim</code>, <code class="language-text">string#replace</code> 메서드로 수정하는 함수를 만들었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">cssMinifierNormal</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> cssString\n    <span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -> CSS 전후 공백 및 개행 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[\\r\\n]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token comment">// -> 개행 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*,\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\',\'</span><span class="token punctuation">)</span>  <span class="token comment">// -> 해당 문자열 주위의 공백을 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*;\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*:\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*{\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*}\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>아직까진 너무 간단한 함수입니다. 만약에 이 함수가 300개 이상의 규칙을 가지고 있다고 한다면 이렇게 작성하는게 옳은 방법일까요? 300개 이상의 규칙을 가지고 있는 함수에 새로운 규칙을 추기해야한다면 어디에 어떻게 추가해야 문제가 없을까요? 아마 당장은 이런 문제에 부딪힐 일이 없겠지만 약간의 고민 끝에 다른 방식으로 구현해 보았습니다.</p>\n<h2 id="함수로-풀어보자"><a href="#%ED%95%A8%EC%88%98%EB%A1%9C-%ED%92%80%EC%96%B4%EB%B3%B4%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수로 풀어보자</h2>\n<p>이번에는 서로 다른 함수를 조합하는 방식으로 또 다른 <code class="language-text">cssMinifier</code> 함수를 만들어보겠습니다. 먼저 조금씩 각기 다른 공백 제거 함수를 분리해보겠습니다.</p>\n<ul>\n<li><code class="language-text">trim</code>: 전후 공백 및 개행 삭제</li>\n<li><code class="language-text">replace</code>: 특정 정규표현식에 해당하는 문자열 교체</li>\n</ul>\n<p>어? 방금 우리가 위에서 사용한 메서드 아닌가요? 하지만 이 메서드를 함수로 표현한다면 약간 이야기가 달라집니다. 함수를 평소와는 약간 다르게 구현해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">=></span> str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// function trim(str) {</span>\n<span class="token comment">//   return str.trim();</span>\n<span class="token comment">// }</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">replace</span> <span class="token operator">=</span> <span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> newSubStr<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">=></span>\n  str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> newSubStr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n<span class="token comment">// function replace(regExp, newSubStr) {</span>\n<span class="token comment">//   return function replacer(str) {</span>\n<span class="token comment">//     return str.replace(regExp, newSubStr);</span>\n<span class="token comment">//   }</span>\n<span class="token comment">// }</span>\n</code></pre>\n      </div>\n<p>화살표 함수(Arrow Function)는 보신적이 있어도 화살표가 이중으로 쓰여진 부분은 익숙지 않으신 분들이 계실지도 모르겠습니다. 그래서 아래에 일반 함수 표현식으로 작성하는 법도 따로 표기했습니다. <code class="language-text">replace</code> 는 일종의 부분 함수입니다. 첫 번째로 인자를 입력해 두면 그 다음에는 <code class="language-text">string#replace</code> 메서드를 적용할 문자열의 입력을 기다리는 함수가 리턴됩니다. (커링이라고 말씀드리려 했으나 엄밀히 따지면 커링은 여러 개의 인자를 받는 함수를 각각 한개씩 받을 수 있도록 만들어주는 기법이라고 이해하고 있어서 부분 함수라고 표현합니다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 콤마 주변의 공백을 제거하는 함수 할당</span>\n<span class="token keyword">const</span> removeSpaceAroundComma <span class="token operator">=</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*,\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\',\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">removeSpaceAroundComma</span><span class="token punctuation">(</span><span class="token string">\'One , Two , Three , Four\'</span><span class="token punctuation">)</span>\n<span class="token comment">// => \'One,Two,Three,Four\'</span>\n</code></pre>\n      </div>\n<p>위의 <code class="language-text">replace</code> 함수를 이런 식으로 활용할 수 있습니다. 조금만 손을 보면 어떤 문자 주변의 공백이든 손쉽게 제거해주는 함수를 만들 수 있겠네요. </p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">removeSpaceAroundChar</span> <span class="token operator">=</span> <span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\\\\s*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>char<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\\\s*`</span></span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> removeSpaceAroundSemi <span class="token operator">=</span> <span class="token function">removeSpaceAroundChar</span><span class="token punctuation">(</span><span class="token string">\';\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">removeSpaceAroundSemi</span><span class="token punctuation">(</span><span class="token string">\'; undefined is not a function ; \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// => \';undefined is not a function;\'</span>\n</code></pre>\n      </div>\n<p>아까 작성한 메서드 체인처럼 원하는 모든 문자열 주변의 공백을 제거하는 함수를 준비해보겠습니다. <code class="language-text">Array#map</code>  함수를 쓰고자 하지만 이번에는 <code class="language-text">map</code> 함수조차 직접 만들어봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token punctuation">(</span>iteratee<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">=></span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>iteratee<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// function map(iteratee) {</span>\n<span class="token comment">//   return function mapped(list) {</span>\n<span class="token comment">//     return list.map(iteratee);</span>\n<span class="token comment">//   }</span>\n<span class="token comment">// }</span>\n</code></pre>\n      </div>\n<p>사실 이번 글에서는 새롭게 작성한 <code class="language-text">map</code> 함수를 별로 사용할 일이 없을지 모르지만, 인자를 나중에 받는 방식으로 구현하면 함수끼리 조합이 용이해지는 이점이 있기 때문에 시험삼아 만들어봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> shrinkers <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>removeSpaceAroundChar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\',\'</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 특정 문자열 주변의 공백을 제거해주는 함수의 배열을 만들었습니다. 그러면 이제 익숙한 <code class="language-text">Array#forEach</code> 함수나 <code class="language-text">Array#reduce</code> 로 문자열을 수정하면 되겠지요. 이렇게요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">shrinkCss</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> shrinkers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> shrinker<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">shrinker</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span><span class="token punctuation">,</span> cssString<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>오늘의 목표는 여기서 끝내는게 아닙니다. 함수를 만드는 것 까지 해봤으니 만든 함수를 <strong>조합</strong>해서 문제를 한번에 해결해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">pipe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=></span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fn</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">pipe</span><span class="token punctuation">(</span>\n  x <span class="token operator">=></span> x <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span>\n  x <span class="token operator">=></span> x <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span>\n  x <span class="token operator">=></span> x <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// => 3000</span>\n</code></pre>\n      </div>\n<p>보시는대로 <code class="language-text">pipe</code> 함수는 인자로 받은 함수를 모아놨다가 적용할 값을 받아서 왼쪽에서 오른쪽으로(위에서 아래로) 순차적으로 연산합니다. 보통 반대로 <code class="language-text">compose</code> 함수를 쓰는 경우도 있는데, 저는 가독성 측면에서 아직은 <code class="language-text">pipe</code>  를 선호합니다.</p>\n<p>그럼 여태 만든 함수를 저 파이프라인에 쌓아두고 CSS 문자열을 넣기만 하면 우리가 원하는 문자열이 나오겠군요? 한번 최종 결과물을 만들어 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nfs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">\'./page-setup.css\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">\'utf-8\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cssMinifier</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">cssMinifier</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">removeSpaceAroundChar</span> <span class="token operator">=</span> char <span class="token operator">=></span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\\\\s*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>char<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\\\s*`</span></span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> removeNewLine <span class="token operator">=</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[\\r\\n]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> shrinkers <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>removeSpaceAroundChar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\',\'</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">pipe</span><span class="token punctuation">(</span>trim<span class="token punctuation">,</span> removeNewLine<span class="token punctuation">,</span> <span class="token operator">...</span>shrinkers<span class="token punctuation">)</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>구문 자체는 약간 복잡해졌을지 몰라도 코드 줄 수는 확연히 줄었으며 만약에 규칙을 추가해야 할 때는 어느 부분에 무엇을 추가해야하는지가 조금 더 간편해지고 명확해졌습니다. 각자 역할을 나타내는 이름을 가진 함수니까요. 지금은 <code class="language-text">shrinkers</code> 오른편에 있는 배열에 원하는 글자만 추가해주면 새로운 공백 제거 규칙이 생성됩니다.</p>\n<p><code class="language-text">shrinkers</code> 는 함수의 배열인지라 <code class="language-text">pipe</code> 함수에 넣을 때는 전개 연산자(Spread Operator)로 풀어헤쳐서 인자로 적용하였습니다. 아마 <code class="language-text">pipe</code> 함수를 고도화하면 배열로 된 인자에도 대응할 수 있겠지요. 이번 시간에는 작게나마 제가 이해하고 있는 부분만 말씀드렸습니다.</p>\n<h2 id="이렇게도-해-보고-저렇게도-해-보고"><a href="#%EC%9D%B4%EB%A0%87%EA%B2%8C%EB%8F%84-%ED%95%B4-%EB%B3%B4%EA%B3%A0-%EC%A0%80%EB%A0%87%EA%B2%8C%EB%8F%84-%ED%95%B4-%EB%B3%B4%EA%B3%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이렇게도 해 보고, 저렇게도 해 보고</h2>\n<p>저도 요즘에야 이렇게 함수를 적극적으로 활용하여 주어진 문제를 풀어나가는 법을 연습하고 있습니다. 머리로 아무리 알고만 있어도 실제로 써먹지 않는다면 사용 가능한 지식이 아니겠지요. 위에 작성한 <code class="language-text">replace</code>, <code class="language-text">map</code>, <code class="language-text">pipe</code> 함수는 원래대로라면 훨씬 고려해야 할 요소들이 많을지도 모릅니다. 제대로 된 인자가 들어왔는지, 더 재사용 가능한 방법이 있는지 등등... 저는 일단 실무에서 <a href="http://ramdajs.com">Ramda.js</a> 를 활용하고 있습니다. 위에 작성한 함수 모두 <code class="language-text">R.replace</code>, <code class="language-text">R.map</code>, <code class="language-text">R.pipe</code> 로 대체 가능합니다.</p>\n<p>가능한 부분에 적극적으로 함수를 활용한 프로그래밍을 하자니 아직 모르는 점이 많습니다.</p>\n<ul>\n<li>비동기 작업(Promise 등)을 일으키는 함수를 다른 함수와 조합하려면 어떻게 해야할까?</li>\n<li>아무 생각없이 작성하는 클래스 상속도 함수의 조합만으로 해결 할 수 있어보이는데, 어떻게 해야할까?</li>\n<li>함수만으로 코드를 작성하자니 어색하다. 뭔가 Class 같이 공통된 역할을 하는 함수를 모으는 일도 해야할까? 한다면 어떻게 해야할까?</li>\n<li>재사용 가능한 함수를 어떻게 만들 수 있을까? 이 함수를 조합하는 방법은 더 다양할 것 같은데 어떤 게 있을까?</li>\n</ul>\n<p>이미 제가 했던 고민을 거쳐온 분들이라면 조금이라도 조언을 부탁드리고 싶고, 위의 문제를 해결하는 방식이 생소한 분들이라면 한번 기존에 작성했던/앞으로 작성하실 코드에 저처럼 다양한 시도를 해 보시길 권하고 싶습니다. 반드시 함수형 프로그래밍이라는 개념을 익힐 필요는 없습니다. 기존의 틀을 벗어나 새로운 시각을 받아들이고 적용하고자 할 때, 더 좋은 프로그램을 만들 수 있는 가능성이 열린다고 생각합니다.</p>\n<h2 id="참고-자료"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2>\n<ul>\n<li><a href="http://ramdajs.com">Ramda Documentation</a></li>\n<li><a href="http://merong.city">merong님의 함수형 자바스크립트 프로그래밍 강좌</a></li>\n<li><a href="https://www.gitbook.com/book/mostly-adequate/mostly-adequate-guide">Frisby 교수님의 함수형 적절한 함수형 프로그래밍 가이드 · GitBook</a></li>\n<li><a href="https://egghead.io/courses/professor-frisby-introduces-composable-functional-javascript">Professor Frisby Introduces Composable Functional JavaScript from @drboolean on @eggheadio</a></li>\n<li><a href="http://aladin.kr/p/rUEvd">함수형 자바스크립트 - 모던 웹 개발에 충실한 실전 함수형 프로그래밍 안내서</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2018-02-19-functional-js-tutorial/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-02-19",path:"/posts/functional-js-tutorial",title:"자바스크립트로 함수형 프로그래밍 아주 살짝 맛보기",tags:["Functional Programming","Javascript"],category:"Functional Programming"}}],Javascript:[{excerpt:"책 링크 일단 자바스크립트 초급자가 읽기 좋은 책은 아니다. 하지만 자바스크립트를 좀 다루면서, Redux 나 RxJS 같은 라이브러리를 접해본 사람들이\n'왜 이런 방식으로 코드를 작성해야하는지' 단서를 얻을 수도 있고, 더 나아가서 함수형 프로그래밍의 기본 개념을 자신에게 익숙한 자바스크립트로 익힐 수 있다. 특히…",html:'<p><img src="https://cl.ly/0w3j30140G45/functional-javascript-cover.jpg" alt="Functional Javascript Cover"></p>\n<p><a href="http://aladin.kr/p/rUEvd">책 링크</a></p>\n<p>일단 자바스크립트 초급자가 읽기 좋은 책은 아니다. 하지만 자바스크립트를 좀 다루면서, Redux 나 RxJS 같은 라이브러리를 접해본 사람들이\n\'왜 이런 방식으로 코드를 작성해야하는지\' 단서를 얻을 수도 있고, 더 나아가서 함수형 프로그래밍의 기본 개념을 자신에게 익숙한 자바스크립트로 익힐 수 있다.</p>\n<p>특히 5 장 때문에 이 책을 활용한 단기 스터디를 진행했는데, 확실히 팀원에게 내가 생각하는 함수 분할 및 조합에 대한 생각을 공유하고 이해시키는데 많은 도움이 되었다.</p>\n<p>번역은 자잘한 오타와 바로 이해가 되기 어려운 내용이 일부 있지만, 최근에 본 다른 책의 번역에 비하면 훨씬 나은 편이다.</p>\n<p>개인적으로 국내 저서 \'함수형 자바스크립트 프로그래밍(유인동 저)\' 보다는 이 책을 먼저 추천하고 싶다.\n국내 저서도 충분히 기본적인 내용을 소개하고 직접 유틸리티 함수를 구현해보는 방식의 접근을 취하고 있지만,\n2017 년에 나오는 책이 ES6 문법을 메인으로 채택하고 있지 않는 이유를 모르겠다.\n또한 정말 본질적으로 궁금했던 Functor 와 Monad 의 개념 및 활용법, 그리고 비동기 함수를 다루는 방법에 대해서는 명시적으로 드러내고 있지 않아서 약간 아쉬웠다.</p>\n<p>다행히도 이 책은 아쉬웠던 부분을 어느 정도 다루고 있기 때문에 나처럼 국내 저서에 그닥 만족스럽지 못했던 사람에게는 그래도 조금 더 나은 책이 될 것이다.</p>\n<hr>\n<p>(2018–03–22 추가) 국내 저서 ‘함수형 자바스크립트 프로그래밍’ 의 저자 유인동님이 지금 읽고 계시는 리뷰에 대해  <a href="http://bit.ly/2HYKHC4">답변을 달아주셨습니다</a>. 꼭 읽어보시길 권합니다. 또한 인동님이 최근에 <a href="https://github.com/Functional-JavaScript/functional.es">Github 에 ES6 에 초점을 맞춘 내용으로 다른 글을 작성하고 계시니</a>  참고하시면 많은 도움이 되리라 생각합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2018-03-14-functional-javascript-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-03-14",path:"/posts/functional-javascript-review",title:"함수형 자바스크립트(루이스 아텐시오 저) 리뷰",tags:["Functional Programming","Javascript"],category:"Javascript"}},{excerpt:"이 포스트는  Nicholas Kariniemi 의  Fear, trust and JavaScript: When types and functional programming fail…",html:'<ul>\n<li>이 포스트는 <a href="https://twitter.com/nkariniemi">Nicholas Kariniemi</a>의 <a href="https://www.reaktor.com/blog/fear-trust-and-javascript/">Fear, trust and JavaScript: When types and functional programming fail</a>를 번역한 글입니다</li>\n<li>번역에 관한 피드백과 내용에 관한 토론은 환영합니다. 댓글로 남겨주세요 :)</li>\n</ul>\n<hr>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/02/reaktor-javascript-reaktor-hero-2800x0-c-default.png"></p>\n<p>개발자로서 우리는 코드 실패에 대한 두려움을 줄이고 코드가 잘 작동한다는 믿음을 더 높이고 싶을 겁니다. 자바스크립트를 사용하는 많은 개발자는 함수형 프로그래밍 및 강타입(Strongly-typed) 언어에서 유용한 아이디어를 빌려 개발자의 도구와 코드로 신뢰를 얻으면서 두려움을 줄입니다. 선택적 타입과, 함수를 통한 변환 및 불변성과 같은 아이디어는 모두 더 나은 자바스크립트 코드 작성에 도움이 될 수 있습니다. 그러나 이러한 아이디어를 자바스크립트로 가져올 때 상충하는 개념 때문에 제대로 맞물려 작동하지 않으며, 궁극적으로 ‘개발자가 코드와 도구로 (코드가 잘 작동한다는) 믿음을 표현한다’는 목표를 달성하지 못합니다.</p>\n<p>이 아이디어를 설명하기 위해 자바스크립트에서 데이터를 처리하는 방법을 두 가지 관점에서 살펴보겠습니다. 하나는 데이터의 모양을 이해하는 것이고, 나머지 하나는 데이터를 변경하는 것입니다.</p>\n<h2 id="데이터의-형태와-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%ED%98%95%ED%83%9C%EC%99%80-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터의 형태와 두려움</h2>\n<p>자바스크립트같은 동적 언어에서는 데이터가 어떤 모양을 가지고 있는지 알기 어렵습니다. 기본적인 접근 방식은 규약(convention)에 의지하는 겁니다. 다른 개발자나 다른 시스템이 서로 동의한 형식으로 올바른 데이터를 제공하고 코드 내의 특정 규범을 따른다고 믿어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 name이 있을 거야</span>\n</code></pre>\n      </div>\n<p>저는 이 방식을 “내가 원하는 것인 척” 하는 접근 방식이라고 말하고 싶습니다. 상호 신뢰가 높은 환경에서는 이 방법이 충분히 유효합니다.</p>\n<p>하지만 실제로는 여기저기 두려움이 가득 차 있습니다. 코드가 복잡해지면서 여러분은 서로 다른 규칙을 따르는 개발자의 코드와 씨름합니다. 잘못된 형식으로 날아오지만 현재 계층에서는 손댈 수 없는 데이터를 수신하며, 널 포인터(null pointer) 오류가 발생하기 시작합니다. 코드에 대한 신뢰가 깨지고 데이터에 대한 의문을 가질 때 자신감보다는 불안감이 일어나기 시작합니다.</p>\n<ul>\n<li>이 데이터가 정말 가지고 있는 값이 뭐지?</li>\n<li>이 값을 지우면 어디 다른데서 터지지 않을까?</li>\n<li>이 데이터를 저 함수에다 넘겨도 될까?</li>\n</ul>\n<p>위의 두려움을 이런 방식의 코드 베이스에서 발견할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>\'자기 자신의 코드가 더 이상 기대되는 데이터를 적절하게 전달해주지 못한다’며 믿음을 잃을 때 이렇게 방어적인 프로그래밍을 하게 됩니다. 여러분의 아름다운 코드는 방어적인 체크 때문에 어수선해지고, 가독성을 잃으며, 유지보수하기 어려워집니다. 두려움이 커지면서 점점 코드가 제대로 동작하는지 믿기 어려워집니다.</p>\n<h3 id="선택적-타입optional-types으로-빡세게-확인하는-척하기"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85optional-types%EC%9C%BC%EB%A1%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%ED%99%95%EC%9D%B8%ED%95%98%EB%8A%94-%EC%B2%99%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입(Optional types)으로 빡세게 확인하는 척하기</h3>\n<p>두려움을 사전에 차단하는 방법 중 하나는 <a href="https://www.typescriptlang.org">Typescript</a>나 <a href="https://flow.org">Flow</a>의 선택적 타입을 도입하는 겁니다. 사용자를 수신할 때 <code class="language-text">User</code> 타입을 사전에 선언해두고, 이후에 <code class="language-text">User</code> 객체로 다루는 방식입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>이는 정말 ‘빡세게 확인하는 척’ 하는 겁니다. 당신은 코드에 대한 신뢰를 확인하는 부분을 바꿔 놓았습니다. 여전히 다른 시스템이 올바른 모양의 데이터를 제공한다고 믿지만, 코드 안에서 데이터에 부여한 타입을 믿고 해당 데이터를 잘못 사용하면 컴파일러에서 오류가 나게 됩니다. 개발자가 데이터의 모양을 알고 적절하게 사용하는 것을 믿는 대신 개발자가 올바른 타입을 작성하고 관리하리라 믿고, ‘컴파일러가 해당 형식에 대해 거짓말을 하지 않는다’고 믿게 되었습니다. 이 이야기는 나중에 더 하겠습니다.</p>\n<p>위의 예제에 타입을 추가해도 근본적인 문제는 해결되지 않습니다. 데이터가 일관성있게 사용되도록 보장함으로써 코드의 신뢰도는 향상되었지만 외부로부터 받은 데이터에 대해서는 아무런 말을 하지 않습니다.</p>\n<h3 id="유효성-검사-믿지만-검사는-해볼게"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC-%EB%AF%BF%EC%A7%80%EB%A7%8C-%EA%B2%80%EC%82%AC%EB%8A%94-%ED%95%B4%EB%B3%BC%EA%B2%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사: 믿지만 검사는 해볼게</h3>\n<p>신뢰도가 낮은 환경에서는 여러 지점에서 데이터의 유효성 검사를 해야 할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 이름이 있다</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 직접 작성할 수도 있지만 임시 방편에다 다루기도 어렵고 오류가 나기도 쉽습니다. 아니면 <a href="http://json-schema.org">JSON schema</a> 정의를 작성해서 데이터가 스키마에 맞는지 확인하거나, <a href="https://github.com/epoberezkin/ajv">ajv</a>같은 도구로 유효성 검사를 할 수도 있습니다. 이렇게 하면 임시 방편처럼 보이지도 않고 문서화 등을 할 때 유용하게 쓸 수 있겠지만, 여전히 여러분이 이렇게 직접 스키마를 작성해야 하기 때문에 오류가 날 가능성이 있으며 번거로운 작업이 될 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"User"</span><span class="token punctuation">,</span>\n  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>\n  <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="선택적-타입--유효성-검사"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85--%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입 + 유효성 검사</h3>\n<p>아니면 타입과 유효성 검사를 함께 사용할 수도 있습니다. 타입을 이용해서 코드 속의 두려움을 걷어내고, 유효성 검사를 통해서 외부로부터 들어오는 데이터를 믿을 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭠마 난 널 믿었는데\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>선택적 타입과 유효성 검사에 같은 정의를 하는 번거로운 작업을 피하기 위해서 Typescript 와 Flow 컴파일러를 직접 라이브러리로서 사용하거나(역주: 어떻게 하는지 방법은 모르겠습니다), <a href="https://github.com/pelotom/runtypes">runtypes(TS)</a>, <a href="https://github.com/seanhess/runtime-types">runtime-types(Flow)</a>, <a href="https://github.com/YousefED/typescript-json-schema">typescript-json-schema(TS)</a> 같은 별도의 라이브러리를 사용할 수도 있습니다. 몇 개의 장애물을 넘고 나면 여러분의 데이터를 더 믿을 수 있게 됩니다. 하지만 더 깊은 곳에 깔린 문제가 있습니다. 조금 뒤에 살펴보겠습니다.</p>\n<h2 id="데이터-변경의-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%80%EA%B2%BD%EC%9D%98-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 변경의 두려움</h2>\n<p>데이터가 바뀔 때는 어떨까요? 기본적으로 자바스크립트에서 데이터는 아무렇게나(willy-nilly) 바뀔 수 있습니다. 예를 들어 여기 문서를 받는 함수가 있는데 이 함수는 문서의 필드를 적절하게 손보고 새 필드를 삽입합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 스타일의 코드는 따라가기도 어렵고 곳곳에 두려움이 도사리고 있습니다. 내 데이터가 다른데서 사용된다면? 이미 다른 곳에서 변경되었다면? 이 시점에서 내 데이터가 가지고 있어야 하는 값이 뭐더라? 내가 지금 가지고 있는 데이터와 내가 실제 사용할 때의 데이터가 어떻게 같은 데이터라고 믿을 수 있지? 위의 예는 아주 작은 부분에 불과하지만 높은 동시성이 요구되는 시스템이나 커다란 코드 베이스에서는 훨씬 큰 문제를 야기할 겁니다.</p>\n<p>선택적 타입을 사용해보지만 별로 도움은 되지 않습니다. Typescript 와 Flow 에서 아래 두 함수는 같은 타입을 가리킵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> String<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-flow"><code class="language-flow"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> <span class="token type tag">String</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token type tag">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token type tag">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n  child_process<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"sudo rm -rf /"</span><span class="token punctuation">)</span>\n  <span class="token function">launchRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이 중 하나는 여러분이 원하는 기능을 수행하지만 나머지 하나는 서비스를 불바다로 만들어버릴 겁니다. 타입 시스템을 통해 바라보면 이 함수는 아무것도 안하는 것이나 마찬가지입니다(역주: 리턴 값이 <code class="language-text">void</code> 라서 그럴까요?).</p>\n<h3 id="불변성을-가장한-규약"><a href="#%EB%B6%88%EB%B3%80%EC%84%B1%EC%9D%84-%EA%B0%80%EC%9E%A5%ED%95%9C-%EA%B7%9C%EC%95%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>불변성을 가장한 규약</h3>\n<p>이제 여러분은 자바스크립트를 더 잘 다룰 수 있고, 팀 안에서 합의를 이루어서 명시적이고(explicit) 묵시적(implicit)으로 불변성을 가지도록 코드를 작성하기 시작합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    creationDate<span class="token punctuation">:</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    source<span class="token punctuation">:</span> source<span class="token punctuation">,</span>\n    text<span class="token punctuation">:</span> doc<span class="token punctuation">.</span>text\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 데이터 변경하지 않기</span>\n  <span class="token comment">// 루트 폴더 지우지 않기</span>\n  <span class="token comment">// 로켓 쏘지 않기</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> date <span class="token operator">?</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>점점 <code class="language-text">var</code> 보단 <code class="language-text">const</code> 를 선호하며 값을 직접 변경하기 보다 새로운 값을 리턴하도록 만들기 시작합니다. <code class="language-text">let</code> 은 변경될 수 있는 값을 가리킬 때만 사용하고, 더 짧은 코드를 작성하기 위해 삼항연산자(ternary operator)를 사용하여 <code class="language-text">if</code> 문을 기능적으로 대체할 수 있다는 사실을 새로이 발견했습니다. <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 나 다른 함수를 사용하여 기존의 데이터를 직접 변경하지 않는 새로운 자료구조를 사용하기도 합니다.</p>\n<p>규약에 다른 불변성은 편리하고 자연스러운 자바스크립트 코드를 만들어냅니다. 그리고 자바스크립트 에코시스템과도 잘 맞아떨어집니다. 하지만 이 방식은 개발자의 신뢰와 훈련(discipline)에 크게 의존합니다. 여러분은 객체의 직접 변경을 피하고 어디서 변경이 일어나는지 정확히 표현하는 등의 규약을 개발자들이 잘 따른다고 믿어야 합니다. 이쯤 오면 더 강한 규약이 필요하다 생각하게 됩니다.</p>\n<h3 id="라이브러리를-사용해서-빡세게-강제하는-척-하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%EA%B0%95%EC%A0%9C%ED%95%98%EB%8A%94-%EC%B2%99-%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리를 사용해서 빡세게 강제하는 척 하기</h3>\n<p>여러분은 데이터 변경이나 불변 자료구조를 위해 라이브러리를 도입해서 오롯이 개발자만 믿어야 하는 부분 일부를 도구 사용에 대한 믿음으로 옮겨올 수 있습니다. 광범위하게 <a href="http://ramdajs.com">Ramda</a>같은 ‘함수형 올인원 팩’ 같은 라이브러리를 도입할 수도 있고 <a href="https://github.com/calmm-js/partial.lenses">partial.lenses</a>, <a href="https://github.com/gcanti/monocle-ts">monocle-ts</a> 같은 렌즈 라이브러리를 도입할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> R <span class="token keyword">from</span> <span class="token string">\'ramda\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// 새 데이터를 만들어 반환한다</span>\n  <span class="token keyword">return</span> R<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 종류의 라이브러리의 기본 개념 중 하나는 사용하는 데이터를 마치 불변 데이터인 것 처럼 다룬다는 겁니다. 실제로는 그렇지 않은데도요. <a href="http://ramdajs.com/docs/#assoc">Ramda 는 얕은 복사(shallow clone)만 합니다.</a> 하지만 불변 데이터에 대한 규약이 충분히 강력하다면 모두들 ‘불변 데이터인 척’ 다루게 됩니다. 약간 퍼포먼스 손해를 보긴 하겠지만 일정 수준의 코드 신뢰도는 얻었습니다. 라이브러리를 광범위하게 사용하고 규약이 잘 잡혀있으면 최상의 효과를 발휘하겠지요.</p>\n<p>진정한 불변성을 강제하고 데이터 변경 시 퍼포먼스 손해를 최소화하려면 <a href="https://github.com/facebook/immutable-js">Immutable.js</a>, <a href="https://github.com/rtfeldman/seamless-immutable">seamless-immutable</a>, <a href="http://swannodette.github.io/mori/">Mori</a> 같은 불변 자료구조를 활용할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> I <span class="token keyword">from</span> <span class="token string">\'immutablejs\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// doc은 직접 수정할 수 없다</span>\n  <span class="token keyword">return</span> doc<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 데이터를 직접 변경할 수 없게 되며 외부로 드러난 인터페이스로만 변경할 수 있게 됩니다. 하지만 라이브러리에서 제공하는 특정 자료구조에서만 적용되는 데이터에만 한정됩니다. 대부분의 자바스크립트 코드는 기본적인 자바스크립트 자료구조에 의존하기 때문에, 결국에는 이리저리 데이터를 변환하게 되고(역주: ImmutableJS 의 <code class="language-text">toJS</code> 를 떠올려보세요) 기본적인 자료구조를 사용할 때마다 기껏 확보한 믿음을 잃어버리게 됩니다.</p>\n<p>규약을 거는 것과 불변 자료구조를 강제하는 방법 모두 한계가 있지만, 제일 큰 문제는 선택적 타입 시스템과 잘 맞지 않는다는 겁니다.</p>\n<h2 id="자바스크립트를-믿기"><a href="#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EB%AF%BF%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자바스크립트를 믿기</h2>\n<p>앞서 소개한 예시들은 선택적 타입, 함수를 통한 변형, 불변 데이터 등 더 효과적인 자바스크립트를 작성하기 위한 도구를 꺼내 본 것입니다. 하지만 자바스크립트를 쓰면서 이런 도구들을 도입 할 때 여러가지 한계점이 있으며, 같이 사용하기도 어렵습니다.</p>\n<h3 id="선택적-타입은-잘못된-보안-의식을-제공한다"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85%EC%9D%80-%EC%9E%98%EB%AA%BB%EB%90%9C-%EB%B3%B4%EC%95%88-%EC%9D%98%EC%8B%9D%EC%9D%84-%EC%A0%9C%EA%B3%B5%ED%95%9C%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입은 잘못된 보안 의식을 제공한다</h3>\n<p>선택적 타입은 말 그대로 자바스크립트에 선택적으로 도입할 수 있도록 설계되었습니다. 말인즉슨 모든 요소가 타입으로 정의된게 아니기 때문에 모두 유효한 타입을 가지고 있다고 믿는게 불가능합니다. Flow 는 타입이 불분명하며(unsound) Typescript 는 <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html">의도적으로 불분명하게(deliberately unsound)</a> 사용할 수 있습니다. 불분명하다는 의미는 여러 상황에서 타입이 타입이 맞지 않는데도 컴파일러가 알아채지 못하는 것을 뜻합니다.</p>\n<p>자바스크립트에서 선택적 타입을 사용 할 때 다른 이유로 맞지 않는 경우도 있습니다. 자바스크립트로 작성된 것들 중 일부는 Typescript 나 Flow 로 타입을 정의하기 어렵거나 심지어 불가능하기도 합니다.</p>\n<ul>\n<li>\n<p>고차 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#call"><code class="language-text">call</code></a>, <a href="http://ramdajs.com/docs/#compose"><code class="language-text">compose</code></a>, <a href="http://ramdajs.com/docs/#chain"><code class="language-text">chain</code></a>, <a href="http://ramdajs.com/docs/#lift"><code class="language-text">lift</code></a>, <a href="http://ramdajs.com/docs/#lens"><code class="language-text">lense</code></a> 계열 함수들</li>\n<li>partial.lenses 의 <a href="https://github.com/calmm-js/partial.lenses/issues/55">함수들</a></li>\n</ul>\n</li>\n<li>\n<p>동적 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#invert"><code class="language-text">invert</code></a>, <a href="http://ramdajs.com/docs/#dissoc"><code class="language-text">dissoc</code></a>, <a href="http://ramdajs.com/docs/#mergeWith"><code class="language-text">mergeWith</code></a></li>\n<li>ImmutableJS 의 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">거의 대부분의 함수</a></li>\n</ul>\n</li>\n<li>\n<p>몽키패칭</p>\n<ul>\n<li>AWS SDK 클라이언트의 <a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/using-promises.html#w2ab1c17c15c14c17">Promise</a></li>\n<li>Bluebird 의 <a href="http://bluebirdjs.com/docs/api/promisification.html">프로미스화 API 들</a></li>\n</ul>\n</li>\n<li>\n<p>아주 동적인 자료구조</p>\n<ul>\n<li>ElasticSearch <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-get">스키마</a></li>\n<li>winston <a href="https://github.com/winstonjs/winston#creating-your-own-logger">커스텀 로거</a></li>\n</ul>\n</li>\n</ul>\n<p>위의 것들을 Typescript 나 Flow 로 타입을 매기려면 여러분들은 아래 요소들 중 한개 이상은 희생해야 합니다.</p>\n<ol>\n<li><strong>타입을 쓰는 이유인 ‘타입 안정성’ 을 희생한다:</strong> <code class="language-text">any</code> 타입을 매겨서 모든 값을 허용하고 타입 체커가 <code class="language-text">any</code> 가 들어가는 경로에 있는 값을 확인하지 않게 만듭니다.</li>\n<li><strong>재사용성을 희생한다:</strong> 더 특정하고 정확한 타입을 제공하는 대신 함수의 재사용성을 낮춥니다.</li>\n<li><strong>다른 개발자의 시간을 희생한다:</strong> 함수를 사용하는 사람들에게 정확한 타입을 제공하도록 만듭니다. 예를 들자면 이렇게요.</li>\n</ol>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript">R<span class="token punctuation">.</span>pipe<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>선택지에 따라 라이브러리를 추가할 때 들쭉날쭉한 정확도를 가진 타입 정의도 함께 추가하게 됩니다. 이 때 라이브러리의 개발자를 향한 믿음 일부를 라이브러리의 ‘타입 정의’를 한 개발자에 대한 믿음으로 옮겨가게 됩니다. 대부분 이런 라이브러리는 <code class="language-text">any</code> 타입 정의를 포함하고 있고, 이렇게 정의 된 함수를 호출하면 자기도 모르는 새 맞지 않는 타입을 믿는다고 말하는 것이나 다름없습니다. 게다가 Flow 는 <code class="language-text">@flow</code> 어노테이션이 들어있지 않은 파일을 조용히 무시합니다.</p>\n<p>암시적이고 명시적으로 <code class="language-text">any</code> 타입을 허용하지 않도록 하면서, 타입 정의를 광범위하게 적용하고 타입 정의가 없는 파일은 린터가 오류를 뿜어내도록 설정하여 타입 신뢰성 문제를 해결할 수도 있습니다.</p>\n<p>하지만 이는 물이 새는 배의 구멍을 막는 것이나 마찬가지입니다. 진짜 문제는 여러분이 구축한 시스템의 타입 시스템을 믿지 못하는 것이 아니라 <strong>타입 시스템을 믿을 수 있다고 생각하는 겁니다.</strong> 타입에 기대어 뭔가 변화가 일어날 때 어디가 잘못되었는지 알려주도록 만들어보려 하지만, <code class="language-text">any</code> 타입 때문에 조용히 지나가거나, 라이브러리 사용 방법 혹은 타입의 정확성 문제 때문에 제대로 이루어지지 못합니다. 자바스크립트에 타입을 적용하는 것은 다른 언어에 적용되어있는 타입과는 다릅니다. 똑같은 수준의 신뢰를 기대할 수 없다는 뜻입니다.</p>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/01/types_and_js2-768x883.png"></p>\n<p>궁극적으로 여러분이 정의한 타입의 강점은 타입을 적용하는 팀의 지식 수준과 신념에 달려 있습니다. 팀이 타입에 대해 높은 수준의 믿음과 지식을 보유하고 있다면, 시스템에 대해 높은 신뢰를 이끌어낼 수 있습니다. 그러나 일정 수준의 신뢰도를 유지하기 위한 팀의 관심과 규율에 의존해야 하며, 두려움은 여러 가지 형태로 그 믿음을 망칠 수 있습니다.</p>\n<h3 id="함수형-프로그래밍-타입-자바스크립트---이-중-두개를-고르세요"><a href="#%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%ED%83%80%EC%9E%85-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8---%EC%9D%B4-%EC%A4%91-%EB%91%90%EA%B0%9C%EB%A5%BC-%EA%B3%A0%EB%A5%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수형 프로그래밍, 타입, 자바스크립트 - 이 중 두개를 고르세요</h3>\n<p>선택적 타입과 <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 를 활용한 기본적인 함수형 프로그래밍은 자바스크립트와 잘 작동합니다. 하지만 더 깊이 들어가려 하면 문제에 봉착하게 됩니다. 두 가지 예를 보여드리죠.</p>\n<p><a href="https://github.com/facebook/immutable-js">ImmutableJS</a>는 자바스크립트를 위한 영속적인 불변 자료구조 라이브러리입니다. 이 라이브러리는 내부 데이터 수정에 의존하지 않는 공용 자료구조를 제공합니다. <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">Typescript</a>와 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/immutable.js.flow">Flow</a>를 위한 타입 정의도 포함되어 있습니다만 한번 살펴보시면 타입 체킹을 무효화하는 <code class="language-text">any</code> 타입이 한가득 들어있습니다. 게다가 어떤 타입은 사용자가 정확한 타입을 제공하도록 책임을 떠넘기기도 합니다. 결과적으로 라이브러리를 사용할 때마다 타입을 도입하지 않을 수도 있고 타입을 도입하기 위해 추가적인 노력을 들일 수도 있습니다. 그러다보면 함수형 프로그래밍을 도입하기 어려워집니다.</p>\n<p>Ramda 는 자바스크립트를 위한 함수형 유틸리티 라이브러리입니다. 타입 정의는 <a href="https://github.com/types/npm-ramda#status">여기</a>에서 보실 수 있는데, 아래의 코멘트와 함께 제공됩니다. (중요한 부분은 강조했습니다)</p>\n<blockquote>\n<p>유의사항: Ramda 의 많은 함수들은 주로 부분 함수(partial application), 커링(currying), 조합(composition)을 중심으로 하는 문제들 때문에 정확한 타입을 제공하기 어렵습니다. 특히 제네릭이 있을 때 그렇습니다. <strong>그리고 네, 아마 여러분들이 Ramda 를 처음 사용하고자 했던 이유는 이런 기능을 사용하기 위해서겠지요.</strong> 특히 타입스크립트로 Ramda 의 타입을 적용하고자 할 때 문제가 됩니다. TS 에 관련 된 몇가지 이슈는 아래의 링크에서 확인하실 수 있습니다(역주: 링크가 실제 원하는 곳으로 연결되지 않아서 배제했습니다)</p>\n</blockquote>\n<p><a href="https://github.com/gcanti">Giulio Canti</a>같은 분의 엄청난 작업에도 불구하고, 매번 조금이라도 불변 자료구조나 함수 합성, 커링같은 고급 함수형 프로그래밍 기법을 도입하려고 하면 타입 체커를 비활성화하거나 타입이 제대로 동작하도록 만들기 위해 추가로 노력을 들여야 합니다. 여전히 함수형 프로그래밍을 도입하기 어렵게 만드는 요소입니다.</p>\n<h3 id="왜-우리는-자바스크립트로-고급진-개념을-사용할-수-없는가"><a href="#%EC%99%9C-%EC%9A%B0%EB%A6%AC%EB%8A%94-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A1%9C-%EA%B3%A0%EA%B8%89%EC%A7%84-%EA%B0%9C%EB%85%90%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 우리는 자바스크립트로 고급진 개념을 사용할 수 없는가</h3>\n<p>불변성은 코드에 골고루 사용될 때 가장 유용합니다. 하지만 자바스크립트라는 언어와 에코시스템 자체가 데이터를 변경하도록 설계되어있고, <a href="http://tagide.com/blog/research/constraints/">라이브러리 수준에서 불변성을 강제할 수 없습니다.</a> 또한 선택적 타입을 도입한다 한들 라이브러리로 불변성을 다룰 때 표현력이 떨어집니다.</p>\n<p>타입도 마찬가지로 골고루 사용될 때 최고의 효과를 발휘합니다. 하지만 자바스크립트에 타입을 사용하는 것은 어디까지나 선택적으로 사용할 수 있도록 설계되었으며, 자바스크립트와의 호환성을 유지하기 위해 극단적인 절충안(역주: <code class="language-text">any</code> 타입 같은 것?)을 취하여 표현력과 유용성을 제한하였습니다.</p>\n<p>타입, 불변성, 그리고 함수형 프로그래밍은 다른 언어에서도 사용되는 것 처럼 서로를 뒷받침할 수 있습니다. 기반 자료구조가 가변적이거나 런타임에는 (타입이) 존재하지 않더라도 타입이 불변성을 강제하는데 사용될 수 있습니다. 타입은 다른 개발자들이 렌즈를 사용하여 함수 합성을 하거나 데이터를 변형할 때 함수들을 제대로 연결하도록 도울 수 있습니다. 함수를 사용한 변형은 타입과 함께 사용할 때 이해하고 유지보수하기 쉬운데다 기반 자료구조가 불변성을 가지고 있는지 알 수 있을 때 더욱 유용합니다.</p>\n<h2 id="두려움을-가지고-코드를-작성하는-법-배우기"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EA%B3%A0-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%8A%94-%EB%B2%95-%EB%B0%B0%EC%9A%B0%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지고 코드를 작성하는 법 배우기</h2>\n<p>그렇다면 어떻게 두려움을 가지고 코드를 작성하는 법을 배울 수 있을까요? 더 나은 자바스크립트 코드를 작성하는 겁니다. 여러분 자신의 코드를 거의 믿을 수 없다는 기본 가정에서 시작하여 함수형 자바스크립트를 작성하고 언어 자체의 나쁜 부분을 피하는 수 많은 기술을 배울 수 있습니다. 필요한 부분에는 타입 유효성 검사를 사용하고 꼭 필요한 경우거나 규약으로 명확히 강제할 때 불변 데이터를 사용합니다. 합당한 이유가 있을 때 선택적 타입을 도입하되, 함수형으로 데이터를 다루거나 불변 데이터를 사용하는 것이 더 나은 이득을 제공한다고 판단되면 타입 사용을 포기합니다. 함수 합성이나 렌즈를 사용하기 위해 의도적으로 타입 체킹을 비활성화 할 수 있습니다.</p>\n<p>아니면 아예 <a href="http://www.purescript.org/">PureScript</a>, <a href="https://bucklescript.github.io/">ReasonML</a>, <a href="http://elm-lang.org/">Elm</a>, <a href="https://clojurescript.org/">ClojureScript</a> 등을 사용하여 다른 물에서 노는 방법이 있습니다. 이 언어들은 오늘날 실존하며 실제 프로덕션 앱이 동작하고 있습니다. 필요하다면 자바스크립트 에코시스템과 함께 동작할 수 있습니다. 불변성, 함수형 프로그래밍, 타입(해당되는 경우)이 기본적으로 잘 작동하고, 이 요소들이 함께 작동하는 환경에서 보다 높은 수준의 신뢰를 제공합니다.</p>\n<p>이런 언어들 중 하나를 선택한다고 모든 문제를 해결할 수는 없습니다. 각자의 언어는 또 문제를 가지고 있습니다. 하지만 기본적으로 자바스크립트에 비해 더 높은 신뢰성이 있으며 필요에 따라 그 신뢰 수준을 끌어올리거나 낮추는 더 나은 도구를 제공합니다. 다음 포스트에서 PureScript 를 활용하여 이런 아이디어가 어떻게 적용되는지 이야기해보겠습니다.</p>\n<p><strong><em>하지만 자바스크립트를 쓰는 한, 두려움은 언제나 여러분과 함께합니다</em>.</strong></p>',
id:"/home/circleci/repo/src/pages/posts/2018-03-04-fear-trust-and-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-03-04",path:"/posts/fear-trust-and-javascript-kr",title:"[번역] 두려움, 믿음, 그리고 자바스크립트 - 언제 타입 시스템과 함수형 프로그래밍이 먹히지 않는가",tags:["Functional Programming","Javascript","Typescript"],category:"Javascript"}},{excerpt:"제가 요즘 프론트엔드 개발을 하면서 주로 관심을 가지고 있는 분야는 CSS로 레이아웃을 더 잘 잡아보기 (without Grid, Flex - 하위호환 때문에…) + 더 사용자 친화적인 UI…",html:'<p>제가 요즘 프론트엔드 개발을 하면서 주로 관심을 가지고 있는 분야는</p>\n<ul>\n<li>CSS로 레이아웃을 더 잘 잡아보기 (without Grid, Flex - 하위호환 때문에…) + 더 사용자 친화적인 UI 고려하기</li>\n<li>타입스크립트의 타입 시스템을 적극적으로 활용해보기</li>\n<li>타입스크립트 뿐 아니라 자바스크립트의 기초에 소홀히 하지 않기</li>\n<li>다양한 프로그래밍 패러다임과 이론을 익히면서 실무에 접목하기 -> 더욱 간결하고 유지보수가 용이한 코드 작성하기</li>\n<li><a href="/posts/what-is-testing-javascript-kr">테스팅</a></li>\n</ul>\n<p>이 정도로 나열해 볼 수 있습니다.</p>\n<p>오늘은 이 중 세 번째와 네 번째 주제에 대해 아주 가벼운 이야기를 해 보려고 합니다. 최근에 자바스크립트 개발과 관련된 담론에서 많이 거론되는 용어가 있습니다. <strong><a href="https://www.reactivemanifesto.org/ko">Reactive Programming</a> - 이 선언에 기반한 RxJS 등의 라이브러리</strong>, <strong>Functional Programming(함수형 프로그래밍)</strong> 입니다. 사실 이 용어들이 등장한 것은 꽤 오래 전 일이라고 합니다만.. 저는 요즘에서야 눈을 돌리게 되었네요.</p>\n<p>그렇게 함수형 프로그래밍에 관심을 가지면서 책이나 강연 등을 살펴보고, 얼마 전에는 함수를 적극적으로 활용하여 CSS 파일을 압축(minify)하는 아주 간단한 함수를 만들었습니다. 이 압축 함수를 만들면서 제가 조금이나마 익힌 함수형 프로그래밍의 개념을 어떻게 활용했는지, 어떻게 발전시킬 수 있을지 함께 고민하는 시간을 마련해보고자 합니다.</p>\n<p>앞으로 제가 선보일 내용은 아주 기초적인데다 심지어 틀릴 수도 있으니 이상한 점이나 잘못된 점이 있다면 댓글이나 메일로 피드백 주시면 대단히 고맙겠습니다.</p>\n<h2 id="함수형-프로그래밍이란"><a href="#%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수형 프로그래밍이란</h2>\n<p>제가 아는 한에서 여러가지로 장황하게 설명을 해 보려고 했으나, 다음 번역 글이 아주 좋은 설명을 하고 있다고 생각하여 링크로 대신하고자 합니다.</p>\n<ul>\n<li><a href="https://medium.com/@jooyunghan/%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80-fab4e960d263">(번역) 함수형 프로그래밍이란 무엇인가? – Jooyung Han (한주영) – Medium</a></li>\n<li><a href="https://medium.com/@jooyunghan/%EC%96%B4%EB%96%A4-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%96%B8%EC%96%B4%EB%93%A4%EC%9D%B4-%ED%95%A8%EC%88%98%ED%98%95%EC%9D%B8%EA%B0%80-fec1e941c47f">(번역) 어떤 프로그래밍 언어들이 함수형인가? – Jooyung Han (한주영) – Medium</a></li>\n</ul>\n<p>제 나름의 정의를 내리자면 “더 안정적인 프로그램을 만들기 위해 입력과 출력이 철저히 통제된 순수 함수 및 부수 효과(Side-effect)를 최소화한 함수 위주로 프로그래밍 하는 것. 이를 통해 간결하고 가독성 높은 프로그램을 작성할 수 있으며 동시성 작업을 더 안전하게 구현할 수 있다.” 라고 말씀드릴 수 있겠습니다. 여기서 한마디 더 얹어보자면 <strong>함수를 특별하게 취급하지 않는 프로그래밍 패러다임</strong> 이라고 말씀드릴 수 있겠습니다.</p>\n<p>사실 자바스크립트는 <strong>함수형 프로그래밍 언어가 아닙니다.</strong> 이 점은 반드시 인지하고 계셔야 합니다. 단순히 자바스크립트에서 함수가 일급 객체(First Class Citizen)이기 때문에 함수형 프로그래밍 언어인 것은 아닙니다. 함수형 프로그래밍이 가능한 정도입니다. 아마 이 주제 때문에 글 하나가 더 나오겠지만.. 언젠가 제가 더 확고한 기반지식을 쌓고 작성할 기회가 있으리라 생각합니다. (사실 이미 다른 분들의 훌륭한 글이나 번역이 많아서요)</p>\n<h2 id="css-압축-함수-만들기---초기-버전"><a href="#css-%EC%95%95%EC%B6%95-%ED%95%A8%EC%88%98-%EB%A7%8C%EB%93%A4%EA%B8%B0---%EC%B4%88%EA%B8%B0-%EB%B2%84%EC%A0%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 압축 함수 만들기 - 초기 버전</h2>\n<p>리액트 프로젝트를 하면서 외부 CSS나 미리 설정된 CSS를 HTML 헤더에 삽입할 일이 있는데, 저는 이 CSS 파일이 고스란히 노출되기보다 최소한 공백이나 개행 등을 제거하여 용량을 줄이고, 사용자가 조금이라도 빠르게 컨텐츠를 볼 수 있기를 원했습니다. 예를 들면 최상단에 페이지의 기본 설정을 위해 다음과 같은 CSS를 설정하였습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* page-setup.css */</span>\n<span class="token selector">html</span> <span class="token punctuation">{</span>\n  <span class="token property">font-size</span><span class="token punctuation">:</span> 62.5%<span class="token punctuation">;</span>\n  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">html, body</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">div, p, h1, h2, h3, h4, h5, h6, ul, ol, li, dl, dt, dd,\ntable, th, td, form, fieldset, legend, input, textarea, blockquote, button</span> <span class="token punctuation">{</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">*, *:before, *:after</span> <span class="token punctuation">{</span>\n  <span class="token property">box-sizing</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">li</span> <span class="token punctuation">{</span>\n  <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>사실 CSS는 중괄호(<code class="language-text">{}</code>) 만 제대로 열고 닫히고, 세미콜론을 지켜주는 등 기본적인 문법 요소만 충족하면 정상적으로 동작합니다. 다만 <code class="language-text">margin: 0 auto;</code>  같이 작성되어 있을 때는 <code class="language-text">0</code> 과 <code class="language-text">auto</code> 사이의 공백은 유지해야합니다. 그래서 제가 만들려는 함수의 필요 구현 조건은 이랬습니다.</p>\n<ul>\n<li>CSS 파일 앞 뒤에 불필요한 공백과 개행이 없어야한다.</li>\n<li>CSS 파일 내부에도 개행이 없어야한다.</li>\n<li>CSS 파일 내부에서 다음 문자 주위의 공백은 불필요하다 -> <code class="language-text">,</code>, <code class="language-text">;</code>, <code class="language-text">:</code>, <code class="language-text">{</code>, <code class="language-text">}</code></li>\n</ul>\n<p>그래서 CSS파일 자체를 문자열로 읽어들여서 이를 <code class="language-text">string#trim</code>, <code class="language-text">string#replace</code> 메서드로 수정하는 함수를 만들었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">cssMinifierNormal</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> cssString\n    <span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -> CSS 전후 공백 및 개행 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[\\r\\n]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token comment">// -> 개행 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*,\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\',\'</span><span class="token punctuation">)</span>  <span class="token comment">// -> 해당 문자열 주위의 공백을 삭제</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*;\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*:\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*{\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*}\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>아직까진 너무 간단한 함수입니다. 만약에 이 함수가 300개 이상의 규칙을 가지고 있다고 한다면 이렇게 작성하는게 옳은 방법일까요? 300개 이상의 규칙을 가지고 있는 함수에 새로운 규칙을 추기해야한다면 어디에 어떻게 추가해야 문제가 없을까요? 아마 당장은 이런 문제에 부딪힐 일이 없겠지만 약간의 고민 끝에 다른 방식으로 구현해 보았습니다.</p>\n<h2 id="함수로-풀어보자"><a href="#%ED%95%A8%EC%88%98%EB%A1%9C-%ED%92%80%EC%96%B4%EB%B3%B4%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수로 풀어보자</h2>\n<p>이번에는 서로 다른 함수를 조합하는 방식으로 또 다른 <code class="language-text">cssMinifier</code> 함수를 만들어보겠습니다. 먼저 조금씩 각기 다른 공백 제거 함수를 분리해보겠습니다.</p>\n<ul>\n<li><code class="language-text">trim</code>: 전후 공백 및 개행 삭제</li>\n<li><code class="language-text">replace</code>: 특정 정규표현식에 해당하는 문자열 교체</li>\n</ul>\n<p>어? 방금 우리가 위에서 사용한 메서드 아닌가요? 하지만 이 메서드를 함수로 표현한다면 약간 이야기가 달라집니다. 함수를 평소와는 약간 다르게 구현해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">=></span> str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// function trim(str) {</span>\n<span class="token comment">//   return str.trim();</span>\n<span class="token comment">// }</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">replace</span> <span class="token operator">=</span> <span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> newSubStr<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">=></span>\n  str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>regExp<span class="token punctuation">,</span> newSubStr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n<span class="token comment">// function replace(regExp, newSubStr) {</span>\n<span class="token comment">//   return function replacer(str) {</span>\n<span class="token comment">//     return str.replace(regExp, newSubStr);</span>\n<span class="token comment">//   }</span>\n<span class="token comment">// }</span>\n</code></pre>\n      </div>\n<p>화살표 함수(Arrow Function)는 보신적이 있어도 화살표가 이중으로 쓰여진 부분은 익숙지 않으신 분들이 계실지도 모르겠습니다. 그래서 아래에 일반 함수 표현식으로 작성하는 법도 따로 표기했습니다. <code class="language-text">replace</code> 는 일종의 부분 함수입니다. 첫 번째로 인자를 입력해 두면 그 다음에는 <code class="language-text">string#replace</code> 메서드를 적용할 문자열의 입력을 기다리는 함수가 리턴됩니다. (커링이라고 말씀드리려 했으나 엄밀히 따지면 커링은 여러 개의 인자를 받는 함수를 각각 한개씩 받을 수 있도록 만들어주는 기법이라고 이해하고 있어서 부분 함수라고 표현합니다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 콤마 주변의 공백을 제거하는 함수 할당</span>\n<span class="token keyword">const</span> removeSpaceAroundComma <span class="token operator">=</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\s*,\\s*/g</span><span class="token punctuation">,</span> <span class="token string">\',\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">removeSpaceAroundComma</span><span class="token punctuation">(</span><span class="token string">\'One , Two , Three , Four\'</span><span class="token punctuation">)</span>\n<span class="token comment">// => \'One,Two,Three,Four\'</span>\n</code></pre>\n      </div>\n<p>위의 <code class="language-text">replace</code> 함수를 이런 식으로 활용할 수 있습니다. 조금만 손을 보면 어떤 문자 주변의 공백이든 손쉽게 제거해주는 함수를 만들 수 있겠네요. </p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">removeSpaceAroundChar</span> <span class="token operator">=</span> <span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\\\\s*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>char<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\\\s*`</span></span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> removeSpaceAroundSemi <span class="token operator">=</span> <span class="token function">removeSpaceAroundChar</span><span class="token punctuation">(</span><span class="token string">\';\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">removeSpaceAroundSemi</span><span class="token punctuation">(</span><span class="token string">\'; undefined is not a function ; \'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// => \';undefined is not a function;\'</span>\n</code></pre>\n      </div>\n<p>아까 작성한 메서드 체인처럼 원하는 모든 문자열 주변의 공백을 제거하는 함수를 준비해보겠습니다. <code class="language-text">Array#map</code>  함수를 쓰고자 하지만 이번에는 <code class="language-text">map</code> 함수조차 직접 만들어봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token punctuation">(</span>iteratee<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">=></span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>iteratee<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// function map(iteratee) {</span>\n<span class="token comment">//   return function mapped(list) {</span>\n<span class="token comment">//     return list.map(iteratee);</span>\n<span class="token comment">//   }</span>\n<span class="token comment">// }</span>\n</code></pre>\n      </div>\n<p>사실 이번 글에서는 새롭게 작성한 <code class="language-text">map</code> 함수를 별로 사용할 일이 없을지 모르지만, 인자를 나중에 받는 방식으로 구현하면 함수끼리 조합이 용이해지는 이점이 있기 때문에 시험삼아 만들어봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> shrinkers <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>removeSpaceAroundChar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\',\'</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 특정 문자열 주변의 공백을 제거해주는 함수의 배열을 만들었습니다. 그러면 이제 익숙한 <code class="language-text">Array#forEach</code> 함수나 <code class="language-text">Array#reduce</code> 로 문자열을 수정하면 되겠지요. 이렇게요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">shrinkCss</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> shrinkers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> shrinker<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">shrinker</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span><span class="token punctuation">,</span> cssString<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>오늘의 목표는 여기서 끝내는게 아닙니다. 함수를 만드는 것 까지 해봤으니 만든 함수를 <strong>조합</strong>해서 문제를 한번에 해결해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">pipe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=></span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fn</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">pipe</span><span class="token punctuation">(</span>\n  x <span class="token operator">=></span> x <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span>\n  x <span class="token operator">=></span> x <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span>\n  x <span class="token operator">=></span> x <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// => 3000</span>\n</code></pre>\n      </div>\n<p>보시는대로 <code class="language-text">pipe</code> 함수는 인자로 받은 함수를 모아놨다가 적용할 값을 받아서 왼쪽에서 오른쪽으로(위에서 아래로) 순차적으로 연산합니다. 보통 반대로 <code class="language-text">compose</code> 함수를 쓰는 경우도 있는데, 저는 가독성 측면에서 아직은 <code class="language-text">pipe</code>  를 선호합니다.</p>\n<p>그럼 여태 만든 함수를 저 파이프라인에 쌓아두고 CSS 문자열을 넣기만 하면 우리가 원하는 문자열이 나오겠군요? 한번 최종 결과물을 만들어 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'fs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nfs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">\'./page-setup.css\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> encoding<span class="token punctuation">:</span> <span class="token string">\'utf-8\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cssMinifier</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">cssMinifier</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">removeSpaceAroundChar</span> <span class="token operator">=</span> char <span class="token operator">=></span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\\\\s*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>char<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\\\s*`</span></span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> removeNewLine <span class="token operator">=</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[\\r\\n]/g</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> shrinkers <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>removeSpaceAroundChar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\',\'</span><span class="token punctuation">,</span> <span class="token string">\';\'</span><span class="token punctuation">,</span> <span class="token string">\':\'</span><span class="token punctuation">,</span> <span class="token string">\'{\'</span><span class="token punctuation">,</span> <span class="token string">\'}\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">pipe</span><span class="token punctuation">(</span>trim<span class="token punctuation">,</span> removeNewLine<span class="token punctuation">,</span> <span class="token operator">...</span>shrinkers<span class="token punctuation">)</span><span class="token punctuation">(</span>cssString<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>구문 자체는 약간 복잡해졌을지 몰라도 코드 줄 수는 확연히 줄었으며 만약에 규칙을 추가해야 할 때는 어느 부분에 무엇을 추가해야하는지가 조금 더 간편해지고 명확해졌습니다. 각자 역할을 나타내는 이름을 가진 함수니까요. 지금은 <code class="language-text">shrinkers</code> 오른편에 있는 배열에 원하는 글자만 추가해주면 새로운 공백 제거 규칙이 생성됩니다.</p>\n<p><code class="language-text">shrinkers</code> 는 함수의 배열인지라 <code class="language-text">pipe</code> 함수에 넣을 때는 전개 연산자(Spread Operator)로 풀어헤쳐서 인자로 적용하였습니다. 아마 <code class="language-text">pipe</code> 함수를 고도화하면 배열로 된 인자에도 대응할 수 있겠지요. 이번 시간에는 작게나마 제가 이해하고 있는 부분만 말씀드렸습니다.</p>\n<h2 id="이렇게도-해-보고-저렇게도-해-보고"><a href="#%EC%9D%B4%EB%A0%87%EA%B2%8C%EB%8F%84-%ED%95%B4-%EB%B3%B4%EA%B3%A0-%EC%A0%80%EB%A0%87%EA%B2%8C%EB%8F%84-%ED%95%B4-%EB%B3%B4%EA%B3%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이렇게도 해 보고, 저렇게도 해 보고</h2>\n<p>저도 요즘에야 이렇게 함수를 적극적으로 활용하여 주어진 문제를 풀어나가는 법을 연습하고 있습니다. 머리로 아무리 알고만 있어도 실제로 써먹지 않는다면 사용 가능한 지식이 아니겠지요. 위에 작성한 <code class="language-text">replace</code>, <code class="language-text">map</code>, <code class="language-text">pipe</code> 함수는 원래대로라면 훨씬 고려해야 할 요소들이 많을지도 모릅니다. 제대로 된 인자가 들어왔는지, 더 재사용 가능한 방법이 있는지 등등... 저는 일단 실무에서 <a href="http://ramdajs.com">Ramda.js</a> 를 활용하고 있습니다. 위에 작성한 함수 모두 <code class="language-text">R.replace</code>, <code class="language-text">R.map</code>, <code class="language-text">R.pipe</code> 로 대체 가능합니다.</p>\n<p>가능한 부분에 적극적으로 함수를 활용한 프로그래밍을 하자니 아직 모르는 점이 많습니다.</p>\n<ul>\n<li>비동기 작업(Promise 등)을 일으키는 함수를 다른 함수와 조합하려면 어떻게 해야할까?</li>\n<li>아무 생각없이 작성하는 클래스 상속도 함수의 조합만으로 해결 할 수 있어보이는데, 어떻게 해야할까?</li>\n<li>함수만으로 코드를 작성하자니 어색하다. 뭔가 Class 같이 공통된 역할을 하는 함수를 모으는 일도 해야할까? 한다면 어떻게 해야할까?</li>\n<li>재사용 가능한 함수를 어떻게 만들 수 있을까? 이 함수를 조합하는 방법은 더 다양할 것 같은데 어떤 게 있을까?</li>\n</ul>\n<p>이미 제가 했던 고민을 거쳐온 분들이라면 조금이라도 조언을 부탁드리고 싶고, 위의 문제를 해결하는 방식이 생소한 분들이라면 한번 기존에 작성했던/앞으로 작성하실 코드에 저처럼 다양한 시도를 해 보시길 권하고 싶습니다. 반드시 함수형 프로그래밍이라는 개념을 익힐 필요는 없습니다. 기존의 틀을 벗어나 새로운 시각을 받아들이고 적용하고자 할 때, 더 좋은 프로그램을 만들 수 있는 가능성이 열린다고 생각합니다.</p>\n<h2 id="참고-자료"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2>\n<ul>\n<li><a href="http://ramdajs.com">Ramda Documentation</a></li>\n<li><a href="http://merong.city">merong님의 함수형 자바스크립트 프로그래밍 강좌</a></li>\n<li><a href="https://www.gitbook.com/book/mostly-adequate/mostly-adequate-guide">Frisby 교수님의 함수형 적절한 함수형 프로그래밍 가이드 · GitBook</a></li>\n<li><a href="https://egghead.io/courses/professor-frisby-introduces-composable-functional-javascript">Professor Frisby Introduces Composable Functional JavaScript from @drboolean on @eggheadio</a></li>\n<li><a href="http://aladin.kr/p/rUEvd">함수형 자바스크립트 - 모던 웹 개발에 충실한 실전 함수형 프로그래밍 안내서</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2018-02-19-functional-js-tutorial/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-02-19",path:"/posts/functional-js-tutorial",title:"자바스크립트로 함수형 프로그래밍 아주 살짝 맛보기",tags:["Functional Programming","Javascript"],category:"Functional Programming"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p>더 좋은 (리액트 애플리케이션) 테스트를 위한 번역 시리즈 마지막입니다. 처음에는 팀원들과 공유하기 위해 테스트의 기초적인 부분을 다루는 글을 번역하려다가, 최대한 실전에 도움이 되면서도 부담없이 시작할 수 있는 내용 위주로 좋은 글을 찾아서 번역해보았습니다.</p>\n<p>제 자신도 번역을 통해 ‘어디까지 테스트하는게 실무에 도움이 많이 될까?’ 라는 질문의 답을 얻는데 많은 도움이 되었습니다. 이제 테스트만 잘 짜면 될텐데요.</p>\n<p><img src="https://cl.ly/0P3O322S1P3y/Screen%20Shot%202018-01-27%20at%2014.46.48.png" alt="test-right-now"></p>\n<p>다음에는 어떤 글을 쓰거나 번역할지 아직 모르겠지만 모쪼록 도움이 되었으면 좋겠습니다.</p>\n<p><a href="https://medium.com/@Tetheta/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-eb581d6d167b">원문은 여기서 보실 수 있습니다</a></p>\n<hr>\n<p>만약 여러분이 기술 중심 회사에서 일하시는게 아니라면, 단위 테스트같은 개발 요소를 도입한다고 관리자를 설득하는게 어려울 수 있습니다. 저는 한동안 열렬한 지지자가 되어(역주: 필자 자신이 ‘관리자’ 임을 암시하는 문장이라 봅니다)  몇몇 프로젝트에 단위 테스트를 도입하고 동료들과 몇 가지 패턴을 도입해보았습니다. 그 과정에서 제가 배운 교훈을 이야기하고자 합니다.</p>\n<h2 id="설정이-만만치-않습니다-"><a href="#%EC%84%A4%EC%A0%95%EC%9D%B4-%EB%A7%8C%EB%A7%8C%EC%B9%98-%EC%95%8A%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설정이 만만치 않습니다 😐</h2>\n<p>여러분이 create-react-app 같은 것을 사용하고 있거나 회사에서 이미 Jest + Enzyme 설정을 해 두었다면 아주 좋습니다!</p>\n<p>저처럼 밑바닥부터 설정해야 한다면 몇 가지 유의하실 점이 있습니다.</p>\n<ol>\n<li>Jest는 노드 환경에서 실행됩니다. 즉 Webpack같은 번들러의 결과물을 실행하는 것이 아니라 파일의 코드 그대로 실행한다는 뜻입니다. 따라서 ES6나 기타 문법을 사용하고 싶다면 테스트 환경에서 사용하는 <code class="language-text">.babelrc</code> 파일을 설정해야 합니다.</li>\n<li>위에 이어서 브라우저가 아니라 노드 환경에서 실행되기 때문에 import, export 같은 문법을 사용하기 위해 폴리필을 추가해야 할 수도 있습니다.</li>\n<li>최신 버전의 Enzyme은 Jest가 제대로 실행되기 위해 <a href="http://airbnb.io/enzyme/#installation">설정 파일이 필요합니다</a>.</li>\n<li>아마 폰트, 이미지, 스타일 파일들을 잔뜩 모킹해야 할지도 모릅니다.</li>\n<li>CI(Continuous Integration) 빌드 중 테스트를 실행하고 싶다면 <code class="language-text">testResultProcessor</code>, <code class="language-text">runInBand</code> 설정을 해 주시는게 좋습니다. 저는 <a href="https://github.com/CHECK24/jest-bamboo-reporter">Bamboo</a>를 사용하고 있습니다.</li>\n</ol>\n<p>컴포넌트를 작성하는 환경과 테스트를 작성하는 환경을 최대한 비슷하게 맞추기 위해(ES2017, import/export 등) 제대로 된 폴리필을 설정하는 것이 가장 큰 장벽이었습니다. React 버전 16으로 업그레이드 하는 것도 꽤 흥미로운 일이었지만 이제 대부분은 자연스럽게 적응(최소한 문서화라도)했습니다.</p>\n<p>기회가 된다면 언젠가 제 설정을 짚어보는 포스트를 써 볼지도 모릅니다. 제 프로젝트의 일부는 그저 문서로 남겨두기엔 특이한 환경을 가지고 있었고, 고통스럽기도 했습니다.</p>\n<h2 id="스냅샷을-사용하세요-json-serializer와-함께-사용하면-더-좋습니다"><a href="#%EC%8A%A4%EB%83%85%EC%83%B7%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%84%B8%EC%9A%94-json-serializer%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4-%EB%8D%94-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스냅샷을 사용하세요 (json serializer와 함께 사용하면 더 좋습니다)</h2>\n<p>스냅샷은 아주 좋습니다 😃. 하지만 이런 코드를 실행하면</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Match previous snapshot\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그냥 enzyme이 사용하는 자체 객체를 뱉어버립니다😦. 저는 <a href="https://github.com/adriantoine/enzyme-to-json">enzyme-to-json</a> 같은 패키지를 써서 가독성을 높이길 추천합니다. 스냅샷이 변경되었을 때 아주 유용합니다.</p>\n<p>그리고 스냅샷을 버전 관리 시스템(Git 등)에 포함시키세요. 여러분이 반영한 변경 사항이 갑자기 문제를 일으킬 때 문제점을 찾는 데 큰 도움이 됩니다.</p>\n<h2 id="jest-watch-도-좋습니다-"><a href="#jest-watch-%EB%8F%84-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>jest —watch 도 좋습니다 😃</h2>\n<p>테스트 할 때 반드시 사용하세요! 여러가지 일을 편하게 만들어주고, 패턴 매치(<code class="language-text">p</code> 키를 누른 뒤 파일이나 폴더 이름을 입력해보세요)를 사용해서 매번 저장할 때마다 모든 테스트를 다시 실행하지 않게 만들 수도 있습니다.</p>\n<h2 id="test-문의-괄호가-제대로-놓여있는지-확인하세요"><a href="#test-%EB%AC%B8%EC%9D%98-%EA%B4%84%ED%98%B8%EA%B0%80-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EB%86%93%EC%97%AC%EC%9E%88%EB%8A%94%EC%A7%80-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>test() 문의 괄호가 제대로 놓여있는지 확인하세요</h2>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 지극히 정상적인 자바스크립트 코드지만 테스트를 실행하면 모두 잘 작동한다면서 아무 일도 일어나지 않을 겁니다.</p>\n<p>올바른 코드는 이렇게 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 실수는 쉽게 저지를 수 있는데다 테스트에 문제가 있는데도 통과하기 때문에 특히 무섭습니다. 저는 특정 단위 테스트를 잘못 썼는데(역주: 문법적 실패가 아니라 fail이 뜨는 코드) 실패가 뜨지 않았습니다. 비슷한 코드를 복사하고 붙여넣다가 간신히 이 실수를 발견했지요.</p>\n<p>그래서 생각한 것이...</p>\n<h2 id="테스트가-실패하는지-꼭-확인하세요"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%8B%A4%ED%8C%A8%ED%95%98%EB%8A%94%EC%A7%80-%EA%BC%AD-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 실패하는지 꼭 확인하세요</h2>\n<p>여러분이 실력있고 TDD를 사용하는 개발자라면 이미 이 방법을 사용하고 있을 겁니다.</p>\n<p>그렇지 않은 분이라면 단위 테스트를 너무 후순위로 취급하기 때문에 테스트를 한 뭉치 작성하고 “좋아! 잘 작동하는군! 이제 다음 단계로 가야지” 라고 생각하기 쉽습니다.</p>\n<p>하지만 앞서 언급된 문제로 이어질 수있는데다, 비슷한 테스트를 복사-붙여넣기 하다보면 특히 쉽게 잘못된 요소나 모킹한 함수를 테스트 할 수 있습니다.</p>\n<p>테스트의 중요한 부분을 잠시 주석처리하는 식으로 쉽게 테스트를 실패하게 만들 수 있으며, 덕분에 여러분이 수없이 겪을 지도 모르는 골치 아픈 상황에서 벗어날 수 있습니다.</p>\n<h2 id="반복-가능하고-확장-가능한-테스트-패턴을-만들어보세요"><a href="#%EB%B0%98%EB%B3%B5-%EA%B0%80%EB%8A%A5%ED%95%98%EA%B3%A0-%ED%99%95%EC%9E%A5-%EA%B0%80%EB%8A%A5%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%8C%A8%ED%84%B4%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>반복 가능하고 확장 가능한 테스트 패턴을 만들어보세요</h2>\n<p>여러분이 혼자서 프로젝트의 테스트를 만들거나 유지보수하지 않는 이상, 새 컴포넌트를 빠르고 쉽게 테스트하거나 최소한 기본 수준의 테스트라도 빠르게 만들고 싶을겁니다.</p>\n<p>제 동료 개발자들을 보니 가장 큰 장벽은 “어떻게 시작해야할지 모른다” 는 부분이었습니다. 명확하고 따라하기 쉬운 패턴을 만들어서 그들을 도울 수 있습니다.</p>\n<p>예를 들어 많은 사용자 입력을 받는 컴포넌트를 테스트하고 싶다면 이런 방식으로 테스트 해 볼 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> userChangeCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'Test1\'</span><span class="token punctuation">,</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">{</span> toLowercase<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'testPre\'</span><span class="token punctuation">,</span>\n  result<span class="token punctuation">:</span> <span class="token string">\'testpre\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  onDataChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'On Change Cases\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    userChangeCases<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> item<span class="token punctuation">.</span>value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onDataChange<span class="token punctuation">)</span><span class="token punctuation">.</span>\n          <span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>resultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그리고 나중에 추가로 사용자 입력 케이스를 테스트할 때 손쉽게 <code class="language-text">userChangeCases</code> 배열에 추가하면 됩니다. 게다가 다른 컴포넌트에 비슷한 테스트를 해야하면 복사하기도 쉽습니다.</p>\n<p>사실 이렇게 제가 따르고 있는 작은 규약들을(beforeEach로 매 테스트마다 wrapper 지정하기, 이름 짓는 방법, props 객체에 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Spread_operator">전개 연산자--MDN 문서 영문판으로 다시 보시길 권장합니다--</a>  사용하기) 어딘가에 정의해두면 다른 사람들이 쉽게 이해하고 자신의 컴포넌트를 테스트 할 때 유용하게 테스트 작동 원리를 베껴갈 수 있습니다.</p>\n<p>이 예는 다소 부자연스럽지만(저는 일반적으로 테스트에 따라 입력 값 변화를 처리하는 순수 함수를 만듭니다) 전체 시스템이 작동하는지 여부를 신속하게 알 수 있으며, 복잡한 입력을 수행하지 않는 경우 필요에 맞게 적절하게 사용 할 수 있습니다.</p>\n<h2 id="enzyme-mount-vs-shallow"><a href="#enzyme-mount-vs-shallow" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enzyme: Mount vs Shallow</h2>\n<p><code class="language-text">shallow</code> 는 “순수 단위 테스트” 방식의 접근입니다. 단순히 여러분이 테스트하고자 하는 컴포넌트아 DOM을 본떠서 그 컴포넌트가 어떤 역할을 수행하는지 테스트합니다. 이런 방식의 테스트는 더 빠르게 동작합니다.</p>\n<p>아주 괜찮은 것 같지만, 여러분은 무엇을 테스트하고자 하는지 신경 쓰셔야 합니다. 각각의 컴포넌트를 완벽하게 분리하고 전체 단위 테스트 커버리지를 높이는게 목표인가요? 아니면 여러가지 문제가 될 수 있는 경우를 테스트하고 그 과정에서 컴포넌트가 제대로 동작하는지를 확인하는게 목표인가요?</p>\n<p>전자의 경우는 <code class="language-text">shallow</code> 를 사용하는게 아마 완벽한 해결책이겠지만 후자의 경우는 <code class="language-text">mount</code> 를 쓰는 게 좀 더 이상적입니다.</p>\n<p><code class="language-text">mount</code> 는 컴포넌트에 속한 모든 것을 가상화(simulates)합니다. 말인즉슨 자손 컴포넌트(예를 들어 특별한 입력 컴포넌트라던가)를 잡아내서 입력값의 변화를 테스트해볼 수도 있습니다. 이렇게 사용자의 동작을 흉내내면서도 테스트하고자 하는 컴포넌트를 부모 컴포넌트와 그 주변 환경에서 분리할 수 있습니다.</p>\n<p>또한 <code class="language-text">mount</code> 는 <a href="https://velopert.com/1130">리액트의 라이프사이클 메서드(lifecycle methods)</a>를 가상화할 수 있습니다. 특정 라이프사이클 메서드에 많은 로직이 있는 복잡한 컴포넌트를 테스트할 때도 유용합니다.</p>\n<p>텍스트 기반의 컴포넌트를 <code class="language-text">mount</code> 로 테스트하는 예를 보여드리겠습니다.</p>\n<p>(제 실수를 지적해주신 <a href="https://medium.com/@ywcoder">Ying Wang</a>님께 감사드립니다. <code class="language-text">shallow</code> 도 마찬가지로 컴포넌트 안의 html 요소를 가상화합니다. 자손 컴포넌트를 다루지 않을 뿐입니다. 이에 맞추어 글을 수정했습니다.)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> CustomInput <span class="token keyword">from</span> <span class="token string">\'./CustomInput.jsx\'</span><span class="token punctuation">;</span>\n<span class="token comment">/*\nCustomInput 컴포넌트 안에는 이렇게 생긴 input 태그가 있고\n&lt;input type="text" disabled={this.props.disabled} onChange={this.props.onChange}\nTextComponent는 이 컴포넌트로 prop을 전달합니다.\n*/</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'Nothing\'</span><span class="token punctuation">,</span>\n  onChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'OnChange called\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'TestVal\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onChange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>\n      expect<span class="token punctuation">.</span><span class="token function">objectContaining</span><span class="token punctuation">(</span><span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이벤트가 올바르게 전달되었는지 확인</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'isDisabled prop works\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isDisabled<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">\'disabled\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 방식의 테스트는 통합 테스트와 단위 테스트와의 경계를 흐리게 하지만, Guillermo Rauch는 이렇게 말했습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Write tests. Not too many. Mostly integration.</p>&mdash; Guillermo Rauch (@rauchg) <a href="https://twitter.com/rauchg/status/807626710350839808?ref_src=twsrc%5Etfw">December 10, 2016</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> \n<p>Kent C. Dodds도 이 트윗에 대해 <a href="https://emaren84.github.io/posts/write-mostly-integration-test-kr">글을 썼는데</a> 꽤 설득력 있습니다.</p>\n<p>제 생각에 두 종류의 테스트 모두 적합한 경우가 있습니다만, 제가 만든 대부분의 애플리케이션에서 단위 테스트를 하기에는 시간이 아깝고 저는 세부 구현이나 기반에 깔린 코드를 테스트하기보다 실제로 동작하는 부분을 테스트하는데 집중하고 싶습니다. 저도 계속 (실용적인 테스트의) 중심을 잡아보려고 노력중입니다.</p>\n<p>요즘은 기본적으로 <code class="language-text">mount</code> 를 사용하고 테스트 퍼포먼스에 영향이 가는 경우에만 <code class="language-text">shallow</code> 를 사용하고 있습니다. 두 경우의 API가 약간 다르므로 특정 작업을 테스트하는 방법을 더 쉽게 기억할 수 있습니다.</p>\n<h2 id="redux-테스트는-흥미로워요-"><a href="#redux-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%ED%9D%A5%EB%AF%B8%EB%A1%9C%EC%9B%8C%EC%9A%94-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redux 테스트는… 흥미로워요 😕</h2>\n<p>반면에 리덕스 액션과 리듀서는 무진장 테스트하기 쉽습니다. 그저 함수일 뿐 아니라 리듀서는 어떠한 부수 효과도 없는 순수 함수여야 합니다.</p>\n<p>하지만 redux-thunks나 redux-saga를 사용하고 계시다면 조금 흥미로운(?) 일이 되고, <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트 하는 일은 더욱 복잡해지게 됩니다.</p>\n<p>Thunk와 Saga는 다른 액션을 대신 보내주면서 비동기 작업을 다루는 일을 합니다. 그래서 스토어를 본뜬 다음에 무슨 액션이 보내졌는지 확인해야하고, 부수 기능도 본떠야 합니다. 매번 테스트할때마다 실제 데이터베이스 호출 등을 하면 안되니까요.</p>\n<p>Saga는 최소한 <a href="https://redux-saga.js.org/docs/advanced/Testing.html">테스트 가능하도록 디자인 되어있고</a> 테스트에 도움되는 기능들을 가지고 있지만, Thunks는 부수 작업이 끝날때까지 대기가 걸리게 만듭니다.</p>\n<p>결국 이런 질문으로 이어지게 되지요. “어느 부분까지 테스트 할 것인가?”</p>\n<p>리덕스 앱을 전체적으로 테스트하기 위한 <a href="https://redux.js.org/docs/recipes/WritingTests.html">좋은 자료</a>가 있습니다만, 여러분이 직접 작성한 코드 말고 리덕스를 테스트하는데 무슨 의미가 있을까요? 리덕스 자체는 완전히 테스트를 마친 라이브러리라서 우리가 같은 테스트를 또 할 필요는 없습니다. 게다가 <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트하는건 굉장히 복잡하기 때문에 앱의 큰 부분을 본떠야 하는 불편함을 감수해야 합니다.</p>\n<p>저는 액션을 제대로 보내기만 하면 리덕스 스토어가 이를 받아서 처리할거라고 확신합니다. 제가 진짜 신경쓰는 부분은 컴포넌트가 그 액션을 잘 받아서 제대로 변화가 일어나는지 확인하는 겁니다. 통합 테스트의 영역이지요.</p>\n<p>그래서 제가 테스트를 할 때는</p>\n<ol>\n<li>먼저 리듀서를 테스트합니다. 테스트하기도 쉽고 중요한 기능을 가지고 있으니까요.</li>\n<li>그리고 리덕스에 연결되지 않은 컴포넌트를 테스트합니다. 특정 이벤트에 제대로 반응하는지 확인할 수 있습니다. 그리고 테스트하기 쉬운데다 데이터를 다루는 부분과 랜더링을 다루는 부분을 분리하여 볼 수 있습니다.</li>\n<li>복잡한 데이터를 다루는 부분을 순수 함수로 빼내어 테스트합니다.</li>\n<li>제 앱의 각 부분이 잘 맞아떨어지는지 확인하기 위해 Selenium을 써서 E2E(end to end) 테스트와 통합 테스트를 합니다.</li>\n</ol>\n<p>이 방법이 완벽한 방법은 아닙니다. 저는 아직 마지막 두 부분을 처리하기 위한 최상의 방법을 찾고 있습니다만, 이 방법들도 테스트 작성을 간단하게 해주며 생산적이라는 생각이 듭니다.</p>\n<p>매번 제가 동료들에게 리덕스에 연결된 컴포넌트를 다 테스트해서 보여줄 때마다 그들의 눈에는 동공지진이 일어납니다(their eyes instantly start glazing over). 많은 로직이 있고 본떠서 다루어야 할 것도 많습니다. 이런 복잡한 것들을 제쳐두면 일이 더 쉬워지며 사용자(혹은 매니저)를 우선적으로 고려한 유형의 테스트를 작성하는데 집중할 수 있습니다. 대부분의 프로젝트에 테스트를 작성할 시간이 얼마나 적은지를 생각한다면 괜찮은 등가교환이라 생각합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 아직도 테스트를 적절하게 하는 법을 배우고 있습니다. 그리고 지난 1년동안 많은 자료를 읽기도 하고 보기도 했습니다. 여러분이 자신만의 패턴을 만들면 Jest와 Enzyme으로 단위 테스트하는건 놀라우리만치 쉽습니다. 특히 리덕스의 복잡한 부분을 통합 테스트와 E2E 테스트로 옮기는 경우에도 유용합니다.</p>\n<p>Jest와 Enzyme을 다루는게 어렵다면 <a href="https://www.reactiflux.com/">ReactFlux</a>를 방문해보세요. 거기 있는 Jest 채널에서 많은 도움을 얻었습니다.</p>\n<p>이제 막 Jest + Enzyme으로 테스트를 시작하신다면 <a href="https://hackernoon.com/testing-react-components-with-jest-and-enzyme-41d592c174f">이 훌륭한 가이드</a>를 읽어보세요.</p>\n<p>스냅샷 테스트에 대해 더 자세히 알아보시려면 <a href="https://hackernoon.com/how-to-snapshot-test-everything-in-your-redux-app-with-jest-fde305ebedea">이 가이드</a>를 참고하세요.</p>\n<p>마찬가지로 React, Redux, Jest의 공식 문서를 꼭 살펴보세요. 모두 최고 수준의 가이드를 제공합니다.</p>\n<p>이 글이 여러분의 테스팅을 향한 여정에 도움이 되었으면 좋겠습니다. 어떠한 질문이나 코멘트가 있다면 <a href="https://twitter.com/tetheta">트위터로</a> 연락주세요.</p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-27-lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-27",path:"/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr",title:"[번역] 리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트 하며 얻은 교훈",tags:["Testing","React","Javascript"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p><a href="/posts/what-is-testing-javascript-kr">지난번</a> <a href="/posts/write-mostly-integration-test-kr">시리즈</a>를 통해 테스트가 무엇인지, 어떤 방향으로 테스트를 해야할지 조금 감을 잡으셨을 겁니다. 이제 본격적으로 리액트 애플리케이션을 테스트하고자 하는데, 또 한번 막히게 되죠.</p>\n<blockquote>\n<p>통합 테스트가 좋다는 건 알겠는데 좀더 실전에 가까운 예가 필요하다</p>\n</blockquote>\n<p>라고 생각하실지 몰라서 (저도 그렇게 생각하기 때문에) 남은 두 번의 번역 시리즈는 리액트 + 리덕스 애플리케이션 개발 시 테스트를 어떻게 했는지, 참고할만한 팁을 번역할 예정입니다.</p>\n<p>참고로 원작자는 ‘Redux app’ 이라는 용어를 계속 사용하고 있어서 저도 그냥 리덕스 앱이라고 번역했습니다. (앵귤러도 리덕스 쓸 수 있는데...) 또한 mocking(흉내내기, 모조품 만들기)의 번역이 부자연스러워 바로 음차했습니다. 더 좋은 표현이 있다면 제안 부탁드립니다.</p>\n<p><a href="https://hackernoon.com/low-effort-high-value-integration-tests-in-redux-apps-d3a590bd9fd5">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p><strong>짧은 정리: 여러분은 노드 환경에서 앱을 랜더링하고, 사용자 동작을 흉내내며 상태나 마크업의 변화를 확인할 수 있습니다. 이런 테스트는 상대적으로 작성하기 쉽고 빠르게 작동하며 이를 통해 많은 자신감을 얻을 수 있습니다.</strong></p>\n<p>효율적인 소프트웨어 테스트를 작성하는 일은 아슬아슬한 줄타기 같습니다(tricky balancing act). ‘효율성’ 이라는 용어는 실행 속도나 자원 소모를 의미하는 것이 아니라, 테스트를 작성하는데 드는 노력과 테스트가 제공하는 가치 사이에서 최고로 얻어낼 수 있는 절충안을 의미합니다.</p>\n<p>이 문제는 알려지지 않았거나 전혀 새로운 문제가 아닙니다. 과거에 수 많은 똑똑한 사람들이 달려들었고, 나중에 이 문제에 맞딱뜨릴 개발자를 위해 가이드라인을 만들었습니다. 저는 <a href="https://martinfowler.com/bliki/TestPyramid.html">테스팅 피라미드</a>를 신봉합니다. 테스팅 피라미드는 다양한 종류의 테스트를 제대로 다루는데 앞서, 각각의 코드를 개별적으로 다루는 단위 테스트(Unit test)가 기반이 되어야 한다고 강조합니다.</p>\n<h2 id="단위-테스트와-리덕스redux"><a href="#%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%EB%A6%AC%EB%8D%95%EC%8A%A4redux" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단위 테스트와 리덕스(Redux)</h2>\n<p>리덕스가 제시하는(역주: ‘강요하는’ 에 가까운 어감으로 느껴집니다) 구조 덕에 단위 테스트를 아주 쉽게 작성할 수 있습니다. 서로 분리되어있는 부분(리듀서, 액션 생성자, 컨테이너 등)을 각각 불러와서 여타 순수 함수와 똑같이 테스트 하면 됩니다. 데이터를 집어넣고, 나온 데이터를 단언(assertion)과 맞춰봅니다. 모킹(mocking)을 할 필요가 없지요. <a href="http://redux.js.org/docs/recipes/WritingTests.html">리덕스 문서 안에 있는 테스팅 가이드</a>에 각 부분의 단위 테스트를 하는 방법이 작성되어 있습니다.</p>\n<p>이 가이드를 따라가면서 지루하게 리듀서끼리, 액션 생성자끼리 테스트를 복-붙(copy-paste) 하다보면 단위 테스트 작성을 끝낼 수 있습니다. 그렇게 모든 작업이 끝나면 테스팅 피라미드가 뒷통수를 때리죠. 단순히 단위 테스트만 가지고는 ‘이 앱이 제대로 작동하는가?’ 라는 가장 기본적인 질문에 답할 수가 없습니다.</p>\n<h2 id="피라미드-오르기"><a href="#%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C-%EC%98%A4%EB%A5%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>피라미드 오르기</h2>\n<p>웹 애플리케이션을 작성하면서 테스팅 피라미드의 윗 단계로 올라가는데 몇 가지 방법이 있습니다. 맨 꼭대기에 있는 end-to-end(e2e) 계층은 Selenium과 <a href="http://webdriver.io">webdriver.io</a>를 사용해서 구현할 수 있습니다. 이런 종류의 테스트는 기술 독립적이라 여러분이 다른 프레임워크를 사용하도록 앱을 포팅해도 잘 작동합니다. 하지만 구현하고 돌려보는데 오래 걸리고, 디버그하기도 어려우며, 종종 원인 모를 문제에 시달릴 수 있습니다. 보통 아주 적은 종류의 e2e 테스트만 프로젝트에 적용하게 됩니다.</p>\n<p>그렇다면 e2e테스트와 단위 테스트 사이에 있는 계층은 어떨까요? 일반적으로 이런 테스트를 통합 테스트(integration test)라고 부릅니다. 애플리케이션의 모듈이 어떻게 상호작용하는지 테스트하지요. 통합 테스트의 범위는 넓습니다. 예를 들자면 액션을 보내기 위해(dispatch) 액션 생성자를 사용하는 리듀서를 테스트한다면 이미 단위 테스트의 범위를 넘어간 겁니다. 다른 측면에서 보면 e2e 테스트는 아주 극단적인 형태의 통합 테스트라고 볼 수 있습니다.</p>\n<p>우리는 리덕스에서 통합 테스트 하기에 아주 적절한 지점(sweet-spot)을 찾아보려 합니다. 개발 과정에서 충분히 빨리 돌려볼 수 있어야 하고, 단위 테스트와 같은 테스트 환경을 사용해야 하면서 리덕스로 관리되는 애플리케이션이 제대로 동작하고 있다는 충분한 확신을 줄 수 있어야 합니다.</p>\n<h2 id="범위를-찾기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EC%B0%BE%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 찾기</h2>\n<p>우선 테스트 하고자 하는 범위를 설정하는 게 좋은 출발점이 됩니다. 일반적인 웹 앱은 이런 방식으로 구성되어있는데요.</p>\n<p><img src="https://cl.ly/271c282D101g/typical-webapp-structure.png" alt="일반적으로 고도화된 웹앱의 구조"></p>\n<p>시스템의 일부는 올바른 테스트 결과를 얻기 위해 모킹되어야 합니다. 제일 제약이 심한 부분이 저 맨 꼭대기 위에 있는 ‘브라우저’입니다. (비록 헤드리스-Headless 라도) 브라우저 인스턴스를 띄워서 테스트를 돌리는 일은 Node.js(이하 노드)에서 테스트 코드를 실행하는 것보다 훨씬 오래 걸립니다. 시작부터 끝까지 진짜 요청이 끝나길 기다릴 필요는 없습니다. 네트워크 계층(역주: 프론트엔드와 백엔드 사이에 통신하는 부분을 지칭하는 것으로 보입니다)은 명확히 정의된 인터페이스라서 적절히 모킹하기 쉽습니다.</p>\n<h2 id="범위를-모킹하기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EB%AA%A8%ED%82%B9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 모킹하기</h2>\n<p>리액트와 리덕스를 쓰는 앱이 있다고 가정하면, 노드 환경에서 부드럽게 돌아가는 테스트를 작성하는게 꽤 쉽습니다(심지어 서버 사이드 랜더링을 한다면 프로덕션 환경에서도 가능합니다). <a href="https://facebook.github.io/jest/">Jest</a>라는 걸출한 테스팅 프레임워크로 테스트를 돌릴 수 있는데다, 마찬가지로 대단한 <a href="https://github.com/airbnb/enzyme">Enzyme</a>은 브라우저 환경 없이 애플리케이션의 일부 혹은 전체를 랜더링해주고 동작을 확인해볼 수 있게 만들어주기 때문입니다.</p>\n<p>Enzyme은 <code class="language-text">mount</code> 라는 함수를 제공하는데, 이 함수로 어떠한 리액트 컴포넌트라도 그려내고 동작을 확인해볼 수 있습니다. 리덕스를 쓰는 앱도 마찬가지로 테스트 가능합니다. 매번 테스트할 때 같은 코드를 반복하지 않기 위해 간단한 유틸리티 함수를 작성해두면 도움이 됩니다. 이 함수는 주어진 상태(Redux 스토어)와 Enzyme의 래퍼 객체(역주: Enzyme을 통해 그려진 컴포넌트를 객체화 한 것. 이후 다양한 메서드를 통해 하위 DOM 탐색 및 다양한 동작을 확인해볼 수 있습니다)를 리턴합니다. 이렇게 만들어둔 함수는 나중에 단언 작성을 꽤 편하게 해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react-redux\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'enzyme\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> MyApp <span class="token keyword">from</span> <span class="token string">\'./containers/MyApp\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> createStore <span class="token keyword">from</span> <span class="token string">\'./createStore\'</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">></span>\n      <span class="token operator">&lt;</span>MyApp <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nwrapper\n  <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'hello\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>노드 환경에서 테스트를 실행할 때 네트워크 계층을 깔끔하게 모킹하는 방법이 있습니다. 예를 들어 <a href="https://github.com/node-nock/nock">nock</a> 같은 라이브러리가 있지요. nock은 테스트를 실행하기 전에 네트워크 요청에 따른 응답 데이터나 에러를 쉽게 선언할 수 있도록 만들어줍니다. 성공적인 GET 요청을 모킹하는 예는 다음과 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">\'nock\'</span><span class="token punctuation">;</span>\n<span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://example.com/api\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 이후 코드 어디에서나 https://example.com/api/1234 로 요청을 하면</span>\n<span class="token comment">// 성공했다는 응답과 함께 { foo: \'bar\' } 를 응답값으로 리턴하게 됩니다.</span>\n</code></pre>\n      </div>\n<p>이렇게 설정하면 통합 테스트를 단위 테스트와 비슷한 수준으로 빠르고 편하게 실행할 수 있습니다. 이제 테스트를 구현하기만 하면 됩니다...</p>\n<p><img src="https://cl.ly/3j3q0t3Q0b2G/mock-boundaries.png" alt="리덕스 통합 테스트를 위해 테스트 범위 모킹"></p>\n<h2 id="무엇을-테스트하나"><a href="#%EB%AC%B4%EC%97%87%EC%9D%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무엇을 테스트하나?</h2>\n<p>여러분이 만든 앱이 정상적으로 동작한다는 자신감을 가장 크게 얻으려면 사용자의 시점에서 통합 테스트를 작성해야 합니다. 버튼 클릭, 폼 채우기 등의 사용자가 조작하는 행위에 따라 앱이 기대한대로 반응하는지 확인하는게 목표입니다.</p>\n<p>간단한 폼을 제출한다는 시나리오를 생각해 보겠습니다. 데이터가 폼에 들어있는 상태로 랜더링 한 뒤에 사용자가 ‘제출’ 버튼을 누르는 행위를 흉내를 내 보겠습니다(simulate). 그리고 지정된 API 엔드포인트로 요청을 제대로 보내는지 확인해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Submitting the form\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> submitButton <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'[type="submit"]\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'sends the data and shows the confirmation page\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://myapp.com/api\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    submitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 이제 무슨 일이 일어나는지 확인합니다</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="언제-테스트하나"><a href="#%EC%96%B8%EC%A0%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>언제 테스트하나?</h2>\n<p>본격적으로 단언을 작성하기 전에, 또 하나의 문제가 있습니다. “테스트를 언제 실행하냐” 인데요(역주: 테스트 코드를 실행하는 행위가 아니라 모든 작업이 다 끝나고 기대값과 결과값을 비교하는 ‘단언’ 을 의미하나봅니다). 모든 변화가 순차적으로 일어나는 단순한 상황에서는 사용자 동작을 흉내를 낸 뒤에 바로 단언을 실행하면 됩니다. 하지만 여러분의 앱은 보통 네트워크 요청 같은 비동기 코드를 다루기 위해 프로미스(Promise) 등을 사용할 겁니다. 네트워크 요청을 순차적으로 실행되게 모킹해놓았다 하더라도, 성공한 프로미스는 <code class="language-text">submitButton.simulate(&#39;click&#39;)</code> 부분 다음의 코드를 바로 실행할겁니다. 우리는 단언이 실행되기 전에 앞선 작업이 “제대로 끝나기를” 기다리게 해야합니다.</p>\n<p>Jest는 여러가지로 비동기 코드를 다루는 방법을 제공하지만, Promise 체인을 직접 다루는 방식으로 동작하거나(이번 예시에는 없지요) , 타이머를 모킹해야 합니다(Promise 기반 코드에는 동작하지 않습니다). <code class="language-text">setTimeout(() =&gt; {}, 0)</code> 같은 코드를 사용할 수 있지만 <a href="https://facebook.github.io/jest/docs/en/asynchronous.html">Jest의 비동기 콜백 기능</a>을 사용해야 해서 코드의 가독성이 떨어지게 됩니다.</p>\n<p>하지만 이 문제를 멋지게 해결하기 위해 한 줄짜리 보조 함수를 사용하면 됩니다. 이 함수는 성공한 Promise를 이벤트 루프의 바로 다음 차례로 넘기는 일을 합니다. Jest에서 기본적으로 지원하는 Promise 리턴과 같이 사용하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">flushAllPromises</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=></span> <span class="token function">setImmediate</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'runs some promise based code\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">triggerSomethingPromiseBased</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise 기반의 동작 실행</span>\n  <span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n     <span class="token comment">// 무슨 일이 일어나는지 확인하기</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="어떻게-테스트하나"><a href="#%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어떻게 테스트하나?</h2>\n<p>사용자와 앱의 상호작용이 제대로 이루어지고 있나 확인하려면 어떤 방법이 있을까요?</p>\n<p><strong>마크업(Markup)</strong> - UI가 제대로 변경되었는지 확인하기 위해 페이지의 마크업을 들여다볼 수 있습니다. 예를 들어 <a href="https://facebook.github.io/jest/docs/snapshot-testing.html">Jest의 스냅샷 기능으로요.</a> (유의할 점: 아래의 테스트 코드를 실행하기 위해 <a href="https://github.com/adriantoine/enzyme-to-json#serializer">enzyme-to-json</a>같은 Jest 스냅샷 직렬화 모듈(serializer)을 설치해야 합니다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 방식의 단언은 작성하기 아주 쉽지만, 어디에 문제가 있는지 살펴보기 어려워지는 경향이 있습니다. 스냅샷은 가끔 겉으로 보기에 상관없어 보이는 테스트가 실패할 때도 변할 수 있습니다. 게다가 변화가 있었는지 확인만 할 뿐 무슨 행동을 했는지 기록을 남기진 않습니다.</p>\n<p><strong>상태(State)</strong> - 애플리케이션의 상태 변경을 확인하는 방법입니다. 한 곳에 집중된 스토어를 가지고 있는 리덕스 애플리케이션은 테스트하기 쉽지만, 상태가 나뉘어있다면 조금 복잡해질 수 있습니다. 이 때도 스냅샷 테스트를 할 수 있지만 저는 객체를 직접 비교하는 방식을 선호하는 편입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n    confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>상태 스토어는 사용자가 보지 못하는 곳에 감추어져 있기 때문에 사용자 중심적인 테스트와는 약간 거리가 있습니다. 하지만 디자인 변경에 따른 마크업 수정이 일어나는 경우 영향을 덜 받습니다.</p>\n<p><strong>부수 기능(Side effects)</strong> - 여러분의 애플리케이션에 따라 확인해야 하는 부수 기능도 있습니다(네트워크 요청, <code class="language-text">localStorage</code> 변화 등). 이럴 때 nock의 <code class="language-text">isDone</code> 메서드를 활용하여 모킹한 요청이 실제로 사용되었는지 확인할 수도 있습니다. </p>\n<p><strong>액션 보내기(Dispatched actions)</strong> - 리덕스의 기능을 십분 활용하여 어떤 액션이 발생했는지 쉽게 로그를 정리하고 나열할 수 있습니다. 이를 이용해서 스토어에 액션을 보내는 흐름을 확인해볼 수 있습니다. <a href="https://github.com/arnaudbenard/redux-mock-store">redux-mock-store</a> 같은 유용한 라이브러리의 도움을 받을 수도 있습니다. 먼저 위에서 정의한 <code class="language-text">renderAppWithState</code> 메서드를 조금 수정해서 가상의 리덕스 스토어를 적용하면, 그 다음 스토어에 어떤 액션들이 호출되었는지 확인하기 위해 <code class="language-text">getActions</code> 메서드를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token comment">// 이제 renderAppWithState는 redux-mock-state를 사용해서 스토어를 생성합니다.</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getActions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_START\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> \n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_SUCCESS\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 유형의 단언은 특히 코드가 비동기로 흘러갈 때 테스트 하고자 할 때 유용합니다. 또한 테스트 시나리오가 어떤 흐름으로 구성되는지 보여주면서 일종의 문서 역할을 합니다.</p>\n<h2 id="중심-잡기"><a href="#%EC%A4%91%EC%8B%AC-%EC%9E%A1%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>중심 잡기</h2>\n<p>앞서 소개한 통합 테스트가 단위 테스트를 완전히 대체한다는 뜻은 아닙니다. 특히 애플리케이션에 무거운 로직이 있는 부분(리듀서나 셀렉터)은 여전히 철저하게 단위 테스트가 적용되어야 합니다. 테스팅 피라미드의 계층은 여전히 유효합니다! 하지만 통합 테스트는 테스트 방법 중 하나로서 충분히 유효하며, 가능한 한 고통을 덜고 더 자신있게 소프트웨어를 배포할 수 있도록 좋은 테스트를 구축하는데 도움이 됩니다.</p>\n<p>소프트웨어 테스트라는 주제는 업계에서 가장 많이 오가는 주제 중 하나입니다. 제 동료는 제 글을 검수해주면서 “<a href="http://blog.thecodewhisperer.com/permalink/integrated-tests-are-a-scam">통합 테스트는 사기다</a>” 라는 글을 알려주기도 했습니다. 어떤 사람들은 저 글을 쓴 사람이 맞다고도 하지만, 제가 생각하기에 흑백 논리로 따질 수 없는 주제라고 생각합니다. 여러분은 어떻게 생각하시나요?</p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-19-intergration-tests-in-redux-apps-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-19",path:"/posts/integration-tests-in-redux-apps-kr",title:"[번역] 리덕스 앱을 저비용 고효율로 통합 테스트 하기",tags:["Testing","React","Javascript"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>요즘 개인적으로 “가능한한 내 코드에 모두 테스트를 작성하겠다” 라는 목표를 가지고 있습니다. 하지만 테스트에 대해 두루뭉술한 개념만 가지고 있고, 지금은 상대적으로 쉬운 함수만 테스트를 작성할 수 있는 수준입니다.</p>\n<p>하지만 실제 개발하고 있는 애플리케이션은 ‘리액트 + 리덕스(혹은 MobX) + 기타등등’ 의 구성으로 되어있기 때문에 조금만 테스트를 제대로 해 보려고 하면 어디부터 손을 대야할지 전혀 감을 못 잡는 상태입니다.</p>\n<p>그래서 실전에 최대한 도움이 될 수 있도록 유용한 글을 몇개 추려서 단계별로 보기 좋은 참고서가 될 수있도록 번역하는 사이드 프로젝트를 진행하고 있습니다. 이 글을 보시는 분들도 리액트로 만드는 애플리케이션을 테스트하는데 도움이 되었으면 좋겠습니다.</p>\n<p>그 첫 번째 단계로 <strong>테스트가 대체 뭐냐?</strong> 라는 질문에 가벼운 답이 될 수 있는 글의 번역부터 시작합니다.</p>\n<p><a href="https://blog.kentcdodds.com/but-really-what-is-a-javascript-test-46fe5f3fad77">원문은 여기서 읽어보실 수 있습니다.</a></p>\n<hr>\n<p><em>일단 한 발짝 물러서서 시작부터 자바스크립트 자동화 테스트를 이해해 보도록 하겠습니다.</em></p>\n<p>소프트웨어를 테스트하는 이유는 수도 없이 많습니다. 저는 크게 두 가지 이유를 가지고 있습니다.</p>\n<ol>\n<li>전체 작업 흐름의 속도를 올려서 개발을 빠르게 한다.</li>\n<li>변경 사항이 있을 때 기존 코드를 무너트리지 않는다는 확신을 갖도록 도와준다.</li>\n</ol>\n<p>그래서 그런데, 저는 여러분에게 몇 가지 여쭈어 보고 싶은게 있습니다. (트위터 투표로 미리 물어보았죠)</p>\n<ul>\n<li><a href="https://twitter.com/kentcdodds/status/942625485829181441">자바스크립트 테스트를 작성해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625486638759938">자바스크립트 테스팅 프레임워크를 사용해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625487511154688">자바스크립트 테스팅 프레임워크를 밑바닥부터 설정해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625489348280320">테스팅 프레임워크를 충분히 이해하고 있고, 아주 간단한 테스팅 프레임워크라도 직접 만들어 보실 수 있습니까?</a></li>\n</ul>\n<p>이 글의 목적은 당신이 마지막 질문에 “네” 라고 대답할 수 있도록 돕는 것입니다. 결과적으로 자바스크립트를 테스트한다는게 무엇인지 알아야 더 좋은 테스트를 작성할 수 있으니까요.</p>\n<p>이제 간단한 <code class="language-text">math.js</code> 모듈을 만들어서 그 안에 두 함수를 작성한 다음에 내보내겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b\n<span class="token keyword">const</span> <span class="token function-variable function">subtract</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">-</span> b\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> sum<span class="token punctuation">,</span> subtract <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><strong>작성하는 모든 코드는 <a href="https://github.com/kentcdodds/js-test-example">Github에</a> 올려두었으니 참고하시면 됩니다</strong> 🐙😸</p>\n<h2 id="1단계"><a href="#1%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1단계</h2>\n<p>제가 생각할 수 있는 가장 기본적인 테스트 형식을 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// basic-test.js</span>\n<span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token boolean">true</span>\n<span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token boolean">false</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'${actual} is not ${expected}\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>터미널에서 <code class="language-text">node basic-test.js</code> 라고 입력하시면 이 테스트 코드를 실행할 수 있습니다. 이게 테스트입니다!</p>\n<p><strong>테스트는 기대하던 결과값과 실제 출력된 값이 맞지 않으면 에러를 일으키는 코드입니다.</strong> 만약 특정한 상태값 설정을 해야하는 등(예를 들자면 컴포넌트가 테스트 실행 전에 그려져야(Rendered on Document) 브라우저 이벤트를 확인해볼 수 있다던가, 데이터베이스에 있는 사용자를 가져온다던가) 특수한 경우에는 더 복잡해질 수 있습니다. 하지만 <code class="language-text">math.js</code> 모듈 같은 순수한 함수(Pure function - 입력값에 따른 출력값이 동일하며 외부의 상태에 영향을 미치지 않는 함수)은 상대적으로 쉽습니다.</p>\n<p><strong>코드의 <code class="language-text">actual !== expected</code> 부분을 “단언(assertion)” 이라고 합니다.</strong> 단언은 어떤 것이 특정한 값으로 되어있어야 한다거나 특정 테스트를 통과해야한다고 코드로 표현하는 것을 뜻합니다. <code class="language-text">actual</code> 부분이 어떠한 정규표현식에 일치해야하거나, 배열이 특정한 길이를 가지고 있어야 한다고 표현하는 것이 단언이 됩니다. 중요한 점은 만약 우리가 작성한 단언이 실패하면 에러가 일어나야 한다는 것입니다.</p>\n<p>그래서 <code class="language-text">math.js</code> 를 가장 기본적인 형태로 테스트 해 본다면 이렇게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 1.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>짜잔! 이 파일을 <code class="language-text">node</code> 커맨드로 실행해보면 에러 없이 실행되고 종료됩니다. 이제 <code class="language-text">sum</code> 함수의 <code class="language-text">+</code> 연산을 <code class="language-text">-</code> 연산으로 바꾸고 다시 실행해서 테스트를 깨지도록 만들어보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 1.js\n/Users/kdodds/Desktop/js-test-example/1.js:8\n  throw new Error(`${result} is not equal to ${expected}`)\n  ^\nError: -4 is not equal to 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/1.js:8:9)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>좋습니다! 우리는 벌써 기본적인 테스트를 사용해서 이득을 보고 있어요! 이제 테스트를 변경하지 않는 이상 <code class="language-text">sum</code> 함수를 마음대로 바꿀 수 없습니다. 쩌네요(Neato)!</p>\n<p><strong>테스팅 프레임워크(혹은 단언 라이브러리)의 가장 중요한 부분은 에러 메세지를 최대한 도움이 되도록 표현하는 겁니다.</strong> 테스트가 실패할 때마다 여러분이 제일 먼저 에러 메세지를 보게 됩니다. 만약 에러 메세지를 보고 어떤 문제가 밑에 깔려있는지 단박에 파악하지 못한다면, 몇분씩 코드를 직접 들여다보면서 뭐가 잘못됐는지 찾아야 합니다. 에러 메세지의 질은 여러분이 주어진 테스팅 프레임워크를 얼마나 잘 이해하고 적절한 단언을 사용하느냐에 따라서 크게 달라집니다.</p>\n<h2 id="2단계"><a href="#2%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2단계</h2>\n<p>사실 Node.js 가 위에서 만들어본 <a href="https://nodejs.org/api/assert.html#assert_assert"><code class="language-text">assert</code></a> 모듈을 내장하고 있다는 걸 알고 계셨나요🤔? 이 모듈을 써서 리팩터링을 해 보겠습니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 2.js</span>\n<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>좋아요! 저번에 작성했던 코드와 기능적으로 완전히 동일한 테스트 모듈을 작성해보았습니다. 딱 하나 다른게 있다면 에러 메세지입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 2.js\nassert.js:42\n  throw new errors.AssertionError({\n  ^\nAssertionError [ERR_ASSERTION]: -4 === 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/2.js:8:8)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>내용을 보시면 아쉽게도 에러가 더 이상 코드 내용을 보여주지 않고 있습니다. 😦 일단 계속 가보죠.</p>\n<h2 id="3단계"><a href="#3%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3단계</h2>\n<p>더 나아가서 직접 테스팅 “프레임워크” 와 단언 라이브러리를 작성해보겠습니다. 먼저 단언 라이브러리부터 시작해보죠. Node의 내장 <code class="language-text">assert</code> 모듈 대신에 <code class="language-text">expect</code> 라는 라이브러리를 만들어보겠습니다. 변경된 코드는 아래와 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 3.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 원하는대로 단언을 추가하고 객체를 리턴하도록 만들 수 있습니다(<code class="language-text">toMatchRegex</code>, <code class="language-text">toHaveLength</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 3.js\n/Users/kdodds/Desktop/js-test-example/3.js:17\n        throw new Error(`${actual} is not equal to ${expected}`)\n        ^\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/3.js:17:15)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/3.js:7:16)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>훨씬 보기 좋아졌네요.</p>\n<h2 id="4단계"><a href="#4%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4단계</h2>\n<p>그런데 만약 에러 메세지가 나온다 해도 정확하게 <code class="language-text">sum</code> 함수에 문제가 생겼다고 파악하려면 어떻게 해야할까요😖? 저 파일 안에는 <code class="language-text">subtract</code> 함수도 있는데 말이죠. 게다가 테스트 파일의 코드는 각각의 테스트를 적절히 분리하지 못하고 있습니다(시각적으로 + 기능적으로). </p>\n<p>그래서 헬퍼 함수를 만들어서 분리해보았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 4.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">try</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`- [x] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`✕ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 특정 테스트에 관련된 내용은 전부 “test” 콜백 안에 집어넣고, 테스트에 제목을 매길 수 있습니다. 그리고 <code class="language-text">test</code> 함수에 유용한 에러 메세지를 출력하도록 할 뿐만 아니라 모든 테스트를 한번에 실행할 수 있게 되었습니다(첫 번째 테스트에서 에러가 발생한다고 멈추지 않구요)!</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 4.js\n✕ sum adds numbers\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/4.js:29:15)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:6:18)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:17:5)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/4.js:3:1)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n- [x] subtract subtracts numbers</code></pre>\n      </div>\n<p>좋아요! 이제 에러 메세지 <em>뿐만 아니라</em> 어떤 부분을 고쳐야하는지 테스트 제목을 보고 찾아갈 수 있습니다.</p>\n<h2 id="5단계"><a href="#5%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5단계</h2>\n<p>마지막 단계로 모든 테스트 파일을 찾아서 실행하는 <a href="https://blog.kentcdodds.com/tips-for-making-a-cli-based-tool-with-node-9903255c2a3b">CLI 도구를 작성하기만 하면 됩니다!</a> 처음엔 쉽겠지만 그 위에 해야하는 일들이 굉장히 많아서 좀 어렵습니다 . 😅</p>\n<p>현재 시점에서 우리는 테스팅 프레임워크와 테스트 실행기(runner)를 만들었습니다. 다행히도 이미 만들어진 도구가 산더미같이 많습니다! 저는 모든 테스팅 도구를 사용해보았고 다 괜찮았습니다. 그래도 제 요구 사항을 가장 만족하는 도구는 Jest 뿐이었습니다. Jest는 아주 대단한 도구입니다. (<a href="http://kcd.im/egghead-jest">Jest를 더 알아보시려면 이 링크를 확인하세요</a>)</p>\n<p>그러니 이제 직접 프레임워크를 작성하는 대신 테스트 파일을 Jest 용으로 바꾸어 보겠습니다. 이를 어쩌죠? 안바꿔도 되는데요!? Jest는 <code class="language-text">test</code>, <code class="language-text">expect</code> 를 글로벌 객체로 가지고 있기 때문에 그냥 이전에 작성한 <code class="language-text">test</code> 와 <code class="language-text">expect</code> 의 구현체를 지우기만 하면 됩니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 5.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>Jest로 이 파일을 실행하면 다음과 같은 결과가 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ jest\n FAIL  ./5.js\n  ✕ sum adds numbers (5ms)\n  - [x] subtract subtracts numbers (1ms)\n● sum adds numbers\nexpect(received).toBe(expected)\n    \n    Expected value to be (using Object.is):\n      10\n    Received:\n      -4\n      4 |   const result = sum(3, 7)\n      5 |   const expected = 10\n    &gt; 6 |   expect(result).toBe(expected)\n      7 | })\n      8 | \n      9 | test(&#39;subtract subtracts numbers&#39;, () =&gt; {\n      \n      at Object.&lt;anonymous&gt;.test (5.js:6:18)\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 passed, 2 total\nSnapshots:   0 total\nTime:        0.6s, estimated 1s\nRan all test suites.</code></pre>\n      </div>\n<p>텍스트만 보아서는 알 수 없지만 사실 결과는 컬러로 출력됩니다. 이미지로 보시면 이렇게 나옵니다.</p>\n<p><img src="https://cl.ly/302i0B3V0J45/what-is-javascript-testing-1.png"></p>\n<p>컬러로 출력되면 관련된 부분을 살펴볼 때 큰 도움이 됩니다. <strong>그리고 에러가 발생하는 부분의 코드를 직접 보여줍니다! 이게 “도움이 되는” 에러 메세지죠!</strong></p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>그래서 자바스크립트 테스트가 뭐라고 했죠? 단순히 특정 상태를 설정해놓은 코드를 가지고 특정 동작을 수행한 뒤, 새 상태를 확인하는 단언을 만드는 겁니다. 이번 시간에는 <a href="https://facebook.github.io/jest/docs/en/api.html#beforeeachfn-timeout"><code class="language-text">beforeEach</code></a>, <a href="https://facebook.github.io/jest/docs/en/api.html#describename-fn"><code class="language-text">describe</code></a> 같은 <a href="https://facebook.github.io/jest/docs/en/api.html">프레임워크 공용으로 사용되는 헬퍼 함수</a>에 대한 이야기는 하지 않았지만, <a href="https://facebook.github.io/jest/docs/en/expect.html#tomatchobjectobject"><code class="language-text">toMatchObject</code></a>, <a href="https://facebook.github.io/jest/docs/en/expect.html#tocontainitem"><code class="language-text">toContain</code></a> 같이 사용할 수 있는 단언이 아주 많이 있습니다. 적어도 이 글이 여러분들에게 자바스크립트로 테스트하는데 기본적인 개념을 제시해주길 바랍니다.</p>\n<p>도움이 되었으면 좋겠군요. 행운을 빕니다! 👍</p>\n<p><strong>놓치지 말고 참고할만한 글 목록(영어 자료)</strong></p>\n<ul>\n<li><a href="https://twitter.com/horse_js/status/942658114209316864">Horse JS on Twitter: “But really, what is a JavaScript”</a> - 문맥을 빗겨가게 끊어진 글을 트윗하는 아주 재밌는 계정입니다.</li>\n<li><a href="https://twitter.com/NTulswani/status/942079674527518720">Introducing React Performance Devtool!! - by Nitin Tulswani</a></li>\n<li><a href="https://www.javascriptjanuary.com">JavaScript January</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2018-01-14-what-is-testing-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-14",path:"/posts/what-is-testing-javascript-kr",title:"[번역] 그래서, 자바스크립트 테스트가 뭔가요?",tags:["Translation","Javascript","Testing"],category:"Testing"}},{excerpt:"MobX를 리액트에 쓰기 위해 필요한 기본 구성은  ,   패키지이다. 그리고 각각  ,   데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다. Observer 생성한 스토어가   로 구성되어 있고, 컴포넌트가   데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다. MobX…",html:'<p>MobX를 리액트에 쓰기 위해 필요한 기본 구성은 <code class="language-text">mobx</code>, <code class="language-text">mobx-react</code> 패키지이다. 그리고 각각 <code class="language-text">observable</code>, <code class="language-text">observer</code> 데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다.</p>\n<h2 id="observer"><a href="#observer" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observer</h2>\n<p>생성한 스토어가 <code class="language-text">observable</code> 로 구성되어 있고, 컴포넌트가 <code class="language-text">observer</code> 데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> appState <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  count<span class="token punctuation">:</span> <span class="token number">0</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">--</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">handleInc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function-variable function">handleDec</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>div<span class="token operator">></span>\n        Counter<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span>count<span class="token punctuation">}</span> <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleInc<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">+</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDec<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">-</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>MobX의 리액트 개발자 도구는 크롬 같은 브라우저의 확장으로 설치하는 것이 아니라 일종의 리액트 컴포넌트로 되어있다. 따라서 프로젝트에 <code class="language-text">mobx-react-devtools</code> 를 설치하고 <code class="language-text">&lt;Devtools /&gt;</code> 같은 컴포넌트를 컴포넌트 트리에 삽입하면 된다.\nObservable 스토어를 다룰 때 DOM을 그리는 등의 동작은 Side Effects(부가 동작)으로 처리된다. 이 때 스토어의 상태를 효율적으로 다루기 위해 <code class="language-text">computed</code> 속성을 쓰면 필요한 부분만 스토어의 변경을 감지하여 효과적인 컴포넌트 랜더링이 가능하다.</p>\n<h2 id="action"><a href="#action" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Action</h2>\n<p><code class="language-text">@action</code> 데코레이터는 리듀서의 액션 디스패치와 같은 역할을 한다. 데코레이터와 함께 메서드를 작성하고, 이에 따라 Observable 값이 변경되도록 하면 MobX가 알아서 처리 해줄 것이다. Observable한 값을 직접 변경해주는 것도 일종의 액션이다. 상태 변경의 방법을 밖으로 드러내어 실수를 미연에 방지하는 것이 액션의 역할 뿐 아니라, 상태 변경을 하나의 단위로 묶어 트랜잭션을 수행하는 역할도 가지고 있다. 또한 비동기 작업 수행을 효과적으로 제어할 때도 사용된다. 예를 들어 작업 시행 -> 작업 종료가 명료하게 동기화되어야 할 때 액션을 사용하면 의도치 않은 동작을 방지할 수 있다.</p>\n<p><code class="language-text">@action(name: string)</code> 같은 형식으로 이름을 넣어서 개발 도구에서 손쉽게 액션을 파악할 수 있다. 그리고 액션을 쓰지 않고 직접 상태를 변경하는 일을 막기 위해 <code class="language-text">useStrict</code> 함수로 strict mode를 설정할 수 있다. 이 때는 액션 데코레이터 없이는 상태 변경을 수행할 수 없다.</p>\n<h2 id="observable-data-structure"><a href="#observable-data-structure" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observable Data Structure</h2>\n<p><code class="language-text">observable</code> 함수로 배열, 객체, Map 등을 감싸서 활용할 수 있다. 이 세 가지는 MobX에서 가장 중요하게 여기는 자료구조이다. 여기서 객체나 배열에 들어갈 값은 기존 자바스크립트에서 쓰는 단순한 객체나 원시 타입의 값일 수도 있지만, 개발자가 MobX의 기능을 활용하여 만든 상태 모델의 인스턴스를 넣어서 조작할 수도 있다. 가령 위에서 이야기한 <code class="language-text">computed</code>, <code class="language-text">action</code> 등을 활용한 임의의 클래스를 만들고, 그 클래스의 인스턴스들을 배열에다 넣어서 다룰 수 있다는 이야기다.</p>\n<p><code class="language-text">observable([])</code> 같은 명령어로 만들어진 배열은 유사 배열이기 때문에 실제 배열처럼 다루려면 <code class="language-text">toJS</code> 같은 별도의 가공이 필요하다.</p>\n<h2 id="컴포넌트를-나누어-관리하기"><a href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%A5%BC-%EB%82%98%EB%88%84%EC%96%B4-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컴포넌트를 나누어 관리하기</h2>\n<p>Observable 상태를 <code class="language-text">map</code> 함수로 순회하며 하위 컴포넌트를 생성할 때 고려해야 할 점이 있다. 아무 처리도 없이 <code class="language-text">map</code> 함수로 생성한 하위 컴포넌트에서 <code class="language-text">onClick</code> 등으로 상태를 바꾸면, 겉으로 보기에는 상태가 변한 부분만 다시 랜더링 되는 것으로 보이지만 실제로 모든 하위 컴포넌트가 다시 랜더링된다. 이런 구조가 누적되면 결과적으로 큰 자원 낭비를 초래하기 때문에 최적화헤야 한다.\n가장 간단한 방법은 <code class="language-text">map</code> 함수 안에서 생성되는 하위 컴포넌트가 <code class="language-text">@observer</code> 임을 명시해주고, 상태 변화 액션도 <code class="language-text">@action</code> 으로 관리해주면 된다. 최적화는 MobX가 알아서 해 준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n    <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n      <span class="token operator">&lt;</span>TView Key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n    <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">TView</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onTempClick<span class="token punctuation">}</span><span class="token operator">></span>\n        <span class="token punctuation">{</span>t<span class="token punctuation">.</span>temperature<span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  @action <span class="token function-variable function">onTempClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="provider-컴포넌트-사용하기"><a href="#provider-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provider 컴포넌트 사용하기</h2>\n<p><code class="language-text">mobx-react</code> 는 <code class="language-text">react-redux</code> 처럼 <code class="language-text">Provider</code> 컴포넌트를 제공한다. 사실 MobX의 스토어는 한번 선언되어있으면 어디서 어떻게 가져다쓰던 <code class="language-text">observer</code>, <code class="language-text">observable</code> 선언만 제대로 되어있으면 동적으로 연결된다. 하지만 기존에 리덕스를 사용할 때 처럼 최상단 컴포넌트를 Provider 컴포넌트로 감싸기만 하면 <code class="language-text">connect</code>, <code class="language-text">mapStateToProps</code> 같은 함수를 사용하지 않아도 바로 자유자재로 사용할 수 있다. 단지 <code class="language-text">@observer</code> 데코레이터 선언 시 어떤 스토어를 사용할지만 명시하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 스토어 선언 및 Provider 감싸기</span>\n<span class="token keyword">const</span> temps <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>Provider temperatures<span class="token operator">=</span><span class="token punctuation">{</span>temps<span class="token punctuation">}</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// App 컴포넌트</span>\n<span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span>\n  <span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n      <span class="token operator">&lt;</span>TemperatureInput <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n        <span class="token operator">&lt;</span>TView key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">)</span><span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// temperatures를 사용하는 컴포넌트</span>\n<span class="token comment">// 위의 App 컴포넌트를 보면 알겠지만 따로 props 선언이 없었음에도 바로 사용 가능하다.</span>\n@<span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">class</span> <span class="token class-name">TemperatureInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  @observable input <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li<span class="token operator">></span>\n        Destination\n        <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">}</span>\n        value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">}</span>\n        <span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit<span class="token punctuation">}</span><span class="token operator">></span>Add<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="특정-상황에서-반응하는-액션-작성하기"><a href="#%ED%8A%B9%EC%A0%95-%EC%83%81%ED%99%A9%EC%97%90%EC%84%9C-%EB%B0%98%EC%9D%91%ED%95%98%EB%8A%94-%EC%95%A1%EC%85%98-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정 상황에서 반응하는 액션 작성하기</h2>\n<p>작성해놓은 스토어를 사용할 때 특정 조건에 맞추어 원하는 동작이 발생하도록 훅을 걸거나(<code class="language-text">when</code>), 모든 상태 변화마다 실행되는 함수를 지정할 수도 있다(<code class="language-text">autorun</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// when의 사용 예</span>\n<span class="token keyword">function</span> <span class="token function">isNice</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> t<span class="token punctuation">.</span>temperatureCelsius <span class="token operator">></span> <span class="token number">25</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">when</span><span class="token punctuation">(</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> temps<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> temps<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Book now! "</span> <span class="token operator">+</span> t<span class="token punctuation">.</span>location<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// autorun의 사용 예</span>\n<span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">autorun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'6\'</span>\nnumbers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'10\'</span>\n</code></pre>\n      </div>\n<p><a href="https://mobx.js.org/refguide/computed-decorator.html">공식 문서</a>에 따르면 <code class="language-text">autorun</code> 함수는 상태 값을 변화시키지 않으면서 항상 실행되어야 하는 상황(로깅, UI 업데이트)에서 사용되며 그 이외의 경우는 전부 <code class="language-text">computed</code> 사용을 권장하고 있다.</p>\n<blockquote>\n<p>Don\'t confuse computed with autorun. They are both reactively invoked expressions, but use @computed if you want to reactively produce a value that can be used by other observers and autorun if you don\'t want to produce a new value but rather want to achieve an effect. For example imperative side effects like logging, making network requests etc.</p>\n</blockquote>\n<h2 id="참고-자료"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2>\n<ul>\n<li><a href="https://egghead.io/courses/manage-complex-state-in-react-apps-with-mobx">Manage Complex State in React Apps with MobX from @mweststrate on @eggheadio</a></li>\n<li><a href="https://egghead.io/courses/manage-application-state-with-mobx-state-tree">Manage Application State with Mobx-state-tree from @mweststrate on @eggheadio</a></li>\n<li><a href="https://mobx.js.org/">Mobx Documentation</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-12-31-mobx-basic-concepts/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-31",path:"/posts/mobx-basic-concepts",title:"MobX로 상태 관리하기",tags:["Javascript","MobX","React"],category:"MobX"}},{excerpt:"감상평을 적기에 앞서 몇 가지 가벼운 질문이 있다. 혹시 아래의 문제를 보았을 때 모르는 내용이 2가지 이상 있거나, 알더라도 바로 명확한 답변이 떠오르지 않는지 생각해보라. (ES…",html:'<p><img src="https://cl.ly/2c1k0h132v3U/%E1%84%89%E1%85%A9%E1%86%A8%E1%84%80%E1%85%B5%E1%87%81%E1%84%8B%E1%85%B3%E1%86%AB_%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B8%E1%84%90%E1%85%B3_cover.jpg" alt="속깊은 자바스크립트 표지"></p>\n<p>감상평을 적기에 앞서 몇 가지 가벼운 질문이 있다. 혹시 아래의 문제를 보았을 때 모르는 내용이 2가지 이상 있거나, 알더라도 바로 명확한 답변이 떠오르지 않는지 생각해보라. (ES5 기준)</p>\n<ul>\n<li>아래의 코드는 무엇이 잘못되었는가? 문제가 있다면 어떻게 해결할 수 있는가?</li>\n</ul>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\tdocument<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"div"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"You clicked div #"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<ul>\n<li>자바스크립트의  <code class="language-text">this</code> 가 어떤 상황에 따라 다르게 묶이는지 이해하고 있는가?</li>\n<li>자바스크립트의 변수 범위(스코프)는 어떻게 정해지는가?</li>\n<li>자바스크립트의 이벤트 루프는 무엇이며 어떤 방식으로 동작하는가?</li>\n<li>DOM을 다루는 자바스크립트 코드를 작성시 성능을 최적화하기 위한 고려 방안을 3가지 이상 알고 있는가?</li>\n<li>사용자가 브라우저로 웹 사이트 접속 시 초기 로딩의 불편함을 최소화하기 위한 자바스크립트 코드를 구상할 수 있는가?</li>\n</ul>\n<p>답을 떠올리기 힘들었다면 자신이 자바스크립트의 제대로 알고 사용하고 있는지 다시 한번 깊이 고민해 볼 필요가 있다. 다행히도 이 책의 많은 부분은 그 \'기본\' 을 충실하게 짚어주는 편이다.</p>\n<p>그래도 코뿔소 책(자바스크립트 완벽 가이드 - 데이비드 플래너건 저)처럼 방대한 내용으로 독자를 허우적거리게 만들거나, 나비 책(자바스크립트 핵심 가이드 - 더글라스 크락포드 저)처럼 겉으로 보기에 너무나 축약된 내용이라 여러번 곱씹어야 내용을 알 법한 어려운 수준의 책도 아니다.\n그렇기에 나는 방금 소개한 두 책보다 자바스크립트 기본을 익힌 다음에 이 책을 먼저 탐독하길 권하고 싶다.</p>\n<p>2017년을 보내고 2018년을 맞이하는 현재 시점에서 이 책을 읽는 독자들이 가져야 할 마음가짐은 <strong>온고지신</strong> 이다.\n아마 이 책에 적힌 유용한 예제 코드를 직접 개발을 하며 사용할 일은 거의 없으리라 생각한다.\n하지만 Babel, Typescript같은 트랜스파일러를 통해(Typescript는 약간 성격이 다르지만 결과물이 일반 자바스크립트임을 감안하여 이 글에서는 트랜스파일러라 명명한다) 변환된 코드들은 이 책의 예제 코드와 유사한 형태를 가지고 있다.\n그리고 <strong>왜</strong> 이런 형태를 가지고 있는지, 문제에 부딪힐 때 어떤 방식으로 개량할 수 있는지 생각할 수 있는 지식을 얻을 수 있다.</p>\n<p>대충 프레임워크 가져다 쓰고, 대충 ES6+ 로 코드 작성하고, 대충 Webpack + Babel 등의 문서를 참고하여 코드 변환되도록 빌드하고 배포하면 (프론트엔드) 웹 애플리케이션이 뚝딱 나온다고 생각하기 쉬운 현재 프론트엔드 생태계 속에서\n자신이 작성하는 자바스크립트 코드의 무게를 다시 생각하는 계기가 될 것이다. <a href="https://medium.com/dev-channel/the-cost-of-javascript-84009f51e99e">우리는 언제나 이 무게를 신경써야 한다.</a></p>\n<p>조금 특이하지만 나는 책의 첫 번째 챕터인 <strong>웹과 자바스크립트</strong>에서 그 옛날 자바스크립트가 어떻게 여기까지 오게 되었는지 간단히 짚어보고,\n후반부 챕터인 <strong>자바스크립트 성능과 사용자 경험 개선</strong>에서 캐싱, 미니피케이션, gzip 등의 HTTP 요청 관련 최적화로 성능을 개선하는 부분까지 웹 개발의 큰 그림을 짚어보는 구성이 마음에 들었다.\n초보 프론트엔드 개발자들이 소홀히하기 쉽고, 아무도 바로 알려주지 않는 ‘최적화’ 에 대해 고민할 수 있는 요소를 알려주기 때문에 기초 수준이나 기초를 벗어나는 수준 즈음에 이 책을 읽어보는 것을 권한다.</p>\n<p>나머지 주요 내용(클로저, 프로토타입과 프로토타입 상속, 자바스크립트만의 독특한 패턴 - 특히 이벤트 델리게이션 등)은 사실 요즘에는 키워드만 알고 검색하면 얼마든지 잘 설명된 자료를 찾아볼 수 있을 것이다.\n다만 내가 보았을 때 그 자료들은 다 영어로 쓰여있었다. 영문으로 된 글을 읽는데 익숙지 않다면 이 책의 내용이 더 유용하리라 기대한다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-12-21-javascript-in-depth-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-21",path:"/posts/javascript-in-depth-review",title:"'속깊은 Javascript' 감상평 및 추천사",tags:["Reading","Javascript"],category:"Review"}},{excerpt:"앞서 제시된 질문들 질문을 번역한 이후 따로 공부를 위해 가볍게 온라인 스터디를 진행하여 서로 조사한 부분을 이야기하고, 참고할만한 링크가 있다면 첨부하는 형식의 스터디를 진행하였습니다. 작성된 내용 중에 오답이 있을 수도 있으니 참고용으로 봐 주시기 바라며, 보충 설명 혹은 수정을 요청하시려면 하단 프로필의 이메일로 요청 부탁드립니다. (중복된 문제에 대한 답안은 작성하지 않았습니다.) Baby phase 자바스크립트의…",html:'<p><a href="/posts/javascript-roadmap-questions">앞서 제시된 질문들</a></p>\n<p>질문을 번역한 이후 따로 공부를 위해 가볍게 온라인 스터디를 진행하여 서로 조사한 부분을 이야기하고, 참고할만한 링크가 있다면 첨부하는 형식의 스터디를 진행하였습니다.</p>\n<p>작성된 내용 중에 오답이 있을 수도 있으니 참고용으로 봐 주시기 바라며, 보충 설명 혹은 수정을 요청하시려면 하단 프로필의 이메일로 요청 부탁드립니다. (중복된 문제에 대한 답안은 작성하지 않았습니다.)</p>\n<h2 id="baby-phase"><a href="#baby-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Baby phase</h2>\n<ol>\n<li>\n<p>자바스크립트의 6가지 기본(원시) 타입은? (ES6에서 한개 더 늘어나서 총 여섯개입니다)</p>\n<ul>\n<li><code class="language-text">Null</code>, <code class="language-text">Number</code>, <code class="language-text">Boolean</code>, <code class="language-text">String</code>, <code class="language-text">Undefined</code>, <code class="language-text">Symbol</code></li>\n</ul>\n</li>\n<li>\n<p>자바스크립트에서 변수를 선언하고 할당하는 방법은?</p>\n<ul>\n<li><code class="language-text">const</code>, <code class="language-text">let</code>, <code class="language-text">var</code> 를 쓰고 한칸 뒤에 변수명 선언, 할당은 <code class="language-text">=</code> 를 선언한 변수 뒤에 붙이고 필요한 값을 넣는다.</li>\n</ul>\n</li>\n<li>\n<p><code class="language-text">const</code>, <code class="language-text">let</code>, <code class="language-text">var</code> 로 변수를 선언할 때의 차이점은?</p>\n<ul>\n<li><code class="language-text">const</code> - 재할당 불가능한 변수 선언. 블록 단위 스코프</li>\n<li><code class="language-text">let</code> - 재할당 가능한 변수를 선언. 블록 단위 스코프</li>\n<li><code class="language-text">var</code> - 자바스크립트 초기부터 변수를 선언하는 방법. 재할당 가능하며 함수 단위 스코프를 가짐</li>\n</ul>\n</li>\n<li>\n<p>아래의 연산자는 어떤 역할을 하는가?</p>\n<ol>\n<li><code class="language-text">+</code></li>\n<li><code class="language-text">-</code></li>\n<li><code class="language-text">*</code></li>\n<li><code class="language-text">/</code></li>\n<li><code class="language-text">%</code></li>\n</ol>\n</li>\n<li>\n<p>아래의 비교연산자의 역할은?</p>\n<ol>\n<li><code class="language-text">===</code></li>\n<li><code class="language-text">!==</code></li>\n<li><code class="language-text">&gt;</code></li>\n<li><code class="language-text">&gt;=</code></li>\n<li><code class="language-text">&lt;</code></li>\n<li><code class="language-text">&lt;=</code></li>\n</ol>\n</li>\n<li>\n<p>다음의 조건문은 어떻게 사용하는가?</p>\n<ol>\n<li><code class="language-text">if</code></li>\n<li><code class="language-text">if else</code></li>\n<li><code class="language-text">else</code></li>\n</ol>\n</li>\n<li>\n<p><code class="language-text">for</code> 루프를 사용하는 방법은?</p>\n<ul>\n<li><code class="language-text">for (let i; i &lt; array.length; i++) {}</code></li>\n<li><code class="language-text">for in</code>, <code class="language-text">for of(ES6)</code>, <code class="language-text">array.forEach</code></li>\n</ul>\n</li>\n<li>\n<p><strong>배열(Array)</strong>은 무엇인가?: 순서가 있는 데이터의 집합, 0부터 시작하는 인덱스</p>\n<ol>\n<li>배열에 값을 넣는 방법은? - <code class="language-text">array.push</code></li>\n<li>배열의 값을 불러오는 방법은? - <code class="language-text">[]</code>, <code class="language-text">array.indexOf</code></li>\n<li>배열의 값을 제거하는 방법은? - <code class="language-text">array.pop</code>, <code class="language-text">array.shift</code>, <code class="language-text">array.splice</code></li>\n<li>배열의 모든 값을 순회하는 방법은? - <code class="language-text">array.forEach</code></li>\n</ol>\n</li>\n<li>\n<p><strong>객체(Object)</strong>란 무엇인가?: 프로퍼티(속성, key)를 가지고 <strong>순서가 없는</strong> 데이터의 집합</p>\n<ol>\n<li>객체에 값을 넣는 방법은?: <code class="language-text">obj[&#39;prop&#39;] = value</code>, <code class="language-text">obj.prop = value</code></li>\n<li>객체의 값을 불러오는 방법은?: <code class="language-text">obj[&#39;prop&#39;]</code>, <code class="language-text">obj.prop</code></li>\n<li>객체의 속성을 제거하는 방법은?: <code class="language-text">delete</code></li>\n<li>객체의 모든 값을 순회하는 방법은?: <code class="language-text">for in</code>, <code class="language-text">Object.keys(obj).forEach(prop =&gt; obj[prop])</code></li>\n<li>객체의 메서드(method)란 무엇인가?: 객체의 프로퍼티가 함수인 것 -> 객체의 기능(행동)을 정의한 것</li>\n<li>\n<p>메서드를 정의하는 방법은?</p>\n<ul>\n<li>객체의 프로퍼티를 함수로 정의</li>\n<li><code class="language-text">const obj = { method() {} }</code></li>\n</ul>\n</li>\n<li>메서드를 호출/실행하는 방법은?: 객체의 값을 불러오면서 <code class="language-text">()</code> 괄호를 붙여준다. 인자가 필요하다면 괄호 안에 인자를 넣는다.</li>\n</ol>\n</li>\n<li>\n<p><strong>함수(Function)</strong>란 무엇인가?: 하나의 단위로 실행되는 코드의 집합</p>\n<ol>\n<li>\n<p>함수를 정의하는 방법은?</p>\n<ul>\n<li>일반 함수 정의: <code class="language-text">function func() {}</code></li>\n<li>변수에 함수 할당: <code class="language-text">const func = () =&gt; {}</code></li>\n</ul>\n</li>\n<li>함수를 호출/실행하는 방법은?: 정의한 함수명 끝에 괄호<code class="language-text">()</code>를 붙인다.</li>\n<li>\n<p>함수에 인수(arguments)를 전달하는 방법은?: 함수를 호출할 때 괄호 안에 인자를 쉼표로 구분지어 전달한다.</p>\n<ul>\n<li>함수를 호출할 때 - 인수(arguments)</li>\n<li>함수 안으로 넘겨진 것 - 매개변수(parameters)</li>\n</ul>\n</li>\n<li>함수 안에서 <code class="language-text">return</code> 키워드는 어떤 역할을 하는가?: 함수를 즉시 종료하고 값을 반환한다. 이 값은 함수 호출의 값이 된다.</li>\n</ol>\n</li>\n</ol>\n<h2 id="child-phase"><a href="#child-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Child phase</h2>\n<ol>\n<li>\n<p>자바스크립트의 스코프(Scope)란?: 현재 접근할 수 있는 변수들의 범위</p>\n<ol>\n<li>\n<p>왜 전역 변수를 최소화해야 하는가?</p>\n<ul>\n<li>소스와 데이터가 외부에 쉽게 노출된다</li>\n<li>비동기 로직의 구현을 용이하게 하고 잘 구분되게 한다. 비동기 로직을 실행하기 위한 변수가 글로벌에 있을 시 예상치 못한 동작이 발생할 우려가 있다.</li>\n<li>다양한 사양의 브라우징 환경에서 미리 정의된 글로벌 변수가 많을 수록 퍼포먼스에 영향을 미치게 된다.</li>\n</ul>\n</li>\n<li>\n<p>클로저(Closure)란 무엇인가?: 특정 함수가 참조하는 변수들은 선언된 환경을 계속 유지하는데, 이 함수와 스코프를 묶어서 클로저라고 한다.</p>\n<ul>\n<li><a href="http://unikys.tistory.com/309">Unikys :: 속깊은 자바스크립트 강좌 Closure 쉽게 이해하기/실용 예제 소스</a></li>\n</ul>\n</li>\n<li>\n<p>클로저를 왜 사용하는가?</p>\n<ul>\n<li>(옛날) 자바스크립트의 스코프 문제를 해결하기 위한 방법 중 하나</li>\n<li>private 변수를 활용해야 할 때 사용</li>\n<li>별도의 스코프를 가지지만 로직은 공유하는 객체를 생성</li>\n<li>반복적으로 같은 작업을 할 때, 같은 초기화 작업이 지속적으로 필요할 때, 콜백 함수에 동적인 데이터를 넘겨주고 싶을 때 활용</li>\n</ul>\n</li>\n</ol>\n</li>\n<li>\n<p>콜백이란 무엇인가?: 함수에 인자로 전달하는 함수로 <strong>함수를 실행한 뒤에</strong> 실행하기 위해 사용</p>\n<ol>\n<li>\n<p>콜백을 어떻게 사용하는가?</p>\n<ul>\n<li>인자로 콜백(혹은 함수)를 받는 함수에 콜백 함수를 전달</li>\n</ul>\n</li>\n<li>\n<p>콜백을 어떻게 작성하는가?</p>\n<ul>\n<li>그냥 함수를 작성한다. 인자가 필요하면 인자를 넣고.</li>\n</ul>\n</li>\n<li>\n<p>콜백을 받아들이는 함수를 작성하는 방법은?</p>\n<ul>\n<li>함수를 작성하되, 인자로 함수를 받도록 하고 특정 시점에서 인자로 받은 함수를 실행한다.</li>\n<li><code class="language-text">fn</code> 을 인자로 받았으면 <code class="language-text">fn()</code></li>\n</ul>\n</li>\n<li><code class="language-text">setTimeout</code> 은 콜백을 받는 함수인가?: Yes</li>\n</ol>\n</li>\n<li>\n<p>비동기 자바스크립트</p>\n<ol>\n<li>\n<p>자바스크립트에서 <strong>동기</strong>와 <strong>비동기</strong>의 의미는 무엇인가?</p>\n<ul>\n<li>동기: 앞서 실행되고있는 작업이 끝날때까지 대기하고 다음 작업을 실행한다.</li>\n<li>비동기: 특정 작업이 실행되는데 시간이 더 걸린다면 나머지 작업을 먼저 수행하고, 그 특정 작업이 끝난 시점에 후속 처리를 한다.</li>\n</ul>\n</li>\n<li>\n<p>자바스크립트로 <strong>비동기</strong> 코드를 작성하는 방법은?</p>\n<ul>\n<li><code class="language-text">setTimeout</code></li>\n<li>Promise</li>\n<li>async - await</li>\n<li>Generators</li>\n</ul>\n</li>\n<li>이벤트 루프가 무엇인가?: 비동기 자바스크립트 이벤트가 처리되는 과정</li>\n<li>이벤트 루프가 어떻게 동작하는가?: (브라우저의 경우) 콜스택에서 비동기 함수 호출 -> Web APIs에서 실행 완료를 대기 -> 콜백은 이벤트 큐에서 실행을 대기 -> 콜스택이 비면 실행 대기중인 이벤트 큐 가장 앞에 있는 콜백이 실행</li>\n</ol>\n</li>\n<li>\n<p>DOM 메서드에 관한 질문들</p>\n<ol>\n<li>엘리먼트(Element)란?: 페이지에서 HTML 태그로 나타나는 DOM 요소들</li>\n<li>노드(Node)란?: 위의 엘리먼트와 중복으로 사용되는 용어지만 정확히는 엘리먼트보다 넓은 범위를 나타낸다. DOM API를 실행하기 위한 인터페이스의 모음이기도 하다.</li>\n<li>\n<p>엘리먼트를 선택하는 방법은?</p>\n<ul>\n<li><code class="language-text">document.querySelector</code>, <code class="language-text">document.getElementBy</code></li>\n</ul>\n</li>\n<li>여러 엘리먼트를 선택하는 방법은?: <code class="language-text">document.querySelectorAll</code></li>\n<li><strong>모든 브라우저</strong>에서 엘리먼트를 순회하는 방법은?: <code class="language-text">document.createNodeIterator</code></li>\n<li>부모 엘리먼트를 선택하는 방법은?: <code class="language-text">Node.parentNode</code></li>\n<li>형제 엘리먼트를 선택하는 방법은?: <code class="language-text">Node.nextSibiling</code>, <code class="language-text">Node.previousSibiling</code></li>\n<li>엘리먼트에 클래스를 추가/제거하는 방법은?: <code class="language-text">element.classList.add</code></li>\n<li>엘리먼트에 특정 클래스가 있는지 확인하는 방법은?: <code class="language-text">element.classList.contains</code></li>\n<li>어떤 상황에서 엘리먼트에 클래스를 추가하는가?: 특정 이벤트의 결과로 다른 스타일을 적용하고 싶을 때</li>\n<li>엘리먼트에 속성을 추가/제거하는 방법은?: <code class="language-text">element.setAttribute</code>, <code class="language-text">element.removeAttribute</code></li>\n<li>엘리먼트에 특정 속성이 있는지 확인하는 방법은?: <code class="language-text">element.hasAttribute</code></li>\n<li>어떤 상황에서 엘리먼트에 속성을 추가/제거하는가?: 특정 엘리먼트에 <code class="language-text">active</code>, 혹은 <code class="language-text">disabled</code> 같은 속성을 부여해서 엘리먼트 사용 자체를 제어할 수 있다.</li>\n<li>HTML 엘리먼트를 자바스크립트로 생성하는 방법은?: <code class="language-text">document.createElement</code></li>\n<li>특정 엘리먼트 바로 앞에 새로운 엘리먼트를 생성하는 방법은? <code class="language-text">Node.appendChild</code></li>\n<li>엘리먼트의 스타일을 변경하는 방법은?: <code class="language-text">HTMLElement.style</code></li>\n<li>엘리먼트의 스타일을 자바스크립트로 바꾸어도 되는가? 왜 되는가/되지 않는가?: 그닥 권장하지 않는다. 자바스크립트로 스타일은 변경하는 경우 무조건 인라인 스타일로 지정되게 되는데 이러면 최상위 우선권을 갖기 때문에 기존에 지정된 CSS가 모두 제 기능을 못하는 경우가 생긴다.</li>\n<li>엘리먼트의 내용을 가져오는 방법은?: <code class="language-text">Node.textContent</code>, <code class="language-text">element.innerHTML</code></li>\n</ol>\n</li>\n<li>\n<p>이벤트</p>\n<ol>\n<li>이벤트 리스너(Event listener)를 추가하는 방법은?: <code class="language-text">element.addEventListener</code></li>\n<li>왜 이벤트 리스너를 추가하는가?: 정적 페이지만 보여주는 것이 아니라 DOM을 동적으로 제어 및 표현하기 위해</li>\n<li>이벤트 리스너를 제거하는 방법은?: <code class="language-text">EventTarget(element).removeEventListener</code></li>\n<li>언제 이벤트 리스너를 제거하는가? 왜 제거하는가?: 특정 DOM 엘리먼트의 사용 주기가 이벤트 리스너와 다르다면 메모리 누수를 방지하기 위해 이벤트 리스너를 제거한다.</li>\n<li>자주 사용되는 마우스 이벤트의 종류는?: <code class="language-text">click</code>, <code class="language-text">mouseup</code>, <code class="language-text">mousedown</code></li>\n<li>자주 사용되는 키보드 이벤트의 종류는?: <code class="language-text">keydown</code>, <code class="language-text">keyup</code></li>\n<li>자주 사용되는 폼(Form) 이벤트의 종류는?: <code class="language-text">submit</code>, <code class="language-text">reset</code></li>\n<li>이벤트 대상의 값을 가져오는 방법은?: <code class="language-text">e.target.value</code></li>\n</ol>\n</li>\n</ol>\n<h2 id="teenage-phase"><a href="#teenage-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Teenage phase</h2>\n<ol>\n<li>\n<p>OOP</p>\n<ol>\n<li>\n<p><code class="language-text">this</code> 의 컨텍스트는 어떻게 바뀌는가? 얼마나 많은 컨텍스트가 있는가?</p>\n<ul>\n<li><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/this">this - JavaScript | MDN</a></li>\n<li>함수가 호출되는 방법에 따라 결정된다.</li>\n<li>전역 컨텍스트: <code class="language-text">window</code></li>\n<li>객체의 메서드일 경우: 바로 가까이 있는 객체에 바인딩됨. 즉 객체가 계층화되어있을 경우에 유의해야함.</li>\n<li>프로토타입 체인에서: 해당 객체의 인스턴스</li>\n<li><code class="language-text">call</code>, <code class="language-text">apply</code>, <code class="language-text">bind</code> 로 임의의 컨텍스트 지정 가능</li>\n<li>이벤트 핸들러: 이벤트가 발생한 타겟 자체</li>\n<li>inline 이벤트 핸들러: 해당 DOM 엘리먼트</li>\n</ul>\n</li>\n<li>\n<p>자바스크립트의 <strong>프로토타입</strong>이란 무엇인가?: 특정 객체의 원형을 의미</p>\n<ul>\n<li><a href="http://meetup.toast.com/posts/104">쉽게 이해하는 자바스크립트 프로토타입 체인 : TOAST Meetup</a></li>\n<li><a href="http://insanehong.kr/post/javascript-prototype/">Javascript 기초 - Object prototype 이해하기 |  Insanehong’s Incorrect Note</a></li>\n</ul>\n</li>\n<li>\n<p>자바스크립트에서 객체를 생성하는 방법은?</p>\n<ul>\n<li><code class="language-text">new</code> 생성자</li>\n<li><code class="language-text">Object.create</code></li>\n<li><code class="language-text">{}</code></li>\n</ul>\n</li>\n<li>\n<p>모듈 패턴은 무엇이며 어떻게 사용하는가?</p>\n<ul>\n<li>모듈 단위로 소스를 나누어 의존성 파악을 용이하게 함.</li>\n<li><a href="http://yubylab.tistory.com/entry/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-for-javascript-Module-Pattern">디자인 패턴 for javascript Module Pattern :: Yuby’s Lab.</a></li>\n</ul>\n</li>\n<li>\n<p>팩토리 패턴은 무엇이며 어떻게 사용하는가?:  정해진 인자를 받아서 원하는 형태의 객체를 반환하는 패턴. 비슷한 객체를 반복해서 생성할 수 있도록 해 주며, 사용자가 구체적인 타입을 모르고도 객체를 생성할 수 있도록 해 준다.</p>\n<ul>\n<li><a href="https://joshua1988.github.io/web_dev/javascript-pattern-design/">Javascript Pattern 요약 - 디자인 패턴 • Captain Pangyo</a></li>\n</ul>\n</li>\n</ol>\n</li>\n<li>\n<p>함수형 프로그래밍</p>\n<ol>\n<li>불변성(Immutability)란 무엇인가?: 할당된 변수 혹은 값이 외부로 인해 변하지 않는 것 혹은 변하지 않도록 하는 것</li>\n<li>배열의 어떤 메서드가 불변성을 가지고 있는가?: <code class="language-text">slice</code>, <code class="language-text">map</code>, <code class="language-text">concat</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> ...</li>\n<li>자바스크립트의 객체를 직접 수정하지 않고 속성을 변경하는 방법은?: <code class="language-text">Object.assign</code></li>\n<li>\n<p>순수 함수(Pure function)란?</p>\n<ul>\n<li>같은 값을 입력하면 같은 값이 출력되는 함수</li>\n<li>부작용(Side effects)를 일으키지 않는 함수</li>\n<li>외부 상태 변화에 기대지 않는 함수</li>\n</ul>\n</li>\n<li>한 개의 함수는 얼마나 많은 행동을 담고 있는게 좋은가?: <strong>Only One</strong></li>\n<li>함수의 부작용(Side effects)이란?: 의도하던 함수의 기능 외에 부가적인 작업이 발생하는 것. 주로 외부 상태를 변경하는 일을 이야기한다.</li>\n<li>순수 함수를 작성할 때 부작용을 다루는 방법은?: 불변성을 가진 함수를 사용하여 새로운 상태를 반환한다. / 모든 함수가 순수 함수가 되는것은 현실적으로 불가능하기 때문에 부작용을 다루는 함수는 구분해서 사용한다.</li>\n</ol>\n</li>\n<li>\n<p>AJAX</p>\n<ol>\n<li>\n<p>자바스크립트 프라미스(Promise)란?: 콜백 문제를 해결하기 위한 객체로, 프로미스 기반 비동기적 함수를 호출하면 <strong>성공</strong>혹은 <strong>실패</strong>가 발생하는 상황에 따라 이어서 처리할 수 있게 해준다.</p>\n<ul>\n<li><a href="https://engineering.huiseoul.com/async-vs-promise-11ea761a98c4">Async vs Promise</a></li>\n<li><a href="http://programmingsummaries.tistory.com/325">JavaScript 바보들을 위한 Promise 강의 - 도대체 Promise는 어떻게 쓰는거야? | 감성 프로그래밍</a></li>\n</ul>\n</li>\n<li>\n<p>프라미스를 연결하는 방법은?: 함수에서 Promise 인스턴스를 리턴한다. 그리고...</p>\n<ul>\n<li><code class="language-text">.then()</code></li>\n<li><code class="language-text">.catch()</code></li>\n</ul>\n</li>\n<li>\n<p>프라미스를 사용할 때 에러를 처리하는 방법은?: 프로미스 객체를 생성하고 그 안에서 <code class="language-text">reject</code> 를 리턴하도록 한다.</p>\n<ul>\n<li><code class="language-text">return reject(new Error(&#39;Error message&#39;))</code> => <code class="language-text">.catch(err =&gt; {})</code></li>\n</ul>\n</li>\n<li>Fetch API를 사용하는 방법은?: <code class="language-text">fetch(&#39;url&#39;).then(result =&gt; result.json()).then(json =&gt; ...)</code></li>\n<li>CRUD란 무엇인가?: Create, Read, Update, Delete</li>\n<li>Github에서 자신의 저장소 목록을 가져오는 API를 어떻게 호출하는가?: <code class="language-text">GET /user/repos</code></li>\n</ol>\n</li>\n<li>\n<p>Best practices</p>\n<ol>\n<li>전역 변수를 피해야 하는 이유는?</li>\n<li>비교 연산자에서 <code class="language-text">==</code> 대신 <code class="language-text">===</code> 를 사용해야 하는 이유는?:  <code class="language-text">==</code> 는 자바스크립트 임의의 형 변환이 일어남</li>\n<li>간결한 코드를 작성하기 위해 삼항연산자를 어떻게 사용하는가?: <code class="language-text">bool ? true : false</code></li>\n<li>간결한 코드 작성을 돕는 ES6 기능은 무엇이 있는가?: Arrow function, Class, Object destructuring, Spread operator …</li>\n<li>\n<p>이벤트 버블링/캡처링이란?</p>\n<ul>\n<li>버블링: 특정 DOM에서 이벤트가 발생하면 가장 하위 DOM부터 상위의 부모 DOM으로 한단계씩 전파되는 것.</li>\n<li>캡처링: 최상위 부모 DOM부터 가장 하위의 DOM까지 부모에서부터 전파되는 것</li>\n</ul>\n</li>\n<li>\n<p>이벤트 전달(delegate)이란?: 모든 DOM에 이벤트 리스너를 할당하기보다 하나의 부모 DOM에 이벤트 처리를 위임하도록 만드는 것</p>\n<ul>\n<li><a href="https://eclatant.github.io/2017-10-08/EventDelegation/">Javascript EventDelegation</a></li>\n</ul>\n</li>\n<li>이벤트 리스너를 제거하는 방법은? 언제 제거하는가?</li>\n</ol>\n</li>\n</ol>',id:"/home/circleci/repo/src/pages/posts/2017-10-09-jsr-questions-answers/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-10-09",path:"/posts/jsr-questions-answers",title:"Javascript Roadmap Questions - 답안",tags:["Javascript"],category:"Javascript"}},{excerpt:"오늘은 저도 공부할 겸 학습거리를 하나 제공해드리려 합니다. 자바스크립트 초심자를 대상으로 학습 로드맵을 제공하는 뉴스레터입니다. 총 7개의 챕터로 좋은 내용들을 전달해주었는데, 자바스크립트 학습의 단계를 Baby -> Child -> Teenage -> Adult…",html:'<p><a href="https://jsroadmap.com">오늘은 저도 공부할 겸 학습거리를 하나 제공해드리려 합니다.</a></p>\n<p>자바스크립트 초심자를 대상으로 학습 로드맵을 제공하는 뉴스레터입니다. 총 7개의 챕터로 좋은 내용들을 전달해주었는데, 자바스크립트 학습의 단계를 Baby -> Child -> Teenage -> Adult 로 구분하여  각 단계별로 익혀야 할 개념들을 소개하고, 챕터 말미에 각 단계별로 진도 확인을 위한 질문들을 제시했습니다.</p>\n<p>이 질문의 내용이 아주 좋다고 생각하여 자바스크립트의 기초를 복습할 겸 질문의 답을 정리해보는 학습을 하고자 합니다. 대부분 질문의 답은 MDN에서 얻을 수 있지만, 답을 찾고 관련된 글을 읽으면서 다시 한번 자바스크립트의 기초를 다지는 계기가 되리라 생각합니다.</p>\n<h2 id="baby-phase"><a href="#baby-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Baby phase</h2>\n<ol>\n<li>자바스크립트의 6가지 기본(원시) 타입은? (ES6에서 한개 더 늘어나서 총 여섯개입니다)</li>\n<li>자바스크립트에서 변수를 선언하고 할당하는 방법은?</li>\n<li><code class="language-text">const</code>, <code class="language-text">let</code>, <code class="language-text">var</code> 로 변수를 선언할 때의 차이점은?</li>\n<li>\n<p>아래의 연산자는 어떤 역할을 하는가?</p>\n<ol>\n<li><code class="language-text">+</code></li>\n<li><code class="language-text">-</code></li>\n<li><code class="language-text">*</code></li>\n<li><code class="language-text">/</code></li>\n<li><code class="language-text">%</code></li>\n</ol>\n</li>\n<li>\n<p>아래의 비교연산자의 역할은?</p>\n<ol>\n<li><code class="language-text">===</code></li>\n<li><code class="language-text">!==</code></li>\n<li><code class="language-text">&gt;</code></li>\n<li><code class="language-text">&gt;=</code></li>\n<li><code class="language-text">&lt;</code></li>\n<li><code class="language-text">&lt;=</code></li>\n</ol>\n</li>\n<li>\n<p>다음의 조건문은 어떻게 사용하는가?</p>\n<ol>\n<li><code class="language-text">if</code></li>\n<li><code class="language-text">if else</code></li>\n<li><code class="language-text">else</code></li>\n</ol>\n</li>\n<li><code class="language-text">for</code> 루프를 사용하는 방법은?</li>\n<li>\n<p><strong>배열(Array)</strong>은 무엇인가?</p>\n<ol>\n<li>배열에 값을 넣는 방법은?</li>\n<li>배열의 값을 불러오는 방법은?</li>\n<li>배열의 값을 제거하는 방법은?</li>\n<li>배열의 모든 값을 순회하는 방법은?</li>\n</ol>\n</li>\n<li>\n<p><strong>객체(Object)</strong>란 무엇인가?</p>\n<ol>\n<li>객체에 값을 넣는 방법은?</li>\n<li>객체의 값을 불러오는 방법은?</li>\n<li>객체의 속성을 제거하는 방법은?</li>\n<li>객체의 모든 값을 순회하는 방법은?</li>\n<li>객체의 메서드(method)란 무엇인가?</li>\n<li>메서드를 정의하는 방법은?</li>\n<li>메서드를 호출/실행하는 방법은?</li>\n</ol>\n</li>\n<li>\n<p><strong>함수(Function)</strong>란 무엇인가?</p>\n<ol>\n<li>함수를 정의하는 방법은?</li>\n<li>함수를 호출/실행하는 방법은?</li>\n<li>함수에 인자(arguments)를 전달하는 방법은?</li>\n<li>함수 안에서 <code class="language-text">return</code> 키워드는 어떤 역할을 하는가?</li>\n</ol>\n</li>\n</ol>\n<h2 id="child-phase"><a href="#child-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Child phase</h2>\n<ol>\n<li>\n<p>자바스크립트의 스코프(Scope)란?</p>\n<ol>\n<li>왜 전역 변수를 최소화해야 하는가?</li>\n<li>클로저(Closure)란 무엇인가?</li>\n<li>클로저를 왜 사용하는가?</li>\n</ol>\n</li>\n<li>\n<p>콜백이란 무엇인가?</p>\n<ol>\n<li>콜백을 어떻게 사용하는가?</li>\n<li>콜백을 어떻게 작성하는가?</li>\n<li>콜백을 받아들이는 함수를 작성하는 방법은?</li>\n<li><code class="language-text">setTimeout</code> 은 콜백을 받는 함수인가?</li>\n</ol>\n</li>\n<li>\n<p>비동기 자바스크립트</p>\n<ol>\n<li>자바스크립트에서 <strong>동기</strong>와 <strong>비동기</strong>의 의미는 무엇인가?</li>\n<li>자바스크립트로 <strong>비동기</strong> 코드를 작성하는 방법은?</li>\n<li>이벤트 루프가 무엇인가?</li>\n<li>이벤트 루프가 어떻게 동작하는가?</li>\n</ol>\n</li>\n<li>\n<p>DOM 메서드에 관한 질문들</p>\n<ol>\n<li>엘리먼트(Element)란?</li>\n<li>노드(Node)란?</li>\n<li>엘리먼트를 선택하는 방법은?</li>\n<li>여러 엘리먼트를 선택하는 방법은?</li>\n<li><strong>모든 브라우저</strong>에서 엘리먼트를 순회하는 방법은?</li>\n<li>부모 엘리먼트를 선택하는 방법은?</li>\n<li>형제 엘리먼트를 선택하는 방법은?</li>\n<li>엘리먼트에 클래스를 추가/제거하는 방법은?</li>\n<li>엘리먼트에 특정 클래스가 있는지 확인하는 방법은?</li>\n<li>어떤 상황에서 엘리먼트에 클래스를 추가하는가?</li>\n<li>엘리먼트에 속성을 추가/제거하는 방법은?</li>\n<li>엘리먼트에 특정 속성이 있는지 확인하는 방법은?</li>\n<li>어떤 상황에서 엘리먼트에 속성을 추가/제거하는가?</li>\n<li>HTML 엘리먼트를 자바스크립트로 생성하는 방법은?</li>\n<li>특정 엘리먼트 바로 앞에 새로운 엘리먼트를 생성하는 방법은?</li>\n<li>엘리먼트의 스타일을 변경하는 방법은?</li>\n<li>엘리먼트의 스타일을 자바스크립트로 바꾸어도 되는가? 왜 되는가/되지 않는가?</li>\n<li>엘리먼트의 내용을 가져오는 방법은?</li>\n</ol>\n</li>\n<li>\n<p>이벤트</p>\n<ol>\n<li>이벤트 리스너(Event listener)를 추가하는 방법은?</li>\n<li>왜 이벤트 리스너를 추가하는가?</li>\n<li>이벤트 리스너를 제거하는 방법은?</li>\n<li>언제 이벤트 리스너를 제거하는가? 왜 제거하는가?</li>\n<li>자주 사용되는 마우스 이벤트의 종류는?</li>\n<li>자주 사용되는 키보드 이벤트의 종류는?</li>\n<li>자주 사용되는 폼(Form) 이벤트의 종류는?</li>\n<li>이벤트 대상의 값을 가져오는 방법은?</li>\n</ol>\n</li>\n</ol>\n<h2 id="teenage-phase"><a href="#teenage-phase" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Teenage phase</h2>\n<ol>\n<li>\n<p>OOP</p>\n<ol>\n<li><code class="language-text">this</code> 의 컨텍스트는 어떻게 바뀌는가? 얼마나 많은 컨텍스트가 있는가?</li>\n<li>자바스크립트의 <strong>프로토타입</strong>이란 무엇인가?</li>\n<li>자바스크립트에서 객체를 생성하는 방법은?</li>\n<li>모듈 패턴은 무엇이며 어떻게 사용하는가?</li>\n<li>팩토리 패턴은 무엇이며 어떻게 사용하는가?</li>\n</ol>\n</li>\n<li>\n<p>함수형 프로그래밍</p>\n<ol>\n<li>불변성(Immutability)란 무엇인가?</li>\n<li>배열의 어떤 메서드가 불변성을 가지고 있는가?</li>\n<li>자바스크립트의 객체를 직접 수정하지 않고 속성을 변경하는 방법은?</li>\n<li>순수 함수(Pure function)란?</li>\n<li>한 개의 함수는 얼마나 많은 행동을 담고 있는게 좋은가?</li>\n<li>함수의 부작용(Side effects)이란?</li>\n<li>순수 함수를 작성할 때 부작용을 다루는 방법은?</li>\n</ol>\n</li>\n<li>\n<p>AJAX</p>\n<ol>\n<li>자바스크립트 프라미스(Promise)란?</li>\n<li>프라미스를 연결하는 방법은?</li>\n<li>프라미스를 사용할 때 에러를 처리하는 방법은?</li>\n<li>Fetch API를 사용하는 방법은?</li>\n<li>CRUD란 무엇인가?</li>\n<li>Github에서 자신의 저장소 목록을 가져오는 API를 어떻게 호출하는가?</li>\n</ol>\n</li>\n<li>\n<p>Best practices</p>\n<ol>\n<li>전역 변수를 피해야 하는 이유는?</li>\n<li>비교 연산자에서 <code class="language-text">==</code> 대신 <code class="language-text">===</code> 를 사용해야 하는 이유는?</li>\n<li>간결한 코드를 작성하기 위해 삼항연산자를 어떻게 사용하는가?</li>\n<li>간결한 코드 작성을 돕는 ES6 기능은 무엇이 있는가?</li>\n<li>이벤트 버블링/캡처링이란?</li>\n<li>이벤트 전달(delegate)이란?</li>\n<li>이벤트 리스너를 제거하는 방법은? 언제 제거하는가?</li>\n</ol>\n</li>\n</ol>',id:"/home/circleci/repo/src/pages/posts/2017-10-06-javascript-roadmap-questions/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-10-06",path:"/posts/javascript-roadmap-questions",title:"Javascript Roadmap Questions",tags:["Javascript"],category:"Javascript"}},{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 로그인 페이지를 만드는데도 꽤 많은 노력이 들었지만, 기존에 사용하시던 방법으로 같은 페이지를 작성한다고 했을 때 얼마나 시간과 노력이 드는지 한번 생각해보시면 Vue.js…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p>로그인 페이지를 만드는데도 꽤 많은 노력이 들었지만, 기존에 사용하시던 방법으로 같은 페이지를 작성한다고 했을 때 얼마나 시간과 노력이 드는지 한번 생각해보시면 Vue.js로 구현하는 쪽이 약간 쉽지 않으셨는지요?</p>\n<p>가계부 페이지 구현은 로그인 페이지보다 내용이 약간 길어지겠지만 여전히 그렇게 어려운 난이도는 아닙니다. 비슷한 페이지를 예전에 React로 만들어 본 적이 있었는데 지금 생각해보면 코드를 따라 쳐 봤을 뿐이지 실질적인 내용은 거의 이해가 되지 않았네요. <strong>참고로 이 글의 내용이 이해가 잘 되지 않으시면 언제든지 질문 및 지적 부탁드립니다.</strong></p>\n<p>처음에 API서버를 만들 때 구상해 두었던 요소들보다 조금 축소되긴 했지만 다음의 기능을 구현해볼 예정입니다. 혹시나 아쉽다고 느끼시는 분들은 직접 구현에 도전해보시는 것도 좋은 배움의 기회가 될 수 있겠네요.</p>\n<ul>\n<li>Amount, Description 을 입력하여 기록</li>\n<li>최신 시간 순서대로 내용을 표로 출력</li>\n<li>\n<p>Edit, Delete 버튼을 눌러서 자료의 수정 및 삭제</p>\n<ul>\n<li>Edit 버튼을 누르면 해당 레코드의 내용이 자동으로 수정 Form으로 변화</li>\n</ul>\n</li>\n<li>모든 수익, 지출과 그 합계를 모아 상단에 대시보드 형식으로 표시</li>\n</ul>\n<p>기존 방식대로 레일즈나 하나미로 웹 애플리케이션을 만들었을 때는 모든 값을 서버에서 미리 계산해두고, 랜더링된 값을 클라이언트로 전달해주면 클라이언트는 받은 페이지를 불러오는 정도의 역할을 수행했었습니다. 하지만 자바스크립트를 적극적으로 활용하면 서버에서는 레코드만 던져주고, 브라우저에서 랜더링에 필요한 값을 계산하여 출력해 줄 수 있게 됩니다.</p>\n<h2 id="페이지-틀-만들기"><a href="#%ED%8E%98%EC%9D%B4%EC%A7%80-%ED%8B%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>페이지 틀 만들기</h2>\n<p>먼저 Vue 인스턴스와 연결할 HTML 페이지를 만들겠습니다. 파일 이름은 <code class="language-text">content.html</code> 이며, 이전에 만들었던 페이지와 같은 폴더에 위치해야 합니다. 불러와야 하는 자바스크립트 라이브러리가 하나 변경된 수준입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.0/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p><code class="language-text">moment</code> 라이브러리는 자바스크립트에서 시간을 다루는 데 필요한 최고의 라이브러리입니다. 현재 서버에 자료를 저장할 때 각 레코드의 <code class="language-text">created_at</code>, <code class="language-text">updated_at</code> 이 UTC 기준으로 저장되어 있는데, 서버에서 이 시간을 변경해서 보내주기보다 클라이언트에서 직접 시간대를 변경하여 알맞은 형식으로 표현하는 것 까지 처리할 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">\n<span class="token selector">html, body</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #E6E6E6<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">#app</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 1.5rem 0<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.title</span> <span class="token punctuation">{</span>\n  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.message:not(:last-child)</span> <span class="token punctuation">{</span>\n  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.message-body</span> <span class="token punctuation">{</span>\n  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.button</span> <span class="token punctuation">{</span>\n  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.income</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.outcome</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10 is-offset-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--title--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title is-2 is-spaced<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Your Records<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--input form--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field has-addons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>amount<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Amount<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control is-expanded<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Description<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Save<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--dashboard--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Income<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Outcome<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Total<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--contents--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Record Time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Amount<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Description<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Delete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Edit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>단순히 입력 태그가 맨 윗쪽에 있고, 대시보드, 테이블 순으로 자료가 표시되는 구조입니다. 이 안에 어떻게 내용을 채워나가게 될 지 기대해주세요.</p>\n<h2 id="인증-및-자료-가져오기"><a href="#%EC%9D%B8%EC%A6%9D-%EB%B0%8F-%EC%9E%90%EB%A3%8C-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>인증 및 자료 가져오기</h2>\n<p>지난번 로그인 페이지를 만들 때 로그인이 성공하면 JWT 토큰을 저장하고, 이 <code class="language-text">content.html</code> 페이지로 이동하도록 만들어 두었습니다. 그러면 당연하게도 <code class="language-text">content.html</code> 페이지를 이용할 수 있는 사람은 유효한 토큰을 가지고 있는 사람이어야 합니다.</p>\n<p>페이지가 처음 랜더링 될 때 무언가 행동을 지시하려면 Vue 인스턴스에 <code class="language-text">created</code> 를 지정하면 됩니다. Vue 인스턴스의 라이프사이클을 더 자세히 보시려면 <a href="https://kr.vuejs.org/v2/guide/instance.html#%EB%9D%BC%EC%9D%B4%ED%94%84%EC%82%AC%EC%9D%B4%ED%81%B4-%EB%8B%A4%EC%9D%B4%EC%96%B4%EA%B7%B8%EB%9E%A8">다음 가이드</a>를 참고해주세요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    records<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./login.html\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>인스턴스가 만들어질 때 토큰을 가져오고, 만약 해당 토큰이 없다고 하면 로그인 페이지로 되돌립니다. <code class="language-text">fetchData</code> 는 바로 아래에 구현할 메서드인데, 여기서도 만약 유효하지 않은 토큰이라고 판명되면 로그인 페이지로 되돌립니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'get\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token string">\'http://localhost:2300/api/records\'</span><span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>records <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>records<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>ersponse<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./login.html\'</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token comment">// handle error</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>토큰이 있다면 <code class="language-text">fetchData</code> 메서드로 토큰을 실어 서버에 요청을 보내게 됩니다. 이미 API 서버를 만들 때 유효하지 않은 토큰이라면 401에러를 리턴하도록 만들어두었기 때문에, 그냥 로그인 페이지로 돌려버리면 됩니다. 만에 하나 다른 에러가 출력된다면 여러분들이 편한 방법대로 에러를 다루면 될 것입니다.</p>\n<p>잘 작동하는지 테스트하실 때는 하나미 API 서버를 미리 켜두시는 것을 잊지 마시기 바랍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami server</code></pre>\n      </div>\n<p>당장은 저장된 자료가 없기 때문에 POSTMAN으로 일일이 요청을 보내어 자료를 생성할 수 밖에 없을겁니다. 그냥 하나미 콘솔에서 임의의 자료를 몇 개 생성해두록 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami console\n-------------------------\n[2] pry(main)&gt; 15.times do\n[2] pry(main)*   RecordRepository.new.create(\n[2] pry(main)*     user_id: 5, // Your favorite user id\n[2] pry(main)*     amount: [-1000, -5000, 5000, 1000, 10000].sample,\n[2] pry(main)*     description: %w(FUS RO DAH).sample\n[2] pry(main)*   )\n[2] pry(main)* end</code></pre>\n      </div>\n<p>이제 랜더링 된 후에 브라우저 콘솔에서 <code class="language-text">app.records</code> 명령어를 입력해보시면 가져온 자료들이 배열로 표시됩니다.</p>\n<h2 id="대시보드-표시하기"><a href="#%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%ED%91%9C%EC%8B%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>대시보드 표시하기</h2>\n<p>대시보드에 쓰일 자료를 자바스크립트로 계산하여 표시해주는 작업은 <code class="language-text">computed</code> 속성에 정의해두면 됩니다. <code class="language-text">data</code> 들을 다루어 계산된 결과를 리턴해주고, 만약 값의 변화가 있다면 바로 반영됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">sumOfIncome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>amount <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> income<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> income<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n    <span class="token function">sumOfOutcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>amount <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> outcome<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> outcome<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n    <span class="token function">totalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> record<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>수입과 지출을 표시해주는 함수는 <code class="language-text">records</code> 배열에서 각각 0보다 크거나 작은 수를 추린 뒤에 모든 수를 합치고, 전체 합계를 표시해주는 함수는 그냥 더해주기만 하면 됩니다. <code class="language-text">filter</code>, <code class="language-text">map</code> 등에 바로 이어 <code class="language-text">reduce</code> 를 활용해주는 방법은 여러모로 유용하게 사용할 수 있습니다.</p>\n<p>이 계산된 값을 바로 HTML 태그 안에 <code class="language-text">{{ }}</code> 로 감싸주어 입력해주시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--dashboard--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Income<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ sumOfIncome }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Outcome<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ sumOfOutcome }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Total<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ totalAmount }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<h2 id="전체-자료-표로-표시하기"><a href="#%EC%A0%84%EC%B2%B4-%EC%9E%90%EB%A3%8C-%ED%91%9C%EB%A1%9C-%ED%91%9C%EC%8B%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전체 자료 표로 표시하기</h2>\n<p>API 서버에 요청하여 가져온 자료를 바로 쓰는데는 몇 가지 문제가 있습니다.</p>\n<ol>\n<li>오래된 자료가 먼저 나옵니다. 보통은 최신 순서로 정렬을 하게 되지요.</li>\n<li>시간 표시가 UTC인데다가, 바로 표시하기 어려운 형식으로 나옵니다.</li>\n</ol>\n<p>그러면 우리는 자료 표시 순서를 뒤집어주고, 시간 표시를 더 깔끔하게 해 주면 되겠네요. 여기서도 <code class="language-text">computed</code> 를 활용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\ncomputed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">allRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> createdAt <span class="token operator">=</span> record<span class="token punctuation">.</span>created_at<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\sUTC$/</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">let</span> localCreatedAt <span class="token operator">=</span> moment<span class="token punctuation">.</span><span class="token function">utc</span><span class="token punctuation">(</span>createdAt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">\'YYYY-MM-DD HH:mm:ss\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        id<span class="token punctuation">:</span> record<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n        amount<span class="token punctuation">:</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>\n        description<span class="token punctuation">:</span> record<span class="token punctuation">.</span>description<span class="token punctuation">,</span>\n        created_at<span class="token punctuation">:</span> localCreatedAt\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">records</code> 배열의 순서를 뒤집어주고, 시간대를 다시 지정한 뒤에 원하는 포맷으로 출력하도록 만들었습니다. 이렇게 변환된 배열을 <code class="language-text">v-for</code> 로 반복 출력해주면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--contents--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Record Time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Amount<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Description<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ record.created_at }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{\n          income: record.amount > 0,\n          outcome: record.amount &lt; 0\n        }<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          {{ record.amount }}\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ record.description }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Delete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Edit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>파이썬의 <code class="language-text">for..in</code> 문법과 비슷하게 생각하시면 됩니다<em>(이 사람은 파이썬을 써 본적이 없다)</em>. <code class="language-text">allRecords</code> 배열에 있는 각각의 <code class="language-text">record</code> 를 사용하여 템플릿을 랜더링하게 됩니다.</p>\n<p>한 가지 살펴보실 점은 수입과 지출을 구분하기 위해 사용한 <code class="language-text">:class</code> 입니다. <code class="language-text">v-bind:class</code> 와 같은 의미인데, 해당 HTML 속성을 Vue 인스턴스와 묶어둔다는 의미입니다. 자세한 내용은 <a href="https://kr.vuejs.org/v2/guide/class-and-style.html">가이드</a>를 참고하시기 바랍니다.</p>\n<p>보통은 <code class="language-text">data</code>, <code class="language-text">computed</code> 에 객체를 정의해두고 <code class="language-text">:class</code> 로 불러와서 해당 객체의 값이 true이면 표시하고, false이면 표시하지 않는 형태로 되어있는데, 반복문에서는 어떻게 활용해야할지 잘 몰라서 저렇게 직접 입력했습니다. 레코드의 값이 0 이상이면 income 클래스가 활성화되고, 0 이하이면 outcome 클래스가 활성화됩니다.</p>\n<p>여기까지 하셨다면 절반은 오신겁니다. 나머지는 자료의 입력, 수정 및 삭제를 구현하면 됩니다.</p>\n<p><img src="/2017-05-02-sc1-b6b1e472327780813fa5b39517e5a316.gif"></p>\n<h2 id="지출-및-수입-기록하기"><a href="#%EC%A7%80%EC%B6%9C-%EB%B0%8F-%EC%88%98%EC%9E%85-%EA%B8%B0%EB%A1%9D%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>지출 및 수입 기록하기</h2>\n<p>지난번 로그인 Form과 같은 형태로 Form이라는 클래스를 따로 만들겠습니다. 클래스 내부는 이전에 로그인 페이지 만들었던 때와 거의 동일합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> data<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> record<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'post\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token string">\'http://localhost:2300/api/records\'</span><span class="token punctuation">,</span>\n      data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token comment">// handle errors</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span><span class="token punctuation">{</span>\n    records<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    insertForm<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      amount<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">create</code> 메서드가 호출될 때 저장되어있던 토큰을 가져와서 요청할 때 헤더에 실어보내게 됩니다. 요청이 성공했을 때 돌아온 데이터는 우리가 레코드 저장용으로 지정해두었던 <code class="language-text">records</code> 배열에다 추가해주면 됩니다. (혹시나 해서 말씀드리지만 <code class="language-text">app.records</code> 는 아래부분에 만들어놓은 Vue 인스턴스의 <code class="language-text">this.records</code> 와 같은 의미입니다.) 그 다음에 배열에 변화를 감지한 뷰 인스턴스는 <code class="language-text">computed</code> 에 지정해두었던 <code class="language-text">allRecords</code> 의 계산을 다시 하게 됩니다. 변경을 감지하는 배열 메서드 및 그 활용법은 <a href="https://kr.vuejs.org/v2/guide/list.html#%EB%B0%B0%EC%97%B4-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80">가이드</a>를 참고하시기 바랍니다.</p>\n<p>나머지는 저장 버튼을 누를 때 <code class="language-text">Form#create</code> 함수가 실행되도록 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--input form--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field has-addons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertForm.amount<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Amount<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control is-expanded<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertForm.description<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Description<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertRecord<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Save<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">insertRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>insertForm<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="기록-변경하기"><a href="#%EA%B8%B0%EB%A1%9D-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기록 변경하기</h2>\n<p>너무나 당연하겠지만 우리가 작성한 기록은 수정할 수 있어야합니다. Edit 버튼을 누르면 기존의 자료가 표시되던 테이블 행이 Input 폼으로 변하게 만들 예정입니다.</p>\n<p><img src="/2017-05-02-sc2-94166b4983ac54195b522a7b106b82ad.gif"></p>\n<p>여기까지 튜토리얼을 진행해보셨다면 Amount, Description 표시 부분에 <code class="language-text">v-if</code>, <code class="language-text">v-else</code> 를 이용하면 되지 않을까? 하고 생각하실 수 있을겁니다. 지금처럼 작은 규모의 프로젝트에는 매 <code class="language-text">td</code> 태그마다 조건에 따라 레이아웃이 변하게 만드는 일이 그렇게 어렵지 않지요. 그런데 너무 줄이 길어져서 가독성도 떨어지고, 아예 <code class="language-text">tr</code> 태그의 레이아웃이 통채로 달라지게 만들 예정이라면? 그럴 땐 컴포넌트를 도입하면 됩니다.</p>\n<h3 id="컴포넌트-추출하기"><a href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%B6%94%EC%B6%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컴포넌트 추출하기</h3>\n<p>리액트를 조금이라도 해 보셨던 분이라면 아시겠지만, 리액트는 JSX로 DOM을 생성하고, 계층화된 컴포넌트의 조합으로 하나의 앱을 만드는게 가능합니다. Vue.js도 컴포넌트를 지원합니다. 보통은 노드 프로젝트로 Vue 프로젝트를 만들 때 많이 쓰게 되는데, 일반적인 자바스크립트에도 충분히 컴포넌트를 만들 수 있습니다.</p>\n<p>HTML 부분에 너무 코드가 많아지면 가독성이 떨어진다고 생각하고, 앞으로 한 부분에서 두 개의 컴포넌트가 나오도록 만들 예정이기 때문에 지금 사용자 레코드를 보여주는 부분을 컴포넌트로 분리해보겠습니다. 우리가 <code class="language-text">v-for</code> 문 바로 아래에 만들었던 <code class="language-text">tr</code> 태그 부분을 통채로 복사하시면 됩니다.</p>\n<p><code class="language-text">Form</code> 클래스 바로 아래에 새로운 변수를 선언합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n    &lt;tr>\n      &lt;td>{{ record.created_at }}&lt;/td>\n      &lt;td :class="{\n        income: record.amount > 0,\n        outcome: record.amount &lt; 0\n      }">\n        {{ record.amount }}\n      &lt;/td>\n      &lt;td>{{ record.description }}&lt;/td>\n      &lt;td>\n        &lt;button class="button is-danger">Delete&lt;/button>\n        &lt;button class="button is-light">Edit&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">template</code> 속성은 이 컴포넌트가 어떤 형태의 HTML 태그를 가지고 있는지 나타냅니다. 그리고 <code class="language-text">props</code> 는 부모 컴포넌트에서 자식 컴포넌트로 내려보내는 속성입니다. 여기서는 기존에 쓰던대로 <code class="language-text">record</code> 를 속성으로 가져왔고, 이 속성을 그대로 활용하고 있습니다.</p>\n<p>컴포넌트를 만들었으면 사용할 수 있도록 장착하고, HTML 파일에 선언해주어야 합니다. 먼저 Vue 인스턴스에 <code class="language-text">components</code> 속성을 정의합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">\'record-row\'</span><span class="token punctuation">:</span> RecordRow\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제 우리는 HTML 파일에 <code class="language-text">record-row</code> 라는 이름으로 태그를 선언하여 컴포넌트를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">:record</code> 는 <code class="language-text">v-bind:record</code> 의 약어입니다. 해당 속성을 이렇게 컴포넌트에 지정해주면 컴포넌트에서 <code class="language-text">record</code> 라는 이름의 속성을 사용할 수 있는겁니다. 다른 이름을 사용하고자 하면 <code class="language-text">:somethingElse</code> 같이 다른 이름을 넣고, 컴포넌트의 <code class="language-text">props</code> 속성에도 다른 이름을 넣어주고 사용하시면 됩니다. 아직까지 이 컴포넌트는 기존에 HTML에 작성해둔 코드와 똑같은 일을 수행합니다.</p>\n<h3 id="edit-버튼으로-토글하기"><a href="#edit-%EB%B2%84%ED%8A%BC%EC%9C%BC%EB%A1%9C-%ED%86%A0%EA%B8%80%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Edit 버튼으로 토글하기</h3>\n<p>일단 Edit 버튼을 누르면 테이블 행 자체가 바뀌도록 만드는 기능부터 구현해보겠습니다. 토글 버튼을 누르면서 일어나는 과정을 순서대로 나열해보자면 다음과 같습니다.</p>\n<ol>\n<li>토글 버튼 클릭</li>\n<li>해당 행의 자료가 \'수정 가능한 상태(isEditMode or isEditable)\' 로 변경</li>\n<li>변경된 자료를 배열에 반영</li>\n<li>배열이 수정되면서 변경된 부분만 Vue.js 가 알아서 새로 랜더링</li>\n</ol>\n<p>우리가 처음에 <code class="language-text">records</code> 배열을 만들 당시에는 수정 가능한 상태를 표시하는 속성이 없었으니 이 속성을 먼저 추가하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Vue instance</span>\ncomputed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">allRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n      id<span class="token punctuation">:</span> record<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n      amount<span class="token punctuation">:</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> record<span class="token punctuation">.</span>description<span class="token punctuation">,</span>\n      created_at<span class="token punctuation">:</span> localCreatedAt<span class="token punctuation">,</span>\n      isEditMode<span class="token punctuation">:</span> record<span class="token punctuation">.</span>isEditMode\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>records <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assgin</span><span class="token punctuation">(</span>record<span class="token punctuation">,</span> <span class="token punctuation">{</span> isEditMode<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>처음에 <code class="language-text">fetchData</code> 메서드로 레코드를 가져올 때 각 레코드마다 <code class="language-text">isEditMode</code> 속성을 추가하면서 초기값으로 <code class="language-text">false</code> 를 넣어주었습니다. 그리고 <code class="language-text">allRecords</code> 는 <code class="language-text">records</code> 배열에 따라 값을 가져오니까 그대로 값을 가져오면 됩니다. 나중에 <code class="language-text">isEditMode</code> 속성이 <code class="language-text">true</code> 로 변하게 되면 <code class="language-text">allRecords</code> 는 자동으로 새로운 배열을 만들어낼겁니다.</p>\n<p>기본적으로 상위 컴포넌트와 하위 컴포넌트는 Props를 통한 단방향 데이터 흐름을 형성합니다. 물론 다양한 방법으로 양방향으로 데이터 변경을 가하는 방법은 있습니다. 하지만 이 경우에는 신중을 기하여 설계하셔야 합니다. 자칫 앱의 규모가 커지면서 상태 관리가 겉잡을 수 없이 복잡해질 수 있으니까요.</p>\n<p>그럼 우리는 어떻게 하위 컴포넌트에 있는 Edit 버튼을 클릭하여 상태를 변경할 수 있을까요? 이 때는 <a href="https://kr.vuejs.org/v2/guide/components.html#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8">사용자 지정 이벤트</a>를 활용하여 하위 컴포넌트에 특정 이벤트가 일어났다고 상위 컴포넌트에 알리고, 그에 따라 상위 컴포넌트가 연산을 수행하도록 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n\t// ...\n      &lt;td>\n        &lt;button class="button is-danger">Delete&lt;/button>\n        &lt;button class="button is-light" @click="toggleEdit">Edit&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">toggle-edit</code> 은 상위 컴포넌트에서 <code class="language-text">record-row</code> 컴포넌트를 선언할 때 이벤트로 지정해두면 됩니다. <strong>이벤트 이름이 일치하지 않는다고 오류가 따로 나지 않기 때문에 오탈자에 유의하셔야 합니다.</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(record, index) in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!record.isEditMode<span class="token punctuation">"</span></span> <span class="token attr-name">@toggle-edit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleEditModeOf(index)<span class="token punctuation">"</span></span> <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>Hello! Edit Mode Toggled!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">v-for</code> 는 이렇게 각 배열의 요소 뿐 아니라 인덱스도 가져올 수 있습니다. Vue 인스턴스에서 <code class="language-text">toggle-edit</code> 이벤트가 일어났다고 감지하면 <code class="language-text">toggleEditModeOf</code> 메서드를 실행하게 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Vue instance</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">toggleEditModeOf</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> target_record <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>\n\t\tObject<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target_record<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      \t\tisEditMode<span class="token punctuation">:</span> <span class="token operator">!</span>target_record<span class="token punctuation">.</span>isEditMode\n\t    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Array#splice</code> 메서드로 해당 인덱스에 있는 자료의 상태를 변경해줍니다. Vue.js는 이 변화를 감지하여 <code class="language-text">allRecords</code> 의 변경된 부분만 새로 만듭니다.</p>\n<h3 id="수정용-컴포넌트-만들기"><a href="#%EC%88%98%EC%A0%95%EC%9A%A9-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>수정용 컴포넌트 만들기</h3>\n<p>이제 토글 버튼을 눌러서 원하는 줄의 내용이 바뀌는걸 확인하셨다면  <code class="language-text">v-else</code> 위치에 새로운 컴포넌트가 들어가게 만들면 됩니다. 수정용 컴포넌트는 조금 더 복잡합니다. 왜냐면 Edit 버튼을 눌렀을 때 원래 적혀있던 값이 input 태그로 바뀌면서 그대로 유지되어야 하며, 변경된 값을 서버에 전송하기 전에 처리해두어야 하기 때문입니다.</p>\n<ol>\n<li>updateForm이라는 새로운 Form 객체를 생성</li>\n<li>Edit 버튼이 토글 될 때 updateForm은 기존 레코드의 자료를 복사해서 저장</li>\n<li>수정용 컴포넌트에서 변경값이 입력될 때 updateForm의 속성도 같이 변화</li>\n<li>Update 버튼을 누르면 입력된 정보를 서버로 전송</li>\n</ol>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> UpdateRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">,</span> <span class="token string">\'form\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n    &lt;tr>\n      &lt;td>{{ record.created_at }}&lt;/td>\n      &lt;td>\n        &lt;input class="input" type="number" :value="record.amount"\n               @input="updateFormValue(\'amount\', $event.target.value)" />\n      &lt;/td>\n      &lt;td>\n        &lt;input class="input" type="text" :value="record.description"\n               @input="updateFormValue(\'description\', $event.target.value)" />\n      &lt;/td>\n      &lt;td>\n        &lt;button class="button is-danger" @click="toggleEdit">Cancel&lt;/button>\n        &lt;button class="button is-light" @click="updateRecord">Update&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span><span class="token punctuation">,</span>\n  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">editForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> form <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">;</span>\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>record<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        form<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>record<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token keyword">return</span> form<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">updateFormValue</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>editForm<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'form-update\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>editForm<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'update-record\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ..</span>\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    updateForm<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      id<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      amount<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>updateForm<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">\'record-row\'</span><span class="token punctuation">:</span> RecordRow<span class="token punctuation">,</span>\n    <span class="token string">\'update-row\'</span><span class="token punctuation">:</span> UpdateRow\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>코드 아래 쪽을 먼저 봐주시면 <code class="language-text">updateForm</code> 객체를 만들어두긴 했지만 아직 빈 값밖에 없는 상태입니다. 그래서 <code class="language-text">editForm</code> 을 이용하여 컴포넌트에서 <code class="language-text">record</code> 의 값을 updateForm(여기서는 form) 으로 복사해주는 작업을 합니다. 다음에는 input 이벤트가 일어날 때마다 해당 값을 반영한 뒤에 변경된 <code class="language-text">form</code> 을 부모 컴포넌트로 올려보냅니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(record, index) in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!record.isEditMode<span class="token punctuation">"</span></span>\n    <span class="token attr-name">@toggle-edit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleEditModeOf(index)<span class="token punctuation">"</span></span>\n    <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n  &lt;update-row v-else\n    @toggle-edit="toggleEditModeOf(index)"\n    :record="record" :form="updateForm"\n    @form-update="form => { updateForm = form }"\n              // 여기서 form은 아까 컴포넌트에 있던 this.editForm 입니다\n    @update-record="updateRecord"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update-row</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">form-update</code> 이벤트 리스너는 자식 컴포넌트가 올려준 <code class="language-text">form</code> 을 기존에 만들어두었던 <code class="language-text">updateForm</code> 과 바꿔치기하게 되지요. 분명 더 좋은 방법은 있습니다만, 저와 이 글을 보시는 여러분 모두 차근차근 보면서 더 나은 방법으로 구현할 수 있게 되었으면 좋겠습니다.</p>\n<h3 id="서버에-전송하기"><a href="#%EC%84%9C%EB%B2%84%EC%97%90-%EC%A0%84%EC%86%A1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서버에 전송하기</h3>\n<p>Update 버튼을 누르면 <code class="language-text">updateRecord</code> 가 실행되게 만드는 것 까지 하셨다면 Form 클래스에 <code class="language-text">update</code> 메서드를 구현하면 됩니다. 기존에 하던 방법처럼 axios로 요청을 보내고 그 응답을 처리하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> record_id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> record<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'patch\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`http://localhost:2300/api/records/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>\n      data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> index <span class="token operator">=</span> app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>id <span class="token operator">===</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token comment">// handle error</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="레코드-삭제하기"><a href="#%EB%A0%88%EC%BD%94%EB%93%9C-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>레코드 삭제하기</h2>\n<p>마지막 기능인 레코드 삭제를 구현하겠습니다. 여지껏 구현해왔던 기능에 비하면 훨씬 쉽게 구현할 수 있습니다. 삭제 버튼을 클릭하면 \'이 기록을 삭제할것이다\' 라는 이벤트를 전송하고, 그러면 우리는 레코드 삭제용 메서드에 해당 레코드의 인덱스를 넘겨주면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">&lt;record-row v-if="!record.isEditMode"\n  @toggle-edit="toggleEditModeOf(index)"\n  @delete-record="deleteRecord(index)" // delete-record 추가\n  :record="record"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n\t// ...\n    &lt;td>\n      &lt;button class="button is-danger" @click="deleteRecord">Delete&lt;/button>\n      &lt;button class="button is-light" @click="toggleEdit">Edit&lt;/button>\n    &lt;/td>\n  `</span></span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">deleteRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'delete-record\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// ...</span>\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">deleteRecord</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> record_id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n      <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        method<span class="token punctuation">:</span> <span class="token string">\'delete\'</span><span class="token punctuation">,</span>\n        url<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`http://localhost:2300/api/records/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>\n        headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>여담이지만 서버와 통신하는 메서드는 어느정도 일관된 틀을 가지고 있다는 점을 보실 수 있습니다. 토큰을 가져와야 하고, 비슷한 URL로 요청을 보내며, 응답에 따라 <code class="language-text">response</code> / <code class="language-text">error</code> 를 받아옵니다. 이 기본 기능을 이해하시면 서버 통신하는 기능을 재사용 가능한 함수로 만들어서 불필요한 코드가 반복되는 일을 줄일 수 있을겁니다.</p>\n<hr>\n<p>이렇게 간단한 가계부 앱을 HTML 페이지 두 장으로 만들어보았습니다. 강좌에서 제공한 코드 곳곳에 개선해야 할 점들은 많습니다. 바로 위에 말씀드렸다시피 중복되는 기능을 재사용 가능하게 만든다던가, 자료를 처리하는 방법을 조금 더 효율적으로 만들거나, 에러를 처리를 위한 고민도 필요합니다.</p>\n<p>코드를 찬찬히 살펴보시면서 \'이렇게 하면 더 나을거같은데..\' 라고 생각하는 부분을 직접 구현해보시면서 점차 Vue.js의 사용법을 익혀나갈 수 있으리라 생각합니다. <a href="https://kr.vuejs.org/v2/guide/">공식 가이드만 참고하셔도</a> 충분히 괜찮은 퀄리티의 앱을 만드실 수 있을겁니다.</p>\n<ul>\n<li>Source Code: <a href="https://github.com/emaren84/moneybook_client">Github</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-05-02-hanami-vuejs-moneybook-frontend-2/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-05-02",path:"/posts/hanami-vuejs-moneybook-frontend-2",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (프론트엔드 편 - 2)",tags:["Javascript","Vue.js"],category:"Vue.js"}},{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 지난 시간에 하나미로 JSON API 서버를 만들었습니다. 이제 가계부 클라이언트를 Vue.js로 구현해보겠습니다.\n처음에는 vue-cli나 Nuxt…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p>지난 시간에 하나미로 JSON API 서버를 만들었습니다. 이제 가계부 클라이언트를 Vue.js로 구현해보겠습니다.\n처음에는 vue-cli나 Nuxt같은 다양한 도구를 이용해서 프로젝트를 만들어야 하나 고민을 했는데, 굳이 그렇게 할 필요도 없이 쉽게 구현 가능하다는 사실을 깨달았습니다.</p>\n<p>이번 프로젝트에서 우리가 필요한건 로그인 페이지와 가계부 페이지 html 두 장 뿐입니다. CSS와 자바스크립트는 같은 파일안에 작성하려는데, 가독성이 떨어지거나 번거롭게 느껴지신다면 따로 분리하여 작업하셔도 됩니다.</p>\n<p><strong>이번에 만드는 프로젝트는 ES6(ECMAscript 2016) 문법을 적극적으로 활용하여 작성할 예정입니다. 크롬 최신버전 (현재 58) 기준으로 만들 예정이며, 더 낮은 버전의 브라우저는 제대로 작동하지 않을 확률이 큽니다(특히 IE).</strong></p>\n<h2 id="vuejs란"><a href="#vuejs%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue.js란?</h2>\n<p>여태까지 AngularJS, ReactJS가 프론트엔드 JS 프레임워크의 양대 산맥을 이루고 있었지만, Vue.js가 혜성처럼 등장하여 3대장과 같은 위치를 차지하게 되었습니다. 두 프레임워크의 장점을 적절히 가져오고 쉽게 익힐 수 있도록 설계되어 있는데다가, 복잡한 프로젝트 세팅 없이 바로 CDN에서 파일을 가져오기만 해도 충분히 쓸만할 만큼 가볍고 사용성이 좋습니다.</p>\n<p>Vue.js에 관한 더 자세한 소개와 간단한 튜토리얼은 아래 링크를 참고하시기 바랍니다</p>\n<p><a href="https://velopert.com/3007">Vue.js 2.0 소개 및 시작하기 - velopert</a></p>\n<h2 id="회원-가입--로그인-페이지-만들기"><a href="#%ED%9A%8C%EC%9B%90-%EA%B0%80%EC%9E%85--%EB%A1%9C%EA%B7%B8%EC%9D%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>회원 가입 &#x26; 로그인 페이지 만들기</h2>\n<p>지난 시간에 가계부 앱에 필요한 기능들을 말씀드렸을 때, 회원 가입을 하고 로그인을 하면 토큰을 받고 브라우저의 LocalStorage에 저장한다고 말씀드렸습니다. 두 기능 모두 거의 같은 로그인 Form을 공유하기 때문에 한 페이지로 만들고 <code class="language-text">v-if</code> 같은 분기문을 사용해서 상태에 따라 조금씩 다른 모습이 나타나도록 만들면 되겠습니다.</p>\n<h3 id="기본-설정"><a href="#%EA%B8%B0%EB%B3%B8-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 설정</h3>\n<p>하나미 프로젝트와 다른 곳 혹은 같은 곳에 폴더를 생성하고 <code class="language-text">login.html</code> 파일을 만든 뒤에 필요한 파일들을 등록해두겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.0/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>서버와 AJAX 통신을 위해 axios, 좀더 깔끔한 페이지 뷰를 위해 CSS 프레임워크인 Bulma를 사용하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">\n  <span class="token selector">html, body</span> <span class="token punctuation">{</span>\n    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n\n  <span class="token selector">#app</span> <span class="token punctuation">{</span>\n    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">background-color</span><span class="token punctuation">:</span> #E6E6E6<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#app .column</span> <span class="token punctuation">{</span>\n    <span class="token property">margin-top</span><span class="token punctuation">:</span> 10%<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#app .column > p</span> <span class="token punctuation">{</span>\n    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#sign-up-button</span> <span class="token punctuation">{</span>\n    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!--main container--></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token comment">&lt;!--centered column--></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-half is-offset-one-quarter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title is-2 is-spaced<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--login form--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-envelope<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                Login\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                Sign up\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--end of form--></span>\n\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token comment">&lt;!--end of column--></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!--end of container--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위의 코드를 넣어주시면 다음과 같은 화면을 보실 수 있습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 56.46437994722956%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPElEQVQoz41TS07DQAzN+TgCl2HBjhNwinIAVl20Cyp2qBISSCj/+QTapGnTJDMPe/pRaJPSkZ7s8djO8ydeHMc4RRRF6LNf8+4NOfH9gO79vw94XQPLMAyd9H0fs9kMk8nEyfF47PT5fI4kSY5+3dgzhuyotUaWZU5KKSGEQJqm7o11tvEbQynVz/BgZOe6aZCvCmzrLfhYa3E4rDOa1qA1FpuqupxQSAEYiqRc1XpDyWsYDm7bP9g5AU1dURzH9yTknnyrDK/lB570FGmuYSmZsQSzg93Ll88Nnt/WCFUJkQ4w9MMAK7XEgx7hxr/HVyMdC07YLd1QqXejH9w+akzfCyLBZKLhtcn1AmudQysaipKu8acoFhrlkoan5dkqna1NQKUHxJZbMATnE4RHZt318a79O4YR7Qezwy9tojFePAHLOwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 04 30 sc1"\n        title=""\n        src="/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-ffc88.png"\n        srcset="/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-d16f8.png 198w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-f21b1.png 395w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-ffc88.png 790w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-81e7e.png 1185w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-53295.png 1516w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="회원-가입--로그인-페이지-전환"><a href="#%ED%9A%8C%EC%9B%90-%EA%B0%80%EC%9E%85--%EB%A1%9C%EA%B7%B8%EC%9D%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%A0%84%ED%99%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>회원 가입 &#x26; 로그인 페이지 전환</h3>\n<p>형태를 잡았으니 본격적인 Vue 도입을 시작하겠습니다. 가장 먼저 <code class="language-text">Vue</code> 인스턴스를 생성한 뒤, 필요한 데이터 필드를 설정하고, 회원 가입 버튼을 누를 때 다른 페이지가 나올 수 있도록 설정할 예정입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignUp<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">body</code> 태그 맨 아래에 <code class="language-text">script</code> 태그를 삽입하고 위의 코드를 넣어줍니다. 먼저 어느 엘리먼트에서 Vue 앱이 구동될지 지정해주고, 앱 안에서 사용하고자 하는 데이터를 설정해준 뒤, 데이터를 조작할 수 있는 메서드를 지정해 주었습니다.</p>\n<p>한 페이지 안에서 로그인 페이지와 회원가입 페이지를 버튼에 따라 다르게 나타나게 하려면 <code class="language-text">v-if</code>, <code class="language-text">v-else</code> 를 사용하면 됩니다. 자세한 내용은 <a href="https://kr.vuejs.org/v2/guide/conditional.html">공식 가이드를 참고해주세요.</a></p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--password confirmation--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password Confirmation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--buttons--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Login\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Sign up\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Submit\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Back\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">template</code> 태그는 Vue에서 사용하는 래퍼 태그입니다. <code class="language-text">v-if</code> 나  <code class="language-text">v-else</code> 는 기본적으로 하나의 태그에만 작동하고, 그 하위 태그들에는 동작하지 않기 때문에 이렇게 단위로 묶어줄 필요가 있습니다.</p>\n<p><code class="language-text">@click.prevent</code> 는 <code class="language-text">v-on:click.prevent</code> 와 같은 의미입니다. 이 버튼을 클릭하면 아까 지정해둔 <code class="language-text">toggleSignIn</code> 메서드를 실행하게 되고, 이 메서드가 <code class="language-text">isSignIn</code> 값을 변경하여 모든 템플릿에 영향을 줍니다.</p>\n<h3 id="form의-자료를-저장할-객체-생성"><a href="#form%EC%9D%98-%EC%9E%90%EB%A3%8C%EB%A5%BC-%EC%A0%80%EC%9E%A5%ED%95%A0-%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Form의 자료를 저장할 객체 생성</h3>\n<p>우리가 만들어놓은 Form에는 세 가지 필드가 있습니다. 이메일 주소, 비밀번호, 비밀번호 확인 필드입니다. 기존에 jQuery를 사용해 오셨다면, 필드의 변화를 바로바로 잡아내기 보다 폼을 제출할 때 이벤트 핸들러가 이런저런 일을 처리하도록 만드셨을 겁니다. Vue도 그렇게 하는게 가능은 하지만 그닥 추천하고 싶은 방법은 아닙니다.</p>\n<p>이번에는 <code class="language-text">v-model</code> 속성을 이용하여 데이터를 묶어두는(binding) 방법을 적용해 보겠습니다. 가장 기초적인 방법으로 Vue 인스턴스에 data를 다음과 같이 지정해둘 수 있을겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignIn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    email<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n    password<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n    password_confirmation<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Vue 인스턴스의 <code class="language-text">data</code> 속성은 해당 인스턴스의 스키마 역할을 하기도 하고, 이렇게 지정해두지 않은 데이터는 동적으로 제어하는게 불가능합니다. (API 문서를 보시면 이후에 추가하는 메서드가 있긴 하지만 그닥 추천드리고 싶지 않습니다) 지금은 필드가 단지 3개밖에 없으니까 이렇게 바로 데이터를 지정해둘 수 있을겁니다.</p>\n<p>미리 서버에 요청을 보내는 과정을 알려드리면 <strong>Form의 데이터를 객체로 모으기 -> axios로 post 요청 보내기 -> 서버의 응답 리턴</strong> 일텐데, 첫 번째 과정을 눈여겨보셔야 합니다. 만약 우리가 회원 가입을 할 때 전화번호나 주소같이 추가적인 정보를 더 많이 받게 된다면, 이 모든 속성을 <code class="language-text">data</code> 에 지정하는 일은 비효율적입니다. 아예 Form 데이터를 모아주고, 요청도 전송해주고, 특정 버튼을 눌렀을 때 input 값을 초기화해주는 등의 역할을 해 주는 객체를 새로 만들면 어떨까요?</p>\n<p>먼저 해당 역할을 해 주는 Form 클래스를 만들고, <code class="language-text">data</code> 속성에 지정해두겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignIn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    form<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      email<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      password<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      password_confirmation<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>참고로 자바스크립트 인터프리터는 코드를 위에서 아래 순서대로 읽기 때문에 Form 클래스의 정의를 Vue 인스턴스 아랫부분에 하게 되면 에러가 납니다.</p>\n<p>Form의 <code class="language-text">originalData</code> 속성은 단순히 필드 저장용으로 사용하게 됩니다. 지금은 <code class="language-text">email</code>, <code class="language-text">password</code>, <code class="language-text">password_confirmation</code> 필드가 있지요. 그리고 for..in으로  Form 클래스의 속성에 필드를 추가합니다.</p>\n<p>이제 input 태그에 데이터를 연결해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--email input--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Email<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-envelope<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--password input--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--password confirmation--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password Confirmation<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.password_confirmation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>각 input 태그에 <code class="language-text">v-model</code> 속성과 함께, 어느 속성이 연결되어야 할 지 지정되어있는 모습을 보실 수 있습니다. 이제 각 필드의 값에 변화가 일어날 때 마다 Form 객체의 속성이 변하게 됩니다.</p>\n<p><img src="/2017-04-30-sc2-f20f52ea53e7fae81e0d032d4e69d830.gif"></p>\n<p>이제 작동 원리가 눈에 들어오셨다면 Form 클래스에 몇 가지 메서드를 추가해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/^password/</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`moneybook:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">return</span> data<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">reset</code> 메서드는 말 그대로 각 필드를 비우는 메서드이고, <code class="language-text">data</code> 필드는 새로운 객체에 각 필드에 입력된 값을 모아주는 역할을 합니다. 서버에 패스워드를 전송할 때는 반드시 암호화되어야 하기 때문에 <a href="https://github.com/emn178/js-sha256">SHA-256 라이브러리</a>를 적용했습니다. 단순히 작동되는 모습을 보기만 하시려면 굳이 적용하지 않으셔도 됩니다.</p>\n<p><code class="language-text">reset</code> 메서드는 <code class="language-text">toggleSignIn</code> 메서드가 실행될 때 같이 실행되도록 하여 회원가입&#x3C;->로그인 전환 시 필드 값을 초기화하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\n\tmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp<span class="token punctuation">;</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="서버와-통신하기"><a href="#%EC%84%9C%EB%B2%84%EC%99%80-%ED%86%B5%EC%8B%A0%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서버와 통신하기</h3>\n<p>사실 Form 을 다루는 이야기를 더 하자면 내용이 꽤 길어집니다. 유효성 검사라던가, 서버로부터 들어온 에러를 다루는 방법이라던가.. 이 부분은 나중에 소스코드에는 구현 할 예정이니 업로드 된 소스코드를 직접 살펴보시길 바랍니다.</p>\n<p>지금은 서버에 데이터를 전송한 뒤에 리턴된 토큰을 저장하는 방법을 살펴보겠습니다. 같은 Form 안에서 조건에 따라 다른 요청을 하도록 구성되어 있기 때문에 Login, Submit 버튼에 다른 메서드를 연결하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--buttons--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitLogin<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Login\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Sign up\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Submit\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Back\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\n\tmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">// ...</span>\n        <span class="token function">submitLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token string">\'http://localhost:2300/api/auth/sign_in\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n        <span class="token function">submitSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token string">\'http://localhost:2300/api/auth/sign_up\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token comment">// ...</span>\n    <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>요청 주소는 하나미 기본 서버 주소 및 포트를 기준으로 했습니다. 별도로 하나미쪽에 CORS를 신경 써 주어야 하는데 미처 신경 쓰지 못했네요, 추후에 업데이트 하겠습니다.</p>\n<p><code class="language-text">submit</code> 메서드는 지정한 url을 받아서 서버에 POST요청을 하고, 응답에 따라 토큰을 저장하거나, 메세지를 띄우면서 Login 페이지로 돌아오는 역할을 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n      <span class="token function">submit</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> user<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">\'auth_token\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">\'auth_token\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n              location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./content.html\'</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n              app<span class="token punctuation">.</span><span class="token function">renderNotification</span><span class="token punctuation">(</span><span class="token string">\'Successfully Singed Up\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n              app<span class="token punctuation">.</span><span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>axios 라이브러리를 이용하여 요청을 하고, 성공하거나 실패한 요청을 각각 <code class="language-text">then</code>, <code class="language-text">catch</code> 로 다룰 수 있습니다. API 서버 구현 파트에서 보셨다시피 사용자가 가입을 할 때는 해당 사용자의 정보를 리턴하고, 가입된 계정으로 로그인을 할 때만 <code class="language-text">auth_token</code> 을 반환합니다. 그리고 받은 토큰을 브라우저의 <code class="language-text">localStorage</code> 에 저장합니다. 그 뒤에 자연스럽게 가계부  앱 페이지로 이동하게 만들면 됩니다.</p>\n<p>회원 가입이 정상적으로 처리 된 뒤에는 다시 로그인 페이지로 돌아도록 만들었습니다. <code class="language-text">renderNotification</code> 메서드는 오른쪽 구석에 알림을 띄우도록 만든 메서드인데, 이를 활용하여 에러 메세지도 손쉽게 표현하실 수 있을겁니다.</p>\n<p>다음 포스팅에서 로그인 이후에 실제 가계부 앱을 Vue.js로 구현해보겠습니다.</p>\n<hr>\n<p>Source Code: <a href="https://github.com/emaren84/moneybook_client">Github</a></p>',
id:"/home/circleci/repo/src/pages/posts/2017-04-30-hanami-vuejs-moneybook-frontend-1/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-30",path:"/posts/hanami-vuejs-moneybook-frontend-1",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (프론트엔드 편 - 1)",tags:["Javascript","Vue.js"],category:"Vue.js"}},{excerpt:"기존에  Learn Vue.js 2  강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다. application.rb…",html:'<p>기존에 <a href="https://laracasts.com/series/learn-vue-2-step-by-step/">Learn Vue.js 2</a> 강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다.</p>\n<h2 id="applicationrb-설정하기"><a href="#applicationrb-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>application.rb 설정하기</h2>\n<p>프로젝트를 작성하고 레일즈로 작성해놓았던 코드도 옮기고 한 건 좋은데 제대로 돌아가는 게 하나도 없었다. 브라우저 콘솔에 나타난 에러를 가만히 들여다보니 Content Security Policy를 미리 설정해둘 필요가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># application.rb</span>\n<span class="token comment"># ...</span>\n      security<span class="token punctuation">.</span>content_security_policy <span class="token string">%{\n        form-action \'self\';\n        frame-ancestors \'self\';\n        base-uri \'self\';\n        default-src \'none\';\n        script-src \'self\' \'unsafe-inline\' \'unsafe-eval\' https:;\n        connect-src \'self\';\n        img-src \'self\' https: data:;\n        style-src \'self\' \'unsafe-inline\' https:;\n        font-src \'self\';\n        object-src \'none\';\n        plugin-types application/pdf;\n        child-src \'self\';\n        frame-src \'self\';\n        media-src \'self\'\n      }</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">script-src</code> 부분에 주목해야한다. <code class="language-text">unsafe-inline</code> 뿐 아니라 <code class="language-text">unsafe-eval</code> 도 추가해주어야 한다. 그리고 애셋을 하나미에서 컴파일하지 않도록 설정해주어야 한다. 그렇지 않으면 자동적으로 하나미가 컴파일되지 않은 파일을 <code class="language-text">public</code> 폴더로 옮겨버린다. 나중에 다시 설정하는 법을 찾을 수 있을지 모르겠지만 <code class="language-text">fingerprint</code> 도 사용하지 않도록 체크해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">    <span class="token comment">##</span>\n    <span class="token comment"># DEVELOPMENT</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:development</span> <span class="token keyword">do</span>\n      <span class="token comment"># Don\'t handle exceptions, render the stack trace</span>\n      handle_exceptions <span class="token keyword">false</span>\n\n      assets <span class="token keyword">do</span>\n        compile <span class="token keyword">false</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n\t<span class="token comment"># ...</span>\n\n    <span class="token comment">##</span>\n    <span class="token comment"># PRODUCTION</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:production</span> <span class="token keyword">do</span>\n      <span class="token comment"># scheme \'https\'</span>\n      <span class="token comment"># host   \'example.org\'</span>\n      <span class="token comment"># port   443</span>\n\n      assets <span class="token keyword">do</span>\n        <span class="token comment"># Don\'t compile static assets in production mode (eg. Sass, ES6)</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://www.rubydoc.info/gems/hanami-assets#Configuration</span>\n        compile <span class="token keyword">false</span>\n        \n        <span class="token comment"># Use fingerprint file name for asset paths</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://hanamirb.org/guides/assets/overview</span>\n        fingerprint <span class="token keyword">false</span>\n        \n        <span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h2 id="yarn-init"><a href="#yarn-init" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn init</h2>\n<p>현재로서 <code class="language-text">npm</code> 보다 <code class="language-text">yarn</code> 이 더 나아보이니까 한번 적용해보았다. 이번 프로젝트와 관련된 모듈들은 다음의 커맨드로 설치하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 필수 모듈\n$ yarn add axios vue\n\n# 개발용 모듈\n$ yarn add webpack babel-core babel-loader babel-preset-es2015 --dev</code></pre>\n      </div>\n<h2 id="webpack-설정-파일-생성"><a href="#webpack-%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack 설정 파일 생성</h2>\n<p>다음은 webpack을 설정하는 파일을 작성할 차례이다. 처음엔 아주 간단한 부분만 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascript/app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// 타겟 파일 지정</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  \tpath<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 번들된 파일 저장 위치, path 모듈을 불러와야한다.</span>\n  \tfilename<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// bundle.js를 많이 쓰는 경향이 있는데 이번엔 app.js로 지정</span>\n  \tpublicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 설정을 해 주고 <code class="language-text">app.js</code> 파일이 엔트리 포인트가 되도록 각 모듈 사이의 <code class="language-text">import</code> 나 <code class="language-text">export</code> 를 지정해준다.</p>\n<p>번들된 파일을 생성하기 위해선 다음 커맨드를 입력해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node_modules/.bin/webpack --hide-modules\n# 계속 변화를 감지하기 위한 커맨드는 다음과 같다.\n$ node_modules/.bin/webpack --hide-modules --watch</code></pre>\n      </div>\n<p>하지만 저 커맨드를 굳이 매번 입력해 줄 필요는 없다. <code class="language-text">package.json</code> 파일에 스크립트를 설정해줄 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// package.json\n<span class="token punctuation">{</span>\n  // ...\n  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules"</span><span class="token punctuation">,</span>\n    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules --watch"</span><span class="token punctuation">,</span>\n    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=production webpack --hide-modules"</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">NODE_ENV</code> 에 대해서는 나중에 살펴 볼 것이다.</p>\n<p>하나미의 <code class="language-text">application.html.erb</code> 파일에서는 <code class="language-text">javascript</code> 뷰 헬퍼로 자바스크립트 파일을 불러오는데, body  태그 마지막에 불러오도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p>대신 css 파일은 수동으로 옮겨주어야 할 것이다. <code class="language-text">scss</code> 같은 preprocessing이 필요한 파일들은 어떻게 처리하는지 아직 실험해보지 못했다. 어차피 전부 webpack으로 해결할 수 있다.</p>\n<p>하지만 막상 번들된 파일을 불러와도 크롬에서 에러를 뿜으면서 랜더링이 되지 않았다. 왜인지 살펴보니 뷰의 모든 구성요소를 컴포넌트로 만들지 않고(Runtime-only), 기존에 작성한 html에 속성을 적용하려면(Full version) <a href="https://kr.vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only">별도의 설정</a>을 해 주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'vue$\'</span><span class="token punctuation">:</span> <span class="token string">\'vue/dist/vue.esm.js\'</span> <span class="token comment">// \'vue/dist/vue.common.js\'  webpack 1용 입니다</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 생각하던대로 작동한다. 나중에 다른 프로젝트에서 Vue 컴포넌트로만 빌드를 하게 되면 이 설정은 입력할 필요가 없을 것이다.</p>\n<h2 id="환경-변수-관리"><a href="#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EA%B4%80%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>환경 변수 관리</h2>\n<p>윗부분에서 <code class="language-text">NODE_ENV</code> 와 관련된 스크립트를 언급했는데, 프로덕션 모드에서는 번들된 패키지를 더 압축해주고, 프로덕션 모드임을 지정해주는 설정이 가능하다. 별도로 패키지를 설정해 줄 필요는 없고, webpack 설정 파일 제일 아랫부분에 스크립트를 더 추가해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">\'production\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        warnings<span class="token punctuation">:</span> <span class="token boolean">false</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token string">\'process_env\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        NODE_ENV<span class="token punctuation">:</span> <span class="token string">\'"production"\'</span> <span class="token comment">// 오타가 아니고 따옴표 안에 겹따옴표 들어가는거 맞다</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="babel-적용하기"><a href="#babel-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>babel 적용하기</h2>\n<p>최신 버전 크롬은 ES6 문법 대부분을 지원하기 때문에 별 신경을 쓰지 않아도 되곘지만.. 그래도 바벨을 적용해두는게 좋을 것이다. </p>\n<p>위에서 필요한 모듈은 설치되어있으니 <code class="language-text">.babelrc</code> 파일부터 지정해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .babelrc\n<span class="token punctuation">{</span>\n  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">"modules"</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 바벨에서 제공하는 <a href="http://babeljs.io/docs/setup/#installation">공식 문서를 따라</a> webpack 설정 파일에 다음 코드를 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n      \ttest<span class="token punctuation">:</span> <span class="token regex">/\\.js$/</span><span class="token punctuation">,</span>\n      \texclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>\n      \tloader<span class="token punctuation">:</span> <span class="token string">"babel-loader"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제부터 webpack을 실행하면 바벨로 변환된 결과물이 나온다.</p>\n<h2 id="라이브러리-나누어서-적용하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EB%82%98%EB%88%84%EC%96%B4%EC%84%9C-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리 나누어서 적용하기</h2>\n<p>만약에 내가 자바스크립트 파일을 작성하다가 아주 일부분만 수정하고 다시 빌드를 해야하는 일이 있다고 할 때 계속 시간을 잡아먹는게 상당히 짜증날 것이다. 일단 기본적인 라이브러리는 내용이 변할 일이 없기 때문에 별도로 합쳐지도록 적용하고, 내가 실제로 작성하는 파일만 변화가 있을 때 다시 번들되도록 만들면 많은 시간을 단축할 수 있을 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascripts/app.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'vue\'</span><span class="token punctuation">,</span> <span class="token string">\'axios\'</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].js\'</span><span class="token punctuation">,</span> <span class="token comment">// entry에 지정된 name(app, vendor)로 번들된 파일이 생성된다.</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunckPlugin</span><span class="token punctuation">(</span>\n      <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'vendor\'</span> <span class="token punctuation">}</span> <span class="token comment">// vendor 파일 덩어리를 따로 보관하고 캐싱한다.</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이러고 나서 빌드를 마치고 나면 <code class="language-text">public/assets</code> 폴더에는 <code class="language-text">app.js</code>, <code class="language-text">vendor.js</code> 두 개의 파일이 생성된다. 당연하게 레이아웃 페이지에서 <code class="language-text">vendor.js</code> 파일도 로딩해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'vendor\', \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<h2 id="css-파일도-관리하자"><a href="#css-%ED%8C%8C%EC%9D%BC%EB%8F%84-%EA%B4%80%EB%A6%AC%ED%95%98%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 파일도 관리하자</h2>\n<p>이래저래 잘 작동하길래 슬슬 코드를 올려볼까 했더니 CSS 파일이 문제가 되었다. 물론 CSS 파일의 내용은 몇 줄 없지만, 매번 내용을 수정한 다음에 일일이 파일을 <code class="language-text">public</code> 폴더로 옮기는건 아주 비효율적이다. 당연히 webpack이 CSS 파일도 모아줄 수 있다.</p>\n<p>먼저 필요한 모듈을 설치한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ yarn add css-loader extract-text-webpack-plugin --dev</code></pre>\n      </div>\n<p>그리고 설정파일에 CSS 관련 모듈 규칙과 플러그인을 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'extract-text-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// ...</span>\n      <span class="token punctuation">{</span>\n        test<span class="token punctuation">:</span> <span class="token regex">/\\.css$/</span><span class="token punctuation">,</span>\n        loader<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          use<span class="token punctuation">:</span> <span class="token string">\'css-loader\'</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">\'styles.css\'</span><span class="token punctuation">)</span> <span class="token comment">// 원하는 이름으로 지정</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이후 webpack을 실행하면 <code class="language-text">public/assets</code> 폴더에 <code class="language-text">styles.css</code> 파일이 추가된다. 나머지는 레이아웃 파일에서 이 파일을 불러오도록 만들면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    &lt;%= stylesheet \'https://cdnjs.cloudflare.com/ajax/libs/bulma/0.3.1/css/bulma.min.css\' %>\n    &lt;%= stylesheet \'styles\' %>\n    <span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 내용을 기반으로 작성한 간단한 프로젝트는 <a href="https://github.com/emaren84/hanami-webpack-config-example">Github</a>에 업로드 되어있다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-04-09-hanami-webpack-config/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-09",path:"/posts/hanami-webpack-config",title:"하나미 프로젝트에서 webpack 설정하기",tags:["Ruby","Hanami","Javascript","Webpack"],category:"Webpack"}}],Typescript:[{excerpt:"이 포스트는  Nicholas Kariniemi 의  Fear, trust and JavaScript: When types and functional programming fail…",html:'<ul>\n<li>이 포스트는 <a href="https://twitter.com/nkariniemi">Nicholas Kariniemi</a>의 <a href="https://www.reaktor.com/blog/fear-trust-and-javascript/">Fear, trust and JavaScript: When types and functional programming fail</a>를 번역한 글입니다</li>\n<li>번역에 관한 피드백과 내용에 관한 토론은 환영합니다. 댓글로 남겨주세요 :)</li>\n</ul>\n<hr>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/02/reaktor-javascript-reaktor-hero-2800x0-c-default.png"></p>\n<p>개발자로서 우리는 코드 실패에 대한 두려움을 줄이고 코드가 잘 작동한다는 믿음을 더 높이고 싶을 겁니다. 자바스크립트를 사용하는 많은 개발자는 함수형 프로그래밍 및 강타입(Strongly-typed) 언어에서 유용한 아이디어를 빌려 개발자의 도구와 코드로 신뢰를 얻으면서 두려움을 줄입니다. 선택적 타입과, 함수를 통한 변환 및 불변성과 같은 아이디어는 모두 더 나은 자바스크립트 코드 작성에 도움이 될 수 있습니다. 그러나 이러한 아이디어를 자바스크립트로 가져올 때 상충하는 개념 때문에 제대로 맞물려 작동하지 않으며, 궁극적으로 ‘개발자가 코드와 도구로 (코드가 잘 작동한다는) 믿음을 표현한다’는 목표를 달성하지 못합니다.</p>\n<p>이 아이디어를 설명하기 위해 자바스크립트에서 데이터를 처리하는 방법을 두 가지 관점에서 살펴보겠습니다. 하나는 데이터의 모양을 이해하는 것이고, 나머지 하나는 데이터를 변경하는 것입니다.</p>\n<h2 id="데이터의-형태와-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%ED%98%95%ED%83%9C%EC%99%80-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터의 형태와 두려움</h2>\n<p>자바스크립트같은 동적 언어에서는 데이터가 어떤 모양을 가지고 있는지 알기 어렵습니다. 기본적인 접근 방식은 규약(convention)에 의지하는 겁니다. 다른 개발자나 다른 시스템이 서로 동의한 형식으로 올바른 데이터를 제공하고 코드 내의 특정 규범을 따른다고 믿어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 name이 있을 거야</span>\n</code></pre>\n      </div>\n<p>저는 이 방식을 “내가 원하는 것인 척” 하는 접근 방식이라고 말하고 싶습니다. 상호 신뢰가 높은 환경에서는 이 방법이 충분히 유효합니다.</p>\n<p>하지만 실제로는 여기저기 두려움이 가득 차 있습니다. 코드가 복잡해지면서 여러분은 서로 다른 규칙을 따르는 개발자의 코드와 씨름합니다. 잘못된 형식으로 날아오지만 현재 계층에서는 손댈 수 없는 데이터를 수신하며, 널 포인터(null pointer) 오류가 발생하기 시작합니다. 코드에 대한 신뢰가 깨지고 데이터에 대한 의문을 가질 때 자신감보다는 불안감이 일어나기 시작합니다.</p>\n<ul>\n<li>이 데이터가 정말 가지고 있는 값이 뭐지?</li>\n<li>이 값을 지우면 어디 다른데서 터지지 않을까?</li>\n<li>이 데이터를 저 함수에다 넘겨도 될까?</li>\n</ul>\n<p>위의 두려움을 이런 방식의 코드 베이스에서 발견할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>\'자기 자신의 코드가 더 이상 기대되는 데이터를 적절하게 전달해주지 못한다’며 믿음을 잃을 때 이렇게 방어적인 프로그래밍을 하게 됩니다. 여러분의 아름다운 코드는 방어적인 체크 때문에 어수선해지고, 가독성을 잃으며, 유지보수하기 어려워집니다. 두려움이 커지면서 점점 코드가 제대로 동작하는지 믿기 어려워집니다.</p>\n<h3 id="선택적-타입optional-types으로-빡세게-확인하는-척하기"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85optional-types%EC%9C%BC%EB%A1%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%ED%99%95%EC%9D%B8%ED%95%98%EB%8A%94-%EC%B2%99%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입(Optional types)으로 빡세게 확인하는 척하기</h3>\n<p>두려움을 사전에 차단하는 방법 중 하나는 <a href="https://www.typescriptlang.org">Typescript</a>나 <a href="https://flow.org">Flow</a>의 선택적 타입을 도입하는 겁니다. 사용자를 수신할 때 <code class="language-text">User</code> 타입을 사전에 선언해두고, 이후에 <code class="language-text">User</code> 객체로 다루는 방식입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>이는 정말 ‘빡세게 확인하는 척’ 하는 겁니다. 당신은 코드에 대한 신뢰를 확인하는 부분을 바꿔 놓았습니다. 여전히 다른 시스템이 올바른 모양의 데이터를 제공한다고 믿지만, 코드 안에서 데이터에 부여한 타입을 믿고 해당 데이터를 잘못 사용하면 컴파일러에서 오류가 나게 됩니다. 개발자가 데이터의 모양을 알고 적절하게 사용하는 것을 믿는 대신 개발자가 올바른 타입을 작성하고 관리하리라 믿고, ‘컴파일러가 해당 형식에 대해 거짓말을 하지 않는다’고 믿게 되었습니다. 이 이야기는 나중에 더 하겠습니다.</p>\n<p>위의 예제에 타입을 추가해도 근본적인 문제는 해결되지 않습니다. 데이터가 일관성있게 사용되도록 보장함으로써 코드의 신뢰도는 향상되었지만 외부로부터 받은 데이터에 대해서는 아무런 말을 하지 않습니다.</p>\n<h3 id="유효성-검사-믿지만-검사는-해볼게"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC-%EB%AF%BF%EC%A7%80%EB%A7%8C-%EA%B2%80%EC%82%AC%EB%8A%94-%ED%95%B4%EB%B3%BC%EA%B2%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사: 믿지만 검사는 해볼게</h3>\n<p>신뢰도가 낮은 환경에서는 여러 지점에서 데이터의 유효성 검사를 해야 할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭐 임마\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// user를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// user는 이름이 있다</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 직접 작성할 수도 있지만 임시 방편에다 다루기도 어렵고 오류가 나기도 쉽습니다. 아니면 <a href="http://json-schema.org">JSON schema</a> 정의를 작성해서 데이터가 스키마에 맞는지 확인하거나, <a href="https://github.com/epoberezkin/ajv">ajv</a>같은 도구로 유효성 검사를 할 수도 있습니다. 이렇게 하면 임시 방편처럼 보이지도 않고 문서화 등을 할 때 유용하게 쓸 수 있겠지만, 여전히 여러분이 이렇게 직접 스키마를 작성해야 하기 때문에 오류가 날 가능성이 있으며 번거로운 작업이 될 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"User"</span><span class="token punctuation">,</span>\n  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>\n  <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="선택적-타입--유효성-검사"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85--%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입 + 유효성 검사</h3>\n<p>아니면 타입과 유효성 검사를 함께 사용할 수도 있습니다. 타입을 이용해서 코드 속의 두려움을 걷어내고, 유효성 검사를 통해서 외부로부터 들어오는 데이터를 믿을 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>\n  id<span class="token punctuation">:</span> <span class="token builtin">number</span>\n  name<span class="token punctuation">:</span> <span class="token builtin">string</span>\n  email<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">fetchUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> validationErrors <span class="token operator">=</span> <span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>validationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'뭠마 난 널 믿었는데\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// User를 가져오는데 성공!</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// 그 이후</span>\n<span class="token function">render</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 컴파일러가 이 객체는 name 속성이 있다고 보증함</span>\n</code></pre>\n      </div>\n<p>선택적 타입과 유효성 검사에 같은 정의를 하는 번거로운 작업을 피하기 위해서 Typescript 와 Flow 컴파일러를 직접 라이브러리로서 사용하거나(역주: 어떻게 하는지 방법은 모르겠습니다), <a href="https://github.com/pelotom/runtypes">runtypes(TS)</a>, <a href="https://github.com/seanhess/runtime-types">runtime-types(Flow)</a>, <a href="https://github.com/YousefED/typescript-json-schema">typescript-json-schema(TS)</a> 같은 별도의 라이브러리를 사용할 수도 있습니다. 몇 개의 장애물을 넘고 나면 여러분의 데이터를 더 믿을 수 있게 됩니다. 하지만 더 깊은 곳에 깔린 문제가 있습니다. 조금 뒤에 살펴보겠습니다.</p>\n<h2 id="데이터-변경의-두려움"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%80%EA%B2%BD%EC%9D%98-%EB%91%90%EB%A0%A4%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터 변경의 두려움</h2>\n<p>데이터가 바뀔 때는 어떨까요? 기본적으로 자바스크립트에서 데이터는 아무렇게나(willy-nilly) 바뀔 수 있습니다. 예를 들어 여기 문서를 받는 함수가 있는데 이 함수는 문서의 필드를 적절하게 손보고 새 필드를 삽입합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 스타일의 코드는 따라가기도 어렵고 곳곳에 두려움이 도사리고 있습니다. 내 데이터가 다른데서 사용된다면? 이미 다른 곳에서 변경되었다면? 이 시점에서 내 데이터가 가지고 있어야 하는 값이 뭐더라? 내가 지금 가지고 있는 데이터와 내가 실제 사용할 때의 데이터가 어떻게 같은 데이터라고 믿을 수 있지? 위의 예는 아주 작은 부분에 불과하지만 높은 동시성이 요구되는 시스템이나 커다란 코드 베이스에서는 훨씬 큰 문제를 야기할 겁니다.</p>\n<p>선택적 타입을 사용해보지만 별로 도움은 되지 않습니다. Typescript 와 Flow 에서 아래 두 함수는 같은 타입을 가리킵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> String<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-flow"><code class="language-flow"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">:</span> Document<span class="token punctuation">,</span> source<span class="token punctuation">:</span> <span class="token type tag">String</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token type tag">void</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    doc<span class="token punctuation">.</span>creationDate <span class="token operator">=</span> <span class="token type tag">null</span>\n  <span class="token punctuation">}</span>\n  doc<span class="token punctuation">.</span>source <span class="token operator">=</span> source\n  child_process<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"sudo rm -rf /"</span><span class="token punctuation">)</span>\n  <span class="token function">launchRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이 중 하나는 여러분이 원하는 기능을 수행하지만 나머지 하나는 서비스를 불바다로 만들어버릴 겁니다. 타입 시스템을 통해 바라보면 이 함수는 아무것도 안하는 것이나 마찬가지입니다(역주: 리턴 값이 <code class="language-text">void</code> 라서 그럴까요?).</p>\n<h3 id="불변성을-가장한-규약"><a href="#%EB%B6%88%EB%B3%80%EC%84%B1%EC%9D%84-%EA%B0%80%EC%9E%A5%ED%95%9C-%EA%B7%9C%EC%95%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>불변성을 가장한 규약</h3>\n<p>이제 여러분은 자바스크립트를 더 잘 다룰 수 있고, 팀 안에서 합의를 이루어서 명시적이고(explicit) 묵시적(implicit)으로 불변성을 가지도록 코드를 작성하기 시작합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    creationDate<span class="token punctuation">:</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>creationDate<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    source<span class="token punctuation">:</span> source<span class="token punctuation">,</span>\n    text<span class="token punctuation">:</span> doc<span class="token punctuation">.</span>text\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 데이터 변경하지 않기</span>\n  <span class="token comment">// 루트 폴더 지우지 않기</span>\n  <span class="token comment">// 로켓 쏘지 않기</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> date <span class="token operator">?</span> <span class="token function">convertTimeToUtc</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>점점 <code class="language-text">var</code> 보단 <code class="language-text">const</code> 를 선호하며 값을 직접 변경하기 보다 새로운 값을 리턴하도록 만들기 시작합니다. <code class="language-text">let</code> 은 변경될 수 있는 값을 가리킬 때만 사용하고, 더 짧은 코드를 작성하기 위해 삼항연산자(ternary operator)를 사용하여 <code class="language-text">if</code> 문을 기능적으로 대체할 수 있다는 사실을 새로이 발견했습니다. <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 나 다른 함수를 사용하여 기존의 데이터를 직접 변경하지 않는 새로운 자료구조를 사용하기도 합니다.</p>\n<p>규약에 다른 불변성은 편리하고 자연스러운 자바스크립트 코드를 만들어냅니다. 그리고 자바스크립트 에코시스템과도 잘 맞아떨어집니다. 하지만 이 방식은 개발자의 신뢰와 훈련(discipline)에 크게 의존합니다. 여러분은 객체의 직접 변경을 피하고 어디서 변경이 일어나는지 정확히 표현하는 등의 규약을 개발자들이 잘 따른다고 믿어야 합니다. 이쯤 오면 더 강한 규약이 필요하다 생각하게 됩니다.</p>\n<h3 id="라이브러리를-사용해서-빡세게-강제하는-척-하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%EB%B9%A1%EC%84%B8%EA%B2%8C-%EA%B0%95%EC%A0%9C%ED%95%98%EB%8A%94-%EC%B2%99-%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리를 사용해서 빡세게 강제하는 척 하기</h3>\n<p>여러분은 데이터 변경이나 불변 자료구조를 위해 라이브러리를 도입해서 오롯이 개발자만 믿어야 하는 부분 일부를 도구 사용에 대한 믿음으로 옮겨올 수 있습니다. 광범위하게 <a href="http://ramdajs.com">Ramda</a>같은 ‘함수형 올인원 팩’ 같은 라이브러리를 도입할 수도 있고 <a href="https://github.com/calmm-js/partial.lenses">partial.lenses</a>, <a href="https://github.com/gcanti/monocle-ts">monocle-ts</a> 같은 렌즈 라이브러리를 도입할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> R <span class="token keyword">from</span> <span class="token string">\'ramda\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// 새 데이터를 만들어 반환한다</span>\n  <span class="token keyword">return</span> R<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이런 종류의 라이브러리의 기본 개념 중 하나는 사용하는 데이터를 마치 불변 데이터인 것 처럼 다룬다는 겁니다. 실제로는 그렇지 않은데도요. <a href="http://ramdajs.com/docs/#assoc">Ramda 는 얕은 복사(shallow clone)만 합니다.</a> 하지만 불변 데이터에 대한 규약이 충분히 강력하다면 모두들 ‘불변 데이터인 척’ 다루게 됩니다. 약간 퍼포먼스 손해를 보긴 하겠지만 일정 수준의 코드 신뢰도는 얻었습니다. 라이브러리를 광범위하게 사용하고 규약이 잘 잡혀있으면 최상의 효과를 발휘하겠지요.</p>\n<p>진정한 불변성을 강제하고 데이터 변경 시 퍼포먼스 손해를 최소화하려면 <a href="https://github.com/facebook/immutable-js">Immutable.js</a>, <a href="https://github.com/rtfeldman/seamless-immutable">seamless-immutable</a>, <a href="http://swannodette.github.io/mori/">Mori</a> 같은 불변 자료구조를 활용할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> I <span class="token keyword">from</span> <span class="token string">\'immutablejs\'</span>\n<span class="token keyword">function</span> <span class="token function">formatDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> creationDate <span class="token operator">=</span> <span class="token function">sanitizeDate</span><span class="token punctuation">(</span>creationDate<span class="token punctuation">)</span>\n  <span class="token comment">// doc은 직접 수정할 수 없다</span>\n  <span class="token keyword">return</span> doc<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> creationDate<span class="token punctuation">,</span> source <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 데이터를 직접 변경할 수 없게 되며 외부로 드러난 인터페이스로만 변경할 수 있게 됩니다. 하지만 라이브러리에서 제공하는 특정 자료구조에서만 적용되는 데이터에만 한정됩니다. 대부분의 자바스크립트 코드는 기본적인 자바스크립트 자료구조에 의존하기 때문에, 결국에는 이리저리 데이터를 변환하게 되고(역주: ImmutableJS 의 <code class="language-text">toJS</code> 를 떠올려보세요) 기본적인 자료구조를 사용할 때마다 기껏 확보한 믿음을 잃어버리게 됩니다.</p>\n<p>규약을 거는 것과 불변 자료구조를 강제하는 방법 모두 한계가 있지만, 제일 큰 문제는 선택적 타입 시스템과 잘 맞지 않는다는 겁니다.</p>\n<h2 id="자바스크립트를-믿기"><a href="#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EB%AF%BF%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자바스크립트를 믿기</h2>\n<p>앞서 소개한 예시들은 선택적 타입, 함수를 통한 변형, 불변 데이터 등 더 효과적인 자바스크립트를 작성하기 위한 도구를 꺼내 본 것입니다. 하지만 자바스크립트를 쓰면서 이런 도구들을 도입 할 때 여러가지 한계점이 있으며, 같이 사용하기도 어렵습니다.</p>\n<h3 id="선택적-타입은-잘못된-보안-의식을-제공한다"><a href="#%EC%84%A0%ED%83%9D%EC%A0%81-%ED%83%80%EC%9E%85%EC%9D%80-%EC%9E%98%EB%AA%BB%EB%90%9C-%EB%B3%B4%EC%95%88-%EC%9D%98%EC%8B%9D%EC%9D%84-%EC%A0%9C%EA%B3%B5%ED%95%9C%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>선택적 타입은 잘못된 보안 의식을 제공한다</h3>\n<p>선택적 타입은 말 그대로 자바스크립트에 선택적으로 도입할 수 있도록 설계되었습니다. 말인즉슨 모든 요소가 타입으로 정의된게 아니기 때문에 모두 유효한 타입을 가지고 있다고 믿는게 불가능합니다. Flow 는 타입이 불분명하며(unsound) Typescript 는 <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html">의도적으로 불분명하게(deliberately unsound)</a> 사용할 수 있습니다. 불분명하다는 의미는 여러 상황에서 타입이 타입이 맞지 않는데도 컴파일러가 알아채지 못하는 것을 뜻합니다.</p>\n<p>자바스크립트에서 선택적 타입을 사용 할 때 다른 이유로 맞지 않는 경우도 있습니다. 자바스크립트로 작성된 것들 중 일부는 Typescript 나 Flow 로 타입을 정의하기 어렵거나 심지어 불가능하기도 합니다.</p>\n<ul>\n<li>\n<p>고차 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#call"><code class="language-text">call</code></a>, <a href="http://ramdajs.com/docs/#compose"><code class="language-text">compose</code></a>, <a href="http://ramdajs.com/docs/#chain"><code class="language-text">chain</code></a>, <a href="http://ramdajs.com/docs/#lift"><code class="language-text">lift</code></a>, <a href="http://ramdajs.com/docs/#lens"><code class="language-text">lense</code></a> 계열 함수들</li>\n<li>partial.lenses 의 <a href="https://github.com/calmm-js/partial.lenses/issues/55">함수들</a></li>\n</ul>\n</li>\n<li>\n<p>동적 함수들</p>\n<ul>\n<li>Ramda 의 <a href="http://ramdajs.com/docs/#invert"><code class="language-text">invert</code></a>, <a href="http://ramdajs.com/docs/#dissoc"><code class="language-text">dissoc</code></a>, <a href="http://ramdajs.com/docs/#mergeWith"><code class="language-text">mergeWith</code></a></li>\n<li>ImmutableJS 의 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">거의 대부분의 함수</a></li>\n</ul>\n</li>\n<li>\n<p>몽키패칭</p>\n<ul>\n<li>AWS SDK 클라이언트의 <a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/using-promises.html#w2ab1c17c15c14c17">Promise</a></li>\n<li>Bluebird 의 <a href="http://bluebirdjs.com/docs/api/promisification.html">프로미스화 API 들</a></li>\n</ul>\n</li>\n<li>\n<p>아주 동적인 자료구조</p>\n<ul>\n<li>ElasticSearch <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-get">스키마</a></li>\n<li>winston <a href="https://github.com/winstonjs/winston#creating-your-own-logger">커스텀 로거</a></li>\n</ul>\n</li>\n</ul>\n<p>위의 것들을 Typescript 나 Flow 로 타입을 매기려면 여러분들은 아래 요소들 중 한개 이상은 희생해야 합니다.</p>\n<ol>\n<li><strong>타입을 쓰는 이유인 ‘타입 안정성’ 을 희생한다:</strong> <code class="language-text">any</code> 타입을 매겨서 모든 값을 허용하고 타입 체커가 <code class="language-text">any</code> 가 들어가는 경로에 있는 값을 확인하지 않게 만듭니다.</li>\n<li><strong>재사용성을 희생한다:</strong> 더 특정하고 정확한 타입을 제공하는 대신 함수의 재사용성을 낮춥니다.</li>\n<li><strong>다른 개발자의 시간을 희생한다:</strong> 함수를 사용하는 사람들에게 정확한 타입을 제공하도록 만듭니다. 예를 들자면 이렇게요.</li>\n</ol>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript">R<span class="token punctuation">.</span>pipe<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>선택지에 따라 라이브러리를 추가할 때 들쭉날쭉한 정확도를 가진 타입 정의도 함께 추가하게 됩니다. 이 때 라이브러리의 개발자를 향한 믿음 일부를 라이브러리의 ‘타입 정의’를 한 개발자에 대한 믿음으로 옮겨가게 됩니다. 대부분 이런 라이브러리는 <code class="language-text">any</code> 타입 정의를 포함하고 있고, 이렇게 정의 된 함수를 호출하면 자기도 모르는 새 맞지 않는 타입을 믿는다고 말하는 것이나 다름없습니다. 게다가 Flow 는 <code class="language-text">@flow</code> 어노테이션이 들어있지 않은 파일을 조용히 무시합니다.</p>\n<p>암시적이고 명시적으로 <code class="language-text">any</code> 타입을 허용하지 않도록 하면서, 타입 정의를 광범위하게 적용하고 타입 정의가 없는 파일은 린터가 오류를 뿜어내도록 설정하여 타입 신뢰성 문제를 해결할 수도 있습니다.</p>\n<p>하지만 이는 물이 새는 배의 구멍을 막는 것이나 마찬가지입니다. 진짜 문제는 여러분이 구축한 시스템의 타입 시스템을 믿지 못하는 것이 아니라 <strong>타입 시스템을 믿을 수 있다고 생각하는 겁니다.</strong> 타입에 기대어 뭔가 변화가 일어날 때 어디가 잘못되었는지 알려주도록 만들어보려 하지만, <code class="language-text">any</code> 타입 때문에 조용히 지나가거나, 라이브러리 사용 방법 혹은 타입의 정확성 문제 때문에 제대로 이루어지지 못합니다. 자바스크립트에 타입을 적용하는 것은 다른 언어에 적용되어있는 타입과는 다릅니다. 똑같은 수준의 신뢰를 기대할 수 없다는 뜻입니다.</p>\n<p><img src="https://www.reaktor.com/wp-content/uploads/2018/01/types_and_js2-768x883.png"></p>\n<p>궁극적으로 여러분이 정의한 타입의 강점은 타입을 적용하는 팀의 지식 수준과 신념에 달려 있습니다. 팀이 타입에 대해 높은 수준의 믿음과 지식을 보유하고 있다면, 시스템에 대해 높은 신뢰를 이끌어낼 수 있습니다. 그러나 일정 수준의 신뢰도를 유지하기 위한 팀의 관심과 규율에 의존해야 하며, 두려움은 여러 가지 형태로 그 믿음을 망칠 수 있습니다.</p>\n<h3 id="함수형-프로그래밍-타입-자바스크립트---이-중-두개를-고르세요"><a href="#%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%ED%83%80%EC%9E%85-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8---%EC%9D%B4-%EC%A4%91-%EB%91%90%EA%B0%9C%EB%A5%BC-%EA%B3%A0%EB%A5%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>함수형 프로그래밍, 타입, 자바스크립트 - 이 중 두개를 고르세요</h3>\n<p>선택적 타입과 <code class="language-text">map</code>, <code class="language-text">filter</code>, <code class="language-text">reduce</code> 를 활용한 기본적인 함수형 프로그래밍은 자바스크립트와 잘 작동합니다. 하지만 더 깊이 들어가려 하면 문제에 봉착하게 됩니다. 두 가지 예를 보여드리죠.</p>\n<p><a href="https://github.com/facebook/immutable-js">ImmutableJS</a>는 자바스크립트를 위한 영속적인 불변 자료구조 라이브러리입니다. 이 라이브러리는 내부 데이터 수정에 의존하지 않는 공용 자료구조를 제공합니다. <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/Immutable.d.ts">Typescript</a>와 <a href="https://github.com/facebook/immutable-js/blob/master/type-definitions/immutable.js.flow">Flow</a>를 위한 타입 정의도 포함되어 있습니다만 한번 살펴보시면 타입 체킹을 무효화하는 <code class="language-text">any</code> 타입이 한가득 들어있습니다. 게다가 어떤 타입은 사용자가 정확한 타입을 제공하도록 책임을 떠넘기기도 합니다. 결과적으로 라이브러리를 사용할 때마다 타입을 도입하지 않을 수도 있고 타입을 도입하기 위해 추가적인 노력을 들일 수도 있습니다. 그러다보면 함수형 프로그래밍을 도입하기 어려워집니다.</p>\n<p>Ramda 는 자바스크립트를 위한 함수형 유틸리티 라이브러리입니다. 타입 정의는 <a href="https://github.com/types/npm-ramda#status">여기</a>에서 보실 수 있는데, 아래의 코멘트와 함께 제공됩니다. (중요한 부분은 강조했습니다)</p>\n<blockquote>\n<p>유의사항: Ramda 의 많은 함수들은 주로 부분 함수(partial application), 커링(currying), 조합(composition)을 중심으로 하는 문제들 때문에 정확한 타입을 제공하기 어렵습니다. 특히 제네릭이 있을 때 그렇습니다. <strong>그리고 네, 아마 여러분들이 Ramda 를 처음 사용하고자 했던 이유는 이런 기능을 사용하기 위해서겠지요.</strong> 특히 타입스크립트로 Ramda 의 타입을 적용하고자 할 때 문제가 됩니다. TS 에 관련 된 몇가지 이슈는 아래의 링크에서 확인하실 수 있습니다(역주: 링크가 실제 원하는 곳으로 연결되지 않아서 배제했습니다)</p>\n</blockquote>\n<p><a href="https://github.com/gcanti">Giulio Canti</a>같은 분의 엄청난 작업에도 불구하고, 매번 조금이라도 불변 자료구조나 함수 합성, 커링같은 고급 함수형 프로그래밍 기법을 도입하려고 하면 타입 체커를 비활성화하거나 타입이 제대로 동작하도록 만들기 위해 추가로 노력을 들여야 합니다. 여전히 함수형 프로그래밍을 도입하기 어렵게 만드는 요소입니다.</p>\n<h3 id="왜-우리는-자바스크립트로-고급진-개념을-사용할-수-없는가"><a href="#%EC%99%9C-%EC%9A%B0%EB%A6%AC%EB%8A%94-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A1%9C-%EA%B3%A0%EA%B8%89%EC%A7%84-%EA%B0%9C%EB%85%90%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 우리는 자바스크립트로 고급진 개념을 사용할 수 없는가</h3>\n<p>불변성은 코드에 골고루 사용될 때 가장 유용합니다. 하지만 자바스크립트라는 언어와 에코시스템 자체가 데이터를 변경하도록 설계되어있고, <a href="http://tagide.com/blog/research/constraints/">라이브러리 수준에서 불변성을 강제할 수 없습니다.</a> 또한 선택적 타입을 도입한다 한들 라이브러리로 불변성을 다룰 때 표현력이 떨어집니다.</p>\n<p>타입도 마찬가지로 골고루 사용될 때 최고의 효과를 발휘합니다. 하지만 자바스크립트에 타입을 사용하는 것은 어디까지나 선택적으로 사용할 수 있도록 설계되었으며, 자바스크립트와의 호환성을 유지하기 위해 극단적인 절충안(역주: <code class="language-text">any</code> 타입 같은 것?)을 취하여 표현력과 유용성을 제한하였습니다.</p>\n<p>타입, 불변성, 그리고 함수형 프로그래밍은 다른 언어에서도 사용되는 것 처럼 서로를 뒷받침할 수 있습니다. 기반 자료구조가 가변적이거나 런타임에는 (타입이) 존재하지 않더라도 타입이 불변성을 강제하는데 사용될 수 있습니다. 타입은 다른 개발자들이 렌즈를 사용하여 함수 합성을 하거나 데이터를 변형할 때 함수들을 제대로 연결하도록 도울 수 있습니다. 함수를 사용한 변형은 타입과 함께 사용할 때 이해하고 유지보수하기 쉬운데다 기반 자료구조가 불변성을 가지고 있는지 알 수 있을 때 더욱 유용합니다.</p>\n<h2 id="두려움을-가지고-코드를-작성하는-법-배우기"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EA%B3%A0-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%8A%94-%EB%B2%95-%EB%B0%B0%EC%9A%B0%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지고 코드를 작성하는 법 배우기</h2>\n<p>그렇다면 어떻게 두려움을 가지고 코드를 작성하는 법을 배울 수 있을까요? 더 나은 자바스크립트 코드를 작성하는 겁니다. 여러분 자신의 코드를 거의 믿을 수 없다는 기본 가정에서 시작하여 함수형 자바스크립트를 작성하고 언어 자체의 나쁜 부분을 피하는 수 많은 기술을 배울 수 있습니다. 필요한 부분에는 타입 유효성 검사를 사용하고 꼭 필요한 경우거나 규약으로 명확히 강제할 때 불변 데이터를 사용합니다. 합당한 이유가 있을 때 선택적 타입을 도입하되, 함수형으로 데이터를 다루거나 불변 데이터를 사용하는 것이 더 나은 이득을 제공한다고 판단되면 타입 사용을 포기합니다. 함수 합성이나 렌즈를 사용하기 위해 의도적으로 타입 체킹을 비활성화 할 수 있습니다.</p>\n<p>아니면 아예 <a href="http://www.purescript.org/">PureScript</a>, <a href="https://bucklescript.github.io/">ReasonML</a>, <a href="http://elm-lang.org/">Elm</a>, <a href="https://clojurescript.org/">ClojureScript</a> 등을 사용하여 다른 물에서 노는 방법이 있습니다. 이 언어들은 오늘날 실존하며 실제 프로덕션 앱이 동작하고 있습니다. 필요하다면 자바스크립트 에코시스템과 함께 동작할 수 있습니다. 불변성, 함수형 프로그래밍, 타입(해당되는 경우)이 기본적으로 잘 작동하고, 이 요소들이 함께 작동하는 환경에서 보다 높은 수준의 신뢰를 제공합니다.</p>\n<p>이런 언어들 중 하나를 선택한다고 모든 문제를 해결할 수는 없습니다. 각자의 언어는 또 문제를 가지고 있습니다. 하지만 기본적으로 자바스크립트에 비해 더 높은 신뢰성이 있으며 필요에 따라 그 신뢰 수준을 끌어올리거나 낮추는 더 나은 도구를 제공합니다. 다음 포스트에서 PureScript 를 활용하여 이런 아이디어가 어떻게 적용되는지 이야기해보겠습니다.</p>\n<p><strong><em>하지만 자바스크립트를 쓰는 한, 두려움은 언제나 여러분과 함께합니다</em>.</strong></p>',
id:"/home/circleci/repo/src/pages/posts/2018-03-04-fear-trust-and-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-03-04",path:"/posts/fear-trust-and-javascript-kr",title:"[번역] 두려움, 믿음, 그리고 자바스크립트 - 언제 타입 시스템과 함수형 프로그래밍이 먹히지 않는가",tags:["Functional Programming","Javascript","Typescript"],category:"Javascript"}}],Testing:[{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p>더 좋은 (리액트 애플리케이션) 테스트를 위한 번역 시리즈 마지막입니다. 처음에는 팀원들과 공유하기 위해 테스트의 기초적인 부분을 다루는 글을 번역하려다가, 최대한 실전에 도움이 되면서도 부담없이 시작할 수 있는 내용 위주로 좋은 글을 찾아서 번역해보았습니다.</p>\n<p>제 자신도 번역을 통해 ‘어디까지 테스트하는게 실무에 도움이 많이 될까?’ 라는 질문의 답을 얻는데 많은 도움이 되었습니다. 이제 테스트만 잘 짜면 될텐데요.</p>\n<p><img src="https://cl.ly/0P3O322S1P3y/Screen%20Shot%202018-01-27%20at%2014.46.48.png" alt="test-right-now"></p>\n<p>다음에는 어떤 글을 쓰거나 번역할지 아직 모르겠지만 모쪼록 도움이 되었으면 좋겠습니다.</p>\n<p><a href="https://medium.com/@Tetheta/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-eb581d6d167b">원문은 여기서 보실 수 있습니다</a></p>\n<hr>\n<p>만약 여러분이 기술 중심 회사에서 일하시는게 아니라면, 단위 테스트같은 개발 요소를 도입한다고 관리자를 설득하는게 어려울 수 있습니다. 저는 한동안 열렬한 지지자가 되어(역주: 필자 자신이 ‘관리자’ 임을 암시하는 문장이라 봅니다)  몇몇 프로젝트에 단위 테스트를 도입하고 동료들과 몇 가지 패턴을 도입해보았습니다. 그 과정에서 제가 배운 교훈을 이야기하고자 합니다.</p>\n<h2 id="설정이-만만치-않습니다-"><a href="#%EC%84%A4%EC%A0%95%EC%9D%B4-%EB%A7%8C%EB%A7%8C%EC%B9%98-%EC%95%8A%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설정이 만만치 않습니다 😐</h2>\n<p>여러분이 create-react-app 같은 것을 사용하고 있거나 회사에서 이미 Jest + Enzyme 설정을 해 두었다면 아주 좋습니다!</p>\n<p>저처럼 밑바닥부터 설정해야 한다면 몇 가지 유의하실 점이 있습니다.</p>\n<ol>\n<li>Jest는 노드 환경에서 실행됩니다. 즉 Webpack같은 번들러의 결과물을 실행하는 것이 아니라 파일의 코드 그대로 실행한다는 뜻입니다. 따라서 ES6나 기타 문법을 사용하고 싶다면 테스트 환경에서 사용하는 <code class="language-text">.babelrc</code> 파일을 설정해야 합니다.</li>\n<li>위에 이어서 브라우저가 아니라 노드 환경에서 실행되기 때문에 import, export 같은 문법을 사용하기 위해 폴리필을 추가해야 할 수도 있습니다.</li>\n<li>최신 버전의 Enzyme은 Jest가 제대로 실행되기 위해 <a href="http://airbnb.io/enzyme/#installation">설정 파일이 필요합니다</a>.</li>\n<li>아마 폰트, 이미지, 스타일 파일들을 잔뜩 모킹해야 할지도 모릅니다.</li>\n<li>CI(Continuous Integration) 빌드 중 테스트를 실행하고 싶다면 <code class="language-text">testResultProcessor</code>, <code class="language-text">runInBand</code> 설정을 해 주시는게 좋습니다. 저는 <a href="https://github.com/CHECK24/jest-bamboo-reporter">Bamboo</a>를 사용하고 있습니다.</li>\n</ol>\n<p>컴포넌트를 작성하는 환경과 테스트를 작성하는 환경을 최대한 비슷하게 맞추기 위해(ES2017, import/export 등) 제대로 된 폴리필을 설정하는 것이 가장 큰 장벽이었습니다. React 버전 16으로 업그레이드 하는 것도 꽤 흥미로운 일이었지만 이제 대부분은 자연스럽게 적응(최소한 문서화라도)했습니다.</p>\n<p>기회가 된다면 언젠가 제 설정을 짚어보는 포스트를 써 볼지도 모릅니다. 제 프로젝트의 일부는 그저 문서로 남겨두기엔 특이한 환경을 가지고 있었고, 고통스럽기도 했습니다.</p>\n<h2 id="스냅샷을-사용하세요-json-serializer와-함께-사용하면-더-좋습니다"><a href="#%EC%8A%A4%EB%83%85%EC%83%B7%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%84%B8%EC%9A%94-json-serializer%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4-%EB%8D%94-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스냅샷을 사용하세요 (json serializer와 함께 사용하면 더 좋습니다)</h2>\n<p>스냅샷은 아주 좋습니다 😃. 하지만 이런 코드를 실행하면</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Match previous snapshot\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그냥 enzyme이 사용하는 자체 객체를 뱉어버립니다😦. 저는 <a href="https://github.com/adriantoine/enzyme-to-json">enzyme-to-json</a> 같은 패키지를 써서 가독성을 높이길 추천합니다. 스냅샷이 변경되었을 때 아주 유용합니다.</p>\n<p>그리고 스냅샷을 버전 관리 시스템(Git 등)에 포함시키세요. 여러분이 반영한 변경 사항이 갑자기 문제를 일으킬 때 문제점을 찾는 데 큰 도움이 됩니다.</p>\n<h2 id="jest-watch-도-좋습니다-"><a href="#jest-watch-%EB%8F%84-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>jest —watch 도 좋습니다 😃</h2>\n<p>테스트 할 때 반드시 사용하세요! 여러가지 일을 편하게 만들어주고, 패턴 매치(<code class="language-text">p</code> 키를 누른 뒤 파일이나 폴더 이름을 입력해보세요)를 사용해서 매번 저장할 때마다 모든 테스트를 다시 실행하지 않게 만들 수도 있습니다.</p>\n<h2 id="test-문의-괄호가-제대로-놓여있는지-확인하세요"><a href="#test-%EB%AC%B8%EC%9D%98-%EA%B4%84%ED%98%B8%EA%B0%80-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EB%86%93%EC%97%AC%EC%9E%88%EB%8A%94%EC%A7%80-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>test() 문의 괄호가 제대로 놓여있는지 확인하세요</h2>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 지극히 정상적인 자바스크립트 코드지만 테스트를 실행하면 모두 잘 작동한다면서 아무 일도 일어나지 않을 겁니다.</p>\n<p>올바른 코드는 이렇게 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 실수는 쉽게 저지를 수 있는데다 테스트에 문제가 있는데도 통과하기 때문에 특히 무섭습니다. 저는 특정 단위 테스트를 잘못 썼는데(역주: 문법적 실패가 아니라 fail이 뜨는 코드) 실패가 뜨지 않았습니다. 비슷한 코드를 복사하고 붙여넣다가 간신히 이 실수를 발견했지요.</p>\n<p>그래서 생각한 것이...</p>\n<h2 id="테스트가-실패하는지-꼭-확인하세요"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%8B%A4%ED%8C%A8%ED%95%98%EB%8A%94%EC%A7%80-%EA%BC%AD-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 실패하는지 꼭 확인하세요</h2>\n<p>여러분이 실력있고 TDD를 사용하는 개발자라면 이미 이 방법을 사용하고 있을 겁니다.</p>\n<p>그렇지 않은 분이라면 단위 테스트를 너무 후순위로 취급하기 때문에 테스트를 한 뭉치 작성하고 “좋아! 잘 작동하는군! 이제 다음 단계로 가야지” 라고 생각하기 쉽습니다.</p>\n<p>하지만 앞서 언급된 문제로 이어질 수있는데다, 비슷한 테스트를 복사-붙여넣기 하다보면 특히 쉽게 잘못된 요소나 모킹한 함수를 테스트 할 수 있습니다.</p>\n<p>테스트의 중요한 부분을 잠시 주석처리하는 식으로 쉽게 테스트를 실패하게 만들 수 있으며, 덕분에 여러분이 수없이 겪을 지도 모르는 골치 아픈 상황에서 벗어날 수 있습니다.</p>\n<h2 id="반복-가능하고-확장-가능한-테스트-패턴을-만들어보세요"><a href="#%EB%B0%98%EB%B3%B5-%EA%B0%80%EB%8A%A5%ED%95%98%EA%B3%A0-%ED%99%95%EC%9E%A5-%EA%B0%80%EB%8A%A5%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%8C%A8%ED%84%B4%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>반복 가능하고 확장 가능한 테스트 패턴을 만들어보세요</h2>\n<p>여러분이 혼자서 프로젝트의 테스트를 만들거나 유지보수하지 않는 이상, 새 컴포넌트를 빠르고 쉽게 테스트하거나 최소한 기본 수준의 테스트라도 빠르게 만들고 싶을겁니다.</p>\n<p>제 동료 개발자들을 보니 가장 큰 장벽은 “어떻게 시작해야할지 모른다” 는 부분이었습니다. 명확하고 따라하기 쉬운 패턴을 만들어서 그들을 도울 수 있습니다.</p>\n<p>예를 들어 많은 사용자 입력을 받는 컴포넌트를 테스트하고 싶다면 이런 방식으로 테스트 해 볼 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> userChangeCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'Test1\'</span><span class="token punctuation">,</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">{</span> toLowercase<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'testPre\'</span><span class="token punctuation">,</span>\n  result<span class="token punctuation">:</span> <span class="token string">\'testpre\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  onDataChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'On Change Cases\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    userChangeCases<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> item<span class="token punctuation">.</span>value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onDataChange<span class="token punctuation">)</span><span class="token punctuation">.</span>\n          <span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>resultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그리고 나중에 추가로 사용자 입력 케이스를 테스트할 때 손쉽게 <code class="language-text">userChangeCases</code> 배열에 추가하면 됩니다. 게다가 다른 컴포넌트에 비슷한 테스트를 해야하면 복사하기도 쉽습니다.</p>\n<p>사실 이렇게 제가 따르고 있는 작은 규약들을(beforeEach로 매 테스트마다 wrapper 지정하기, 이름 짓는 방법, props 객체에 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Spread_operator">전개 연산자--MDN 문서 영문판으로 다시 보시길 권장합니다--</a>  사용하기) 어딘가에 정의해두면 다른 사람들이 쉽게 이해하고 자신의 컴포넌트를 테스트 할 때 유용하게 테스트 작동 원리를 베껴갈 수 있습니다.</p>\n<p>이 예는 다소 부자연스럽지만(저는 일반적으로 테스트에 따라 입력 값 변화를 처리하는 순수 함수를 만듭니다) 전체 시스템이 작동하는지 여부를 신속하게 알 수 있으며, 복잡한 입력을 수행하지 않는 경우 필요에 맞게 적절하게 사용 할 수 있습니다.</p>\n<h2 id="enzyme-mount-vs-shallow"><a href="#enzyme-mount-vs-shallow" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enzyme: Mount vs Shallow</h2>\n<p><code class="language-text">shallow</code> 는 “순수 단위 테스트” 방식의 접근입니다. 단순히 여러분이 테스트하고자 하는 컴포넌트아 DOM을 본떠서 그 컴포넌트가 어떤 역할을 수행하는지 테스트합니다. 이런 방식의 테스트는 더 빠르게 동작합니다.</p>\n<p>아주 괜찮은 것 같지만, 여러분은 무엇을 테스트하고자 하는지 신경 쓰셔야 합니다. 각각의 컴포넌트를 완벽하게 분리하고 전체 단위 테스트 커버리지를 높이는게 목표인가요? 아니면 여러가지 문제가 될 수 있는 경우를 테스트하고 그 과정에서 컴포넌트가 제대로 동작하는지를 확인하는게 목표인가요?</p>\n<p>전자의 경우는 <code class="language-text">shallow</code> 를 사용하는게 아마 완벽한 해결책이겠지만 후자의 경우는 <code class="language-text">mount</code> 를 쓰는 게 좀 더 이상적입니다.</p>\n<p><code class="language-text">mount</code> 는 컴포넌트에 속한 모든 것을 가상화(simulates)합니다. 말인즉슨 자손 컴포넌트(예를 들어 특별한 입력 컴포넌트라던가)를 잡아내서 입력값의 변화를 테스트해볼 수도 있습니다. 이렇게 사용자의 동작을 흉내내면서도 테스트하고자 하는 컴포넌트를 부모 컴포넌트와 그 주변 환경에서 분리할 수 있습니다.</p>\n<p>또한 <code class="language-text">mount</code> 는 <a href="https://velopert.com/1130">리액트의 라이프사이클 메서드(lifecycle methods)</a>를 가상화할 수 있습니다. 특정 라이프사이클 메서드에 많은 로직이 있는 복잡한 컴포넌트를 테스트할 때도 유용합니다.</p>\n<p>텍스트 기반의 컴포넌트를 <code class="language-text">mount</code> 로 테스트하는 예를 보여드리겠습니다.</p>\n<p>(제 실수를 지적해주신 <a href="https://medium.com/@ywcoder">Ying Wang</a>님께 감사드립니다. <code class="language-text">shallow</code> 도 마찬가지로 컴포넌트 안의 html 요소를 가상화합니다. 자손 컴포넌트를 다루지 않을 뿐입니다. 이에 맞추어 글을 수정했습니다.)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> CustomInput <span class="token keyword">from</span> <span class="token string">\'./CustomInput.jsx\'</span><span class="token punctuation">;</span>\n<span class="token comment">/*\nCustomInput 컴포넌트 안에는 이렇게 생긴 input 태그가 있고\n&lt;input type="text" disabled={this.props.disabled} onChange={this.props.onChange}\nTextComponent는 이 컴포넌트로 prop을 전달합니다.\n*/</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'Nothing\'</span><span class="token punctuation">,</span>\n  onChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'OnChange called\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'TestVal\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onChange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>\n      expect<span class="token punctuation">.</span><span class="token function">objectContaining</span><span class="token punctuation">(</span><span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이벤트가 올바르게 전달되었는지 확인</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'isDisabled prop works\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isDisabled<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">\'disabled\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 방식의 테스트는 통합 테스트와 단위 테스트와의 경계를 흐리게 하지만, Guillermo Rauch는 이렇게 말했습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Write tests. Not too many. Mostly integration.</p>&mdash; Guillermo Rauch (@rauchg) <a href="https://twitter.com/rauchg/status/807626710350839808?ref_src=twsrc%5Etfw">December 10, 2016</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> \n<p>Kent C. Dodds도 이 트윗에 대해 <a href="https://emaren84.github.io/posts/write-mostly-integration-test-kr">글을 썼는데</a> 꽤 설득력 있습니다.</p>\n<p>제 생각에 두 종류의 테스트 모두 적합한 경우가 있습니다만, 제가 만든 대부분의 애플리케이션에서 단위 테스트를 하기에는 시간이 아깝고 저는 세부 구현이나 기반에 깔린 코드를 테스트하기보다 실제로 동작하는 부분을 테스트하는데 집중하고 싶습니다. 저도 계속 (실용적인 테스트의) 중심을 잡아보려고 노력중입니다.</p>\n<p>요즘은 기본적으로 <code class="language-text">mount</code> 를 사용하고 테스트 퍼포먼스에 영향이 가는 경우에만 <code class="language-text">shallow</code> 를 사용하고 있습니다. 두 경우의 API가 약간 다르므로 특정 작업을 테스트하는 방법을 더 쉽게 기억할 수 있습니다.</p>\n<h2 id="redux-테스트는-흥미로워요-"><a href="#redux-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%ED%9D%A5%EB%AF%B8%EB%A1%9C%EC%9B%8C%EC%9A%94-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redux 테스트는… 흥미로워요 😕</h2>\n<p>반면에 리덕스 액션과 리듀서는 무진장 테스트하기 쉽습니다. 그저 함수일 뿐 아니라 리듀서는 어떠한 부수 효과도 없는 순수 함수여야 합니다.</p>\n<p>하지만 redux-thunks나 redux-saga를 사용하고 계시다면 조금 흥미로운(?) 일이 되고, <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트 하는 일은 더욱 복잡해지게 됩니다.</p>\n<p>Thunk와 Saga는 다른 액션을 대신 보내주면서 비동기 작업을 다루는 일을 합니다. 그래서 스토어를 본뜬 다음에 무슨 액션이 보내졌는지 확인해야하고, 부수 기능도 본떠야 합니다. 매번 테스트할때마다 실제 데이터베이스 호출 등을 하면 안되니까요.</p>\n<p>Saga는 최소한 <a href="https://redux-saga.js.org/docs/advanced/Testing.html">테스트 가능하도록 디자인 되어있고</a> 테스트에 도움되는 기능들을 가지고 있지만, Thunks는 부수 작업이 끝날때까지 대기가 걸리게 만듭니다.</p>\n<p>결국 이런 질문으로 이어지게 되지요. “어느 부분까지 테스트 할 것인가?”</p>\n<p>리덕스 앱을 전체적으로 테스트하기 위한 <a href="https://redux.js.org/docs/recipes/WritingTests.html">좋은 자료</a>가 있습니다만, 여러분이 직접 작성한 코드 말고 리덕스를 테스트하는데 무슨 의미가 있을까요? 리덕스 자체는 완전히 테스트를 마친 라이브러리라서 우리가 같은 테스트를 또 할 필요는 없습니다. 게다가 <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트하는건 굉장히 복잡하기 때문에 앱의 큰 부분을 본떠야 하는 불편함을 감수해야 합니다.</p>\n<p>저는 액션을 제대로 보내기만 하면 리덕스 스토어가 이를 받아서 처리할거라고 확신합니다. 제가 진짜 신경쓰는 부분은 컴포넌트가 그 액션을 잘 받아서 제대로 변화가 일어나는지 확인하는 겁니다. 통합 테스트의 영역이지요.</p>\n<p>그래서 제가 테스트를 할 때는</p>\n<ol>\n<li>먼저 리듀서를 테스트합니다. 테스트하기도 쉽고 중요한 기능을 가지고 있으니까요.</li>\n<li>그리고 리덕스에 연결되지 않은 컴포넌트를 테스트합니다. 특정 이벤트에 제대로 반응하는지 확인할 수 있습니다. 그리고 테스트하기 쉬운데다 데이터를 다루는 부분과 랜더링을 다루는 부분을 분리하여 볼 수 있습니다.</li>\n<li>복잡한 데이터를 다루는 부분을 순수 함수로 빼내어 테스트합니다.</li>\n<li>제 앱의 각 부분이 잘 맞아떨어지는지 확인하기 위해 Selenium을 써서 E2E(end to end) 테스트와 통합 테스트를 합니다.</li>\n</ol>\n<p>이 방법이 완벽한 방법은 아닙니다. 저는 아직 마지막 두 부분을 처리하기 위한 최상의 방법을 찾고 있습니다만, 이 방법들도 테스트 작성을 간단하게 해주며 생산적이라는 생각이 듭니다.</p>\n<p>매번 제가 동료들에게 리덕스에 연결된 컴포넌트를 다 테스트해서 보여줄 때마다 그들의 눈에는 동공지진이 일어납니다(their eyes instantly start glazing over). 많은 로직이 있고 본떠서 다루어야 할 것도 많습니다. 이런 복잡한 것들을 제쳐두면 일이 더 쉬워지며 사용자(혹은 매니저)를 우선적으로 고려한 유형의 테스트를 작성하는데 집중할 수 있습니다. 대부분의 프로젝트에 테스트를 작성할 시간이 얼마나 적은지를 생각한다면 괜찮은 등가교환이라 생각합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 아직도 테스트를 적절하게 하는 법을 배우고 있습니다. 그리고 지난 1년동안 많은 자료를 읽기도 하고 보기도 했습니다. 여러분이 자신만의 패턴을 만들면 Jest와 Enzyme으로 단위 테스트하는건 놀라우리만치 쉽습니다. 특히 리덕스의 복잡한 부분을 통합 테스트와 E2E 테스트로 옮기는 경우에도 유용합니다.</p>\n<p>Jest와 Enzyme을 다루는게 어렵다면 <a href="https://www.reactiflux.com/">ReactFlux</a>를 방문해보세요. 거기 있는 Jest 채널에서 많은 도움을 얻었습니다.</p>\n<p>이제 막 Jest + Enzyme으로 테스트를 시작하신다면 <a href="https://hackernoon.com/testing-react-components-with-jest-and-enzyme-41d592c174f">이 훌륭한 가이드</a>를 읽어보세요.</p>\n<p>스냅샷 테스트에 대해 더 자세히 알아보시려면 <a href="https://hackernoon.com/how-to-snapshot-test-everything-in-your-redux-app-with-jest-fde305ebedea">이 가이드</a>를 참고하세요.</p>\n<p>마찬가지로 React, Redux, Jest의 공식 문서를 꼭 살펴보세요. 모두 최고 수준의 가이드를 제공합니다.</p>\n<p>이 글이 여러분의 테스팅을 향한 여정에 도움이 되었으면 좋겠습니다. 어떠한 질문이나 코멘트가 있다면 <a href="https://twitter.com/tetheta">트위터로</a> 연락주세요.</p>',id:"/home/circleci/repo/src/pages/posts/2018-01-27-lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-27",path:"/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr",title:"[번역] 리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트 하며 얻은 교훈",tags:["Testing","React","Javascript"],
category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p><a href="/posts/what-is-testing-javascript-kr">지난번</a> <a href="/posts/write-mostly-integration-test-kr">시리즈</a>를 통해 테스트가 무엇인지, 어떤 방향으로 테스트를 해야할지 조금 감을 잡으셨을 겁니다. 이제 본격적으로 리액트 애플리케이션을 테스트하고자 하는데, 또 한번 막히게 되죠.</p>\n<blockquote>\n<p>통합 테스트가 좋다는 건 알겠는데 좀더 실전에 가까운 예가 필요하다</p>\n</blockquote>\n<p>라고 생각하실지 몰라서 (저도 그렇게 생각하기 때문에) 남은 두 번의 번역 시리즈는 리액트 + 리덕스 애플리케이션 개발 시 테스트를 어떻게 했는지, 참고할만한 팁을 번역할 예정입니다.</p>\n<p>참고로 원작자는 ‘Redux app’ 이라는 용어를 계속 사용하고 있어서 저도 그냥 리덕스 앱이라고 번역했습니다. (앵귤러도 리덕스 쓸 수 있는데...) 또한 mocking(흉내내기, 모조품 만들기)의 번역이 부자연스러워 바로 음차했습니다. 더 좋은 표현이 있다면 제안 부탁드립니다.</p>\n<p><a href="https://hackernoon.com/low-effort-high-value-integration-tests-in-redux-apps-d3a590bd9fd5">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p><strong>짧은 정리: 여러분은 노드 환경에서 앱을 랜더링하고, 사용자 동작을 흉내내며 상태나 마크업의 변화를 확인할 수 있습니다. 이런 테스트는 상대적으로 작성하기 쉽고 빠르게 작동하며 이를 통해 많은 자신감을 얻을 수 있습니다.</strong></p>\n<p>효율적인 소프트웨어 테스트를 작성하는 일은 아슬아슬한 줄타기 같습니다(tricky balancing act). ‘효율성’ 이라는 용어는 실행 속도나 자원 소모를 의미하는 것이 아니라, 테스트를 작성하는데 드는 노력과 테스트가 제공하는 가치 사이에서 최고로 얻어낼 수 있는 절충안을 의미합니다.</p>\n<p>이 문제는 알려지지 않았거나 전혀 새로운 문제가 아닙니다. 과거에 수 많은 똑똑한 사람들이 달려들었고, 나중에 이 문제에 맞딱뜨릴 개발자를 위해 가이드라인을 만들었습니다. 저는 <a href="https://martinfowler.com/bliki/TestPyramid.html">테스팅 피라미드</a>를 신봉합니다. 테스팅 피라미드는 다양한 종류의 테스트를 제대로 다루는데 앞서, 각각의 코드를 개별적으로 다루는 단위 테스트(Unit test)가 기반이 되어야 한다고 강조합니다.</p>\n<h2 id="단위-테스트와-리덕스redux"><a href="#%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%EB%A6%AC%EB%8D%95%EC%8A%A4redux" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단위 테스트와 리덕스(Redux)</h2>\n<p>리덕스가 제시하는(역주: ‘강요하는’ 에 가까운 어감으로 느껴집니다) 구조 덕에 단위 테스트를 아주 쉽게 작성할 수 있습니다. 서로 분리되어있는 부분(리듀서, 액션 생성자, 컨테이너 등)을 각각 불러와서 여타 순수 함수와 똑같이 테스트 하면 됩니다. 데이터를 집어넣고, 나온 데이터를 단언(assertion)과 맞춰봅니다. 모킹(mocking)을 할 필요가 없지요. <a href="http://redux.js.org/docs/recipes/WritingTests.html">리덕스 문서 안에 있는 테스팅 가이드</a>에 각 부분의 단위 테스트를 하는 방법이 작성되어 있습니다.</p>\n<p>이 가이드를 따라가면서 지루하게 리듀서끼리, 액션 생성자끼리 테스트를 복-붙(copy-paste) 하다보면 단위 테스트 작성을 끝낼 수 있습니다. 그렇게 모든 작업이 끝나면 테스팅 피라미드가 뒷통수를 때리죠. 단순히 단위 테스트만 가지고는 ‘이 앱이 제대로 작동하는가?’ 라는 가장 기본적인 질문에 답할 수가 없습니다.</p>\n<h2 id="피라미드-오르기"><a href="#%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C-%EC%98%A4%EB%A5%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>피라미드 오르기</h2>\n<p>웹 애플리케이션을 작성하면서 테스팅 피라미드의 윗 단계로 올라가는데 몇 가지 방법이 있습니다. 맨 꼭대기에 있는 end-to-end(e2e) 계층은 Selenium과 <a href="http://webdriver.io">webdriver.io</a>를 사용해서 구현할 수 있습니다. 이런 종류의 테스트는 기술 독립적이라 여러분이 다른 프레임워크를 사용하도록 앱을 포팅해도 잘 작동합니다. 하지만 구현하고 돌려보는데 오래 걸리고, 디버그하기도 어려우며, 종종 원인 모를 문제에 시달릴 수 있습니다. 보통 아주 적은 종류의 e2e 테스트만 프로젝트에 적용하게 됩니다.</p>\n<p>그렇다면 e2e테스트와 단위 테스트 사이에 있는 계층은 어떨까요? 일반적으로 이런 테스트를 통합 테스트(integration test)라고 부릅니다. 애플리케이션의 모듈이 어떻게 상호작용하는지 테스트하지요. 통합 테스트의 범위는 넓습니다. 예를 들자면 액션을 보내기 위해(dispatch) 액션 생성자를 사용하는 리듀서를 테스트한다면 이미 단위 테스트의 범위를 넘어간 겁니다. 다른 측면에서 보면 e2e 테스트는 아주 극단적인 형태의 통합 테스트라고 볼 수 있습니다.</p>\n<p>우리는 리덕스에서 통합 테스트 하기에 아주 적절한 지점(sweet-spot)을 찾아보려 합니다. 개발 과정에서 충분히 빨리 돌려볼 수 있어야 하고, 단위 테스트와 같은 테스트 환경을 사용해야 하면서 리덕스로 관리되는 애플리케이션이 제대로 동작하고 있다는 충분한 확신을 줄 수 있어야 합니다.</p>\n<h2 id="범위를-찾기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EC%B0%BE%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 찾기</h2>\n<p>우선 테스트 하고자 하는 범위를 설정하는 게 좋은 출발점이 됩니다. 일반적인 웹 앱은 이런 방식으로 구성되어있는데요.</p>\n<p><img src="https://cl.ly/271c282D101g/typical-webapp-structure.png" alt="일반적으로 고도화된 웹앱의 구조"></p>\n<p>시스템의 일부는 올바른 테스트 결과를 얻기 위해 모킹되어야 합니다. 제일 제약이 심한 부분이 저 맨 꼭대기 위에 있는 ‘브라우저’입니다. (비록 헤드리스-Headless 라도) 브라우저 인스턴스를 띄워서 테스트를 돌리는 일은 Node.js(이하 노드)에서 테스트 코드를 실행하는 것보다 훨씬 오래 걸립니다. 시작부터 끝까지 진짜 요청이 끝나길 기다릴 필요는 없습니다. 네트워크 계층(역주: 프론트엔드와 백엔드 사이에 통신하는 부분을 지칭하는 것으로 보입니다)은 명확히 정의된 인터페이스라서 적절히 모킹하기 쉽습니다.</p>\n<h2 id="범위를-모킹하기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EB%AA%A8%ED%82%B9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 모킹하기</h2>\n<p>리액트와 리덕스를 쓰는 앱이 있다고 가정하면, 노드 환경에서 부드럽게 돌아가는 테스트를 작성하는게 꽤 쉽습니다(심지어 서버 사이드 랜더링을 한다면 프로덕션 환경에서도 가능합니다). <a href="https://facebook.github.io/jest/">Jest</a>라는 걸출한 테스팅 프레임워크로 테스트를 돌릴 수 있는데다, 마찬가지로 대단한 <a href="https://github.com/airbnb/enzyme">Enzyme</a>은 브라우저 환경 없이 애플리케이션의 일부 혹은 전체를 랜더링해주고 동작을 확인해볼 수 있게 만들어주기 때문입니다.</p>\n<p>Enzyme은 <code class="language-text">mount</code> 라는 함수를 제공하는데, 이 함수로 어떠한 리액트 컴포넌트라도 그려내고 동작을 확인해볼 수 있습니다. 리덕스를 쓰는 앱도 마찬가지로 테스트 가능합니다. 매번 테스트할 때 같은 코드를 반복하지 않기 위해 간단한 유틸리티 함수를 작성해두면 도움이 됩니다. 이 함수는 주어진 상태(Redux 스토어)와 Enzyme의 래퍼 객체(역주: Enzyme을 통해 그려진 컴포넌트를 객체화 한 것. 이후 다양한 메서드를 통해 하위 DOM 탐색 및 다양한 동작을 확인해볼 수 있습니다)를 리턴합니다. 이렇게 만들어둔 함수는 나중에 단언 작성을 꽤 편하게 해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react-redux\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'enzyme\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> MyApp <span class="token keyword">from</span> <span class="token string">\'./containers/MyApp\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> createStore <span class="token keyword">from</span> <span class="token string">\'./createStore\'</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">></span>\n      <span class="token operator">&lt;</span>MyApp <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nwrapper\n  <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'hello\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>노드 환경에서 테스트를 실행할 때 네트워크 계층을 깔끔하게 모킹하는 방법이 있습니다. 예를 들어 <a href="https://github.com/node-nock/nock">nock</a> 같은 라이브러리가 있지요. nock은 테스트를 실행하기 전에 네트워크 요청에 따른 응답 데이터나 에러를 쉽게 선언할 수 있도록 만들어줍니다. 성공적인 GET 요청을 모킹하는 예는 다음과 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">\'nock\'</span><span class="token punctuation">;</span>\n<span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://example.com/api\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 이후 코드 어디에서나 https://example.com/api/1234 로 요청을 하면</span>\n<span class="token comment">// 성공했다는 응답과 함께 { foo: \'bar\' } 를 응답값으로 리턴하게 됩니다.</span>\n</code></pre>\n      </div>\n<p>이렇게 설정하면 통합 테스트를 단위 테스트와 비슷한 수준으로 빠르고 편하게 실행할 수 있습니다. 이제 테스트를 구현하기만 하면 됩니다...</p>\n<p><img src="https://cl.ly/3j3q0t3Q0b2G/mock-boundaries.png" alt="리덕스 통합 테스트를 위해 테스트 범위 모킹"></p>\n<h2 id="무엇을-테스트하나"><a href="#%EB%AC%B4%EC%97%87%EC%9D%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무엇을 테스트하나?</h2>\n<p>여러분이 만든 앱이 정상적으로 동작한다는 자신감을 가장 크게 얻으려면 사용자의 시점에서 통합 테스트를 작성해야 합니다. 버튼 클릭, 폼 채우기 등의 사용자가 조작하는 행위에 따라 앱이 기대한대로 반응하는지 확인하는게 목표입니다.</p>\n<p>간단한 폼을 제출한다는 시나리오를 생각해 보겠습니다. 데이터가 폼에 들어있는 상태로 랜더링 한 뒤에 사용자가 ‘제출’ 버튼을 누르는 행위를 흉내를 내 보겠습니다(simulate). 그리고 지정된 API 엔드포인트로 요청을 제대로 보내는지 확인해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Submitting the form\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> submitButton <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'[type="submit"]\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'sends the data and shows the confirmation page\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://myapp.com/api\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    submitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 이제 무슨 일이 일어나는지 확인합니다</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="언제-테스트하나"><a href="#%EC%96%B8%EC%A0%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>언제 테스트하나?</h2>\n<p>본격적으로 단언을 작성하기 전에, 또 하나의 문제가 있습니다. “테스트를 언제 실행하냐” 인데요(역주: 테스트 코드를 실행하는 행위가 아니라 모든 작업이 다 끝나고 기대값과 결과값을 비교하는 ‘단언’ 을 의미하나봅니다). 모든 변화가 순차적으로 일어나는 단순한 상황에서는 사용자 동작을 흉내를 낸 뒤에 바로 단언을 실행하면 됩니다. 하지만 여러분의 앱은 보통 네트워크 요청 같은 비동기 코드를 다루기 위해 프로미스(Promise) 등을 사용할 겁니다. 네트워크 요청을 순차적으로 실행되게 모킹해놓았다 하더라도, 성공한 프로미스는 <code class="language-text">submitButton.simulate(&#39;click&#39;)</code> 부분 다음의 코드를 바로 실행할겁니다. 우리는 단언이 실행되기 전에 앞선 작업이 “제대로 끝나기를” 기다리게 해야합니다.</p>\n<p>Jest는 여러가지로 비동기 코드를 다루는 방법을 제공하지만, Promise 체인을 직접 다루는 방식으로 동작하거나(이번 예시에는 없지요) , 타이머를 모킹해야 합니다(Promise 기반 코드에는 동작하지 않습니다). <code class="language-text">setTimeout(() =&gt; {}, 0)</code> 같은 코드를 사용할 수 있지만 <a href="https://facebook.github.io/jest/docs/en/asynchronous.html">Jest의 비동기 콜백 기능</a>을 사용해야 해서 코드의 가독성이 떨어지게 됩니다.</p>\n<p>하지만 이 문제를 멋지게 해결하기 위해 한 줄짜리 보조 함수를 사용하면 됩니다. 이 함수는 성공한 Promise를 이벤트 루프의 바로 다음 차례로 넘기는 일을 합니다. Jest에서 기본적으로 지원하는 Promise 리턴과 같이 사용하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">flushAllPromises</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=></span> <span class="token function">setImmediate</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'runs some promise based code\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">triggerSomethingPromiseBased</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise 기반의 동작 실행</span>\n  <span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n     <span class="token comment">// 무슨 일이 일어나는지 확인하기</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="어떻게-테스트하나"><a href="#%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어떻게 테스트하나?</h2>\n<p>사용자와 앱의 상호작용이 제대로 이루어지고 있나 확인하려면 어떤 방법이 있을까요?</p>\n<p><strong>마크업(Markup)</strong> - UI가 제대로 변경되었는지 확인하기 위해 페이지의 마크업을 들여다볼 수 있습니다. 예를 들어 <a href="https://facebook.github.io/jest/docs/snapshot-testing.html">Jest의 스냅샷 기능으로요.</a> (유의할 점: 아래의 테스트 코드를 실행하기 위해 <a href="https://github.com/adriantoine/enzyme-to-json#serializer">enzyme-to-json</a>같은 Jest 스냅샷 직렬화 모듈(serializer)을 설치해야 합니다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 방식의 단언은 작성하기 아주 쉽지만, 어디에 문제가 있는지 살펴보기 어려워지는 경향이 있습니다. 스냅샷은 가끔 겉으로 보기에 상관없어 보이는 테스트가 실패할 때도 변할 수 있습니다. 게다가 변화가 있었는지 확인만 할 뿐 무슨 행동을 했는지 기록을 남기진 않습니다.</p>\n<p><strong>상태(State)</strong> - 애플리케이션의 상태 변경을 확인하는 방법입니다. 한 곳에 집중된 스토어를 가지고 있는 리덕스 애플리케이션은 테스트하기 쉽지만, 상태가 나뉘어있다면 조금 복잡해질 수 있습니다. 이 때도 스냅샷 테스트를 할 수 있지만 저는 객체를 직접 비교하는 방식을 선호하는 편입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n    confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>상태 스토어는 사용자가 보지 못하는 곳에 감추어져 있기 때문에 사용자 중심적인 테스트와는 약간 거리가 있습니다. 하지만 디자인 변경에 따른 마크업 수정이 일어나는 경우 영향을 덜 받습니다.</p>\n<p><strong>부수 기능(Side effects)</strong> - 여러분의 애플리케이션에 따라 확인해야 하는 부수 기능도 있습니다(네트워크 요청, <code class="language-text">localStorage</code> 변화 등). 이럴 때 nock의 <code class="language-text">isDone</code> 메서드를 활용하여 모킹한 요청이 실제로 사용되었는지 확인할 수도 있습니다. </p>\n<p><strong>액션 보내기(Dispatched actions)</strong> - 리덕스의 기능을 십분 활용하여 어떤 액션이 발생했는지 쉽게 로그를 정리하고 나열할 수 있습니다. 이를 이용해서 스토어에 액션을 보내는 흐름을 확인해볼 수 있습니다. <a href="https://github.com/arnaudbenard/redux-mock-store">redux-mock-store</a> 같은 유용한 라이브러리의 도움을 받을 수도 있습니다. 먼저 위에서 정의한 <code class="language-text">renderAppWithState</code> 메서드를 조금 수정해서 가상의 리덕스 스토어를 적용하면, 그 다음 스토어에 어떤 액션들이 호출되었는지 확인하기 위해 <code class="language-text">getActions</code> 메서드를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token comment">// 이제 renderAppWithState는 redux-mock-state를 사용해서 스토어를 생성합니다.</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getActions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_START\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> \n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_SUCCESS\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 유형의 단언은 특히 코드가 비동기로 흘러갈 때 테스트 하고자 할 때 유용합니다. 또한 테스트 시나리오가 어떤 흐름으로 구성되는지 보여주면서 일종의 문서 역할을 합니다.</p>\n<h2 id="중심-잡기"><a href="#%EC%A4%91%EC%8B%AC-%EC%9E%A1%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>중심 잡기</h2>\n<p>앞서 소개한 통합 테스트가 단위 테스트를 완전히 대체한다는 뜻은 아닙니다. 특히 애플리케이션에 무거운 로직이 있는 부분(리듀서나 셀렉터)은 여전히 철저하게 단위 테스트가 적용되어야 합니다. 테스팅 피라미드의 계층은 여전히 유효합니다! 하지만 통합 테스트는 테스트 방법 중 하나로서 충분히 유효하며, 가능한 한 고통을 덜고 더 자신있게 소프트웨어를 배포할 수 있도록 좋은 테스트를 구축하는데 도움이 됩니다.</p>\n<p>소프트웨어 테스트라는 주제는 업계에서 가장 많이 오가는 주제 중 하나입니다. 제 동료는 제 글을 검수해주면서 “<a href="http://blog.thecodewhisperer.com/permalink/integrated-tests-are-a-scam">통합 테스트는 사기다</a>” 라는 글을 알려주기도 했습니다. 어떤 사람들은 저 글을 쓴 사람이 맞다고도 하지만, 제가 생각하기에 흑백 논리로 따질 수 없는 주제라고 생각합니다. 여러분은 어떻게 생각하시나요?</p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-19-intergration-tests-in-redux-apps-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-19",path:"/posts/integration-tests-in-redux-apps-kr",title:"[번역] 리덕스 앱을 저비용 고효율로 통합 테스트 하기",tags:["Testing","React","Javascript"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며번역-서문"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며(번역 서문)</h2>\n<p>“더 좋은 테스트를 위한 번역 시리즈” 두 번째입니다. 테스트를 작성하는게 좋다는 공감대는 얻었을 지 몰라도 막상 코드 에디터 앞에서는 대략 정신이 멍해지기 일쑤입니다. 전부 다 테스트를 하자니 너무 광범위하고, 함수 단위로 유닛 테스트만 작성하자니 너무 세세해서 실제 제대로 애플리케이션이 동작하는지 파악하기도 어렵거니와 노력 대비 별로 쓸모가 없어보이기도 합니다.</p>\n<p>그 고민을 조금이나마 덜어드리고자 좋은 조언을 가져와서 번역해 보았습니다.</p>\n<p><a href="https://blog.kentcdodds.com/write-tests-not-too-many-mostly-integration-5e8c7fff591c">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p>얼마 전에 <a href="https://medium.com/@rauchg">Guillermo Rauch</a>(<a href="https://socket.io">Socket.io</a>의 창시자이자 <a href="https://zeit.co">Zeit.co</a>의 설립자입니다)가 위 제목으로 <a href="https://twitter.com/rauchg/status/807626710350839808">심오한 트윗</a>을 하나 작성했습니다. </p>\n<p><img src="https://cl.ly/1w0Q053W1B1O/write-integration-test-2.png"></p>\n<blockquote>\n<p><strong>테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>짧지만 긴 내용입니다. 더 자세히 들어가보죠.</p>\n<blockquote>\n<p><strong>테스트를 작성하라.</strong></p>\n</blockquote>\n<p>네, 여러분은 대부분의 프로젝트에 자동화된 테스트를 작성해야 합니다. 특히 자신의 시간을 소중히 여긴다면요. 새벽 두 시에 버그 때문에 불려나가는 것 보다 로컬에서 버그를 잡아내는게 훨씬 낫습니다. <strong>저는 테스트를 작성하는데 시간을 들일 때 오히려 시간을 절약한다고 느낍니다.</strong> 테스트를 작성하다 보면 제가 실제로 만들고자 하는 것 보다 더 오래 걸릴 수도 있고, 그렇지 않을 수도 있지만, 저는(그리고 다른 사람들도) 거의 확실히 유지보수 하는데 드는 시간을 절약하고 있습니다.</p>\n<p>테스트를 작성할 때는 이 테스트가 프로젝트의 버그를 얼마나 줄여줄 자신이 있는지 신경쓰셔야 합니다. <a href="https://flow.org/">Flow</a>, <a href="https://eslint.org/">ESLint</a> 같은 정적 타이핑이나 린트는 의미있는 수준의 자신감을 가져다 줍니다. 혹시 써보지 않으셨다면 반드시 살펴보시길 권합니다. 하지만 <strong>아무리 강한 타입을 적용한 프로그래밍 언어라도 테스트가 있어야 합니다.</strong> 타입과 린트는 여러분의 비지니스 로직에 버그가 없도록 만들어주지 않습니다. 그러니 좋은 테스트를 작성해서 (버그를 줄인다는)자신감을 크게 끌어올릴 필요가 있습니다.</p>\n<blockquote>\n<p><strong>너무 많이는 말고.</strong></p>\n</blockquote>\n<p>저는 애플리케이션에 100%의 코드 커버리지를 달성하려는 매니저나 팀이 있다고 들었습니다. 이는 굉장히 안 좋은 생각입니다. 커버리지가 70%(제 추측입니다.. 과학적인 증거는 없어요)를 넘어가게 되면서부터 여러분이 테스트로 얻는 이익이 점감하게 되는 문제가 있습니다. 왜 그럴까요? 음, 언제나 100%를 달성하기 위해 힘을 쏟다 보면 막상 테스트 할 필요 없는 것을 테스트하는데 시간을 소모하게 됩니다. 실제 신경써야 할 로직이 없는 것들 말이죠(ESLint나 Flow로도 충분히 잡아낼 수 있는 모든 버그들). <em>이런 규모의 테스트를 유지보수하는데 엄청난 시간이 들고 여러분의 팀을 힘들게 만들 겁니다.</em></p>\n<p>그리고 테스트 환경에서 재현하기 어려운 한 줄의 코드를 위해 테스트를 작성할 때도 있습니다. 이런 경우는 <em>진짜로</em> 피하고 싶을겁니다. 왜냐면 이 테스트는 애플리케이션이 제대로 작동한다는 자신감을 별로 주지도 못하고, 리팩터링 할 때 속도를 늦출 뿐이기 때문입니다. <strong>코드를 리팩터링 할 때 테스트를 변경해야 하는 경우는 거의 없습니다.</strong></p>\n<p>제가 작성한 대부분의 오픈 소스 프로젝트는 거의 100%의 코드 커버리지를 가지고 있다는 말씀을 드려야겠군요. 대부분의 프로젝트들은 작은 라이브러리나 툴이며, 여러 다른 상황(코드가 깨진다면 심각한 상황으로 이어질 수 있는 프로젝트들이 사용하는 상황)에서 재사용하기 쉽도록 작성되었습니다. 그래서 어찌저찌 상대적으로 100%의 커버리지를 얻을 수 있었습니다.</p>\n<blockquote>\n<p><strong>통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>테스트의 종류는 아주 다양합니다(제가 Fluent Conf에서 <a href="https://youtu.be/Da9wfQ0frGA">“바퀴를 테스트하면서 배울 수 있는 것들”</a>이라는 제목으로 5분짜리 발표를 했습니다). 각각의 테스트는 장단점이 있습니다. 보통 자동화된 테스트를 이야기 할 때 많이 거론되는 테스트는 단위(Unit) 테스트, 통합(Integration) 테스트, E2E(End to End) 테스트입니다.</p>\n<p>여기 제가 <a href="https://frontendmasters.com/courses/testing-javascript/">“자바스크립트 애플리케이션 테스트하기”</a> 라는 Frontend Masters 워크샵에서 선보인 <a href="http://slides.com/kentcdodds/testing-workshop#/4/8">슬라이드</a>를 잠시 보시죠.</p>\n<p><img src="https://cl.ly/3x273a0A343P/write-integration-test-1.png"></p>\n<p>테스팅 피라미드는 <a href="https://martinfowler.com/bliki/TestPyramid.html">마틴 파울러의 블로그</a>와 <a href="https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html">구글 테스팅 블로그</a>에서 얻은 개념을 한데 합친 것입니다.</p>\n<p>앞서 말씀드린대로 이 피라미드는 바닥부터 꼭대기까지 단위 테스트, 통합 테스트, E2E 테스트로 이루어져 있습니다. 피라미드의 위로 올라갈수록 테스트를 실행하고 작성하는데 더 많은 시간이 들고, 실행하고 유지보수하는데 비용(시간과 자원 측면에서)이 많이 듭니다. 그림만 보면 유닛 테스트를 작성하는데 시간을 더 투자해야 하는 것 처럼 보입니다.</p>\n<p>미처 언급되지 않은 점이 있는데, 피라미드 위로 올라갈 수록 각 테스트의 신뢰성이 증가한다는 겁니다. 여러분이 생각한 것 보다 훨씬 큰 이득을 얻을 수 있습니다(You get more bang for your buck). 따라서 E2E 테스트가 단위 테스트보다 느리고 비용이 많이 들지라도, 애플리케이션이 의도대로 동작한다는 자신감은 더 크게 제공합니다.</p>\n<p><a href="https://twitter.com/kentcdodds/status/628658648001048577">제 트윗 중 가장 많이 리트윗된 트윗</a>이 단위 테스트의 주요 문제를 다루고 있습니다.</p>\n<blockquote>\n<p>아직도 이 사진을 좋아해요. 유닛 테스트만 좋아하는 사람들은 이렇게 “작동하는 것 같다” 라고 말하죠.  </p>\n</blockquote>\n<p><img src="https://cl.ly/093u1O2j0k1Y/write-integration-test-3.gif"></p>\n<p>이 사람이 방에서 달릴 수 있고, 팔굽혀펴기를 하고, 독서를 할 수 있는지 확인하기 위해 단위 테스트를 작성했지만, 이 사람은 자신의 다양한 신체 부위를 아주 효율적으로 사용하지 못하는데다 통합하지 않고 있습니다. 만약 버튼 컴포넌트가 <code class="language-text">onClick</code> 핸들러를 호출할 때 핸들러가 올바른 데이터를 제대로 요청하지 않는다면, 핸들러의 호출이 잘 되는지 확인하는 일은 그닥 중요한게 아닙니다! 각각 분리 된 부분이 자신의 역할을 제대로 수행하는지 확인하기 위해 단위 테스트를 작성하는 것은 그리 나쁜 일은 아닙니다. *분리 된 부분이 <strong>함께</strong> 제 역할을 수행하는지 확인하지 않는다면 아무 소용 없습니다.*</p>\n<p><strong>통합 테스트는 자신감을 심어주는 역할 대비 속도/비용을 부담하는 정도를 아주 균형있게 가지고 있습니다.</strong> 그래서 여러분이 <em>대부분</em>(혹시 몰라 말씀드리지만 전부는 아닙니다)의 시간을 통합 테스트에 투자하라는 조언을 드리는 겁니다.</p>\n<hr>\n<p><strong>통합 테스트를 더 많이 작성하는 방법</strong></p>\n<p>통합 테스트와 단위 테스트 사이의 경계는 약간 모호합니다. 어느 쪽이든 더 많은 통합 테스트를 작성하기 위해 가장 도움되는 것이 무엇이냐 물으신다면 <strong>일단 너무 많은 것을 모킹(mocking)하지 않기를 권합니다.</strong> <em>무언가를 모킹할 때, 테스트하고자 하는 것과 모킹된 것 사이의 통합테스트 신뢰도는 떨어지게 됩니다.</em> 때로는 이 방법이 도움 되지 않을 수 있습니다(<a href="https://www.youtube.com/watch?v=EaxDl5NPuCA&#x26;feature=youtu.be">반대하는 사람도 있지만요</a>). 실제로 매 테스트마다 이메일을 발송하거나 신용카드 결제를 할 필요는 없지만, 대부분의 경우 모킹을 피하면 테스팅을 더 잘 하게 되리라 생각합니다.</p>\n<p><strong>만약 리액트로 개발을 하고 계시다면, 얕은 랜더링(<a href="http://airbnb.io/enzyme/docs/api/shallow.html">shallow rendering</a>)도 포함됩니다.</strong> 저는 오랜 시간동안 얕은 랜더링은 세부 구현을 테스트하는 것이나 마찬가지라고 이야기해왔습니다. 이 부분을 <a href="https://www.briefs.fm/3-minutes-with-kent/49">3분 짜리 팟캐스트</a>에서(그리고 리액트 테스팅에 대한 다른 팁도 포함해서) 다루고 있습니다.</p>\n<p>도움이 되셨길 바라며 모두 행운을 빕니다! 👍</p>',id:"/home/circleci/repo/src/pages/posts/2018-01-15-write-mostly-integration-test-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-15",path:"/posts/write-mostly-integration-test-kr",title:"[번역] 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.",tags:["Translation","Testing","TDD"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>요즘 개인적으로 “가능한한 내 코드에 모두 테스트를 작성하겠다” 라는 목표를 가지고 있습니다. 하지만 테스트에 대해 두루뭉술한 개념만 가지고 있고, 지금은 상대적으로 쉬운 함수만 테스트를 작성할 수 있는 수준입니다.</p>\n<p>하지만 실제 개발하고 있는 애플리케이션은 ‘리액트 + 리덕스(혹은 MobX) + 기타등등’ 의 구성으로 되어있기 때문에 조금만 테스트를 제대로 해 보려고 하면 어디부터 손을 대야할지 전혀 감을 못 잡는 상태입니다.</p>\n<p>그래서 실전에 최대한 도움이 될 수 있도록 유용한 글을 몇개 추려서 단계별로 보기 좋은 참고서가 될 수있도록 번역하는 사이드 프로젝트를 진행하고 있습니다. 이 글을 보시는 분들도 리액트로 만드는 애플리케이션을 테스트하는데 도움이 되었으면 좋겠습니다.</p>\n<p>그 첫 번째 단계로 <strong>테스트가 대체 뭐냐?</strong> 라는 질문에 가벼운 답이 될 수 있는 글의 번역부터 시작합니다.</p>\n<p><a href="https://blog.kentcdodds.com/but-really-what-is-a-javascript-test-46fe5f3fad77">원문은 여기서 읽어보실 수 있습니다.</a></p>\n<hr>\n<p><em>일단 한 발짝 물러서서 시작부터 자바스크립트 자동화 테스트를 이해해 보도록 하겠습니다.</em></p>\n<p>소프트웨어를 테스트하는 이유는 수도 없이 많습니다. 저는 크게 두 가지 이유를 가지고 있습니다.</p>\n<ol>\n<li>전체 작업 흐름의 속도를 올려서 개발을 빠르게 한다.</li>\n<li>변경 사항이 있을 때 기존 코드를 무너트리지 않는다는 확신을 갖도록 도와준다.</li>\n</ol>\n<p>그래서 그런데, 저는 여러분에게 몇 가지 여쭈어 보고 싶은게 있습니다. (트위터 투표로 미리 물어보았죠)</p>\n<ul>\n<li><a href="https://twitter.com/kentcdodds/status/942625485829181441">자바스크립트 테스트를 작성해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625486638759938">자바스크립트 테스팅 프레임워크를 사용해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625487511154688">자바스크립트 테스팅 프레임워크를 밑바닥부터 설정해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625489348280320">테스팅 프레임워크를 충분히 이해하고 있고, 아주 간단한 테스팅 프레임워크라도 직접 만들어 보실 수 있습니까?</a></li>\n</ul>\n<p>이 글의 목적은 당신이 마지막 질문에 “네” 라고 대답할 수 있도록 돕는 것입니다. 결과적으로 자바스크립트를 테스트한다는게 무엇인지 알아야 더 좋은 테스트를 작성할 수 있으니까요.</p>\n<p>이제 간단한 <code class="language-text">math.js</code> 모듈을 만들어서 그 안에 두 함수를 작성한 다음에 내보내겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b\n<span class="token keyword">const</span> <span class="token function-variable function">subtract</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">-</span> b\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> sum<span class="token punctuation">,</span> subtract <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><strong>작성하는 모든 코드는 <a href="https://github.com/kentcdodds/js-test-example">Github에</a> 올려두었으니 참고하시면 됩니다</strong> 🐙😸</p>\n<h2 id="1단계"><a href="#1%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1단계</h2>\n<p>제가 생각할 수 있는 가장 기본적인 테스트 형식을 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// basic-test.js</span>\n<span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token boolean">true</span>\n<span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token boolean">false</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'${actual} is not ${expected}\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>터미널에서 <code class="language-text">node basic-test.js</code> 라고 입력하시면 이 테스트 코드를 실행할 수 있습니다. 이게 테스트입니다!</p>\n<p><strong>테스트는 기대하던 결과값과 실제 출력된 값이 맞지 않으면 에러를 일으키는 코드입니다.</strong> 만약 특정한 상태값 설정을 해야하는 등(예를 들자면 컴포넌트가 테스트 실행 전에 그려져야(Rendered on Document) 브라우저 이벤트를 확인해볼 수 있다던가, 데이터베이스에 있는 사용자를 가져온다던가) 특수한 경우에는 더 복잡해질 수 있습니다. 하지만 <code class="language-text">math.js</code> 모듈 같은 순수한 함수(Pure function - 입력값에 따른 출력값이 동일하며 외부의 상태에 영향을 미치지 않는 함수)은 상대적으로 쉽습니다.</p>\n<p><strong>코드의 <code class="language-text">actual !== expected</code> 부분을 “단언(assertion)” 이라고 합니다.</strong> 단언은 어떤 것이 특정한 값으로 되어있어야 한다거나 특정 테스트를 통과해야한다고 코드로 표현하는 것을 뜻합니다. <code class="language-text">actual</code> 부분이 어떠한 정규표현식에 일치해야하거나, 배열이 특정한 길이를 가지고 있어야 한다고 표현하는 것이 단언이 됩니다. 중요한 점은 만약 우리가 작성한 단언이 실패하면 에러가 일어나야 한다는 것입니다.</p>\n<p>그래서 <code class="language-text">math.js</code> 를 가장 기본적인 형태로 테스트 해 본다면 이렇게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 1.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>짜잔! 이 파일을 <code class="language-text">node</code> 커맨드로 실행해보면 에러 없이 실행되고 종료됩니다. 이제 <code class="language-text">sum</code> 함수의 <code class="language-text">+</code> 연산을 <code class="language-text">-</code> 연산으로 바꾸고 다시 실행해서 테스트를 깨지도록 만들어보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 1.js\n/Users/kdodds/Desktop/js-test-example/1.js:8\n  throw new Error(`${result} is not equal to ${expected}`)\n  ^\nError: -4 is not equal to 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/1.js:8:9)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>좋습니다! 우리는 벌써 기본적인 테스트를 사용해서 이득을 보고 있어요! 이제 테스트를 변경하지 않는 이상 <code class="language-text">sum</code> 함수를 마음대로 바꿀 수 없습니다. 쩌네요(Neato)!</p>\n<p><strong>테스팅 프레임워크(혹은 단언 라이브러리)의 가장 중요한 부분은 에러 메세지를 최대한 도움이 되도록 표현하는 겁니다.</strong> 테스트가 실패할 때마다 여러분이 제일 먼저 에러 메세지를 보게 됩니다. 만약 에러 메세지를 보고 어떤 문제가 밑에 깔려있는지 단박에 파악하지 못한다면, 몇분씩 코드를 직접 들여다보면서 뭐가 잘못됐는지 찾아야 합니다. 에러 메세지의 질은 여러분이 주어진 테스팅 프레임워크를 얼마나 잘 이해하고 적절한 단언을 사용하느냐에 따라서 크게 달라집니다.</p>\n<h2 id="2단계"><a href="#2%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2단계</h2>\n<p>사실 Node.js 가 위에서 만들어본 <a href="https://nodejs.org/api/assert.html#assert_assert"><code class="language-text">assert</code></a> 모듈을 내장하고 있다는 걸 알고 계셨나요🤔? 이 모듈을 써서 리팩터링을 해 보겠습니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 2.js</span>\n<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>좋아요! 저번에 작성했던 코드와 기능적으로 완전히 동일한 테스트 모듈을 작성해보았습니다. 딱 하나 다른게 있다면 에러 메세지입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 2.js\nassert.js:42\n  throw new errors.AssertionError({\n  ^\nAssertionError [ERR_ASSERTION]: -4 === 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/2.js:8:8)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>내용을 보시면 아쉽게도 에러가 더 이상 코드 내용을 보여주지 않고 있습니다. 😦 일단 계속 가보죠.</p>\n<h2 id="3단계"><a href="#3%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3단계</h2>\n<p>더 나아가서 직접 테스팅 “프레임워크” 와 단언 라이브러리를 작성해보겠습니다. 먼저 단언 라이브러리부터 시작해보죠. Node의 내장 <code class="language-text">assert</code> 모듈 대신에 <code class="language-text">expect</code> 라는 라이브러리를 만들어보겠습니다. 변경된 코드는 아래와 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 3.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 원하는대로 단언을 추가하고 객체를 리턴하도록 만들 수 있습니다(<code class="language-text">toMatchRegex</code>, <code class="language-text">toHaveLength</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 3.js\n/Users/kdodds/Desktop/js-test-example/3.js:17\n        throw new Error(`${actual} is not equal to ${expected}`)\n        ^\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/3.js:17:15)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/3.js:7:16)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>훨씬 보기 좋아졌네요.</p>\n<h2 id="4단계"><a href="#4%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4단계</h2>\n<p>그런데 만약 에러 메세지가 나온다 해도 정확하게 <code class="language-text">sum</code> 함수에 문제가 생겼다고 파악하려면 어떻게 해야할까요😖? 저 파일 안에는 <code class="language-text">subtract</code> 함수도 있는데 말이죠. 게다가 테스트 파일의 코드는 각각의 테스트를 적절히 분리하지 못하고 있습니다(시각적으로 + 기능적으로). </p>\n<p>그래서 헬퍼 함수를 만들어서 분리해보았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 4.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">try</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`- [x] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`✕ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 특정 테스트에 관련된 내용은 전부 “test” 콜백 안에 집어넣고, 테스트에 제목을 매길 수 있습니다. 그리고 <code class="language-text">test</code> 함수에 유용한 에러 메세지를 출력하도록 할 뿐만 아니라 모든 테스트를 한번에 실행할 수 있게 되었습니다(첫 번째 테스트에서 에러가 발생한다고 멈추지 않구요)!</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 4.js\n✕ sum adds numbers\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/4.js:29:15)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:6:18)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:17:5)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/4.js:3:1)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n- [x] subtract subtracts numbers</code></pre>\n      </div>\n<p>좋아요! 이제 에러 메세지 <em>뿐만 아니라</em> 어떤 부분을 고쳐야하는지 테스트 제목을 보고 찾아갈 수 있습니다.</p>\n<h2 id="5단계"><a href="#5%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5단계</h2>\n<p>마지막 단계로 모든 테스트 파일을 찾아서 실행하는 <a href="https://blog.kentcdodds.com/tips-for-making-a-cli-based-tool-with-node-9903255c2a3b">CLI 도구를 작성하기만 하면 됩니다!</a> 처음엔 쉽겠지만 그 위에 해야하는 일들이 굉장히 많아서 좀 어렵습니다 . 😅</p>\n<p>현재 시점에서 우리는 테스팅 프레임워크와 테스트 실행기(runner)를 만들었습니다. 다행히도 이미 만들어진 도구가 산더미같이 많습니다! 저는 모든 테스팅 도구를 사용해보았고 다 괜찮았습니다. 그래도 제 요구 사항을 가장 만족하는 도구는 Jest 뿐이었습니다. Jest는 아주 대단한 도구입니다. (<a href="http://kcd.im/egghead-jest">Jest를 더 알아보시려면 이 링크를 확인하세요</a>)</p>\n<p>그러니 이제 직접 프레임워크를 작성하는 대신 테스트 파일을 Jest 용으로 바꾸어 보겠습니다. 이를 어쩌죠? 안바꿔도 되는데요!? Jest는 <code class="language-text">test</code>, <code class="language-text">expect</code> 를 글로벌 객체로 가지고 있기 때문에 그냥 이전에 작성한 <code class="language-text">test</code> 와 <code class="language-text">expect</code> 의 구현체를 지우기만 하면 됩니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 5.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>Jest로 이 파일을 실행하면 다음과 같은 결과가 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ jest\n FAIL  ./5.js\n  ✕ sum adds numbers (5ms)\n  - [x] subtract subtracts numbers (1ms)\n● sum adds numbers\nexpect(received).toBe(expected)\n    \n    Expected value to be (using Object.is):\n      10\n    Received:\n      -4\n      4 |   const result = sum(3, 7)\n      5 |   const expected = 10\n    &gt; 6 |   expect(result).toBe(expected)\n      7 | })\n      8 | \n      9 | test(&#39;subtract subtracts numbers&#39;, () =&gt; {\n      \n      at Object.&lt;anonymous&gt;.test (5.js:6:18)\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 passed, 2 total\nSnapshots:   0 total\nTime:        0.6s, estimated 1s\nRan all test suites.</code></pre>\n      </div>\n<p>텍스트만 보아서는 알 수 없지만 사실 결과는 컬러로 출력됩니다. 이미지로 보시면 이렇게 나옵니다.</p>\n<p><img src="https://cl.ly/302i0B3V0J45/what-is-javascript-testing-1.png"></p>\n<p>컬러로 출력되면 관련된 부분을 살펴볼 때 큰 도움이 됩니다. <strong>그리고 에러가 발생하는 부분의 코드를 직접 보여줍니다! 이게 “도움이 되는” 에러 메세지죠!</strong></p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>그래서 자바스크립트 테스트가 뭐라고 했죠? 단순히 특정 상태를 설정해놓은 코드를 가지고 특정 동작을 수행한 뒤, 새 상태를 확인하는 단언을 만드는 겁니다. 이번 시간에는 <a href="https://facebook.github.io/jest/docs/en/api.html#beforeeachfn-timeout"><code class="language-text">beforeEach</code></a>, <a href="https://facebook.github.io/jest/docs/en/api.html#describename-fn"><code class="language-text">describe</code></a> 같은 <a href="https://facebook.github.io/jest/docs/en/api.html">프레임워크 공용으로 사용되는 헬퍼 함수</a>에 대한 이야기는 하지 않았지만, <a href="https://facebook.github.io/jest/docs/en/expect.html#tomatchobjectobject"><code class="language-text">toMatchObject</code></a>, <a href="https://facebook.github.io/jest/docs/en/expect.html#tocontainitem"><code class="language-text">toContain</code></a> 같이 사용할 수 있는 단언이 아주 많이 있습니다. 적어도 이 글이 여러분들에게 자바스크립트로 테스트하는데 기본적인 개념을 제시해주길 바랍니다.</p>\n<p>도움이 되었으면 좋겠군요. 행운을 빕니다! 👍</p>\n<p><strong>놓치지 말고 참고할만한 글 목록(영어 자료)</strong></p>\n<ul>\n<li><a href="https://twitter.com/horse_js/status/942658114209316864">Horse JS on Twitter: “But really, what is a JavaScript”</a> - 문맥을 빗겨가게 끊어진 글을 트윗하는 아주 재밌는 계정입니다.</li>\n<li><a href="https://twitter.com/NTulswani/status/942079674527518720">Introducing React Performance Devtool!! - by Nitin Tulswani</a></li>\n<li><a href="https://www.javascriptjanuary.com">JavaScript January</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2018-01-14-what-is-testing-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-14",path:"/posts/what-is-testing-javascript-kr",title:"[번역] 그래서, 자바스크립트 테스트가 뭔가요?",tags:["Translation","Javascript","Testing"],category:"Testing"}},{excerpt:"이 글은 Twitter  @ageldama 님의 TDD 조언에 관한 글타래를 허락 받고 정리한 내용입니다. 정리하면서 말씀하신 의도가 약간 달라진 부분 혹은 제 지식이 부족하여 제대로 표현하지 못한 부분도 있을 수 있습니다. 피드백환영합니다. 해당 포스팅은  Medium…",html:'<p><img src="https://cdn-images-1.medium.com/max/1600/1*jFw7ZZMoVcsEYM_fS33DBA.gif"></p>\n<p>이 글은 Twitter <a href="https://twitter.com/ageldama">@ageldama</a>님의 TDD 조언에 관한 글타래를 허락 받고 정리한 내용입니다. 정리하면서 말씀하신 의도가 약간 달라진 부분 혹은 제 지식이 부족하여 제대로 표현하지 못한 부분도 있을 수 있습니다. 피드백환영합니다. 해당 포스팅은 <a href="https://medium.com/@devRinae/tdd-test-driven-development-%EB%A5%BC-%EC%97%B0%EC%8A%B5%ED%95%98%EB%A9%B4%EC%84%9C-%EC%B0%B8%EA%B3%A0%ED%95%98%EA%B8%B0-%EC%A2%8B%EC%9D%80-%ED%8C%81-10%EA%B0%80%EC%A7%80-d8cf46ae1806">Medium에 먼저 발행되었으니</a> 댓글로 의견 공유 부탁드립니다.</p>\n<p><strong>(번호가 중요도 혹은 순서를 나타내지 않습니다)</strong></p>\n<ol>\n<li><strong>유닛 테스트를 한다면 테스트할 주제와 대상 클래스를 정하고, 대상 클래스가 사용하는 의존성(패키지일 수도 있고 특정 함수일 수도있겠지요)들은 Mock이나 Stub으로 만든다.</strong> <a href="https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub">(Mock과 Stub이란?)</a> Mocking을 어떻게 하는지는 사용하는 언어마다 주로 사용하는 테스팅 프레임워크의 레퍼런스를 참고하라. 그러고 나면 자신이 의존성을 잘 정리했는지 살펴보기 좋아지고, 이어서 테스트하기 좋은 형태가 눈에 들어오기 시작한다.</li>\n<li><strong>무엇을 테스트할지 정하기 어렵다면?</strong> 단위 테스트를 예로 들면 자신이 만든 클래스나 모듈, 함수 등의 기능이 정상적으로 동작하는지 확인하기 위해 테스트를 작성한다고 생각해보라.</li>\n<li><strong>Q: 테스트를 작성하는데 “망했다” 혹은 “잘못되었다” 는 느낌이 든다. / A:</strong> 오히려 좋은 징조인데, 당신이 작성한 테스트는 리팩토링 및 회귀 테스트 시 복구해야 할 곳이 있음을 보여주고, 제대로 복구하고 있다는 지침이 된다.</li>\n<li>처음에는 작성한 모듈이나 클래스 비율이 높게 테스트를 짜는데, 단언(assertions)은 조금 엉성하더라도 기본적인 부분만 확인하도록 작성한다. 이후 리팩토링을 하면서 다양한 경우에 대응하기 위해 단계적으로 단언을 추가한다.</li>\n<li><strong>원칙적으로 TDD인만큼</strong> 테스트를 먼저 스펙에 반영해 작성하고, 그에 따라 테스트를 충족하기 위해 코드를 작성 후 리팩토링 하는 것이 바람직하지만 <strong>실제로는 쉽지 않다</strong>. 초심자라면 코드를 어느 정도 수준까지 짜 놓고 테스트, Mock을 붙이는걸 권한다. — <a href="https://emaren84.github.io/posts/how-do-you-take-an-app-from-no-tests-to-tdd-kor">참고 포스트</a></li>\n<li>처음부터 Mocking을 하지 않아도 좋다. 입력과 기대값이 명확하게 나타나는 로직 부분일수록, 또한 다른 모듈이나 DB 등 외부 시스템과 연결이 없을 수록 테스트를 작성하기 쉽고 그 효과를 체감하기 쉽다.</li>\n<li><strong>가장 중요한 것은 테스트가 다 붙은 상황에서 리팩토링을 시작하는 것이다.</strong> 테스트가 깨지는 것을 보고 코드와 테스트를 계속 수정해나가면서 연습해보면 <strong>“테스트 먼저”</strong>를 어떻게 하게 되는지 자연스럽게 익히게 된다.</li>\n<li><strong>Q: E2E(End-to-End) 과정을 생각해서 하나씩 시나리오대로 테스트를 짜는 것이 좋지 않나? / A:</strong> 맨 처음 스펙 도출 이후 테스트 작성, 단언, Mocking 등 순차적으로 내려가는 것이 좋겠지만, 일반적인 테스팅 프레임워크를 적용해서 작은 단위로 테스트를 작성해야 단순하고 쉽게 접근할 수 있기 때문에 개별 모듈별로 먼저 단위 테스트를 시도해 보는 것을 권장한다.</li>\n<li><strong>UI를 테스트할 때는 다른 테스팅 기법과 도구들이 잘 맞을 수도 있다.</strong> 하지만 UI 테스트나 일반 테스트 모두 공통적으로 테스트를 <strong>어떻게든</strong> 만들기 위해 노력하고, 테스트 기법 및 테스트에 맞게 자신의 코드를 생각해야 한다.</li>\n<li><strong>테스트 커버리지는 모듈 단위로, 단언은 세세하게.</strong> 테스트하고자 하는 모듈의 테스트 골격을 먼저 잡아 놓으면, 이를 기반으로 더 세세한 고려 사항을 쉽게 떠올릴 수 있다. 처음부터 모든 경우를 명확하게 나열할 수 있다면 좋지만 현실적으로 변경 사항이나 버그가 나올 때마다 추가하며 더욱 명확해지도록 만드는 것이 좋다.</li>\n</ol>\n<p>TDD 가 좋은 개발 방법론 중 하나라는 것은 초짜인 저도 많이 들었던 내용이지만, 매번 테스트 한줄이라도 작성하려 하면 너무 어렵게 느껴지고 여러 가지 핑계로 제대로 도입을 하지 못하고 있었습니다. 이번에 접한 조언을 계기로 테스트 작성에 더 익숙해지면서 더 좋은 코드를 작성하고 싶습니다.</p>\n<p>자바스크립트 기본적인 문법에 익숙하신 분이라면 <a href="https://github.com/dwyl/learn-tdd">이 글</a>과 함께 TDD를 도전해보셔도 괜찮아 보입니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-11-04-tdd-practice-tips/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-11-04",path:"/posts/tdd-practice-tips",title:"TDD(Test Driven Development) 를 연습하면서 참고하기 좋은 팁 10가지",tags:["TDD","Testing"],category:"TDD"}},{excerpt:"이 번역글은  Justin Weiss의 포스팅 을 번역한 글입니다 오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요 당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development…",html:'<ul>\n<li><strong>이 번역글은 <a href="http://www.justinweiss.com/articles/how-do-you-take-an-app-from-test-less-to-tdd/">Justin Weiss의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요</strong></li>\n</ul>\n<hr>\n<p>당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development) 방법론을 적용하여 코드를 쓰고 싶었지만, 어디부터 시작해야 할지 전혀 몰라서 막혀버렸다. 어디부터 시작해야 할 것인가? <strong>어떻게 하면 테스트가 없는 앱을 가지고 TDD를 이용한 앱을 작성할 수 있을까?</strong></p>\n<h2 id="이미-작성한-코드를-테스트하라"><a href="#%EC%9D%B4%EB%AF%B8-%EC%9E%91%EC%84%B1%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%9D%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이미 작성한 코드를 테스트하라</h2>\n<p>당신은 테스트가 없는 코드 뭉치를 가지고 있다. 그렇다고 <em>당장</em> 기존의 코드를 가지고 테스트를 작성할 수 없다는 뜻은 아니다. 이미 가지고 있는 코드를 테스트하는 것 부터 시작해보라. 기대하던대로 코드가 작동하는지 확인해보는 것이다.</p>\n<p>이건 TDD가 아니다. <strong>그러나 이미 존재하는 코드를 테스팅하는 것은 TDD를 배우는데 도움을 줄 것이다.</strong></p>\n<ul>\n<li>\n<p><strong>예외적인 경우나 에러가 발생하는 조건에 대해 생각하는 연습을 하게 된다</strong></p>\n<p>모든 가능한 입력을 테스트하느라 수 년을 허비하지 않고 테스트를 작성하기 위해서, 당신은 보통 코드의 어느 부분에서 문제가 발생하는지 생각해야 한다. 만약 문자열을 받는 메서드를 테스트한다고 할 때, 대신 심볼을 넣으면 어떤 일이 생길 것인가?  <code class="language-text">nil</code> 을 넣는다면? 혹은 숫자를 나누는 함수를 테스트한다면, 0을 입력하는 경우에 대한 테스트를 하는 것이 좋다. 하지만 아마 1과 2를 테스트 할 필요는 없을 것이다.</p>\n<p>당신은 충분한 테스트를 작성한 뒤에 메서드의 어느 부분에서 문제가 발생할지 예측하기 시작할 것이다. 그리고 한번 TDD를 시작하면 이 기술을 이용하여 탄탄한 테스트를 작성할 수 있을 것이다. 이 테스트들은 예외 사항들을 더욱 잘 처리하도록 코드를 강제하는 역할을 한다. </p>\n</li>\n<li>\n<p><strong>짜임새있는 테스트를 작성하는 연습을 하게 된다</strong></p>\n<p>이미 작성한 코드에 대한 테스트를 작성한다면, 이 테스트들을 <a href="https://www.justinweiss.com/articles/writing-better-tests-with-the-three-phase-pattern//">구조화하는 다른 패턴들</a>을 시도해볼 수도 있다. 테스트하고자 하는 코드는 이미 있다. 그러니 당신은 테스트 자체, 그리고 이 테스트가 어떤 식으로 작성되어야 하는지에 대해 집중할 수 있다. 그리고 한번 몇몇 좋은 패턴들을 익히고 나면 당신이 기댈 코드가 <em>없을</em> 때에도 더 좋은 테스트를 작성할 것이다.</p>\n</li>\n<li>\n<p><strong>코드를 테스트하기 힘들게 하는 요소들을 발견하게 된다</strong></p>\n<p>테스트들을 작성할 수록 점점 시스템 어느 부분이 테스트하기 제일 어려운지 느끼게 될 것이다. 그런 부분들을 알아차리게 되면 그 부분을 리팩터링이 필요한 부분이라고 표시해둘 수 있다. 더 나아가 처음부터 더욱 테스트하기 좋은 코드를 작성하기 시작할 것이다.</p>\n<p>테스트하기 좋은 코드가 어떤 식으로 생겼는지 알기 시작하면, 그 지식을 기반으로 TDD하기 쉬운 API를 개발할 수 있으며 더욱 빨리 앱을 개발할 수 있을 것이다.</p>\n</li>\n</ul>\n<h2 id="tdd에-익숙해지기ease-into-tdd"><a href="#tdd%EC%97%90-%EC%9D%B5%EC%88%99%ED%95%B4%EC%A7%80%EA%B8%B0ease-into-tdd" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TDD에 익숙해지기(Ease into TDD)</h2>\n<p>\'테스트를 나중에\' 기법을 TDD를 배우는데 도움이 되는 기술로 사용할 수 있다. 하지만 여전히 당신 앱의 일부에 TDD를 적용하고 싶을 것이다.<em>(역주: 테스트를 먼저 작성하고 기능을 개발하는 것을 의미하는 것이라 추정합니다)</em> <strong>그리고 기존의 코드를 가지고 TDD에 익숙해지는 간단한 방법이 있다: <a href="https://ko.wikipedia.org/wiki/%ED%9A%8C%EA%B7%80_%ED%85%8C%EC%8A%A4%ED%8A%B8">회귀 테스트를 작성하는 것이다</a></strong></p>\n<p>회귀 테스트는 이미 확정한 코드를 부수는 것을 억누른다. 아이디어 자체는 아주 간단하다. 당신이 버그를 발견할 때마다, 그 버그를 다시 만들어보기 위해 브라우저에서 여기저기 클릭해보는 대신에:</p>\n<ul>\n<li>버그를 재생성하기 위해 <strong>실패하는 테스트를 작성하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 그 테스트가 확실히 실패하는지 확인하라 (왜냐면 버그는 아직 존재하니까).</li>\n<li>가능한한 가장 간단한 방법으로 <strong>버그를 수정하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 테스트가 통과하는지 확인하라.</li>\n<li>만약 필요하다면 당신이 수정한 방법을 <strong>리팩터링하라.</strong></li>\n</ul>\n<p>이 방법은 새 시스템을 밑바닥부터 TDD로 개발하는 것 보단 훨씬 쉽다. 왜냐면 이미 작성된 코드를 단지 테스트 주도적으로 바꾸기만 하는 것이기 때문이다. 그리고 "Red, Green, Refactor" 라는 TDD의 핵심적인 루프를 습관화하게 된다. <strong>그리고 이쯤부터 당신의 TDD는 테스트가 없는 상태에서 바로 TDD로 개발하는 것에 가까워지게 된다.(And from here, TDD is a shorter step away than trying to go straight to TDD from no tests.)</strong></p>\n<h2 id="테스트가-없는-상태에서-tdd로"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%97%86%EB%8A%94-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C-tdd%EB%A1%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 없는 상태에서 TDD로</h2>\n<p>테스트가 없는 앱은 그렇게 나쁜 출발점은 아니다. 이미 작성된 코드를 테스트할 때, 당신은 좋은 TDD 테스트를 작성하기 위해 무엇이 필요한지 많이 배우게 될 것이다. \'테스트를 나중에\' 하는 것은 시작부터 TDD로 개발하는 것 보다 쉽다. 왜냐면 아직 어떻게 디자인해야할지 모르는 API들을 상상할 필요가 없기 때문이다. 그리고 자신의 앱에 한번 TDD를 도입하기로 결정했다면 회귀 테스트를 통해 익숙해질 수 있다.</p>\n<p>그러니 만약 당신이 상상하고 있는 시스템에 TDD를 어떻게 도입해야 할 지 모르겠다면, 계속 테스트를 작성하라. 비록 코드를 먼저 써야 하더라도 말이다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>2017년 첫 번역은 TDD에 관한 글입니다. TDD 혹은 BDD(Behavior Driven Development)가 개발 방법론에 있어서 절대적인 진리는 아닐 겁니다. 다만 많이 권장되는데는 이유가 있겠지요. 저는 간단하게 TDD가 확장성, 유지보수성에 큰 도움이 된다고 인지하고 있습니다.</p>\n<p>제 자신도 아직 실력이 미천하여 코드 없이 테스트를 작성한다는 것에 큰 두려움을 느끼면서 지내왔습니다. 최근에야 일부 기능에 대해 예측되는 결과를 먼저 테스트로 작성하고, 이후에 실제 기능을 작성하여 잘 작동하는지 확인하는 수준에 불과합니다.</p>\n<p>그러다가 마침 기존에 작성한 코드를 이용하여 TDD를 배워나가는 과정에 대해 간단한 포스팅이 있어 이렇게 소개를 하게 되었습니다. 음.. 당장은 기존의 코드를 이용하여 테스트를 작성하는게 꽤 부끄럽지만 (왜냐면 테스트를 작성할 것도 없이 손대야 할 부분들이 수두룩하게 보이니까요) 이런 방식으로 약간 우회하여 TDD를 습득하는 방법도 있겠지요. </p>\n<p>그럼 모두 2017년 한해에도 좋은 테스트 + 테스트를 통과하는 좋은 코드 작성이 잘 되시길 바랍니다 :)</p>\n<p>(추가) 피드백에 의해 \'You\' 라는 단어의 직역이 너무 많이 들어간 것 같아 조금 수정하였습니다. 확실히 번역할 때 \'당신\' 이라는 단어가 일일이 들어갈 필요는 없겠네요. 좋은 피드백을 주신 <a href="https://twitter.com/initnirvana">@initNirvana</a> 님께 감사드립니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-01-16-how-do-you-take-an-app-from-no-tests-to-tdd-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-01-16",path:"/posts/how-do-you-take-an-app-from-no-tests-to-tdd-kor",title:"[번역] 테스트가 없는 앱을 이용하여 TDD를 배우는 방법",tags:["Ruby","Testing","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Luca Guidi의 포스팅을  번역한 글입니다 문제를 설명하는데 나온 하나미(Hanami…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://lucaguidi.com/2016/12/27/isolate-global-state.html">Luca Guidi의 포스팅을</a> 번역한 글입니다</strong></li>\n<li><strong>문제를 설명하는데 나온 하나미(Hanami)에 대해서는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction">이 포스팅</a>을 참조해주세요</strong></li>\n<li><strong>전문 번역이 아니기에 부족한 표현이나 오역은 언제든지 지적해주세요</strong></li>\n</ul>\n<hr>\n<p>소프트웨어 프로그램에서 전역 상태를 사용하는건 개발하기엔 쉽지만 유지보수 할 때는 악몽이 된다. 예상치 못한 상황에서 발생하여 추적하기도 어려운 버그가 되기 쉽상이다.</p>\n<p>왜 그렇게 되는지, 그리고 어떻게 그 문제를 완화할 수 있을지 살펴보자.</p>\n<p><em>역주: 이 글에서 전역 상태는 전역 변수와 거의 동일한 의미로 사용되는 것으로 추정됩니다.</em></p>\n<h2 id="문제의-예시"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 예시</h2>\n<p>예를 들자면 하나미의 코드 베이스 안에서 우리는 환경 변수에 따라 어떻게 프레임워크가 설정되는지 테스트 할 필요가 있다.</p>\n<p>우리<em>(역주: 하나미 개발팀으로 보입니다)</em>는 보통 테스트를 이런 식으로 작성한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  before <span class="token keyword">do</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'RACK_ENV\'</span><span class="token punctuation">]</span>    <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_HOST\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_PORT\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    before <span class="token keyword">do</span>\n      <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'production\'</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span>\n    <span class="token class-name">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리는 보통 각각의 테스트를 실행하기 전에 모든 환경 변수를 초기화해왔다. 그리고 우리가 필요로 하는 특별한 상황(the edge case)에서만 하나씩 설정했다.</p>\n<p>이러한 접근 방식을 사용할 때의 <strong>문제는</strong> 이 방법이 루비 프로세스의 전역 상태를 <strong>더럽힌다는</strong> 것이다. 우리가 테스트 파일을 단독으로 실행할 때는  <code class="language-text">before</code> 블록이 환경 변수를 리셋하기 때문에 잘 작동한다.</p>\n<p>그러나 모든 테스트를 한번에 실행할 때, 테스트는 꼬이게 될 것이다. 환경 변수 초기화가 언제나 작동하진 않기 때문이다.</p>\n<p>만약 한 테스트가 <code class="language-text">ENV</code> 속성을 변환하고 나서 뒷정리를 하지 않으면, 그 다음 테스트는 기존의 <code class="language-text">ENV</code> 값의 변화를 <strong>물려받아서</strong> 우리가 기대하던대로 작동하지 않을 수 있다.</p>\n<p>때때로 위의 예시 처럼 눈에 띄는 부분에서 변화를 준 경우에는 우리가 <code class="language-text">after</code> 블록을 설정하여 뒷정리를 할 수 있다. 그러나 다른 때엔 변환한 것(the mutation)이 우리 눈에 보이지 않는 부분에서 부작용을 초래할 수 있다.</p>\n<p>이건 소스의 버그다. 그리고 이 버그는 엉킨 실타래처럼 되어 디버그하기 힘들다.</p>\n<p><strong>오랜 시간동안, 여러 가지 전역 상태의 조합하는 것은 하나미를 지속적 통합 개발(<a href="https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9">CI builds</a>)이 힘들도록 만들고 여러 버그를 일으켰다.</strong></p>\n<p>개발자로서의 내 경험으로 미루어보아(<em>역주: Luca Guidi는 숙련된 웹 개발자입니다</em>) 이런 형태의 문제를 완화할 수 있는 유일한 방법은 <strong>전역 상태를 격리하거나, 전역 상태를 사용하는 것을 아예 피하는 것이다.</strong> 우리는 <strong>가능한한 전역 상태를 사용하는 것을 줄이도록</strong> 하나미의 내부 구현을 바꾸고 있다.</p>\n<h2 id="문제의-해법"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%ED%95%B4%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 해법</h2>\n<p>앞서 이야기한 특별한 경우를 위해 우리는 환경 변수를 격리할 수 있는 새로운 객체를 선보였다. 이는 <code class="language-text">Hanami::Env</code> 라고 불린다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Env</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> env\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>구현 자체는 별 것 아니다: <code class="language-text">ENV</code> 에 접근하는 것을 캡슐화하는 것이다.</p>\n<p>우리는 환경 변수를 관리하기 위해 자체 인터페이스를 정의했다. 우리는 명시적인 구현(concrete implementation)을 사용하기보다(<code class="language-text">ENV</code>) 추상화(<code class="language-text">Hanami::Env</code>)에 의존하고 있다(<a href="https://ko.wikipedia.org/wiki/%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84_%EC%97%AD%EC%A0%84_%EC%9B%90%EC%B9%99">의존관계 역전 원칙 참고</a>). </p>\n<p><code class="language-text">Hanami::Environment</code> 는 프로젝트의 환경 변수를 설정하는 책임을 가지고 있는데, 우리는 이런 방식으로 사용한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Environment</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>\n      opts <span class="token operator">=</span> options<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>dup\n      <span class="token variable">@env</span> <span class="token operator">=</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Env</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> opts<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n\n      <span class="token comment"># ...</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 하나미 프로젝트를 사용할 때, <code class="language-text">:env</code> 옵션은 설정되지 않은 상태이다. 이로 인해 <code class="language-text">@env</code> 는 <code class="language-text">ENV</code> 를 참조하여 루비 프로세스의 진짜 환경 변수를 읽거나 쓰게 된다.</p>\n<p>이렇게 우리는 <code class="language-text">Hanami::Environment</code> 의 테스트 중에 많은 양의 코드를 단순화하고, <strong>공유되고 변화 가능한 상태(shared mutable state, 즉 <code class="language-text">ENV</code> 말이다)의 사용을 피할 수 있었다.</strong> 아래 코드에서 우리는 <code class="language-text">ENV</code> 와 유사하게 동작하는 <code class="language-text">:env</code> 를 객체의 옵션으로 전달하지만, 이 것은 실제로 <code class="language-text">ENV</code>가 아니다: 그냥 <code class="language-text">Hash</code> 이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token builtin">Hash</span><span class="token punctuation">[</span><span class="token string">"HANAMI_ENV"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"production"</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n\n    it <span class="token string">"tests something interesting"</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> env<span class="token punctuation">)</span>  \n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p><a href="https://ko.wikipedia.org/wiki/%EC%BA%A1%EC%8A%90%ED%99%94">캡슐화</a>와 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">의존성 주입</a>을 적절하게 사용하여, 각각의 테스트에서 발생할 수 있는 변화는 나머지 테스트에서는 보이지 않게 되었다. 결과적으로 안정적인 테스트 수행을 할 수 있게 되었고, 하나미 내부를 <a href="https://ko.wikipedia.org/wiki/SOLID">SOLID 디자인</a>에 맞게 구성할 수 있었다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>보통 루비 프로젝트에서 <code class="language-text">dotenv</code> 같은 젬으로 환경 변수를 관리합니다. 사실 이 환경 변수라는 개념도 저에게 아직 모호한 개념이지만, 객체지향 프로그래밍의 핵심적인 주제인 캡슐화와 의존성 주입을 어떤 식으로 활용하는지 좋은 예를 보여준 것 같아 한번 번역해보게 되었습니다.</p>\n<p>특히 제가 요즘에야 테스트를 작성해보기 시작했는데, 테스트를 개별로 실행할 때는 몰라도 전체 테스트를 실행할 때 원인을 알 수 없는 오류가 생길 때가 종종 있었습니다. 이 글을 통해 약간의 힌트를 얻었다는 생각도 듭니다. </p>',id:"/home/circleci/repo/src/pages/posts/2016-12-30-isolate-global-state-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-30",path:"/posts/isolate-global-state-kor",title:"[번역] 전역 상태를 격리하라",tags:["Ruby","Hanami","Testing","Translation"],category:"Translation"}}],React:[{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p>더 좋은 (리액트 애플리케이션) 테스트를 위한 번역 시리즈 마지막입니다. 처음에는 팀원들과 공유하기 위해 테스트의 기초적인 부분을 다루는 글을 번역하려다가, 최대한 실전에 도움이 되면서도 부담없이 시작할 수 있는 내용 위주로 좋은 글을 찾아서 번역해보았습니다.</p>\n<p>제 자신도 번역을 통해 ‘어디까지 테스트하는게 실무에 도움이 많이 될까?’ 라는 질문의 답을 얻는데 많은 도움이 되었습니다. 이제 테스트만 잘 짜면 될텐데요.</p>\n<p><img src="https://cl.ly/0P3O322S1P3y/Screen%20Shot%202018-01-27%20at%2014.46.48.png" alt="test-right-now"></p>\n<p>다음에는 어떤 글을 쓰거나 번역할지 아직 모르겠지만 모쪼록 도움이 되었으면 좋겠습니다.</p>\n<p><a href="https://medium.com/@Tetheta/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-eb581d6d167b">원문은 여기서 보실 수 있습니다</a></p>\n<hr>\n<p>만약 여러분이 기술 중심 회사에서 일하시는게 아니라면, 단위 테스트같은 개발 요소를 도입한다고 관리자를 설득하는게 어려울 수 있습니다. 저는 한동안 열렬한 지지자가 되어(역주: 필자 자신이 ‘관리자’ 임을 암시하는 문장이라 봅니다)  몇몇 프로젝트에 단위 테스트를 도입하고 동료들과 몇 가지 패턴을 도입해보았습니다. 그 과정에서 제가 배운 교훈을 이야기하고자 합니다.</p>\n<h2 id="설정이-만만치-않습니다-"><a href="#%EC%84%A4%EC%A0%95%EC%9D%B4-%EB%A7%8C%EB%A7%8C%EC%B9%98-%EC%95%8A%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설정이 만만치 않습니다 😐</h2>\n<p>여러분이 create-react-app 같은 것을 사용하고 있거나 회사에서 이미 Jest + Enzyme 설정을 해 두었다면 아주 좋습니다!</p>\n<p>저처럼 밑바닥부터 설정해야 한다면 몇 가지 유의하실 점이 있습니다.</p>\n<ol>\n<li>Jest는 노드 환경에서 실행됩니다. 즉 Webpack같은 번들러의 결과물을 실행하는 것이 아니라 파일의 코드 그대로 실행한다는 뜻입니다. 따라서 ES6나 기타 문법을 사용하고 싶다면 테스트 환경에서 사용하는 <code class="language-text">.babelrc</code> 파일을 설정해야 합니다.</li>\n<li>위에 이어서 브라우저가 아니라 노드 환경에서 실행되기 때문에 import, export 같은 문법을 사용하기 위해 폴리필을 추가해야 할 수도 있습니다.</li>\n<li>최신 버전의 Enzyme은 Jest가 제대로 실행되기 위해 <a href="http://airbnb.io/enzyme/#installation">설정 파일이 필요합니다</a>.</li>\n<li>아마 폰트, 이미지, 스타일 파일들을 잔뜩 모킹해야 할지도 모릅니다.</li>\n<li>CI(Continuous Integration) 빌드 중 테스트를 실행하고 싶다면 <code class="language-text">testResultProcessor</code>, <code class="language-text">runInBand</code> 설정을 해 주시는게 좋습니다. 저는 <a href="https://github.com/CHECK24/jest-bamboo-reporter">Bamboo</a>를 사용하고 있습니다.</li>\n</ol>\n<p>컴포넌트를 작성하는 환경과 테스트를 작성하는 환경을 최대한 비슷하게 맞추기 위해(ES2017, import/export 등) 제대로 된 폴리필을 설정하는 것이 가장 큰 장벽이었습니다. React 버전 16으로 업그레이드 하는 것도 꽤 흥미로운 일이었지만 이제 대부분은 자연스럽게 적응(최소한 문서화라도)했습니다.</p>\n<p>기회가 된다면 언젠가 제 설정을 짚어보는 포스트를 써 볼지도 모릅니다. 제 프로젝트의 일부는 그저 문서로 남겨두기엔 특이한 환경을 가지고 있었고, 고통스럽기도 했습니다.</p>\n<h2 id="스냅샷을-사용하세요-json-serializer와-함께-사용하면-더-좋습니다"><a href="#%EC%8A%A4%EB%83%85%EC%83%B7%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%84%B8%EC%9A%94-json-serializer%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4-%EB%8D%94-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스냅샷을 사용하세요 (json serializer와 함께 사용하면 더 좋습니다)</h2>\n<p>스냅샷은 아주 좋습니다 😃. 하지만 이런 코드를 실행하면</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Match previous snapshot\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그냥 enzyme이 사용하는 자체 객체를 뱉어버립니다😦. 저는 <a href="https://github.com/adriantoine/enzyme-to-json">enzyme-to-json</a> 같은 패키지를 써서 가독성을 높이길 추천합니다. 스냅샷이 변경되었을 때 아주 유용합니다.</p>\n<p>그리고 스냅샷을 버전 관리 시스템(Git 등)에 포함시키세요. 여러분이 반영한 변경 사항이 갑자기 문제를 일으킬 때 문제점을 찾는 데 큰 도움이 됩니다.</p>\n<h2 id="jest-watch-도-좋습니다-"><a href="#jest-watch-%EB%8F%84-%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>jest —watch 도 좋습니다 😃</h2>\n<p>테스트 할 때 반드시 사용하세요! 여러가지 일을 편하게 만들어주고, 패턴 매치(<code class="language-text">p</code> 키를 누른 뒤 파일이나 폴더 이름을 입력해보세요)를 사용해서 매번 저장할 때마다 모든 테스트를 다시 실행하지 않게 만들 수도 있습니다.</p>\n<h2 id="test-문의-괄호가-제대로-놓여있는지-확인하세요"><a href="#test-%EB%AC%B8%EC%9D%98-%EA%B4%84%ED%98%B8%EA%B0%80-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EB%86%93%EC%97%AC%EC%9E%88%EB%8A%94%EC%A7%80-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>test() 문의 괄호가 제대로 놓여있는지 확인하세요</h2>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 지극히 정상적인 자바스크립트 코드지만 테스트를 실행하면 모두 잘 작동한다면서 아무 일도 일어나지 않을 겁니다.</p>\n<p>올바른 코드는 이렇게 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'Test\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 실수는 쉽게 저지를 수 있는데다 테스트에 문제가 있는데도 통과하기 때문에 특히 무섭습니다. 저는 특정 단위 테스트를 잘못 썼는데(역주: 문법적 실패가 아니라 fail이 뜨는 코드) 실패가 뜨지 않았습니다. 비슷한 코드를 복사하고 붙여넣다가 간신히 이 실수를 발견했지요.</p>\n<p>그래서 생각한 것이...</p>\n<h2 id="테스트가-실패하는지-꼭-확인하세요"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%8B%A4%ED%8C%A8%ED%95%98%EB%8A%94%EC%A7%80-%EA%BC%AD-%ED%99%95%EC%9D%B8%ED%95%98%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 실패하는지 꼭 확인하세요</h2>\n<p>여러분이 실력있고 TDD를 사용하는 개발자라면 이미 이 방법을 사용하고 있을 겁니다.</p>\n<p>그렇지 않은 분이라면 단위 테스트를 너무 후순위로 취급하기 때문에 테스트를 한 뭉치 작성하고 “좋아! 잘 작동하는군! 이제 다음 단계로 가야지” 라고 생각하기 쉽습니다.</p>\n<p>하지만 앞서 언급된 문제로 이어질 수있는데다, 비슷한 테스트를 복사-붙여넣기 하다보면 특히 쉽게 잘못된 요소나 모킹한 함수를 테스트 할 수 있습니다.</p>\n<p>테스트의 중요한 부분을 잠시 주석처리하는 식으로 쉽게 테스트를 실패하게 만들 수 있으며, 덕분에 여러분이 수없이 겪을 지도 모르는 골치 아픈 상황에서 벗어날 수 있습니다.</p>\n<h2 id="반복-가능하고-확장-가능한-테스트-패턴을-만들어보세요"><a href="#%EB%B0%98%EB%B3%B5-%EA%B0%80%EB%8A%A5%ED%95%98%EA%B3%A0-%ED%99%95%EC%9E%A5-%EA%B0%80%EB%8A%A5%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%8C%A8%ED%84%B4%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EC%84%B8%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>반복 가능하고 확장 가능한 테스트 패턴을 만들어보세요</h2>\n<p>여러분이 혼자서 프로젝트의 테스트를 만들거나 유지보수하지 않는 이상, 새 컴포넌트를 빠르고 쉽게 테스트하거나 최소한 기본 수준의 테스트라도 빠르게 만들고 싶을겁니다.</p>\n<p>제 동료 개발자들을 보니 가장 큰 장벽은 “어떻게 시작해야할지 모른다” 는 부분이었습니다. 명확하고 따라하기 쉬운 패턴을 만들어서 그들을 도울 수 있습니다.</p>\n<p>예를 들어 많은 사용자 입력을 받는 컴포넌트를 테스트하고 싶다면 이런 방식으로 테스트 해 볼 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> userChangeCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'Test1\'</span><span class="token punctuation">,</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">{</span> toLowercase<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'testPre\'</span><span class="token punctuation">,</span>\n  result<span class="token punctuation">:</span> <span class="token string">\'testpre\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  onDataChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'On Change Cases\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    userChangeCases<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> item<span class="token punctuation">.</span>value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onDataChange<span class="token punctuation">)</span><span class="token punctuation">.</span>\n          <span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>resultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>그리고 나중에 추가로 사용자 입력 케이스를 테스트할 때 손쉽게 <code class="language-text">userChangeCases</code> 배열에 추가하면 됩니다. 게다가 다른 컴포넌트에 비슷한 테스트를 해야하면 복사하기도 쉽습니다.</p>\n<p>사실 이렇게 제가 따르고 있는 작은 규약들을(beforeEach로 매 테스트마다 wrapper 지정하기, 이름 짓는 방법, props 객체에 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/Spread_operator">전개 연산자--MDN 문서 영문판으로 다시 보시길 권장합니다--</a>  사용하기) 어딘가에 정의해두면 다른 사람들이 쉽게 이해하고 자신의 컴포넌트를 테스트 할 때 유용하게 테스트 작동 원리를 베껴갈 수 있습니다.</p>\n<p>이 예는 다소 부자연스럽지만(저는 일반적으로 테스트에 따라 입력 값 변화를 처리하는 순수 함수를 만듭니다) 전체 시스템이 작동하는지 여부를 신속하게 알 수 있으며, 복잡한 입력을 수행하지 않는 경우 필요에 맞게 적절하게 사용 할 수 있습니다.</p>\n<h2 id="enzyme-mount-vs-shallow"><a href="#enzyme-mount-vs-shallow" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enzyme: Mount vs Shallow</h2>\n<p><code class="language-text">shallow</code> 는 “순수 단위 테스트” 방식의 접근입니다. 단순히 여러분이 테스트하고자 하는 컴포넌트아 DOM을 본떠서 그 컴포넌트가 어떤 역할을 수행하는지 테스트합니다. 이런 방식의 테스트는 더 빠르게 동작합니다.</p>\n<p>아주 괜찮은 것 같지만, 여러분은 무엇을 테스트하고자 하는지 신경 쓰셔야 합니다. 각각의 컴포넌트를 완벽하게 분리하고 전체 단위 테스트 커버리지를 높이는게 목표인가요? 아니면 여러가지 문제가 될 수 있는 경우를 테스트하고 그 과정에서 컴포넌트가 제대로 동작하는지를 확인하는게 목표인가요?</p>\n<p>전자의 경우는 <code class="language-text">shallow</code> 를 사용하는게 아마 완벽한 해결책이겠지만 후자의 경우는 <code class="language-text">mount</code> 를 쓰는 게 좀 더 이상적입니다.</p>\n<p><code class="language-text">mount</code> 는 컴포넌트에 속한 모든 것을 가상화(simulates)합니다. 말인즉슨 자손 컴포넌트(예를 들어 특별한 입력 컴포넌트라던가)를 잡아내서 입력값의 변화를 테스트해볼 수도 있습니다. 이렇게 사용자의 동작을 흉내내면서도 테스트하고자 하는 컴포넌트를 부모 컴포넌트와 그 주변 환경에서 분리할 수 있습니다.</p>\n<p>또한 <code class="language-text">mount</code> 는 <a href="https://velopert.com/1130">리액트의 라이프사이클 메서드(lifecycle methods)</a>를 가상화할 수 있습니다. 특정 라이프사이클 메서드에 많은 로직이 있는 복잡한 컴포넌트를 테스트할 때도 유용합니다.</p>\n<p>텍스트 기반의 컴포넌트를 <code class="language-text">mount</code> 로 테스트하는 예를 보여드리겠습니다.</p>\n<p>(제 실수를 지적해주신 <a href="https://medium.com/@ywcoder">Ying Wang</a>님께 감사드립니다. <code class="language-text">shallow</code> 도 마찬가지로 컴포넌트 안의 html 요소를 가상화합니다. 자손 컴포넌트를 다루지 않을 뿐입니다. 이에 맞추어 글을 수정했습니다.)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> CustomInput <span class="token keyword">from</span> <span class="token string">\'./CustomInput.jsx\'</span><span class="token punctuation">;</span>\n<span class="token comment">/*\nCustomInput 컴포넌트 안에는 이렇게 생긴 input 태그가 있고\n&lt;input type="text" disabled={this.props.disabled} onChange={this.props.onChange}\nTextComponent는 이 컴포넌트로 prop을 전달합니다.\n*/</span>\n<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>\n  value<span class="token punctuation">:</span> <span class="token string">\'Nothing\'</span><span class="token punctuation">,</span>\n  onChange<span class="token punctuation">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Testing TextComponent\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> wrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TextComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'OnChange called\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    input<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'TestVal\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>onChange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeCalledWith</span><span class="token punctuation">(</span>\n      expect<span class="token punctuation">.</span><span class="token function">objectContaining</span><span class="token punctuation">(</span><span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이벤트가 올바르게 전달되었는지 확인</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'isDisabled prop works\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    wrapper<span class="token punctuation">.</span><span class="token function">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isDisabled<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> input <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>CustomInput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">\'disabled\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이런 방식의 테스트는 통합 테스트와 단위 테스트와의 경계를 흐리게 하지만, Guillermo Rauch는 이렇게 말했습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Write tests. Not too many. Mostly integration.</p>&mdash; Guillermo Rauch (@rauchg) <a href="https://twitter.com/rauchg/status/807626710350839808?ref_src=twsrc%5Etfw">December 10, 2016</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> \n<p>Kent C. Dodds도 이 트윗에 대해 <a href="https://emaren84.github.io/posts/write-mostly-integration-test-kr">글을 썼는데</a> 꽤 설득력 있습니다.</p>\n<p>제 생각에 두 종류의 테스트 모두 적합한 경우가 있습니다만, 제가 만든 대부분의 애플리케이션에서 단위 테스트를 하기에는 시간이 아깝고 저는 세부 구현이나 기반에 깔린 코드를 테스트하기보다 실제로 동작하는 부분을 테스트하는데 집중하고 싶습니다. 저도 계속 (실용적인 테스트의) 중심을 잡아보려고 노력중입니다.</p>\n<p>요즘은 기본적으로 <code class="language-text">mount</code> 를 사용하고 테스트 퍼포먼스에 영향이 가는 경우에만 <code class="language-text">shallow</code> 를 사용하고 있습니다. 두 경우의 API가 약간 다르므로 특정 작업을 테스트하는 방법을 더 쉽게 기억할 수 있습니다.</p>\n<h2 id="redux-테스트는-흥미로워요-"><a href="#redux-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%ED%9D%A5%EB%AF%B8%EB%A1%9C%EC%9B%8C%EC%9A%94-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redux 테스트는… 흥미로워요 😕</h2>\n<p>반면에 리덕스 액션과 리듀서는 무진장 테스트하기 쉽습니다. 그저 함수일 뿐 아니라 리듀서는 어떠한 부수 효과도 없는 순수 함수여야 합니다.</p>\n<p>하지만 redux-thunks나 redux-saga를 사용하고 계시다면 조금 흥미로운(?) 일이 되고, <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트 하는 일은 더욱 복잡해지게 됩니다.</p>\n<p>Thunk와 Saga는 다른 액션을 대신 보내주면서 비동기 작업을 다루는 일을 합니다. 그래서 스토어를 본뜬 다음에 무슨 액션이 보내졌는지 확인해야하고, 부수 기능도 본떠야 합니다. 매번 테스트할때마다 실제 데이터베이스 호출 등을 하면 안되니까요.</p>\n<p>Saga는 최소한 <a href="https://redux-saga.js.org/docs/advanced/Testing.html">테스트 가능하도록 디자인 되어있고</a> 테스트에 도움되는 기능들을 가지고 있지만, Thunks는 부수 작업이 끝날때까지 대기가 걸리게 만듭니다.</p>\n<p>결국 이런 질문으로 이어지게 되지요. “어느 부분까지 테스트 할 것인가?”</p>\n<p>리덕스 앱을 전체적으로 테스트하기 위한 <a href="https://redux.js.org/docs/recipes/WritingTests.html">좋은 자료</a>가 있습니다만, 여러분이 직접 작성한 코드 말고 리덕스를 테스트하는데 무슨 의미가 있을까요? 리덕스 자체는 완전히 테스트를 마친 라이브러리라서 우리가 같은 테스트를 또 할 필요는 없습니다. 게다가 <code class="language-text">connect</code> 로 연결된 컴포넌트를 테스트하는건 굉장히 복잡하기 때문에 앱의 큰 부분을 본떠야 하는 불편함을 감수해야 합니다.</p>\n<p>저는 액션을 제대로 보내기만 하면 리덕스 스토어가 이를 받아서 처리할거라고 확신합니다. 제가 진짜 신경쓰는 부분은 컴포넌트가 그 액션을 잘 받아서 제대로 변화가 일어나는지 확인하는 겁니다. 통합 테스트의 영역이지요.</p>\n<p>그래서 제가 테스트를 할 때는</p>\n<ol>\n<li>먼저 리듀서를 테스트합니다. 테스트하기도 쉽고 중요한 기능을 가지고 있으니까요.</li>\n<li>그리고 리덕스에 연결되지 않은 컴포넌트를 테스트합니다. 특정 이벤트에 제대로 반응하는지 확인할 수 있습니다. 그리고 테스트하기 쉬운데다 데이터를 다루는 부분과 랜더링을 다루는 부분을 분리하여 볼 수 있습니다.</li>\n<li>복잡한 데이터를 다루는 부분을 순수 함수로 빼내어 테스트합니다.</li>\n<li>제 앱의 각 부분이 잘 맞아떨어지는지 확인하기 위해 Selenium을 써서 E2E(end to end) 테스트와 통합 테스트를 합니다.</li>\n</ol>\n<p>이 방법이 완벽한 방법은 아닙니다. 저는 아직 마지막 두 부분을 처리하기 위한 최상의 방법을 찾고 있습니다만, 이 방법들도 테스트 작성을 간단하게 해주며 생산적이라는 생각이 듭니다.</p>\n<p>매번 제가 동료들에게 리덕스에 연결된 컴포넌트를 다 테스트해서 보여줄 때마다 그들의 눈에는 동공지진이 일어납니다(their eyes instantly start glazing over). 많은 로직이 있고 본떠서 다루어야 할 것도 많습니다. 이런 복잡한 것들을 제쳐두면 일이 더 쉬워지며 사용자(혹은 매니저)를 우선적으로 고려한 유형의 테스트를 작성하는데 집중할 수 있습니다. 대부분의 프로젝트에 테스트를 작성할 시간이 얼마나 적은지를 생각한다면 괜찮은 등가교환이라 생각합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 아직도 테스트를 적절하게 하는 법을 배우고 있습니다. 그리고 지난 1년동안 많은 자료를 읽기도 하고 보기도 했습니다. 여러분이 자신만의 패턴을 만들면 Jest와 Enzyme으로 단위 테스트하는건 놀라우리만치 쉽습니다. 특히 리덕스의 복잡한 부분을 통합 테스트와 E2E 테스트로 옮기는 경우에도 유용합니다.</p>\n<p>Jest와 Enzyme을 다루는게 어렵다면 <a href="https://www.reactiflux.com/">ReactFlux</a>를 방문해보세요. 거기 있는 Jest 채널에서 많은 도움을 얻었습니다.</p>\n<p>이제 막 Jest + Enzyme으로 테스트를 시작하신다면 <a href="https://hackernoon.com/testing-react-components-with-jest-and-enzyme-41d592c174f">이 훌륭한 가이드</a>를 읽어보세요.</p>\n<p>스냅샷 테스트에 대해 더 자세히 알아보시려면 <a href="https://hackernoon.com/how-to-snapshot-test-everything-in-your-redux-app-with-jest-fde305ebedea">이 가이드</a>를 참고하세요.</p>\n<p>마찬가지로 React, Redux, Jest의 공식 문서를 꼭 살펴보세요. 모두 최고 수준의 가이드를 제공합니다.</p>\n<p>이 글이 여러분의 테스팅을 향한 여정에 도움이 되었으면 좋겠습니다. 어떠한 질문이나 코멘트가 있다면 <a href="https://twitter.com/tetheta">트위터로</a> 연락주세요.</p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-27-lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-27",path:"/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr",title:"[번역] 리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트 하며 얻은 교훈",tags:["Testing","React","Javascript"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="번역-서문"><a href="#%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 서문</h2>\n<p><a href="/posts/what-is-testing-javascript-kr">지난번</a> <a href="/posts/write-mostly-integration-test-kr">시리즈</a>를 통해 테스트가 무엇인지, 어떤 방향으로 테스트를 해야할지 조금 감을 잡으셨을 겁니다. 이제 본격적으로 리액트 애플리케이션을 테스트하고자 하는데, 또 한번 막히게 되죠.</p>\n<blockquote>\n<p>통합 테스트가 좋다는 건 알겠는데 좀더 실전에 가까운 예가 필요하다</p>\n</blockquote>\n<p>라고 생각하실지 몰라서 (저도 그렇게 생각하기 때문에) 남은 두 번의 번역 시리즈는 리액트 + 리덕스 애플리케이션 개발 시 테스트를 어떻게 했는지, 참고할만한 팁을 번역할 예정입니다.</p>\n<p>참고로 원작자는 ‘Redux app’ 이라는 용어를 계속 사용하고 있어서 저도 그냥 리덕스 앱이라고 번역했습니다. (앵귤러도 리덕스 쓸 수 있는데...) 또한 mocking(흉내내기, 모조품 만들기)의 번역이 부자연스러워 바로 음차했습니다. 더 좋은 표현이 있다면 제안 부탁드립니다.</p>\n<p><a href="https://hackernoon.com/low-effort-high-value-integration-tests-in-redux-apps-d3a590bd9fd5">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p><strong>짧은 정리: 여러분은 노드 환경에서 앱을 랜더링하고, 사용자 동작을 흉내내며 상태나 마크업의 변화를 확인할 수 있습니다. 이런 테스트는 상대적으로 작성하기 쉽고 빠르게 작동하며 이를 통해 많은 자신감을 얻을 수 있습니다.</strong></p>\n<p>효율적인 소프트웨어 테스트를 작성하는 일은 아슬아슬한 줄타기 같습니다(tricky balancing act). ‘효율성’ 이라는 용어는 실행 속도나 자원 소모를 의미하는 것이 아니라, 테스트를 작성하는데 드는 노력과 테스트가 제공하는 가치 사이에서 최고로 얻어낼 수 있는 절충안을 의미합니다.</p>\n<p>이 문제는 알려지지 않았거나 전혀 새로운 문제가 아닙니다. 과거에 수 많은 똑똑한 사람들이 달려들었고, 나중에 이 문제에 맞딱뜨릴 개발자를 위해 가이드라인을 만들었습니다. 저는 <a href="https://martinfowler.com/bliki/TestPyramid.html">테스팅 피라미드</a>를 신봉합니다. 테스팅 피라미드는 다양한 종류의 테스트를 제대로 다루는데 앞서, 각각의 코드를 개별적으로 다루는 단위 테스트(Unit test)가 기반이 되어야 한다고 강조합니다.</p>\n<h2 id="단위-테스트와-리덕스redux"><a href="#%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%EB%A6%AC%EB%8D%95%EC%8A%A4redux" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단위 테스트와 리덕스(Redux)</h2>\n<p>리덕스가 제시하는(역주: ‘강요하는’ 에 가까운 어감으로 느껴집니다) 구조 덕에 단위 테스트를 아주 쉽게 작성할 수 있습니다. 서로 분리되어있는 부분(리듀서, 액션 생성자, 컨테이너 등)을 각각 불러와서 여타 순수 함수와 똑같이 테스트 하면 됩니다. 데이터를 집어넣고, 나온 데이터를 단언(assertion)과 맞춰봅니다. 모킹(mocking)을 할 필요가 없지요. <a href="http://redux.js.org/docs/recipes/WritingTests.html">리덕스 문서 안에 있는 테스팅 가이드</a>에 각 부분의 단위 테스트를 하는 방법이 작성되어 있습니다.</p>\n<p>이 가이드를 따라가면서 지루하게 리듀서끼리, 액션 생성자끼리 테스트를 복-붙(copy-paste) 하다보면 단위 테스트 작성을 끝낼 수 있습니다. 그렇게 모든 작업이 끝나면 테스팅 피라미드가 뒷통수를 때리죠. 단순히 단위 테스트만 가지고는 ‘이 앱이 제대로 작동하는가?’ 라는 가장 기본적인 질문에 답할 수가 없습니다.</p>\n<h2 id="피라미드-오르기"><a href="#%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C-%EC%98%A4%EB%A5%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>피라미드 오르기</h2>\n<p>웹 애플리케이션을 작성하면서 테스팅 피라미드의 윗 단계로 올라가는데 몇 가지 방법이 있습니다. 맨 꼭대기에 있는 end-to-end(e2e) 계층은 Selenium과 <a href="http://webdriver.io">webdriver.io</a>를 사용해서 구현할 수 있습니다. 이런 종류의 테스트는 기술 독립적이라 여러분이 다른 프레임워크를 사용하도록 앱을 포팅해도 잘 작동합니다. 하지만 구현하고 돌려보는데 오래 걸리고, 디버그하기도 어려우며, 종종 원인 모를 문제에 시달릴 수 있습니다. 보통 아주 적은 종류의 e2e 테스트만 프로젝트에 적용하게 됩니다.</p>\n<p>그렇다면 e2e테스트와 단위 테스트 사이에 있는 계층은 어떨까요? 일반적으로 이런 테스트를 통합 테스트(integration test)라고 부릅니다. 애플리케이션의 모듈이 어떻게 상호작용하는지 테스트하지요. 통합 테스트의 범위는 넓습니다. 예를 들자면 액션을 보내기 위해(dispatch) 액션 생성자를 사용하는 리듀서를 테스트한다면 이미 단위 테스트의 범위를 넘어간 겁니다. 다른 측면에서 보면 e2e 테스트는 아주 극단적인 형태의 통합 테스트라고 볼 수 있습니다.</p>\n<p>우리는 리덕스에서 통합 테스트 하기에 아주 적절한 지점(sweet-spot)을 찾아보려 합니다. 개발 과정에서 충분히 빨리 돌려볼 수 있어야 하고, 단위 테스트와 같은 테스트 환경을 사용해야 하면서 리덕스로 관리되는 애플리케이션이 제대로 동작하고 있다는 충분한 확신을 줄 수 있어야 합니다.</p>\n<h2 id="범위를-찾기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EC%B0%BE%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 찾기</h2>\n<p>우선 테스트 하고자 하는 범위를 설정하는 게 좋은 출발점이 됩니다. 일반적인 웹 앱은 이런 방식으로 구성되어있는데요.</p>\n<p><img src="https://cl.ly/271c282D101g/typical-webapp-structure.png" alt="일반적으로 고도화된 웹앱의 구조"></p>\n<p>시스템의 일부는 올바른 테스트 결과를 얻기 위해 모킹되어야 합니다. 제일 제약이 심한 부분이 저 맨 꼭대기 위에 있는 ‘브라우저’입니다. (비록 헤드리스-Headless 라도) 브라우저 인스턴스를 띄워서 테스트를 돌리는 일은 Node.js(이하 노드)에서 테스트 코드를 실행하는 것보다 훨씬 오래 걸립니다. 시작부터 끝까지 진짜 요청이 끝나길 기다릴 필요는 없습니다. 네트워크 계층(역주: 프론트엔드와 백엔드 사이에 통신하는 부분을 지칭하는 것으로 보입니다)은 명확히 정의된 인터페이스라서 적절히 모킹하기 쉽습니다.</p>\n<h2 id="범위를-모킹하기"><a href="#%EB%B2%94%EC%9C%84%EB%A5%BC-%EB%AA%A8%ED%82%B9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>범위를 모킹하기</h2>\n<p>리액트와 리덕스를 쓰는 앱이 있다고 가정하면, 노드 환경에서 부드럽게 돌아가는 테스트를 작성하는게 꽤 쉽습니다(심지어 서버 사이드 랜더링을 한다면 프로덕션 환경에서도 가능합니다). <a href="https://facebook.github.io/jest/">Jest</a>라는 걸출한 테스팅 프레임워크로 테스트를 돌릴 수 있는데다, 마찬가지로 대단한 <a href="https://github.com/airbnb/enzyme">Enzyme</a>은 브라우저 환경 없이 애플리케이션의 일부 혹은 전체를 랜더링해주고 동작을 확인해볼 수 있게 만들어주기 때문입니다.</p>\n<p>Enzyme은 <code class="language-text">mount</code> 라는 함수를 제공하는데, 이 함수로 어떠한 리액트 컴포넌트라도 그려내고 동작을 확인해볼 수 있습니다. 리덕스를 쓰는 앱도 마찬가지로 테스트 가능합니다. 매번 테스트할 때 같은 코드를 반복하지 않기 위해 간단한 유틸리티 함수를 작성해두면 도움이 됩니다. 이 함수는 주어진 상태(Redux 스토어)와 Enzyme의 래퍼 객체(역주: Enzyme을 통해 그려진 컴포넌트를 객체화 한 것. 이후 다양한 메서드를 통해 하위 DOM 탐색 및 다양한 동작을 확인해볼 수 있습니다)를 리턴합니다. 이렇게 만들어둔 함수는 나중에 단언 작성을 꽤 편하게 해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react-redux\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'enzyme\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> MyApp <span class="token keyword">from</span> <span class="token string">\'./containers/MyApp\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> createStore <span class="token keyword">from</span> <span class="token string">\'./createStore\'</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">></span>\n      <span class="token operator">&lt;</span>MyApp <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nwrapper\n  <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'input\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token string">\'hello\'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>노드 환경에서 테스트를 실행할 때 네트워크 계층을 깔끔하게 모킹하는 방법이 있습니다. 예를 들어 <a href="https://github.com/node-nock/nock">nock</a> 같은 라이브러리가 있지요. nock은 테스트를 실행하기 전에 네트워크 요청에 따른 응답 데이터나 에러를 쉽게 선언할 수 있도록 만들어줍니다. 성공적인 GET 요청을 모킹하는 예는 다음과 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">\'nock\'</span><span class="token punctuation">;</span>\n<span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://example.com/api\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token string">\'bar\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 이후 코드 어디에서나 https://example.com/api/1234 로 요청을 하면</span>\n<span class="token comment">// 성공했다는 응답과 함께 { foo: \'bar\' } 를 응답값으로 리턴하게 됩니다.</span>\n</code></pre>\n      </div>\n<p>이렇게 설정하면 통합 테스트를 단위 테스트와 비슷한 수준으로 빠르고 편하게 실행할 수 있습니다. 이제 테스트를 구현하기만 하면 됩니다...</p>\n<p><img src="https://cl.ly/3j3q0t3Q0b2G/mock-boundaries.png" alt="리덕스 통합 테스트를 위해 테스트 범위 모킹"></p>\n<h2 id="무엇을-테스트하나"><a href="#%EB%AC%B4%EC%97%87%EC%9D%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무엇을 테스트하나?</h2>\n<p>여러분이 만든 앱이 정상적으로 동작한다는 자신감을 가장 크게 얻으려면 사용자의 시점에서 통합 테스트를 작성해야 합니다. 버튼 클릭, 폼 채우기 등의 사용자가 조작하는 행위에 따라 앱이 기대한대로 반응하는지 확인하는게 목표입니다.</p>\n<p>간단한 폼을 제출한다는 시나리오를 생각해 보겠습니다. 데이터가 폼에 들어있는 상태로 랜더링 한 뒤에 사용자가 ‘제출’ 버튼을 누르는 행위를 흉내를 내 보겠습니다(simulate). 그리고 지정된 API 엔드포인트로 요청을 제대로 보내는지 확인해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'Submitting the form\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> submitButton <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'[type="submit"]\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'sends the data and shows the confirmation page\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">\'https://myapp.com/api\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">\'/12345\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    submitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 이제 무슨 일이 일어나는지 확인합니다</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="언제-테스트하나"><a href="#%EC%96%B8%EC%A0%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>언제 테스트하나?</h2>\n<p>본격적으로 단언을 작성하기 전에, 또 하나의 문제가 있습니다. “테스트를 언제 실행하냐” 인데요(역주: 테스트 코드를 실행하는 행위가 아니라 모든 작업이 다 끝나고 기대값과 결과값을 비교하는 ‘단언’ 을 의미하나봅니다). 모든 변화가 순차적으로 일어나는 단순한 상황에서는 사용자 동작을 흉내를 낸 뒤에 바로 단언을 실행하면 됩니다. 하지만 여러분의 앱은 보통 네트워크 요청 같은 비동기 코드를 다루기 위해 프로미스(Promise) 등을 사용할 겁니다. 네트워크 요청을 순차적으로 실행되게 모킹해놓았다 하더라도, 성공한 프로미스는 <code class="language-text">submitButton.simulate(&#39;click&#39;)</code> 부분 다음의 코드를 바로 실행할겁니다. 우리는 단언이 실행되기 전에 앞선 작업이 “제대로 끝나기를” 기다리게 해야합니다.</p>\n<p>Jest는 여러가지로 비동기 코드를 다루는 방법을 제공하지만, Promise 체인을 직접 다루는 방식으로 동작하거나(이번 예시에는 없지요) , 타이머를 모킹해야 합니다(Promise 기반 코드에는 동작하지 않습니다). <code class="language-text">setTimeout(() =&gt; {}, 0)</code> 같은 코드를 사용할 수 있지만 <a href="https://facebook.github.io/jest/docs/en/asynchronous.html">Jest의 비동기 콜백 기능</a>을 사용해야 해서 코드의 가독성이 떨어지게 됩니다.</p>\n<p>하지만 이 문제를 멋지게 해결하기 위해 한 줄짜리 보조 함수를 사용하면 됩니다. 이 함수는 성공한 Promise를 이벤트 루프의 바로 다음 차례로 넘기는 일을 합니다. Jest에서 기본적으로 지원하는 Promise 리턴과 같이 사용하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">flushAllPromises</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=></span> <span class="token function">setImmediate</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'runs some promise based code\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">triggerSomethingPromiseBased</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise 기반의 동작 실행</span>\n  <span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n     <span class="token comment">// 무슨 일이 일어나는지 확인하기</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="어떻게-테스트하나"><a href="#%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%82%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어떻게 테스트하나?</h2>\n<p>사용자와 앱의 상호작용이 제대로 이루어지고 있나 확인하려면 어떤 방법이 있을까요?</p>\n<p><strong>마크업(Markup)</strong> - UI가 제대로 변경되었는지 확인하기 위해 페이지의 마크업을 들여다볼 수 있습니다. 예를 들어 <a href="https://facebook.github.io/jest/docs/snapshot-testing.html">Jest의 스냅샷 기능으로요.</a> (유의할 점: 아래의 테스트 코드를 실행하기 위해 <a href="https://github.com/adriantoine/enzyme-to-json#serializer">enzyme-to-json</a>같은 Jest 스냅샷 직렬화 모듈(serializer)을 설치해야 합니다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 방식의 단언은 작성하기 아주 쉽지만, 어디에 문제가 있는지 살펴보기 어려워지는 경향이 있습니다. 스냅샷은 가끔 겉으로 보기에 상관없어 보이는 테스트가 실패할 때도 변할 수 있습니다. 게다가 변화가 있었는지 확인만 할 뿐 무슨 행동을 했는지 기록을 남기진 않습니다.</p>\n<p><strong>상태(State)</strong> - 애플리케이션의 상태 변경을 확인하는 방법입니다. 한 곳에 집중된 스토어를 가지고 있는 리덕스 애플리케이션은 테스트하기 쉽지만, 상태가 나뉘어있다면 조금 복잡해질 수 있습니다. 이 때도 스냅샷 테스트를 할 수 있지만 저는 객체를 직접 비교하는 방식을 선호하는 편입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n    confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>상태 스토어는 사용자가 보지 못하는 곳에 감추어져 있기 때문에 사용자 중심적인 테스트와는 약간 거리가 있습니다. 하지만 디자인 변경에 따른 마크업 수정이 일어나는 경우 영향을 덜 받습니다.</p>\n<p><strong>부수 기능(Side effects)</strong> - 여러분의 애플리케이션에 따라 확인해야 하는 부수 기능도 있습니다(네트워크 요청, <code class="language-text">localStorage</code> 변화 등). 이럴 때 nock의 <code class="language-text">isDone</code> 메서드를 활용하여 모킹한 요청이 실제로 사용되었는지 확인할 수도 있습니다. </p>\n<p><strong>액션 보내기(Dispatched actions)</strong> - 리덕스의 기능을 십분 활용하여 어떤 액션이 발생했는지 쉽게 로그를 정리하고 나열할 수 있습니다. 이를 이용해서 스토어에 액션을 보내는 흐름을 확인해볼 수 있습니다. <a href="https://github.com/arnaudbenard/redux-mock-store">redux-mock-store</a> 같은 유용한 라이브러리의 도움을 받을 수도 있습니다. 먼저 위에서 정의한 <code class="language-text">renderAppWithState</code> 메서드를 조금 수정해서 가상의 리덕스 스토어를 적용하면, 그 다음 스토어에 어떤 액션들이 호출되었는지 확인하기 위해 <code class="language-text">getActions</code> 메서드를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ...</span>\n<span class="token comment">// 이제 renderAppWithState는 redux-mock-state를 사용해서 스토어를 생성합니다.</span>\n<span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> wrapper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">renderAppWithState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'John Doe\'</span><span class="token punctuation">,</span>\n  confirmationVisible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nsubmitButton<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'click\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> <span class="token function">flushAllPromises</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getActions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_START\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> \n    <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">\'SUBMIT_FORM_SUCCESS\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이런 유형의 단언은 특히 코드가 비동기로 흘러갈 때 테스트 하고자 할 때 유용합니다. 또한 테스트 시나리오가 어떤 흐름으로 구성되는지 보여주면서 일종의 문서 역할을 합니다.</p>\n<h2 id="중심-잡기"><a href="#%EC%A4%91%EC%8B%AC-%EC%9E%A1%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>중심 잡기</h2>\n<p>앞서 소개한 통합 테스트가 단위 테스트를 완전히 대체한다는 뜻은 아닙니다. 특히 애플리케이션에 무거운 로직이 있는 부분(리듀서나 셀렉터)은 여전히 철저하게 단위 테스트가 적용되어야 합니다. 테스팅 피라미드의 계층은 여전히 유효합니다! 하지만 통합 테스트는 테스트 방법 중 하나로서 충분히 유효하며, 가능한 한 고통을 덜고 더 자신있게 소프트웨어를 배포할 수 있도록 좋은 테스트를 구축하는데 도움이 됩니다.</p>\n<p>소프트웨어 테스트라는 주제는 업계에서 가장 많이 오가는 주제 중 하나입니다. 제 동료는 제 글을 검수해주면서 “<a href="http://blog.thecodewhisperer.com/permalink/integrated-tests-are-a-scam">통합 테스트는 사기다</a>” 라는 글을 알려주기도 했습니다. 어떤 사람들은 저 글을 쓴 사람이 맞다고도 하지만, 제가 생각하기에 흑백 논리로 따질 수 없는 주제라고 생각합니다. 여러분은 어떻게 생각하시나요?</p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-19-intergration-tests-in-redux-apps-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-19",path:"/posts/integration-tests-in-redux-apps-kr",title:"[번역] 리덕스 앱을 저비용 고효율로 통합 테스트 하기",tags:["Testing","React","Javascript"],category:"Testing"}},{excerpt:"다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로  TypeStyle 을 활용하는 방안을 검토중이다. 그래서  egghead의 강좌 를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다. 적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS…",html:'<p>다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로 <a href="https://typestyle.github.io">TypeStyle</a>을 활용하는 방안을 검토중이다.</p>\n<p>그래서 <a href="https://egghead.io/courses/maintainable-css-using-typestyle">egghead의 강좌</a>를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다.</p>\n<p>적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS를 적극적으로 활용하여 동적인 스타일을 입힐 수 있으리라 기대한다.</p>\n<p>참고로 아래의 예제 코드는 모두 리액트 애플리케이션을 개발한다는 전제하에 소개하고 있다. 하지만 TypeStyle 자체는 어느 환경에서나 사용 가능하다.</p>\n<h2 id="기본-사용법"><a href="#%EA%B8%B0%EB%B3%B8-%EC%82%AC%EC%9A%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 사용법</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOM <span class="token keyword">from</span> <span class="token string">\'react-dom\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  position<span class="token punctuation">:</span> <span class="token string">\'relative\'</span> \n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello TypeStyle<span class="token operator">!</span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">style</code> 함수로 생성된 내용이 스타일이 적용된 임의의 클래스 이름을 만들게 되고 DOM은 바로 클래스 이름을 사용하면 되도록 구성되어 있다.</p>\n<p>이 과정에서 객체 형식으로 되어있는 key-value 값은 이미 라이브러리에 CSS 스펙에 맞게 정의되어 있기 때문에 오타가 날 시 컴파일러가 친절하게 에러를 잡아준다.</p>\n<h2 id="스타일-믹스인"><a href="#%EC%8A%A4%ED%83%80%EC%9D%BC-%EB%AF%B9%EC%8A%A4%EC%9D%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스타일 믹스인</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 위 코드와 동일한 DOM 랜더링</span>\n<span class="token keyword">function</span> <span class="token function">fontSize</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> valueStr <span class="token operator">=</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">\'string\'</span>\n    <span class="token operator">?</span> value\n    <span class="token punctuation">:</span> value <span class="token operator">+</span> <span class="token string">\'px\'</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> valueStr\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> fontColor <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token string">\'3em\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  fontColor\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>위의 코드 처럼 <code class="language-text">style</code> 함수는 객체를 믹스인 할 수 있다. 프로퍼티가 맞는 순수 객체가 들어가면 아무 없이 작동하기 때문에 위의 <code class="language-text">fontSize</code> 함수처럼 상황에 맞게 적절한 객체를 리턴하는 함수를 만들어서 다양한 상황에 맞게 사용할 수 있다.</p>\n<h2 id="미디어-쿼리"><a href="#%EB%AF%B8%EB%94%94%EC%96%B4-%EC%BF%BC%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>미디어 쿼리</h2>\n<p><code class="language-text">media</code> 함수로 간단히 미디어 쿼리를 생성할 수 있다. 생성된 쿼리를 <code class="language-text">style</code> 함수 안에 넣으면 자동으로 Nested 쿼리 형식으로 생성된다. 수동으로 Nested 쿼리를 입력하고자 할 때는 <code class="language-text">style</code> 함수 안에 넣는 객체에 <code class="language-text">$nest</code> 속성을 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> media <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">:</span> <span class="token number">700</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">701</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="수도-클래스pseudo-class-작성"><a href="#%EC%88%98%EB%8F%84-%ED%81%B4%EB%9E%98%EC%8A%A4pseudo-class-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>수도 클래스(pseudo class) 작성</h2>\n<p>Sass, Less와 유사한 형태로 계층 화된 쿼리를 작성할 수 있다. 위에서 언급한 <code class="language-text">$nest</code> 속성을 선택하면 해당 클래스의 계층 쿼리를 작성할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span><span class="token punctuation">,</span>\n    $nest<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'&amp;:focus\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token string">\'&amp;&amp;:hover\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class.class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="css-클래스-조합하기"><a href="#css-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%A1%B0%ED%95%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 클래스 조합하기</h2>\n<p>클래스를 조합하는건 <code class="language-text">style</code> 함수로 만들어진 클래스들을 분기에 따라 추가하고 제거하도록 만들면 된다. 다만 이 과정에서 있는 경우와 없는 경우에 따라 문자열을 조합하는게 번거로울 수 있는데, <code class="language-text">classes</code> 함수가 귀찮은 부분을 쉽게 해결하도록 도와준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> baseClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'#333\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> errorClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">interface</span> <span class="token class-name">AppProps</span> <span class="token punctuation">{</span>\n  className<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n  hasError<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> className<span class="token punctuation">,</span> hasError <span class="token punctuation">}</span><span class="token punctuation">:</span> AppProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>\n    <span class="token function">classes</span><span class="token punctuation">(</span>\n      baseClassName<span class="token punctuation">,</span>\n      className<span class="token punctuation">,</span>\n      hasError <span class="token operator">&amp;&amp;</span> errorClassName\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token operator">></span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="keyframes-함수로-애니메이션-만들기"><a href="#keyframes-%ED%95%A8%EC%88%98%EB%A1%9C-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Keyframes 함수로 애니메이션 만들기</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> keyframes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> colorAnimationName <span class="token operator">=</span> <span class="token function">keyframes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token string">\'0%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'black\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">\'50%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'blue\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'20px\'</span><span class="token punctuation">,</span>\n    animationName<span class="token punctuation">:</span> colorAnimationName<span class="token punctuation">,</span>\n    animationDuration<span class="token punctuation">:</span> <span class="token string">\'1s\'</span><span class="token punctuation">,</span>\n    animationIterationCount<span class="token punctuation">:</span> <span class="token string">\'infinite\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">colorAnimationName</code> 을 일일이 변수로 분리 할 필요는 없다. 한번만 사용할거면 <code class="language-text">animationName</code> 속성에 바로 <code class="language-text">keyframes</code> 를 사용한 객체를 리턴하도록 만들면 된다.</p>\n<h2 id="일반-css를-사용하기"><a href="#%EC%9D%BC%EB%B0%98-css%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일반 CSS를 사용하기</h2>\n<p><code class="language-text">cssRaw</code> 함수를 사용하고 그 안에 일반 CSS를 문자열로 집어넣으면 그대로 글로벌 스타일로 변환된다. 그리고 그 파일안에 있는 컴포넌트에 전부 영향을 준다. 특정 이름을 가진 클래스를 만들고, 간단하게 기존 스타일을 마이그레이션 하거나 NormalizeCSS 등을 바로 가져올 때도 유용하게 사용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> cssRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.red {\n  color: red;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.bold {\n  font-weight: bold;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className <span class="token operator">+</span> <span class="token string">\' red bold\'</span><span class="token punctuation">}</span><span class="token operator">></span> <span class="token comment">// red, bold 클래스 사용 가능</span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="구형-브라우저용-속성-사용하기"><a href="#%EA%B5%AC%ED%98%95-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9A%A9-%EC%86%8D%EC%84%B1-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구형 브라우저용 속성 사용하기</h2>\n<p><code class="language-text">rgba</code> 같은 구형 브라우저에서 지원되지 않는 속성을 사용하면서 구형 브라우저를 지원하는 용도로 <code class="language-text">rgb</code> 를 사용하는 경우, CSS 파일에서는 보통 같은 속성을 두번 작성해서 문제를 해결할 수 있다. 하지만 TypeStyle은 객체를 파싱하기 때문에 같은 속성 값을 두번 선언할 수는 없다.</p>\n<p>하지만 배열을 사용하면 한 속성에 배열의 요소를 순차적으로 따라 스타일을 적용하도록 만들 수 있으며, 비슷한 원리를 vendor prefix에도 적용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> types <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> scroll<span class="token punctuation">:</span> types<span class="token punctuation">.</span>NestedCSSProperties <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token string">\'-webkit-overflow-scrolling\'</span><span class="token punctuation">:</span> <span class="token string">\'touch\'</span><span class="token punctuation">,</span>\n  overflow<span class="token punctuation">:</span> <span class="token string">\'auto\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  scroll<span class="token punctuation">,</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span><span class="token punctuation">,</span>\n    backgroundColor<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token string">\'rgb(200, 54, 54)\'</span><span class="token punctuation">,</span> <span class="token comment">// 구형 브라우저용</span>\n      <span class="token string">\'rgba(200, 54, 54, 0.5)\'</span> <span class="token comment">// 요즘 브라우저용</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="정적-페이지-만들어보기"><a href="#%EC%A0%95%EC%A0%81-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정적 페이지 만들어보기</h2>\n<p><code class="language-text">getStyles</code> 함수는 현재 작성된 파일 안에 정의된 TypeStyle 스타일을 문자열로 변환하는 기능을 한다. 이를 이용해서 간단한 HTML 페이지를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// app.tsx</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fs <span class="token keyword">from</span> <span class="token string">\'fs\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOMServer <span class="token keyword">from</span> <span class="token string">\'react-dom/server\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> getStyles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello World\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> html <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToStaticMarkup</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> css <span class="token operator">=</span> <span class="token function">getStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">renderPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> html<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> css<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token string">`\n&lt;html>\n  &lt;head>\n    &lt;style></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>css<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/style>\n  &lt;/head>\n  &lt;body>\n    </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n  &lt;/body>\n&lt;/html>\n`</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> renderedPage <span class="token operator">=</span> <span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nfs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">,</span> renderedPage<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- 결과물 --></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token selector">.fyuerk</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fyuerk<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hello World<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 방식을 응용하여 서버 사이드 랜더링에서도 스타일을 적용할 수 있다. <a href="https://egghead.io/lessons/css-render-html-css-server-side-using-typestyle">영상 참고.</a></p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-16-typestyle-basic/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-16",path:"/posts/typestyle-basic",title:"TypeStyle 사용하기",tags:["TypeScript","React","CSS"],category:"TypeStyle"}},{excerpt:"MobX를 리액트에 쓰기 위해 필요한 기본 구성은  ,   패키지이다. 그리고 각각  ,   데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다. Observer 생성한 스토어가   로 구성되어 있고, 컴포넌트가   데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다. MobX…",html:'<p>MobX를 리액트에 쓰기 위해 필요한 기본 구성은 <code class="language-text">mobx</code>, <code class="language-text">mobx-react</code> 패키지이다. 그리고 각각 <code class="language-text">observable</code>, <code class="language-text">observer</code> 데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다.</p>\n<h2 id="observer"><a href="#observer" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observer</h2>\n<p>생성한 스토어가 <code class="language-text">observable</code> 로 구성되어 있고, 컴포넌트가 <code class="language-text">observer</code> 데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> appState <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  count<span class="token punctuation">:</span> <span class="token number">0</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">--</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">handleInc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function-variable function">handleDec</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>div<span class="token operator">></span>\n        Counter<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span>count<span class="token punctuation">}</span> <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleInc<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">+</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDec<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">-</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>MobX의 리액트 개발자 도구는 크롬 같은 브라우저의 확장으로 설치하는 것이 아니라 일종의 리액트 컴포넌트로 되어있다. 따라서 프로젝트에 <code class="language-text">mobx-react-devtools</code> 를 설치하고 <code class="language-text">&lt;Devtools /&gt;</code> 같은 컴포넌트를 컴포넌트 트리에 삽입하면 된다.\nObservable 스토어를 다룰 때 DOM을 그리는 등의 동작은 Side Effects(부가 동작)으로 처리된다. 이 때 스토어의 상태를 효율적으로 다루기 위해 <code class="language-text">computed</code> 속성을 쓰면 필요한 부분만 스토어의 변경을 감지하여 효과적인 컴포넌트 랜더링이 가능하다.</p>\n<h2 id="action"><a href="#action" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Action</h2>\n<p><code class="language-text">@action</code> 데코레이터는 리듀서의 액션 디스패치와 같은 역할을 한다. 데코레이터와 함께 메서드를 작성하고, 이에 따라 Observable 값이 변경되도록 하면 MobX가 알아서 처리 해줄 것이다. Observable한 값을 직접 변경해주는 것도 일종의 액션이다. 상태 변경의 방법을 밖으로 드러내어 실수를 미연에 방지하는 것이 액션의 역할 뿐 아니라, 상태 변경을 하나의 단위로 묶어 트랜잭션을 수행하는 역할도 가지고 있다. 또한 비동기 작업 수행을 효과적으로 제어할 때도 사용된다. 예를 들어 작업 시행 -> 작업 종료가 명료하게 동기화되어야 할 때 액션을 사용하면 의도치 않은 동작을 방지할 수 있다.</p>\n<p><code class="language-text">@action(name: string)</code> 같은 형식으로 이름을 넣어서 개발 도구에서 손쉽게 액션을 파악할 수 있다. 그리고 액션을 쓰지 않고 직접 상태를 변경하는 일을 막기 위해 <code class="language-text">useStrict</code> 함수로 strict mode를 설정할 수 있다. 이 때는 액션 데코레이터 없이는 상태 변경을 수행할 수 없다.</p>\n<h2 id="observable-data-structure"><a href="#observable-data-structure" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observable Data Structure</h2>\n<p><code class="language-text">observable</code> 함수로 배열, 객체, Map 등을 감싸서 활용할 수 있다. 이 세 가지는 MobX에서 가장 중요하게 여기는 자료구조이다. 여기서 객체나 배열에 들어갈 값은 기존 자바스크립트에서 쓰는 단순한 객체나 원시 타입의 값일 수도 있지만, 개발자가 MobX의 기능을 활용하여 만든 상태 모델의 인스턴스를 넣어서 조작할 수도 있다. 가령 위에서 이야기한 <code class="language-text">computed</code>, <code class="language-text">action</code> 등을 활용한 임의의 클래스를 만들고, 그 클래스의 인스턴스들을 배열에다 넣어서 다룰 수 있다는 이야기다.</p>\n<p><code class="language-text">observable([])</code> 같은 명령어로 만들어진 배열은 유사 배열이기 때문에 실제 배열처럼 다루려면 <code class="language-text">toJS</code> 같은 별도의 가공이 필요하다.</p>\n<h2 id="컴포넌트를-나누어-관리하기"><a href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%A5%BC-%EB%82%98%EB%88%84%EC%96%B4-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컴포넌트를 나누어 관리하기</h2>\n<p>Observable 상태를 <code class="language-text">map</code> 함수로 순회하며 하위 컴포넌트를 생성할 때 고려해야 할 점이 있다. 아무 처리도 없이 <code class="language-text">map</code> 함수로 생성한 하위 컴포넌트에서 <code class="language-text">onClick</code> 등으로 상태를 바꾸면, 겉으로 보기에는 상태가 변한 부분만 다시 랜더링 되는 것으로 보이지만 실제로 모든 하위 컴포넌트가 다시 랜더링된다. 이런 구조가 누적되면 결과적으로 큰 자원 낭비를 초래하기 때문에 최적화헤야 한다.\n가장 간단한 방법은 <code class="language-text">map</code> 함수 안에서 생성되는 하위 컴포넌트가 <code class="language-text">@observer</code> 임을 명시해주고, 상태 변화 액션도 <code class="language-text">@action</code> 으로 관리해주면 된다. 최적화는 MobX가 알아서 해 준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n    <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n      <span class="token operator">&lt;</span>TView Key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n    <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">TView</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onTempClick<span class="token punctuation">}</span><span class="token operator">></span>\n        <span class="token punctuation">{</span>t<span class="token punctuation">.</span>temperature<span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  @action <span class="token function-variable function">onTempClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="provider-컴포넌트-사용하기"><a href="#provider-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provider 컴포넌트 사용하기</h2>\n<p><code class="language-text">mobx-react</code> 는 <code class="language-text">react-redux</code> 처럼 <code class="language-text">Provider</code> 컴포넌트를 제공한다. 사실 MobX의 스토어는 한번 선언되어있으면 어디서 어떻게 가져다쓰던 <code class="language-text">observer</code>, <code class="language-text">observable</code> 선언만 제대로 되어있으면 동적으로 연결된다. 하지만 기존에 리덕스를 사용할 때 처럼 최상단 컴포넌트를 Provider 컴포넌트로 감싸기만 하면 <code class="language-text">connect</code>, <code class="language-text">mapStateToProps</code> 같은 함수를 사용하지 않아도 바로 자유자재로 사용할 수 있다. 단지 <code class="language-text">@observer</code> 데코레이터 선언 시 어떤 스토어를 사용할지만 명시하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 스토어 선언 및 Provider 감싸기</span>\n<span class="token keyword">const</span> temps <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>Provider temperatures<span class="token operator">=</span><span class="token punctuation">{</span>temps<span class="token punctuation">}</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// App 컴포넌트</span>\n<span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span>\n  <span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n      <span class="token operator">&lt;</span>TemperatureInput <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n        <span class="token operator">&lt;</span>TView key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">)</span><span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// temperatures를 사용하는 컴포넌트</span>\n<span class="token comment">// 위의 App 컴포넌트를 보면 알겠지만 따로 props 선언이 없었음에도 바로 사용 가능하다.</span>\n@<span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">class</span> <span class="token class-name">TemperatureInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  @observable input <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li<span class="token operator">></span>\n        Destination\n        <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">}</span>\n        value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">}</span>\n        <span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit<span class="token punctuation">}</span><span class="token operator">></span>Add<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="특정-상황에서-반응하는-액션-작성하기"><a href="#%ED%8A%B9%EC%A0%95-%EC%83%81%ED%99%A9%EC%97%90%EC%84%9C-%EB%B0%98%EC%9D%91%ED%95%98%EB%8A%94-%EC%95%A1%EC%85%98-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정 상황에서 반응하는 액션 작성하기</h2>\n<p>작성해놓은 스토어를 사용할 때 특정 조건에 맞추어 원하는 동작이 발생하도록 훅을 걸거나(<code class="language-text">when</code>), 모든 상태 변화마다 실행되는 함수를 지정할 수도 있다(<code class="language-text">autorun</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// when의 사용 예</span>\n<span class="token keyword">function</span> <span class="token function">isNice</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> t<span class="token punctuation">.</span>temperatureCelsius <span class="token operator">></span> <span class="token number">25</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">when</span><span class="token punctuation">(</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> temps<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> temps<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Book now! "</span> <span class="token operator">+</span> t<span class="token punctuation">.</span>location<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// autorun의 사용 예</span>\n<span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">autorun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'6\'</span>\nnumbers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'10\'</span>\n</code></pre>\n      </div>\n<p><a href="https://mobx.js.org/refguide/computed-decorator.html">공식 문서</a>에 따르면 <code class="language-text">autorun</code> 함수는 상태 값을 변화시키지 않으면서 항상 실행되어야 하는 상황(로깅, UI 업데이트)에서 사용되며 그 이외의 경우는 전부 <code class="language-text">computed</code> 사용을 권장하고 있다.</p>\n<blockquote>\n<p>Don\'t confuse computed with autorun. They are both reactively invoked expressions, but use @computed if you want to reactively produce a value that can be used by other observers and autorun if you don\'t want to produce a new value but rather want to achieve an effect. For example imperative side effects like logging, making network requests etc.</p>\n</blockquote>\n<h2 id="참고-자료"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2>\n<ul>\n<li><a href="https://egghead.io/courses/manage-complex-state-in-react-apps-with-mobx">Manage Complex State in React Apps with MobX from @mweststrate on @eggheadio</a></li>\n<li><a href="https://egghead.io/courses/manage-application-state-with-mobx-state-tree">Manage Application State with Mobx-state-tree from @mweststrate on @eggheadio</a></li>\n<li><a href="https://mobx.js.org/">Mobx Documentation</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-12-31-mobx-basic-concepts/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-31",path:"/posts/mobx-basic-concepts",title:"MobX로 상태 관리하기",tags:["Javascript","MobX","React"],category:"MobX"}},{excerpt:"Advanced React Component Patterns 강좌 강좌에 수록된 코드 Kent C. Dodds 의 강좌가 egghead에 한정된 기간동안 무료로 올라왔다. 때문에 다른 강의들을 제쳐두고 일단 이 강의부터 끝내기로 했다. HOC, Render props…",html:'<ul>\n<li><a href="https://egghead.io/courses/advanced-react-component-patterns">Advanced React Component Patterns 강좌</a></li>\n<li><a href="https://github.com/kentcdodds/advanced-react-patterns">강좌에 수록된 코드</a></li>\n</ul>\n<p><a href="https://kentcdodds.com/">Kent C. Dodds</a>의 강좌가 egghead에 한정된 기간동안 무료로 올라왔다. 때문에 다른 강의들을 제쳐두고 일단 이 강의부터 끝내기로 했다. HOC, Render props같은 고급 리액트 개발 방법론에 관심은 있었으나 대강 글만 봐서는 이해가 되지 않았기 때문이다.</p>\n<p>강의에 들어가는 코드는 복잡한 개발환경을 설정하는데 시간을 낭비하지 않기 위해 html페이지 하나로 모든 작업을 다 할 수 있도록 만들어져있다. React, ReactDOM, Babel을 unpkg로 불러온 뒤 수업을 따라가면 된다. 처음에는 강의 코드를 제공하지 않는 줄 알고 토글 버튼의 스타일은 <a href="https://codepen.io/designcouch/pen/qdBErE">구글링해서 넣었었다</a>.</p>\n<p>이후에 작성된 코드는 강의에서 나온 코드 중 핵심 부분을 발췌해서 넣어둔 것이며, 맥락을 파악하기 위해서 강의 자료를 보거나 코드 저장소에 있는 완결된 코드를 살펴보기 바란다.</p>\n<hr>\n<h2 id="compound-components"><a href="#compound-components" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compound Components</h2>\n<p>만약 <code class="language-text">Toggle</code> 컴포넌트를 랜더할 때 현재 켜졌는지 꺼졌는지 텍스트를 표시하면서도 그 위치를 때에 따라 조절하고자 한다면 단순히 <code class="language-text">render</code> 메서드 안에 삼항연산자 등을 쓸 수 있을 것이다. 하지만 이 경우 텍스트를 표시하지 않으면서 컴포넌트를 재사용하기 어려워진다. 이 때 <code class="language-text">React.Children.map</code> 함수를 이용해서 자손 컴포넌트를 생성함과 동시에 컴포넌트의 state, prop을 전달할 수 있고, 자손 컴포넌트는 이를 받아 상태에 따라 랜더할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ToggleOn</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> on <span class="token operator">?</span> children <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">ToggleOff</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> on <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> children<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">ToggleButton</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Switch</span> <span class="token attr-name">on</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on<span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Toggle</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token keyword">static</span> On <span class="token operator">=</span> ToggleOn<span class="token punctuation">;</span>\n  <span class="token keyword">static</span> Off <span class="token operator">=</span> ToggleOff<span class="token punctuation">;</span>\n  <span class="token keyword">static</span> Button <span class="token operator">=</span> ToggleButton<span class="token punctuation">;</span>\n  <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span> onToggle<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span> on<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  \n  <span class="token function-variable function">toggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> \n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>\n      <span class="token punctuation">(</span><span class="token punctuation">{</span> on <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">:</span> <span class="token operator">!</span>on <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onToggle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> children <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span>\n      child <span class="token operator">=></span>\n        React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n          on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n          toggle<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span> <span class="token attr-name">onToggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'toggle\'</span><span class="token punctuation">,</span> on<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.On</span><span class="token punctuation">></span></span>The Button is on<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.On</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Button</span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Off</span><span class="token punctuation">></span></span>The Button is off<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.Off</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="context로-확장성을-더하기"><a href="#context%EB%A1%9C-%ED%99%95%EC%9E%A5%EC%84%B1%EC%9D%84-%EB%8D%94%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context로 확장성을 더하기</h2>\n<p><a href="https://reactjs.org/docs/context.html#how-to-use-context">Context란?</a></p>\n<p>위의 코드에는 약간의 문제가 있는데, children은 바로 하위 컴포넌트만 처리하기 때문에 계층을 조금 더 복잡하게 만드는 순간 전혀 작동하지 않는다. 예를 들자면</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span> <span class="token attr-name">onToggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'toggle\'</span><span class="token punctuation">,</span> on<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.On</span><span class="token punctuation">></span></span>The Button is on<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.On</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Button</span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Off</span><span class="token punctuation">></span></span>The Button is off<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.Off</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 <code class="language-text">div</code>로 감싸진 <code class="language-text">child</code>는 작동하지 않는다. 이 때 Context 속성을 사용하는데, 예전에 <a href="https://egghead.io/courses/getting-started-with-redux">Dan의 Redux 직강</a>에서 리덕스를 직접 구현하는 방법을 보여줄 때 사용했던 요소이다. 사실 Context API는 실제로 사용자가 이를 직접 쓰기보단 라이브러리 등에서 유용하게 쓰기 위한 목적으로 만들어진 것으로 보인다.</p>\n<p>혹시나 Context가 중복되지 않도록 고유의 context key를 선언한 다음, 부모 컴포넌트에는 <code class="language-text">getChildContext</code> 메서드를 선언해서 key에 맞는 값을 돌려주는 객체를 리턴하도록 만든다. 그리고 <code class="language-text">contextTypes</code>라는 PropTypes 검사를 항상 마련해두어야 하는 것으로 보인다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ToggleOn</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> on <span class="token punctuation">}</span> <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> on <span class="token operator">?</span> children <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\nToggleOn<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n<span class="token comment">// 부모 컴포넌트의 메서드 정의</span>\n<span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n      toggle<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이러면 얼마나 깊이 해당 컴포넌트가 묻혀있는지 상관없이 자손 컴포넌트이기만 하고, 알맞은 context key를 가져올 수 있다면 원하는 상태를 추출할 수 있다.</p>\n<hr>\n<h2 id="higher-order-components"><a href="#higher-order-components" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Higher Order Components</h2>\n<h3 id="hoc-만들기"><a href="#hoc-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HOC 만들기</h3>\n<p>이번에는 더 작은 규모의 <code class="language-text">MyToggle</code> 이라는 버튼으로만 이루어진 컴포넌트를 만들면서 시작한다. 버튼 자체는 <code class="language-text">on</code> 속성에 따라 다른 텍스트를 보여주는 정도인데, 이 버튼이 손쉽게 Context의 속성을 받기 위해 새로운 함수를 만든다. </p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// Higher order component</span>\n<span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">toggleContext</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> Wrapper<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> MyToggle <span class="token operator">=</span> <span class="token function">withToggle</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">withToggle</code> 함수가 컴포넌트를 인자로 받은 뒤 이를 <code class="language-text">toggleContext</code> 속성이 추가된 컴포넌트로 돌려주고 있다. 결과적으로 toggleContext가 필요한 컴포넌트는 모두 <code class="language-text">withToggle</code> 함수로 감싸면 되도록 만들었다.</p>\n<h3 id="네임스페이스-충돌을-방지하기"><a href="#%EB%84%A4%EC%9E%84%EC%8A%A4%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%B6%A9%EB%8F%8C%EC%9D%84-%EB%B0%A9%EC%A7%80%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>네임스페이스 충돌을 방지하기</h3>\n<p>하지만 나중에 이 HOC를 이용하는 사용자가 우리가 미리 정의해놓은 속성과 같은 이름의 속성을 사용하는 경우 충돌이 날 수 있다. 지금의 경우는 <code class="language-text">on</code>  속성이 문제가 될 수 있을 것이다. 따라서 HOC를 위한 네임스페이스를 별도로 지정해주어 문제를 해결한다. 다만 이 때는 객체 분해 시 별도의 이름을 지정해주어야하는 번거로움이 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// Higher order component with their own namespace</span>\n<span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span>\n      <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleContext<span class="token punctuation">}</span></span>\n      <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>\n    <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> Wrapper<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// extract toggle context from HOC</span>\n<span class="token keyword">const</span> MyToggle <span class="token operator">=</span> <span class="token function">withToggle</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> toggle<span class="token punctuation">:</span> <span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h3 id="개발자-도구의-사용성-높이기"><a href="#%EA%B0%9C%EB%B0%9C%EC%9E%90-%EB%8F%84%EA%B5%AC%EC%9D%98-%EC%82%AC%EC%9A%A9%EC%84%B1-%EB%86%92%EC%9D%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>개발자 도구의 사용성 높이기</h3>\n<p>HOC를 쓰게 되는 경우 브라우저의 리액트 개발자 도구로 디버깅을 할 때 예기치 못한 문제가 발생하는데, 개발자 도구에 표시되는 컴포넌트 이름은 함수 이름 기반이기 때문에 <code class="language-text">Wrapper</code> 라는 이름으로 감싸는 컴포넌트가 표시되고, 감싸지는 컴포넌트는 익명함수를 전달했기 때문에 <code class="language-text">Unknown</code> 이라는 이름으로 표시된다. 이러면 아주 복잡한 컴포넌트 트리에서 원하는 이름의 컴포넌트를 찾고자 검색을 이용하고자 해도 원하는 결과를 찾을 수 없다.</p>\n<p>그러면 두 가지 문제를 해결해야 하는데 먼저 <code class="language-text">withToggle(something)</code> 이라고 HOC의 명확한 이름을 지정해주는 것과, 감싸지는 컴포넌트에도 명확한 이름을 지정해주는 것이다.</p>\n<p>첫 번째 문제는 HOC에 <code class="language-text">displayName</code> 속성을 지정해주어 해결할 수 있다. 두 번째 문제는 익명함수들을 명확한 이름을 가진 함수로 분리하고, <code class="language-text">withToggle</code> 로 따로 감싸서 해결하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// displayName 속성 추가</span>\n<span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span> <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleContext<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token comment">// displayName이 지정되지 않은 컴포넌트는 각자 함수의 이름을 name 속성으로 가진다</span>\n  Wrapper<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`withToggle(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> Wrapper<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">MyToggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> toggle<span class="token punctuation">:</span> <span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> MyToggleWrapper <span class="token operator">=</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>MyToggle<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h3 id="ref-속성-제어"><a href="#ref-%EC%86%8D%EC%84%B1-%EC%A0%9C%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ref 속성 제어</h3>\n<p>만약 토글 상태에 따라 버튼의 포커스를 조절하고 싶을 때는 <code class="language-text">ref</code> 를 이용해서 컴포넌트를 제어할 수 있을 것이다. 하지만 <code class="language-text">ref</code> 속성은 SFC(Stateless Functional Component)에는 사용할 수 없다. 게다가 클래스 컴포넌트를 만들었다 하더라도 HOC로 감싸게 되면 <code class="language-text">Wrapper</code> 함수가 SFC를 리턴하기 때문에 제대로 써 먹을 수가 없다. </p>\n<p>간단한 해법은 <code class="language-text">ref</code> 를 HOC로 전달하는건데, 유의할 점은 <code class="language-text">ref</code> 는 그 이름 바로 전달할 수가 없다. 따라서 <code class="language-text">innerRef</code> 같은 별도의 이름을 지정해서 전달하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// handle innerRef</span>\n<span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span><span class="token punctuation">{</span> innerRef<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span>\n        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>\n        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>innerRef<span class="token punctuation">}</span></span>\n        <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleContext<span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  Wrapper<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`withToggle(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> Wrapper<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyToggle</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">focus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>button<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> toggle <span class="token punctuation">:</span> <span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>\n        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span>\n        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>button <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button <span class="token operator">=</span> button<span class="token punctuation">)</span><span class="token punctuation">}</span></span>\n      <span class="token punctuation">></span></span>\n        <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> MyToggleWrapper <span class="token operator">=</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>MyToggle<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span> <span class="token attr-name">onToggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on <span class="token operator">=></span> on <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myToggle<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.On</span><span class="token punctuation">></span></span>The Button is on<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.On</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Off</span><span class="token punctuation">></span></span>The Button is off<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle.Off</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle.Button</span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n          <span class="token punctuation">{</span><span class="token comment">/* inject ref */</span><span class="token punctuation">}</span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MyToggleWrapper</span>\n            <span class="token attr-name">innerRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>myToggle <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>myToggle <span class="token operator">=</span> myToggle<span class="token punctuation">)</span><span class="token punctuation">}</span></span>\n          <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="테스트를-용이하게-만들기"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9A%A9%EC%9D%B4%ED%95%98%EA%B2%8C-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트를 용이하게 만들기</h3>\n<p>컴포넌트가 제대로 랜더링 되는지 테스트를 한다고 할 때도 문제가 생길 수 있다. 왜냐면 실질적으로 랜더링되는 컴포넌트는 <strong>감싸진</strong> 컴포넌트이기 때문이다. 이 때는 <code class="language-text">Wrapper</code> 에 <code class="language-text">WrappedComponent</code> 라는 속성을 지정해주고, 테스트 시 컴포넌트 랜더링을 할 대는 <code class="language-text">HOC.WrappedComponent</code> 같은 방식으로 불러오면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span><span class="token punctuation">{</span> innerRef<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span>\n        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>\n        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>innerRef<span class="token punctuation">}</span></span>\n        <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleContext<span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  Wrapper<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`withToggle(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">;</span>\n  <span class="token comment">// Set wrapped component so that can be easily tested.</span>\n  Wrapper<span class="token punctuation">.</span>WrappedComponnet <span class="token operator">=</span> Component<span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> Wrapper<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="static-속성과-함께-사용하기"><a href="#static-%EC%86%8D%EC%84%B1%EA%B3%BC-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Static 속성과 함께 사용하기</h3>\n<p>마지막으로 누군가 HOC를 이용해서 또 다른 Compound component를 만들었을 때 그 컴포넌트는 제대로 표현되지 않을 것이다. HOC 안에서 일일이 Static 속성을 지정해주어야 할 텐데 현실적으로 불가능하다. 그래서 React에서 기본적으로 사용하고 있는 속성을 제외한 이름의 속성을 끌어올려주는 라이브러리(hoist-non-react-statics)를 사용한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">function</span> <span class="token function">Wrapper</span><span class="token punctuation">(</span><span class="token punctuation">{</span> innerRef<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> toggleContext <span class="token operator">=</span> context<span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span>\n        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>\n        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>innerRef<span class="token punctuation">}</span></span>\n        <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleContext<span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  Wrapper<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>TOGGLE_CONTEXT<span class="token punctuation">]</span><span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  Wrapper<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`withToggle(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">;</span>\n  Wrapper<span class="token punctuation">.</span>WrappedComponnet <span class="token operator">=</span> Component<span class="token punctuation">;</span>\n\n  <span class="token comment">// use host-non-react-static library</span>\n  <span class="token keyword">return</span> <span class="token function">hoistNonReactStatics</span><span class="token punctuation">(</span>Wrapper<span class="token punctuation">,</span> Component<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyToggle</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token keyword">static</span> ToggleMessage <span class="token operator">=</span> <span class="token function">withToggle</span><span class="token punctuation">(</span>\n    <span class="token punctuation">(</span><span class="token punctuation">{</span> toggle<span class="token punctuation">:</span> <span class="token punctuation">{</span> on <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n      on\n        <span class="token operator">?</span> <span class="token string">\'Warning: The button is toggled on\'</span>\n        <span class="token punctuation">:</span> <span class="token keyword">null</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> toggle<span class="token punctuation">:</span> <span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n        <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<hr>\n<h2 id="render-props"><a href="#render-props" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Render props</h2>\n<p>앞서 해결한 많은 양의 HOC 문제를 Render props를 사용하면 별 문제 없이 해결할 수 있다. 물론 만능은 아니지만, 확연한 차이점은 앞에서 해결한 Compound 컴포넌트의 Context 문제, Wrapper의 속성 지정 같은 문제들로부터 자유로워진다는 점이다.</p>\n<ul>\n<li>\n<p>HOC</p>\n<ul>\n<li>필요한 컴포넌트를 일일이 다 HOC로 감싸주어야 한다</li>\n<li>Static 속성의 문제</li>\n<li>HOC가 중첩될 경우 문제가 생길 때 디버깅이 어렵다</li>\n<li>중간에 추가적인 속성이 들어갈 경우 일일이 HOC의 구현을 살펴보아야 한다</li>\n<li>Typescript, Flow 등의 도움을 받기 힘들다</li>\n<li>컴포넌트의 조합이 <code class="language-text">render</code> 메서드 전에 발생한다 -> 때문에 동적인 상태를 활용할 때 Context 같은 부가적인 작업이 필요하다</li>\n</ul>\n</li>\n<li>\n<p>Render Props</p>\n<ul>\n<li>위에 제기된 문제로부터 자유롭다</li>\n<li>컴포넌트의 조합이 일반적인 <code class="language-text">render</code> 메서드 시점에서 발생하기 때문에 동적인 조합을 만들어내기 쉽다</li>\n</ul>\n</li>\n</ul>\n<h3 id="prop-collections-만들어서-재사용성-높이기"><a href="#prop-collections-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%84%9C-%EC%9E%AC%EC%82%AC%EC%9A%A9%EC%84%B1-%EB%86%92%EC%9D%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prop Collections 만들어서 재사용성 높이기</h3>\n<p>Render props 안의 여러 컴포넌트에게 같은 속성을 주입해주고자 할 때는 감싸는 컴포넌트에서 컬렉션을 만들어서 전달해주면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Toggle</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span> on<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token function-variable function">toggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> \n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>\n      <span class="token punctuation">(</span><span class="token punctuation">{</span> on <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">:</span> <span class="token operator">!</span>on <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onToggle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n      toggle<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle<span class="token punctuation">,</span>\n      <span class="token comment">// 여러 하위 컴포넌트에 공통되는 속성을 한꺼번에 넘겨주기 위해 사용</span>\n      togglerProps<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">\'aria-expanded\'</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n        onClick<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span>\n      <span class="token attr-name">onToggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'toggle\'</span><span class="token punctuation">,</span> on<span class="token punctuation">)</span><span class="token punctuation">}</span></span>\n      <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle<span class="token punctuation">,</span> togglerProps <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Switch</span> <span class="token attr-name">on</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>on<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">togglerProps</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">togglerProps</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n            <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token punctuation">)</span><span class="token punctuation">}</span></span>\n    <span class="token punctuation">/></span></span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="prop-getters-만들기"><a href="#prop-getters-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prop Getters 만들기</h3>\n<p><code class="language-text">togglerProps</code> 에 이미 정의된 속성(함수)에 별도의 추가 동작과 속성을 얹으려면 별도의 함수를 만들어야 한다. Props Getter 패턴으로 불리는 것 같다. 먼저 <code class="language-text">getTogglerProps</code> 함수를 만들어보고 거기에 기존 toggle 동작 이전에 alert을 띄우도록 만들어본다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// ... Toggle Class</span>\n  <span class="token function-variable function">getTogglerProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> onClick<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token string">\'aria-expanded\'</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n    onClick<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token operator">...</span>props\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">,</span>\n      toggle<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle<span class="token punctuation">,</span>\n      getTogglerProps<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>getTogglerProps\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>Toggle\n      onToggle<span class="token operator">=</span><span class="token punctuation">{</span>on <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'toggle\'</span><span class="token punctuation">,</span> on<span class="token punctuation">)</span><span class="token punctuation">}</span>\n      render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> on<span class="token punctuation">,</span> toggle<span class="token punctuation">,</span> getTogglerProps <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n          <span class="token punctuation">{</span><span class="token comment">/* 이 Switch 버튼은 클릭 시 동작하지 않는다. onClick이 정의되어있지 않으니까. */</span><span class="token punctuation">}</span>\n          <span class="token operator">&lt;</span>Switch on<span class="token operator">=</span><span class="token punctuation">{</span>on<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token function">getTogglerProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n          <span class="token operator">&lt;</span>button <span class="token punctuation">{</span><span class="token operator">...</span><span class="token function">getTogglerProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n            onClick<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">\'HI\'</span><span class="token punctuation">)</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>\n            <span class="token punctuation">{</span>on <span class="token operator">?</span> <span class="token string">\'on\'</span> <span class="token punctuation">:</span> <span class="token string">\'off\'</span><span class="token punctuation">}</span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token punctuation">)</span><span class="token punctuation">}</span>\n    <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Switch</code> 컴포넌트는 <code class="language-text">onClick</code> 에 새 함수를 조합할 필요가 없었기 때문에 아무 값도 넣지 않았는데, 문제가 발생했다. <code class="language-text">getTogglerProps</code>  함수가 실행시킬 <code class="language-text">onClick</code> 이 없어서 에러가 나는 것이다. 간단히 문제를 해결하려면 <code class="language-text">onClick &amp;&amp; onClick()</code> 같은 방식으로 해결할 수 있지만 매번 이런 식의 코드를 넣어줄 수는 없다. 그래서 별도로  <code class="language-text">compose</code> 함수를 만들어 적용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">compose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=></span> fns<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>fn <span class="token operator">=></span> fn <span class="token operator">&amp;&amp;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n<span class="token function-variable function">getTogglerProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> onClick<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    onClick<span class="token punctuation">:</span> <span class="token function">compose</span><span class="token punctuation">(</span>onClick<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>toggle<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3 id="초기-상태-설정하기"><a href="#%EC%B4%88%EA%B8%B0-%EC%83%81%ED%83%9C-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>초기 상태 설정하기</h3>\n<p>이번에는 토글 하고 나서 리셋 버튼을 만들고자 한다. 리셋을 하려면 기본이 되는 상태를 가지고 있어야 할텐데 컴포넌트 내부에 기본 상태를 지정해두는 것 보다 속성으로 내려받도록 해야 더 유연한 구현을 할 수 있다. 또한 그 속성을 <code class="language-text">initialState</code> 같은 맴버 변수로 보관하고 있으면 컴포넌트에 메서드를 정의할 때 ‘초기 상태로 되돌릴 필요가 있다면’ 언제든지 이 변수를 가져다 쓰면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Toggle</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>\n    defaultOn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    onToggle<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    onReset<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  initialState <span class="token operator">=</span> <span class="token punctuation">{</span> on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultOn <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>initialState<span class="token punctuation">;</span>\n\n  <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>initialState<span class="token punctuation">,</span>\n      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onReset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="controlled-props-설정하기"><a href="#controlled-props-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controlled Props 설정하기</h3>\n<p>특정 상태를 컴포넌트 외부에서 다룰지 내부에서 다룰지 조절할 수도 있다. 외부에서 다루어질 경우 Controlled props라고 한다.</p>\n<p>같은 컴포넌트를 재사용하는데 어떤 컴포넌트는 사용자가 4번 클릭하면 동작하지 않도록 막고, 어떤 컴포넌트는 경고만 띄운 채로 계속 동작할 수 있도록  만든다고 가정해보자. 그러면 부모 컴포넌트에 별도의 상태를 정의한 뒤 자손 컴포넌트에 상태를 주입할 경우에는 동작을 제어하고, 그렇지 않은 경우 자손 컴포넌트의 자체 상태를 이용하게 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// Toogle 컴포넌트</span>\n<span class="token comment">// ...</span>\n  <span class="token function-variable function">isOnControlled</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>on <span class="token operator">!==</span> undefined<span class="token punctuation">;</span>\n\n  <span class="token comment">// 부모 컴포넌트로부터 상태를 받았는지 아닌지에 따라 다른 행동 정의</span>\n  <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isOnControlled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onReset</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>on<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>initialState<span class="token punctuation">,</span>\n        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onReset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>on<span class="token punctuation">)</span>\n      <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n\n<span class="token comment">// App 컴포넌트</span>\n<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  initialState <span class="token operator">=</span> <span class="token punctuation">{</span> timesClicked<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>initialState<span class="token punctuation">;</span>\n\n  <span class="token function-variable function">handleToggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> timesClicked<span class="token punctuation">,</span> on <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>\n      timesClicked<span class="token punctuation">:</span> timesClicked <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n      on<span class="token punctuation">:</span> timesClicked <span class="token operator">>=</span> <span class="token number">4</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token punctuation">:</span> <span class="token operator">!</span>on\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token function-variable function">handleReset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> timesClicked<span class="token punctuation">,</span> on <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>Toggle\n        <span class="token punctuation">{</span><span class="token comment">/* on이 있으면 부모가 통제, 없으면 자손이 통제 */</span><span class="token punctuation">}</span>\n        on<span class="token operator">=</span><span class="token punctuation">{</span>on<span class="token punctuation">}</span> \n        onToggle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleToggle<span class="token punctuation">}</span>\n        onReset<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleReset<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="provider-컴포넌트-만들기"><a href="#provider-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provider 컴포넌트 만들기</h3>\n<p>애플리케이션의 규모가 더 커져서 컴포넌트는 여러개로 나누었는데, <code class="language-text">toggle</code> 속성을 일일이 주입해주는 구현을 해 버렸다고 할 때, 리팩터링을 하기 위해서 다시 한번 Context가 등장한다. 이번에는 HOC로 감싸는게 아니라 Render props를 이용해서 Provider를 만든다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// ...</span>\n<span class="token comment">// Provider 정의</span>\n<span class="token keyword">class</span> <span class="token class-name">ToggleProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token keyword">static</span> contextName <span class="token operator">=</span> <span class="token string">\'__toggle__\'</span>\n  <span class="token keyword">static</span> Renderer <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>\n    <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n      <span class="token punctuation">[</span>ToggleProvider<span class="token punctuation">.</span>contextName<span class="token punctuation">]</span><span class="token punctuation">:</span>\n        PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        <span class="token punctuation">[</span>ToggleProvider<span class="token punctuation">.</span>contextName<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props\n          <span class="token punctuation">.</span>toggle<span class="token punctuation">,</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span>\n      children<span class="token punctuation">,</span>\n      <span class="token operator">...</span>remainingProps\n    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span>\n        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">remainingProps</span><span class="token punctuation">}</span></span>\n        <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle <span class="token operator">=></span> <span class="token punctuation">(</span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ToggleProvider.Renderer</span>\n            <span class="token attr-name">toggle</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span>\n            <span class="token attr-name">children</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span></span>\n          <span class="token punctuation">/></span></span>\n        <span class="token punctuation">)</span><span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Toggle 속성과 연결  </span>\n<span class="token keyword">function</span> <span class="token function">ConnectedToggle</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n    context<span class="token punctuation">[</span>ToggleProvider<span class="token punctuation">.</span>contextName<span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\nConnectedToggle<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token punctuation">[</span>ToggleProvider<span class="token punctuation">.</span>contextName<span class="token punctuation">]</span><span class="token punctuation">:</span>\n    PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n<span class="token comment">// 컴포넌트와 연결하는 방법</span>\n<span class="token keyword">function</span> <span class="token function">Title</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ConnectedToggle</span>\n          <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle <span class="token operator">=></span>\n            <span class="token template-string"><span class="token string">`Who is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>toggle<span class="token punctuation">.</span>on\n              <span class="token operator">?</span> <span class="token string">\'🕶❓\'</span>\n              <span class="token punctuation">:</span> <span class="token string">\'awesome?\'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span></span>\n        <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Subtitle</span> <span class="token punctuation">/></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>실제 구현에서는 컴포넌트 최상단에서 <code class="language-text">ToggleProvider</code> 로 감싸두었기 때문에 <code class="language-text">ConnectedToggle</code> 컴포넌트를 사용할 시 자연스럽게 Context에 접근할 수 있다.</p>\n<h3 id="자손-컴포넌트의-리랜더링rerendering과-shouldcomponentupdate"><a href="#%EC%9E%90%EC%86%90-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%9D%98-%EB%A6%AC%EB%9E%9C%EB%8D%94%EB%A7%81rerendering%EA%B3%BC-shouldcomponentupdate" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자손 컴포넌트의 리랜더링(Rerendering)과 shouldComponentUpdate</h3>\n<p>리액트의 퍼포먼스에서 제일 신경써야 할 점은 컴포넌트가 업데이트되면서 화면을 다시 그리는 일을 최소화하는 것이다. <code class="language-text">shouldComponentUpdate</code> 라이프사이클 훅을 사용하는 방법이 가장 일반적이겠지만 Provider로 감싸진 컴포넌트에 사용하면 예기치 못한 결과를 초래할 수 있다. <a href="https://github.com/ReactTraining/react-broadcast">react-broadcast</a> 라이브러리를 사용하여 채널을 설정하고, 값을 설정하면 새로 내려지는 값이 변화했는지 아닌지에 따라 랜더링을 제어해준다.</p>\n<hr>\n<p>강좌 마지막에는 Redux와 Redner props를 함께 활용하는 방법 등이 있었지만 바로 이해가 되지 않아서 나중에 활용 가능할 때 업데이트 할 예정이다. 또한 Provider 패턴에 들어서면서도 내용이 조금 복잡해져서 잘못 정리된 정보를 전달할 수 있는 여지가 있으니 글 내용이 확실해보이지 않을 경우 강좌를 참고하기 바란다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-12-10-advanced-react-component-patterns-summary/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-10",path:"/posts/advanced-react-component-patterns-summary",title:"Advanced React Component Patterns 내용 정리",tags:["React"],category:"React"}},{excerpt:"새로운 도전의 시작 올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다) 기존에도 프론트엔드 라이브러리로 React와 Vue.js…",html:'<h2 id="새로운-도전의-시작"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EB%8F%84%EC%A0%84%EC%9D%98-%EC%8B%9C%EC%9E%91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 도전의 시작</h2>\n<p>올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다)</p>\n<p>기존에도 프론트엔드 라이브러리로 React와 Vue.js에 많은 관심을 가지고 있었는데, 이제 본격적으로 리액트를 업무에 사용하게 되었기 때문에 <strong>리액트로 뭘 만들어볼까?</strong> 하다가 가장 만만한 블로그부터 다시 만들어 보기로 결심했습니다. 블로그를 만들고자 했던 이유는 몇 가지 더 있었습니다.</p>\n<ol>\n<li>기왕 하는거 간단한 디자인 및 프로토타이핑까지 하여 하나의 사이트 개발을 처음부터 끝까지 직접 해 보고 싶다.</li>\n<li>기존 블로그는 테마를 바로 가져다 썼는데, 충분히 좋지만 불필요한 요소나 레이아웃을 걷어내고 최대한 간소하게 만들어보고 싶다.</li>\n<li>간소하게 만들면서 관리 및 유지보수가 더 원활한 형태로 재구성하고 싶다.</li>\n</ol>\n<p>결론부터 말씀드리자면 1번은 절반의 성공만 거두고 나머지는 성공했습니다. 종이에다 어떤 모양이 나와야하는지 그려본 뒤에, 그 모습을 실제 코드로 옮기는데 성공했지만 CSS를 밑바닥부터 그려낼 실력은 되지 않아 <a href="https://bulma.io">Bulma</a>를 활용하여 만들었습니다.</p>\n<p>그러면 2, 3번은 어떻게 달성했을까요?</p>\n<h2 id="gatsby를-만나다"><a href="#gatsby%EB%A5%BC-%EB%A7%8C%EB%82%98%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby를 만나다</h2>\n<p>이전에 ‘리액트를 학습하는 과정’ 을 안내하는 포스팅을 읽은 적이 있는데 <em>기본을 익혔다면 <a href="https://www.gatsbyjs.org">Gatsby</a>같은 리액트 기반의 정적 페이지 생성기를 사용하여 리액트를 연습해보라</em> 라는 내용이 적혀있더군요. <strong>어떻게 리액트로 정적 페이지를 만들 수 있을까?</strong> 하며 궁금해하면서 이름을 기억해두고 있었습니다.</p>\n<p>보통 정적 페이지 생성기를 사용하여 블로그를 만든다고 하면 루비를 이용한 <a href="https://jekyllrb.com">Jekyll</a>과 Node.js를 이용한 <a href="https://hexo.io">Hexo</a> 등을 사용하게 됩니다. 각각의 포스팅을 마크다운으로 작성하고 생성기가 이를 html 파일로 변환해주며, 특정 정보가 삽입되어야 할 때(날짜, 사용자가 직접 입력한 정보 등)는 템플릿 엔진이 페이지 생성을 도와주는 형식으로 되어 있습니다.</p>\n<p>그런데 당시 제가 아는 수준에서 리액트로 블로그를 만드는 것은 굉장히 기술을 과하게 사용하는 일이었습니다. 먼저 블로그를 정말 메모장 대신으로 쓸 것이 아니면 검색 엔진에 노출 되는 것이 좋다고 생각하는데, 리액트로 SPA(Single Page Application)을 제작하게되면 검색엔진 봇이 내용을 수집하기 힘듭니다. 아니면 별도로 라우팅과 SSR(Server Side Rendering)을 구성해야 합니다.</p>\n<p>하지만 Gatsby의 도움을 받으면 비교적 간단하게 리액트를 활용하여 빠르고 유연한 정적 페이지를 생성할 수 있습니다. Gatsby를 활용할 때 생기는 장점 소개는 공식 사이트의 소개와 <a href="https://blog.scottnonnenberg.com/static-site-generation-with-gatsby-js/">이 포스팅</a>으로 가볍게 미루겠습니다.</p>\n<p><strong>여담이지만 이번에 Facebook에서 React 16 발매와 함께 <a href="https://reactjs.org">웹사이트</a>를 개편할 때 Gatsby를 사용했습니다</strong> 😏</p>\n<p>제가 블로그를 다시 만들면서 했던 일들은 기본적인 프로젝트 설정을 한 뒤에, 일반적인 리액트 애플리케이션 만들듯이 컴포넌트를 작성하고 배포 커맨드를 입력한 정도밖에 되지 않았습니다. (실제로는 자잘한 작업들이 더 있긴 했지만 큰 틀은 이렇습니다) 이제부터 실제로 이 블로그를 제작한 과정 일부와 문제 해결 과정을 코드와 함께 소개해 드리겠습니다.</p>\n<p><strong>아래 내용을 보시기에 앞서 <a href="https://www.gatsbyjs.org/tutorial/">Gatsby 공식 튜토리얼</a>을 참고하시기 바랍니다. 대부분은 공식 튜토리얼에서 사용한 코드 및 Gatsby로 만들어진 블로그의 코드 일부를 참고하였습니다.</strong></p>\n<p><strong>또한 아래에 정리하는 내용은 기초 수준 이상의 리액트 라이브러리의 이해를 전제로 작성하였습니다.</strong></p>\n<h2 id="프로젝트-설정"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 설정</h2>\n<p>먼저 이 블로그를 만들기 시작한 시점의 로컬 개발환경은 다음과 같습니다</p>\n<ul>\n<li><strong>Yarn</strong>: <code class="language-text">1.1.0</code> (npm은 사용하지 않았습니다)</li>\n<li><strong>Node.js</strong>: <code class="language-text">8.6.0</code></li>\n</ul>\n<p>핵심은 이 둘이고 나머지는 필요한 패키지만 설치하면 가능한 한 최신 버전으로 유지하시면서 개발하시면 됩니다.</p>\n<h3 id="gatsby-프로젝트-생성"><a href="#gatsby-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby 프로젝트 생성</h3>\n<p>먼저 Gatsby의 CLI를 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn global add gatsby-cli</code></pre>\n      </div>\n<p>그리고 레일즈 등의 프로젝트를 생성하듯이 터미널에 명령어를 <code class="language-text">gatsby new blog</code> 명령어를 입력하시면 되는데, 만약 마음에 드는 Gatsby 스타터(보일러플레이트)를 발견하시면 Git 주소를 인자로 입력하실 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 빈 프로젝트 생성\ngatsby new blog\n\n# 보일러플레이트 이용 예\ngatsby new blog https://github.com/dschau/gatsby-blog-starter-kit</code></pre>\n      </div>\n<p>그리고 <code class="language-text">blog</code> 폴더를 에디터로 열어 작업하시면 됩니다. 저는 Visual Studio Code를 사용했습니다.</p>\n<h3 id="prettier-설정"><a href="#prettier-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prettier 설정</h3>\n<p>기존에는 프로젝트에 ESLint를 활용해서 코드 스타일을 유지했는데, <a href="https://github.com/prettier/prettier">Prettier</a>를 활용하기 시작하면서 굳이 필요가 없게 되었습니다. 특히 이 트윗을 보고 나서 <code class="language-text">prettier-eslint</code> 플러그인마저 필요 없다는 사실을 뒤늦게 깨달았습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">PSA: I&#39;m no longer using prettier-eslint. I use raw prettier and disable all eslint style rules.<br><br>My life has been better ever since...</p>&mdash; Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/913760103118991361?ref_src=twsrc%5Etfw">September 29, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>여러분들도 가독성있는 코드 스타일을 유지하는데 관심이 있으시다면 다음 설정을 참고해 보시기 바랍니다.\n먼저 프로젝트에 Prettier를 추가합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn add prettier --dev</code></pre>\n      </div>\n<p>VS Code 사용자 기준으로 다음 플러그인도 설치하셔야 합니다.</p>\n<p><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier - JavaScript formatter - Visual Studio Marketplace</a></p>\n<p>그리고 커맨드 팔레트(macOS기준 Cmd+Shift+P)를 열어 <code class="language-text">Preferences: Open Workspace Settings</code> 를 선택하신 뒤에 Prettier 스타일 세팅 및 저장시 자동 적용을 활성화 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .vscode/settings.json\n<span class="token punctuation">{</span>\n  <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token property">"prettier.printWidth"</span><span class="token operator">:</span> <span class="token number">100</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>저는 스타일 기본값을 사용하고 한 줄당 길이만 100이 되도록 설정하였습니다. 앞으로는 저장 시 자동으로 파일마다 Prettier가 작동하여 코드의 스타일을 다듬어줍니다.</p>\n<h3 id="플러그인-설치"><a href="#%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>플러그인 설치</h3>\n<p>Gatsby의 다양한 플러그인을 활용하여 사용자가 더 편하게 웹페이지를 제작할 수 있습니다. 특히 보통 리액트를 사용할 때 많이 활용하는 패키지와 Gatsby가 잘 결합되도록 따로 플러그인을 만들어 배포하고 있습니다. 예를 들어 <code class="language-text">react-helmet</code> 을 사용하시려면 <code class="language-text">gatsby-plugin-react-helmet</code> 플러그인을 설치하여 설정 파일에서 불러오도록 만들어야 합니다. 사용 가능한 플러그인 리스트는 <a href="https://www.gatsbyjs.org/docs/plugins/">공식 문서</a>를 참고해주세요.</p>\n<p>저는 제 블로그를 구현하기 위한 기능을 먼저 정의한 뒤에 필요한 부분만 플러그인을 추가 &#x26; 설정하였습니다.</p>\n<ul>\n<li>유동적으로 HTML <code class="language-text">head</code> 태그가 바뀌어야 한다(제목 등) -> <code class="language-text">gatsby-react-helmet</code></li>\n<li>Sass(SCSS)를 사용한다 -> <code class="language-text">gatsby-plugin-sass</code></li>\n<li>\n<p>(당연하지만) 본문에 마크다운을 사용한다 -> <code class="language-text">gatsby-transformer-remark</code></p>\n<ul>\n<li>마크다운에 트위터 임베딩이 필요하다 -> <code class="language-text">gatsby-plugin-twitter</code></li>\n<li>마크다운에 Syntax highlighting이 필요하다 -> <code class="language-text">gatsby-remark-prismjs</code></li>\n<li>…</li>\n</ul>\n</li>\n<li>…</li>\n</ul>\n<p>실제 적용된 플러그인의 전체 목록은 소스코드를 참고해 주시기 바랍니다.</p>\n<p>플러그인은 프로젝트 폴더에 <code class="language-text">gatsby-config.js</code> 파일을 만들어서 자바스크립트 객체로 내보내시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  siteMetadata<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    siteUrl<span class="token punctuation">:</span> <span class="token string">"https://emaren84.github.io"</span><span class="token punctuation">,</span>\n    title<span class="token punctuation">:</span> <span class="token string">"rinae\'s blog"</span><span class="token punctuation">,</span>\n    description<span class="token punctuation">:</span> <span class="token string">"about Translation, Ruby, Javascript, Practical Dev etc."</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"gatsby-plugin-react-helmet"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-catch-links"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-sass"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-styled-components"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-twitter"</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n    <span class="token string">"gatsby-remark-responsive-iframe"</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="실제-블로그-포스트를-가져오기"><a href="#%EC%8B%A4%EC%A0%9C-%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실제 블로그 포스트를 가져오기</h2>\n<h3 id="프로젝트-폴더-구성"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 폴더 구성</h3>\n<p>Gatsby로 페이지를 작성하는데 필요한 폴더는 세 가지 입니다.</p>\n<ul>\n<li><code class="language-text">src/layouts</code> - 페이지의 전반적인 레이아웃을 담당. 모든 개별 페이지가 이 폴더의 <code class="language-text">index.js</code> 파일의 하위 컴포넌트로 동작함.</li>\n<li><code class="language-text">src/pages</code> - 개별 페이지를 담아두는 폴더. 블로그 포스트(마크다운)나 404, index 페이지를 작성</li>\n<li><code class="language-text">src/templates</code> - 반복되는 페이지의 템플릿을 저장 (예: 블로그 포스트의 템플릿)</li>\n</ul>\n<p>위 폴더의 구조는 얼마든지 사용자화 할 수 있습니다. 다만 저는 제시된 구조로 충분했기 때문에 특별히 변형하진 않았습니다. 추가적으로 재사용이 잦은 컴포넌트를 <code class="language-text">src/components</code> 폴더에 정의하여 사용했습니다.</p>\n<p>참고로 <code class="language-text">src/pages</code> 폴더에 저장해 둔 마크다운 파일을 불러오기 위해서 약간의 설정이 필요합니다. 위에서 언급한 <code class="language-text">gatsby-config.js</code> 파일에 다음 플러그인을 추가해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\n<span class="token comment">// ...</span>\n\tplugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token comment">// ...</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\tresolve<span class="token punctuation">:</span> <span class="token string">"gatsby-source-filesystem"</span><span class="token punctuation">,</span>\n\t\t\toptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\tpath<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/pages`</span></span><span class="token punctuation">,</span>\n\t\t\t\tname<span class="token punctuation">:</span> <span class="token string">"pages"</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t\t<span class="token comment">// ...</span>\n\t<span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="기본-레이아웃-작성"><a href="#%EA%B8%B0%EB%B3%B8-%EB%A0%88%EC%9D%B4%EC%95%84%EC%9B%83-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 레이아웃 작성</h3>\n<p><code class="language-text">src/layout/index.js</code> 파일은 대부분의 리액트 프로젝트의 <code class="language-text">index.html</code> 같은 파일입니다. 보통 <code class="language-text">index.html</code> 파일에서 favicon, head 태그 등의 공통적인 내용을 정의한 뒤에 ReactDOM이 랜더링될 위치를 지정해 주지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Helmet <span class="token keyword">from</span> <span class="token string">"react-helmet"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// import styles</span>\n<span class="token keyword">import</span> <span class="token string">"typeface-noto-sans"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"bulma"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"mdi/scss/materialdesignicons.scss"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"prismjs/themes/prism-solarizedlight.css"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"./layout-style.scss"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> favicon <span class="token keyword">from</span> <span class="token string">"../assets/favicon.ico"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TemplateWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charSet</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Rinae\'s playground<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shortcut icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>favicon<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Helmet</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span> <span class="token attr-name">toggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>toggled<span class="token punctuation">}</span></span> <span class="token attr-name">handleToggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleToggled<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Footer</span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Helmet</code> 컴포넌트는 html의 <code class="language-text">head</code> 태그를 생성해주는 역할을 합니다. 그리고 <code class="language-text">Link</code> 컴포넌트는 react-router의 <code class="language-text">Link</code> 컴포넌트와 거의 동일하게 작동합니다. 주로 특정 DOM 엘리먼트를 클릭하면 페이지 어디로 이동할지 지정해줄 때 사용합니다. 개발자 도구를 열어보면 <code class="language-text">a</code>  태그가 랜더링되지만 페이지를 다시 불러오지 않고 미리 준비된 다른 컴포넌트와 바꿔치기 하는 방식으로 동작하나 봅니다.</p>\n<p><code class="language-text">props</code> 로 내려온 <code class="language-text">children</code> 이 일반 페이지 컴포넌트들이 됩니다. 말 그대로 <code class="language-text">src/layout/index.js</code> 는 모든 페이지들의 부모 컴포넌트가 된다고 이해하시면 되겠습니다.</p>\n<h3 id="포스트-리스트-보여주기"><a href="#%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EB%A6%AC%EC%8A%A4%ED%8A%B8-%EB%B3%B4%EC%97%AC%EC%A3%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>포스트 리스트 보여주기</h3>\n<p>이번에는 <code class="language-text">src/pages/index.js</code> 파일을 살펴보겠습니다. 이 페이지는 블로그에 접속하면 가장 처음 접하게 되는 페이지로, 모든 포스트를 리스트로 가져와서 최신 순서대로 나열해주는 역할을 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> Hero <span class="token keyword">from</span> <span class="token string">"../components/Hero"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PostList <span class="token keyword">from</span> <span class="token string">"../components/PostList"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">IndexPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> edges <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> postsData <span class="token operator">=</span> edges<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>edge <span class="token operator">=></span> edge<span class="token punctuation">.</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Hero</span>\n          <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Welcome to my writing playground<span class="token punctuation">"</span></span>\n          <span class="token attr-name">subtitle</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>about Translation, Ruby, Javascript, Practical Dev etc.<span class="token punctuation">"</span></span>\n        <span class="token punctuation">/></span></span>\n\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-10-tablet is-offset-1-tablet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PostList</span> <span class="token attr-name">postsData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>postsData<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query IndexQuery {\n    allMarkdownRemark(limit: 1000, sort: { order: DESC, fields: [frontmatter___date] }) {\n      edges {\n        node {\n          excerpt(pruneLength: 250)\n          id\n          frontmatter {\n            title\n            category\n            date(formatString: "YYYY/MM/DD")\n            path\n          }\n        }\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>파일 아래 부분에 <code class="language-text">pageQuery</code>를 주목해주세요. <code class="language-text">graphql</code>? 무슨 정적 사이트 생성기에 GraphQL을 쓰지? 라는 생각을 했는데, Gatsby에서 나름 효율적으로 사용자가 원하는 자료를 가져올 수 있도록 제공된 인터페이스를 사용하는 느낌이었습니다.</p>\n<p>저도 GraphQL을 이름만 들어보고 실제로 사용해본 적은 한 번도 없었지만 공식 사이트의 튜토리얼을 참고해보고, Gatsby에서 제공하는 GraphQL IDE(개발 모드에서 <code class="language-text">localhost:8000/___graphql</code>)로 여러가지 실험을 해 보니 필요한 만큼은 이해할 수 있었습니다. 당장 GraphQL에 익숙하지 않으시더라도 저 쿼리가 대강 어떤 자료를 가져오려고 하는 지 눈에 잘 들어올겁니다. 실제 리턴받는 데이터도 저 구조대로 자바스크립트 객체 형태를 가지고 있습니다.</p>\n<hr>\n<p>미처 설명드리지 못했지만 <code class="language-text">frontmatter</code> 는 각각의 마크다운 파일 맨 처음에 작성하는 일종의 헤더로 다음과 같이 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">---\ntitle: &quot;Some title&quot;\ncategory: &quot;Example&quot;\ndate: &quot;2017/10/04&quot;\npath: &quot;/posts/some-title&quot;\n...\n---</code></pre>\n      </div>\n<hr>\n<p>쿼리하고 받은 데이터는 같은 파일에 작성된 리액트 컴포넌트에 <code class="language-text">props</code>로 자동 설정됩니다. 그래서 <code class="language-text">this.props.data.allMarkdownRemark</code> 처럼 사용할 수 있는 겁니다.</p>\n<p>그런데 마크다운으로 작성된 블로그 포스트는 어떻게 리액트 컴포넌트로 표현해주어야 할까요? <code class="language-text">http://blog.com/post/1</code> 같이 포스트마다 고유의 경로를 가져야 할 테고, 그러려면 <code class="language-text">src/pages</code> 안에 각각의 포스트마다 컴포넌트를 작성해주어야 할까요? 다행히도 그렇게 복잡한 방식을 사용할 필요는 없습니다.</p>\n<h3 id="블로그-포스트-생성하기"><a href="#%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블로그 포스트 생성하기</h3>\n<p>Gatsby는 자체 Node API를 제공하여 페이지를 생성하거나 수정하는 작업을 처리할 수 있습니다. 리액트의  Lifecycle methods 처럼 페이지 생성부터 종료까지 다양한 시점에 걸쳐 설정을 할 수 있지만, 저는 <code class="language-text">createPages</code> 메서드만 사용했습니다.</p>\n<p>자세한 내용은 <a href="https://www.gatsbyjs.org/docs/creating-and-modifying-pages/">공식 문서</a>를 참고해주세요. 또한 대부분 공식 튜토리얼 파트4에 소개되어있는 내용을 참고했습니다.</p>\n<p>먼저 프로젝트 루트에 <code class="language-text">gatsby-node.js</code> 파일을 생성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-node.js</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">boundActionCreators</code> 는 Redux로 구현된 다양한 행동 모음집(액션 디스패처들)입니다. 우리는 여기서 <code class="language-text">createPage</code> 액션 하나만 사용할 예정입니다. <code class="language-text">graphql</code> 은 GraphQL 쿼리를 실행하고 그 결과를 프로미스로 리턴하는 함수입니다. <code class="language-text">createPages</code> 함수 내부를 조금 더 자세히 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> createPage <span class="token punctuation">}</span> <span class="token operator">=</span> boundActionCreators<span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> blogPostTemplate <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`src/templates/blog-post.js`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">graphql</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n    {\n      allMarkdownRemark(sort: { order: DESC, fields: [frontmatter___date] }, limit: 1000) {\n        edges {\n          node {\n            excerpt(pruneLength: 250)\n            html\n            id\n            frontmatter {\n              date\n              path\n              title\n              tags\n              category\n            }\n          }\n        }\n      }\n    }\n  `</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">const</span> posts <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n\n    posts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> node <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        path<span class="token punctuation">:</span> node<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>path<span class="token punctuation">,</span>\n        component<span class="token punctuation">:</span> blogPostTemplate<span class="token punctuation">,</span>\n        context<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">blogPostTemplate</code> 는 블로그 포스트를 표현하기 위한 리액트 컴포넌트입니다. 조금 뒤에 살펴보겠습니다.</p>\n<p><code class="language-text">graphql</code> 함수가 쿼리를 하고 나온 결과는 <code class="language-text">result.data</code> 에 담기게 되며 아까 <code class="language-text">src/pages/index.js</code> 파일 안에서 GraphQL 쿼리 결과를 가져올 때랑 똑같이 다룰 수 있습니다.</p>\n<p>그리고 <code class="language-text">createPage</code> 라는 함수에 각각의 포스트를 인자로 넘기면 됩니다. <code class="language-text">path</code> 속성은 어떤 URL로 생성될지, <code class="language-text">component</code> 는 어떤 컴포넌트를 사용하여 페이지를 만들지 지정합니다. <code class="language-text">context</code> 는 상황에 따라 사용자 임의의 속성을 지정해줄 수 있는 기능인데, 저는 굳이 사용하지 않았습니다.</p>\n<p>중요한 점은 저 <code class="language-text">path</code> 속성이 템플릿 컴포넌트로 넘어갈때 GraphQL의 인자로 사용된다는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// src/templates/blog-post.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Template</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> markdownRemark<span class="token punctuation">:</span> post <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>tags<span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-8-tablet is-offset-2-tablet is-8-desktop is-offset-2-desktop<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span> <span class="token attr-name">title</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - Rinae\'s playground`</span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>has-text-grey-light is-size-6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>date<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> __html<span class="token punctuation">:</span> post<span class="token punctuation">.</span>html <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TagList</span> <span class="token attr-name">tags</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tags<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>About</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info is-large<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-medium<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mdi mdi-36px mdi-format-list-bulleted<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Back to All posts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query BlogPostByPath($path: String!) {\n    markdownRemark(frontmatter: { path: { eq: $path } }) {\n      html\n      frontmatter {\n        date(formatString: "YYYY/MM/DD")\n        path\n        title\n        tags\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">pageQuery</code> 의 <code class="language-text">graphql</code> 이 인자로 <code class="language-text">$path</code> 를 받는데 아까 <code class="language-text">createPage</code> 함수에서 가져온 <code class="language-text">path</code> 속성을 의미합니다. 그리고 <code class="language-text">$path</code> 를 이용하여 <strong>마크다운 파일 중에  frontmatter의 path가 <code class="language-text">$path</code> 와 같은 노드를 검색하라</strong> 라는 쿼리를 전달할 수 있는 것입니다. 나머지는 그 데이터를 그대로 컴포넌트에 넘겨주기만 하면 됩니다.</p>\n<p>그리고 마크다운 파일은 플러그인에 의해 자동으로 html로 변환되는데, 이 html을 <a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml"><code class="language-text">dangerouslySetInnerHTML</code> 속성</a>을 사용해서 주입했습니다.</p>\n<p>설명을 보시면서 생략된 부분이 많다고 느끼실 수 있지만, 앞서 언급한 공식 튜토리얼을 가볍게 진행해보시면 생각보다 쉽게 간단한 블로그정도는 만들 수 있다는 생각이 드실 겁니다.</p>\n<h2 id="자잘한-문제-해결"><a href="#%EC%9E%90%EC%9E%98%ED%95%9C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자잘한 문제 해결</h2>\n<p>하지만 공식 문서에서는 미처 언급되지 않아 제가 약간 삽질을 하면서 해결했던 문제들이 있습니다. 기록 겸 이 글을 읽으시는 분들이 만약 같은 문제를 겪으실 때 쉽게 해결하실 수 있었으면 좋겠습니다.</p>\n<h3 id="rss-feed-설정"><a href="#rss-feed-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RSS Feed 설정</h3>\n<p>Gatsby는 RSS Feed를 생성하는 플러그인을 제공합니다. 제 블로그가 아무리 대단한 내용이 없다 하더라도 RSS Feed를 제공하는 것은 기본 중의 기본이라 생각하여 설정하고 있었는데, 아무리 해도 <code class="language-text">head</code> 태그에 <code class="language-text">rss.xml</code> 파일이 제대로 된 경로로 설정되지 않았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n\t<span class="token comment">&lt;!-- rss.xml의 경로가 절대경로로만 표시된다 --></span>\n\t<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alternate<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>application/rss+xml<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/rss.xml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>이렇게 되면 제가 기존에 쓰던 블로그 주소인 <code class="language-text">https://emaren84.github.io/blog</code> 를 사용할 경우 RSS Feed를 제공할 수 없게 됩니다. 왜냐면 <code class="language-text">rss.xml</code> 의 위치는 <code class="language-text">https://emaren84.github.io/rss.xml</code> 이 되어버리기 때문입니다.</p>\n<p>플러그인 소스를 보니  <code class="language-text">pathPrefix</code> 설정을 받아들이는 부분도 없고 무조건 절대경로로 파일을 생성하도록 되어있나봅니다.</p>\n<p>결국 블로그 주소를 바꿔서 해결했지만.. 기존에 사용하던 지킬 테마에서는 피드 생성이 잘 되었다는 것을 생각해보면 나중에 수정되었으면 좋겠습니다.</p>\n<h3 id="gif-파일-표시"><a href="#gif-%ED%8C%8C%EC%9D%BC-%ED%91%9C%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GIF 파일 표시</h3>\n<p>Gatsby의 remark-images 플러그인은 jpg, png 파일은 아주 잘 처리합니다. 다만 gif파일은 처리하지 않습니다. 보통 gif 파일을 쓸 일이 없긴 하지만, 몇몇 포스트에 gif파일을 사용하기 때문에 문제를 해결해야 했습니다.</p>\n<p><code class="language-text">gatsby-remark-copy-linked-files</code> 을 추가하면 문제는 해결됩니다. 이 플러그인은 PDF 파일 등의 링크를 제공할 때 사용하는 플러그인으로 생각하고 간과하고 있었는데, 이 플러그인을 설치한 채로 gif파일의 링크를 설정하니 잘 작동합니다.</p>\n<h3 id="코드-블락의-css-오류"><a href="#%EC%BD%94%EB%93%9C-%EB%B8%94%EB%9D%BD%EC%9D%98-css-%EC%98%A4%EB%A5%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>코드 블락의 CSS 오류</h3>\n<p>개발 블로그를 작성하면서 가장 중요한게 코드의 표현인데, Gatsby로 블로그를 만들고 나니 일부 코드 블락이 이상하게 표현되었습니다. 처음에는 PrismJS 플러그인의 문제라고 생각했는데, 제가 이 블로그를 만들기 위해 사용한 CSS 프레임워크인 Bulma의 CSS와 일부 충돌하는 부분이 있었기 때문에 코드가 이상하게 나온 것이었습니다.</p>\n<p>블로그 포스트 템플릿에 CSS를 추가하여 문제를 해결했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-scss"><code class="language-scss"><span class="token comment">// ...</span>\n<span class="token comment">// resolve conflicts between bulma css preset and prismjs</span>\n<span class="token selector">pre[class*="language-"] .tag,\npre[class*="language-"] .number </span><span class="token punctuation">{</span>\n  <span class="token property">align-items</span><span class="token punctuation">:</span> stretch<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>\n  <span class="token property">font-size</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>\n  <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>\n  <span class="token property">line-height</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">white-space</span><span class="token punctuation">:</span> pre<span class="token punctuation">;</span>\n  <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>\n  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>\n  <span class="token property">vertical-align</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<hr>\n<p>제가 만든 블로그는 <a href="https://github.com/emaren84/gatsby-blog">Github에 공개 되어 있습니다</a>. 커밋 로그를 조금 살펴보시면 블로그에서 미처 언급하지 못했던 제작과정을 참고하실 수 있습니다.</p>\n<p><strong>참고자료</strong></p>\n<ul>\n<li><a href="https://www.gatsbyjs.org/tutorial/">Gatsby Tutorial</a></li>\n<li><a href="https://github.com/alxshelepenok/gatsby-starter-lumen">GitHub - alxshelepenok/gatsby-starter-lumen: Lumen is a minimal, lightweight and mobile-first starter for creating blogs uses Gatsby</a></li>\n<li><a href="https://dustinschau.com/blog/getting-started-with-gatsby">Dustin Schau - Creating a Blog with Gatsby</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-10-05-creating-new-blog-with-gatsby/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-10-05",path:"/posts/creating-new-blog-with-gatsby",title:"Gatsby를 활용한 블로그 재구성",tags:["Markdown","React","GraphQL"],category:"Gatsby"}}],TypeScript:[{excerpt:"다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로  TypeStyle 을 활용하는 방안을 검토중이다. 그래서  egghead의 강좌 를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다. 적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS…",html:'<p>다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로 <a href="https://typestyle.github.io">TypeStyle</a>을 활용하는 방안을 검토중이다.</p>\n<p>그래서 <a href="https://egghead.io/courses/maintainable-css-using-typestyle">egghead의 강좌</a>를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다.</p>\n<p>적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS를 적극적으로 활용하여 동적인 스타일을 입힐 수 있으리라 기대한다.</p>\n<p>참고로 아래의 예제 코드는 모두 리액트 애플리케이션을 개발한다는 전제하에 소개하고 있다. 하지만 TypeStyle 자체는 어느 환경에서나 사용 가능하다.</p>\n<h2 id="기본-사용법"><a href="#%EA%B8%B0%EB%B3%B8-%EC%82%AC%EC%9A%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 사용법</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOM <span class="token keyword">from</span> <span class="token string">\'react-dom\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  position<span class="token punctuation">:</span> <span class="token string">\'relative\'</span> \n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello TypeStyle<span class="token operator">!</span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">style</code> 함수로 생성된 내용이 스타일이 적용된 임의의 클래스 이름을 만들게 되고 DOM은 바로 클래스 이름을 사용하면 되도록 구성되어 있다.</p>\n<p>이 과정에서 객체 형식으로 되어있는 key-value 값은 이미 라이브러리에 CSS 스펙에 맞게 정의되어 있기 때문에 오타가 날 시 컴파일러가 친절하게 에러를 잡아준다.</p>\n<h2 id="스타일-믹스인"><a href="#%EC%8A%A4%ED%83%80%EC%9D%BC-%EB%AF%B9%EC%8A%A4%EC%9D%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스타일 믹스인</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 위 코드와 동일한 DOM 랜더링</span>\n<span class="token keyword">function</span> <span class="token function">fontSize</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> valueStr <span class="token operator">=</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">\'string\'</span>\n    <span class="token operator">?</span> value\n    <span class="token punctuation">:</span> value <span class="token operator">+</span> <span class="token string">\'px\'</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> valueStr\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> fontColor <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token string">\'3em\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  fontColor\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>위의 코드 처럼 <code class="language-text">style</code> 함수는 객체를 믹스인 할 수 있다. 프로퍼티가 맞는 순수 객체가 들어가면 아무 없이 작동하기 때문에 위의 <code class="language-text">fontSize</code> 함수처럼 상황에 맞게 적절한 객체를 리턴하는 함수를 만들어서 다양한 상황에 맞게 사용할 수 있다.</p>\n<h2 id="미디어-쿼리"><a href="#%EB%AF%B8%EB%94%94%EC%96%B4-%EC%BF%BC%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>미디어 쿼리</h2>\n<p><code class="language-text">media</code> 함수로 간단히 미디어 쿼리를 생성할 수 있다. 생성된 쿼리를 <code class="language-text">style</code> 함수 안에 넣으면 자동으로 Nested 쿼리 형식으로 생성된다. 수동으로 Nested 쿼리를 입력하고자 할 때는 <code class="language-text">style</code> 함수 안에 넣는 객체에 <code class="language-text">$nest</code> 속성을 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> media <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">:</span> <span class="token number">700</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">701</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="수도-클래스pseudo-class-작성"><a href="#%EC%88%98%EB%8F%84-%ED%81%B4%EB%9E%98%EC%8A%A4pseudo-class-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>수도 클래스(pseudo class) 작성</h2>\n<p>Sass, Less와 유사한 형태로 계층 화된 쿼리를 작성할 수 있다. 위에서 언급한 <code class="language-text">$nest</code> 속성을 선택하면 해당 클래스의 계층 쿼리를 작성할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span><span class="token punctuation">,</span>\n    $nest<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'&amp;:focus\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token string">\'&amp;&amp;:hover\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class.class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="css-클래스-조합하기"><a href="#css-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%A1%B0%ED%95%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 클래스 조합하기</h2>\n<p>클래스를 조합하는건 <code class="language-text">style</code> 함수로 만들어진 클래스들을 분기에 따라 추가하고 제거하도록 만들면 된다. 다만 이 과정에서 있는 경우와 없는 경우에 따라 문자열을 조합하는게 번거로울 수 있는데, <code class="language-text">classes</code> 함수가 귀찮은 부분을 쉽게 해결하도록 도와준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> baseClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'#333\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> errorClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">interface</span> <span class="token class-name">AppProps</span> <span class="token punctuation">{</span>\n  className<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n  hasError<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> className<span class="token punctuation">,</span> hasError <span class="token punctuation">}</span><span class="token punctuation">:</span> AppProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>\n    <span class="token function">classes</span><span class="token punctuation">(</span>\n      baseClassName<span class="token punctuation">,</span>\n      className<span class="token punctuation">,</span>\n      hasError <span class="token operator">&amp;&amp;</span> errorClassName\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token operator">></span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="keyframes-함수로-애니메이션-만들기"><a href="#keyframes-%ED%95%A8%EC%88%98%EB%A1%9C-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Keyframes 함수로 애니메이션 만들기</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> keyframes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> colorAnimationName <span class="token operator">=</span> <span class="token function">keyframes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token string">\'0%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'black\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">\'50%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'blue\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'20px\'</span><span class="token punctuation">,</span>\n    animationName<span class="token punctuation">:</span> colorAnimationName<span class="token punctuation">,</span>\n    animationDuration<span class="token punctuation">:</span> <span class="token string">\'1s\'</span><span class="token punctuation">,</span>\n    animationIterationCount<span class="token punctuation">:</span> <span class="token string">\'infinite\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">colorAnimationName</code> 을 일일이 변수로 분리 할 필요는 없다. 한번만 사용할거면 <code class="language-text">animationName</code> 속성에 바로 <code class="language-text">keyframes</code> 를 사용한 객체를 리턴하도록 만들면 된다.</p>\n<h2 id="일반-css를-사용하기"><a href="#%EC%9D%BC%EB%B0%98-css%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일반 CSS를 사용하기</h2>\n<p><code class="language-text">cssRaw</code> 함수를 사용하고 그 안에 일반 CSS를 문자열로 집어넣으면 그대로 글로벌 스타일로 변환된다. 그리고 그 파일안에 있는 컴포넌트에 전부 영향을 준다. 특정 이름을 가진 클래스를 만들고, 간단하게 기존 스타일을 마이그레이션 하거나 NormalizeCSS 등을 바로 가져올 때도 유용하게 사용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> cssRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.red {\n  color: red;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.bold {\n  font-weight: bold;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className <span class="token operator">+</span> <span class="token string">\' red bold\'</span><span class="token punctuation">}</span><span class="token operator">></span> <span class="token comment">// red, bold 클래스 사용 가능</span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="구형-브라우저용-속성-사용하기"><a href="#%EA%B5%AC%ED%98%95-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9A%A9-%EC%86%8D%EC%84%B1-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구형 브라우저용 속성 사용하기</h2>\n<p><code class="language-text">rgba</code> 같은 구형 브라우저에서 지원되지 않는 속성을 사용하면서 구형 브라우저를 지원하는 용도로 <code class="language-text">rgb</code> 를 사용하는 경우, CSS 파일에서는 보통 같은 속성을 두번 작성해서 문제를 해결할 수 있다. 하지만 TypeStyle은 객체를 파싱하기 때문에 같은 속성 값을 두번 선언할 수는 없다.</p>\n<p>하지만 배열을 사용하면 한 속성에 배열의 요소를 순차적으로 따라 스타일을 적용하도록 만들 수 있으며, 비슷한 원리를 vendor prefix에도 적용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> types <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> scroll<span class="token punctuation">:</span> types<span class="token punctuation">.</span>NestedCSSProperties <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token string">\'-webkit-overflow-scrolling\'</span><span class="token punctuation">:</span> <span class="token string">\'touch\'</span><span class="token punctuation">,</span>\n  overflow<span class="token punctuation">:</span> <span class="token string">\'auto\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  scroll<span class="token punctuation">,</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span><span class="token punctuation">,</span>\n    backgroundColor<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token string">\'rgb(200, 54, 54)\'</span><span class="token punctuation">,</span> <span class="token comment">// 구형 브라우저용</span>\n      <span class="token string">\'rgba(200, 54, 54, 0.5)\'</span> <span class="token comment">// 요즘 브라우저용</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="정적-페이지-만들어보기"><a href="#%EC%A0%95%EC%A0%81-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정적 페이지 만들어보기</h2>\n<p><code class="language-text">getStyles</code> 함수는 현재 작성된 파일 안에 정의된 TypeStyle 스타일을 문자열로 변환하는 기능을 한다. 이를 이용해서 간단한 HTML 페이지를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// app.tsx</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fs <span class="token keyword">from</span> <span class="token string">\'fs\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOMServer <span class="token keyword">from</span> <span class="token string">\'react-dom/server\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> getStyles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello World\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> html <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToStaticMarkup</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> css <span class="token operator">=</span> <span class="token function">getStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">renderPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> html<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> css<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token string">`\n&lt;html>\n  &lt;head>\n    &lt;style></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>css<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/style>\n  &lt;/head>\n  &lt;body>\n    </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n  &lt;/body>\n&lt;/html>\n`</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> renderedPage <span class="token operator">=</span> <span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nfs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">,</span> renderedPage<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- 결과물 --></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token selector">.fyuerk</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fyuerk<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hello World<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 방식을 응용하여 서버 사이드 랜더링에서도 스타일을 적용할 수 있다. <a href="https://egghead.io/lessons/css-render-html-css-server-side-using-typestyle">영상 참고.</a></p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-16-typestyle-basic/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-16",path:"/posts/typestyle-basic",title:"TypeStyle 사용하기",tags:["TypeScript","React","CSS"],category:"TypeStyle"}}],CSS:[{excerpt:"다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로  TypeStyle 을 활용하는 방안을 검토중이다. 그래서  egghead의 강좌 를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다. 적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS…",html:'<p>다음 프로젝트에서 본격적으로 타입스크립트를 사용한 리액트 애플리케이션을 도입하고자 하는데, CSS를 입히기 위한 도구로 <a href="https://typestyle.github.io">TypeStyle</a>을 활용하는 방안을 검토중이다.</p>\n<p>그래서 <a href="https://egghead.io/courses/maintainable-css-using-typestyle">egghead의 강좌</a>를 가볍게 따라가며 내용을 정리해보았다. 이 정도면 충분히 도입할 만한 가치가 있어 보인다.</p>\n<p>적어도 스타일 속성 이름으로 오타가 날 일은 없어 보이며 JS를 적극적으로 활용하여 동적인 스타일을 입힐 수 있으리라 기대한다.</p>\n<p>참고로 아래의 예제 코드는 모두 리액트 애플리케이션을 개발한다는 전제하에 소개하고 있다. 하지만 TypeStyle 자체는 어느 환경에서나 사용 가능하다.</p>\n<h2 id="기본-사용법"><a href="#%EA%B8%B0%EB%B3%B8-%EC%82%AC%EC%9A%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 사용법</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOM <span class="token keyword">from</span> <span class="token string">\'react-dom\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  position<span class="token punctuation">:</span> <span class="token string">\'relative\'</span> \n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello TypeStyle<span class="token operator">!</span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">style</code> 함수로 생성된 내용이 스타일이 적용된 임의의 클래스 이름을 만들게 되고 DOM은 바로 클래스 이름을 사용하면 되도록 구성되어 있다.</p>\n<p>이 과정에서 객체 형식으로 되어있는 key-value 값은 이미 라이브러리에 CSS 스펙에 맞게 정의되어 있기 때문에 오타가 날 시 컴파일러가 친절하게 에러를 잡아준다.</p>\n<h2 id="스타일-믹스인"><a href="#%EC%8A%A4%ED%83%80%EC%9D%BC-%EB%AF%B9%EC%8A%A4%EC%9D%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스타일 믹스인</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 위 코드와 동일한 DOM 랜더링</span>\n<span class="token keyword">function</span> <span class="token function">fontSize</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> valueStr <span class="token operator">=</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">\'string\'</span>\n    <span class="token operator">?</span> value\n    <span class="token punctuation">:</span> value <span class="token operator">+</span> <span class="token string">\'px\'</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> valueStr\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> fontColor <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token string">\'3em\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  fontColor\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>위의 코드 처럼 <code class="language-text">style</code> 함수는 객체를 믹스인 할 수 있다. 프로퍼티가 맞는 순수 객체가 들어가면 아무 없이 작동하기 때문에 위의 <code class="language-text">fontSize</code> 함수처럼 상황에 맞게 적절한 객체를 리턴하는 함수를 만들어서 다양한 상황에 맞게 사용할 수 있다.</p>\n<h2 id="미디어-쿼리"><a href="#%EB%AF%B8%EB%94%94%EC%96%B4-%EC%BF%BC%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>미디어 쿼리</h2>\n<p><code class="language-text">media</code> 함수로 간단히 미디어 쿼리를 생성할 수 있다. 생성된 쿼리를 <code class="language-text">style</code> 함수 안에 넣으면 자동으로 Nested 쿼리 형식으로 생성된다. 수동으로 Nested 쿼리를 입력하고자 할 때는 <code class="language-text">style</code> 함수 안에 넣는 객체에 <code class="language-text">$nest</code> 속성을 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> media <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">:</span> <span class="token number">700</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token function">media</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minWidth<span class="token punctuation">:</span> <span class="token number">701</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="수도-클래스pseudo-class-작성"><a href="#%EC%88%98%EB%8F%84-%ED%81%B4%EB%9E%98%EC%8A%A4pseudo-class-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>수도 클래스(pseudo class) 작성</h2>\n<p>Sass, Less와 유사한 형태로 계층 화된 쿼리를 작성할 수 있다. 위에서 언급한 <code class="language-text">$nest</code> 속성을 선택하면 해당 클래스의 계층 쿼리를 작성할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> \n    color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n    transition<span class="token punctuation">:</span> <span class="token string">\'font-size .2s\'</span><span class="token punctuation">,</span>\n    $nest<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'&amp;:focus\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token string">\'&amp;&amp;:hover\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// .class.class:focus</span>\n        fontSize<span class="token punctuation">:</span> <span class="token string">\'50px\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="css-클래스-조합하기"><a href="#css-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%A1%B0%ED%95%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 클래스 조합하기</h2>\n<p>클래스를 조합하는건 <code class="language-text">style</code> 함수로 만들어진 클래스들을 분기에 따라 추가하고 제거하도록 만들면 된다. 다만 이 과정에서 있는 경우와 없는 경우에 따라 문자열을 조합하는게 번거로울 수 있는데, <code class="language-text">classes</code> 함수가 귀찮은 부분을 쉽게 해결하도록 도와준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> baseClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'#333\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> errorClassName <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">interface</span> <span class="token class-name">AppProps</span> <span class="token punctuation">{</span>\n  className<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n  hasError<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> className<span class="token punctuation">,</span> hasError <span class="token punctuation">}</span><span class="token punctuation">:</span> AppProps<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>\n    <span class="token function">classes</span><span class="token punctuation">(</span>\n      baseClassName<span class="token punctuation">,</span>\n      className<span class="token punctuation">,</span>\n      hasError <span class="token operator">&amp;&amp;</span> errorClassName\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token operator">></span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="keyframes-함수로-애니메이션-만들기"><a href="#keyframes-%ED%95%A8%EC%88%98%EB%A1%9C-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Keyframes 함수로 애니메이션 만들기</h2>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> keyframes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> colorAnimationName <span class="token operator">=</span> <span class="token function">keyframes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token string">\'0%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'black\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">\'50%\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'blue\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'20px\'</span><span class="token punctuation">,</span>\n    animationName<span class="token punctuation">:</span> colorAnimationName<span class="token punctuation">,</span>\n    animationDuration<span class="token punctuation">:</span> <span class="token string">\'1s\'</span><span class="token punctuation">,</span>\n    animationIterationCount<span class="token punctuation">:</span> <span class="token string">\'infinite\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">colorAnimationName</code> 을 일일이 변수로 분리 할 필요는 없다. 한번만 사용할거면 <code class="language-text">animationName</code> 속성에 바로 <code class="language-text">keyframes</code> 를 사용한 객체를 리턴하도록 만들면 된다.</p>\n<h2 id="일반-css를-사용하기"><a href="#%EC%9D%BC%EB%B0%98-css%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일반 CSS를 사용하기</h2>\n<p><code class="language-text">cssRaw</code> 함수를 사용하고 그 안에 일반 CSS를 문자열로 집어넣으면 그대로 글로벌 스타일로 변환된다. 그리고 그 파일안에 있는 컴포넌트에 전부 영향을 준다. 특정 이름을 가진 클래스를 만들고, 간단하게 기존 스타일을 마이그레이션 하거나 NormalizeCSS 등을 바로 가져올 때도 유용하게 사용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> cssRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.red {\n  color: red;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">cssRaw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n.bold {\n  font-weight: bold;\n}\n`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  <span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className <span class="token operator">+</span> <span class="token string">\' red bold\'</span><span class="token punctuation">}</span><span class="token operator">></span> <span class="token comment">// red, bold 클래스 사용 가능</span>\n    Hello world\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="구형-브라우저용-속성-사용하기"><a href="#%EA%B5%AC%ED%98%95-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9A%A9-%EC%86%8D%EC%84%B1-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구형 브라우저용 속성 사용하기</h2>\n<p><code class="language-text">rgba</code> 같은 구형 브라우저에서 지원되지 않는 속성을 사용하면서 구형 브라우저를 지원하는 용도로 <code class="language-text">rgb</code> 를 사용하는 경우, CSS 파일에서는 보통 같은 속성을 두번 작성해서 문제를 해결할 수 있다. 하지만 TypeStyle은 객체를 파싱하기 때문에 같은 속성 값을 두번 선언할 수는 없다.</p>\n<p>하지만 배열을 사용하면 한 속성에 배열의 요소를 순차적으로 따라 스타일을 적용하도록 만들 수 있으며, 비슷한 원리를 vendor prefix에도 적용할 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> types <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> scroll<span class="token punctuation">:</span> types<span class="token punctuation">.</span>NestedCSSProperties <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token string">\'-webkit-overflow-scrolling\'</span><span class="token punctuation">:</span> <span class="token string">\'touch\'</span><span class="token punctuation">,</span>\n  overflow<span class="token punctuation">:</span> <span class="token string">\'auto\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span>\n  scroll<span class="token punctuation">,</span>\n  <span class="token punctuation">{</span>\n    fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span><span class="token punctuation">,</span>\n    backgroundColor<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token string">\'rgb(200, 54, 54)\'</span><span class="token punctuation">,</span> <span class="token comment">// 구형 브라우저용</span>\n      <span class="token string">\'rgba(200, 54, 54, 0.5)\'</span> <span class="token comment">// 요즘 브라우저용</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h2 id="정적-페이지-만들어보기"><a href="#%EC%A0%95%EC%A0%81-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정적 페이지 만들어보기</h2>\n<p><code class="language-text">getStyles</code> 함수는 현재 작성된 파일 안에 정의된 TypeStyle 스타일을 문자열로 변환하는 기능을 한다. 이를 이용해서 간단한 HTML 페이지를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token comment">// app.tsx</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fs <span class="token keyword">from</span> <span class="token string">\'fs\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOMServer <span class="token keyword">from</span> <span class="token string">\'react-dom/server\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> style<span class="token punctuation">,</span> getStyles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'typestyle\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> className <span class="token operator">=</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  color<span class="token punctuation">:</span> <span class="token string">\'red\'</span><span class="token punctuation">,</span>\n  fontSize<span class="token punctuation">:</span> <span class="token string">\'30px\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">></span>\n    Hello World\n  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> html <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToStaticMarkup</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> css <span class="token operator">=</span> <span class="token function">getStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">renderPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> html<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> css<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token string">`\n&lt;html>\n  &lt;head>\n    &lt;style></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>css<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/style>\n  &lt;/head>\n  &lt;body>\n    </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n  &lt;/body>\n&lt;/html>\n`</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> renderedPage <span class="token operator">=</span> <span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> html<span class="token punctuation">,</span> css <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nfs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/index.html\'</span><span class="token punctuation">,</span> renderedPage<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- 결과물 --></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token selector">.fyuerk</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fyuerk<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hello World<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 방식을 응용하여 서버 사이드 랜더링에서도 스타일을 적용할 수 있다. <a href="https://egghead.io/lessons/css-render-html-css-server-side-using-typestyle">영상 참고.</a></p>',
id:"/home/circleci/repo/src/pages/posts/2018-01-16-typestyle-basic/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-16",path:"/posts/typestyle-basic",title:"TypeStyle 사용하기",tags:["TypeScript","React","CSS"],category:"TypeStyle"}}],Translation:[{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며번역-서문"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며(번역 서문)</h2>\n<p>“더 좋은 테스트를 위한 번역 시리즈” 두 번째입니다. 테스트를 작성하는게 좋다는 공감대는 얻었을 지 몰라도 막상 코드 에디터 앞에서는 대략 정신이 멍해지기 일쑤입니다. 전부 다 테스트를 하자니 너무 광범위하고, 함수 단위로 유닛 테스트만 작성하자니 너무 세세해서 실제 제대로 애플리케이션이 동작하는지 파악하기도 어렵거니와 노력 대비 별로 쓸모가 없어보이기도 합니다.</p>\n<p>그 고민을 조금이나마 덜어드리고자 좋은 조언을 가져와서 번역해 보았습니다.</p>\n<p><a href="https://blog.kentcdodds.com/write-tests-not-too-many-mostly-integration-5e8c7fff591c">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p>얼마 전에 <a href="https://medium.com/@rauchg">Guillermo Rauch</a>(<a href="https://socket.io">Socket.io</a>의 창시자이자 <a href="https://zeit.co">Zeit.co</a>의 설립자입니다)가 위 제목으로 <a href="https://twitter.com/rauchg/status/807626710350839808">심오한 트윗</a>을 하나 작성했습니다. </p>\n<p><img src="https://cl.ly/1w0Q053W1B1O/write-integration-test-2.png"></p>\n<blockquote>\n<p><strong>테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>짧지만 긴 내용입니다. 더 자세히 들어가보죠.</p>\n<blockquote>\n<p><strong>테스트를 작성하라.</strong></p>\n</blockquote>\n<p>네, 여러분은 대부분의 프로젝트에 자동화된 테스트를 작성해야 합니다. 특히 자신의 시간을 소중히 여긴다면요. 새벽 두 시에 버그 때문에 불려나가는 것 보다 로컬에서 버그를 잡아내는게 훨씬 낫습니다. <strong>저는 테스트를 작성하는데 시간을 들일 때 오히려 시간을 절약한다고 느낍니다.</strong> 테스트를 작성하다 보면 제가 실제로 만들고자 하는 것 보다 더 오래 걸릴 수도 있고, 그렇지 않을 수도 있지만, 저는(그리고 다른 사람들도) 거의 확실히 유지보수 하는데 드는 시간을 절약하고 있습니다.</p>\n<p>테스트를 작성할 때는 이 테스트가 프로젝트의 버그를 얼마나 줄여줄 자신이 있는지 신경쓰셔야 합니다. <a href="https://flow.org/">Flow</a>, <a href="https://eslint.org/">ESLint</a> 같은 정적 타이핑이나 린트는 의미있는 수준의 자신감을 가져다 줍니다. 혹시 써보지 않으셨다면 반드시 살펴보시길 권합니다. 하지만 <strong>아무리 강한 타입을 적용한 프로그래밍 언어라도 테스트가 있어야 합니다.</strong> 타입과 린트는 여러분의 비지니스 로직에 버그가 없도록 만들어주지 않습니다. 그러니 좋은 테스트를 작성해서 (버그를 줄인다는)자신감을 크게 끌어올릴 필요가 있습니다.</p>\n<blockquote>\n<p><strong>너무 많이는 말고.</strong></p>\n</blockquote>\n<p>저는 애플리케이션에 100%의 코드 커버리지를 달성하려는 매니저나 팀이 있다고 들었습니다. 이는 굉장히 안 좋은 생각입니다. 커버리지가 70%(제 추측입니다.. 과학적인 증거는 없어요)를 넘어가게 되면서부터 여러분이 테스트로 얻는 이익이 점감하게 되는 문제가 있습니다. 왜 그럴까요? 음, 언제나 100%를 달성하기 위해 힘을 쏟다 보면 막상 테스트 할 필요 없는 것을 테스트하는데 시간을 소모하게 됩니다. 실제 신경써야 할 로직이 없는 것들 말이죠(ESLint나 Flow로도 충분히 잡아낼 수 있는 모든 버그들). <em>이런 규모의 테스트를 유지보수하는데 엄청난 시간이 들고 여러분의 팀을 힘들게 만들 겁니다.</em></p>\n<p>그리고 테스트 환경에서 재현하기 어려운 한 줄의 코드를 위해 테스트를 작성할 때도 있습니다. 이런 경우는 <em>진짜로</em> 피하고 싶을겁니다. 왜냐면 이 테스트는 애플리케이션이 제대로 작동한다는 자신감을 별로 주지도 못하고, 리팩터링 할 때 속도를 늦출 뿐이기 때문입니다. <strong>코드를 리팩터링 할 때 테스트를 변경해야 하는 경우는 거의 없습니다.</strong></p>\n<p>제가 작성한 대부분의 오픈 소스 프로젝트는 거의 100%의 코드 커버리지를 가지고 있다는 말씀을 드려야겠군요. 대부분의 프로젝트들은 작은 라이브러리나 툴이며, 여러 다른 상황(코드가 깨진다면 심각한 상황으로 이어질 수 있는 프로젝트들이 사용하는 상황)에서 재사용하기 쉽도록 작성되었습니다. 그래서 어찌저찌 상대적으로 100%의 커버리지를 얻을 수 있었습니다.</p>\n<blockquote>\n<p><strong>통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>테스트의 종류는 아주 다양합니다(제가 Fluent Conf에서 <a href="https://youtu.be/Da9wfQ0frGA">“바퀴를 테스트하면서 배울 수 있는 것들”</a>이라는 제목으로 5분짜리 발표를 했습니다). 각각의 테스트는 장단점이 있습니다. 보통 자동화된 테스트를 이야기 할 때 많이 거론되는 테스트는 단위(Unit) 테스트, 통합(Integration) 테스트, E2E(End to End) 테스트입니다.</p>\n<p>여기 제가 <a href="https://frontendmasters.com/courses/testing-javascript/">“자바스크립트 애플리케이션 테스트하기”</a> 라는 Frontend Masters 워크샵에서 선보인 <a href="http://slides.com/kentcdodds/testing-workshop#/4/8">슬라이드</a>를 잠시 보시죠.</p>\n<p><img src="https://cl.ly/3x273a0A343P/write-integration-test-1.png"></p>\n<p>테스팅 피라미드는 <a href="https://martinfowler.com/bliki/TestPyramid.html">마틴 파울러의 블로그</a>와 <a href="https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html">구글 테스팅 블로그</a>에서 얻은 개념을 한데 합친 것입니다.</p>\n<p>앞서 말씀드린대로 이 피라미드는 바닥부터 꼭대기까지 단위 테스트, 통합 테스트, E2E 테스트로 이루어져 있습니다. 피라미드의 위로 올라갈수록 테스트를 실행하고 작성하는데 더 많은 시간이 들고, 실행하고 유지보수하는데 비용(시간과 자원 측면에서)이 많이 듭니다. 그림만 보면 유닛 테스트를 작성하는데 시간을 더 투자해야 하는 것 처럼 보입니다.</p>\n<p>미처 언급되지 않은 점이 있는데, 피라미드 위로 올라갈 수록 각 테스트의 신뢰성이 증가한다는 겁니다. 여러분이 생각한 것 보다 훨씬 큰 이득을 얻을 수 있습니다(You get more bang for your buck). 따라서 E2E 테스트가 단위 테스트보다 느리고 비용이 많이 들지라도, 애플리케이션이 의도대로 동작한다는 자신감은 더 크게 제공합니다.</p>\n<p><a href="https://twitter.com/kentcdodds/status/628658648001048577">제 트윗 중 가장 많이 리트윗된 트윗</a>이 단위 테스트의 주요 문제를 다루고 있습니다.</p>\n<blockquote>\n<p>아직도 이 사진을 좋아해요. 유닛 테스트만 좋아하는 사람들은 이렇게 “작동하는 것 같다” 라고 말하죠.  </p>\n</blockquote>\n<p><img src="https://cl.ly/093u1O2j0k1Y/write-integration-test-3.gif"></p>\n<p>이 사람이 방에서 달릴 수 있고, 팔굽혀펴기를 하고, 독서를 할 수 있는지 확인하기 위해 단위 테스트를 작성했지만, 이 사람은 자신의 다양한 신체 부위를 아주 효율적으로 사용하지 못하는데다 통합하지 않고 있습니다. 만약 버튼 컴포넌트가 <code class="language-text">onClick</code> 핸들러를 호출할 때 핸들러가 올바른 데이터를 제대로 요청하지 않는다면, 핸들러의 호출이 잘 되는지 확인하는 일은 그닥 중요한게 아닙니다! 각각 분리 된 부분이 자신의 역할을 제대로 수행하는지 확인하기 위해 단위 테스트를 작성하는 것은 그리 나쁜 일은 아닙니다. *분리 된 부분이 <strong>함께</strong> 제 역할을 수행하는지 확인하지 않는다면 아무 소용 없습니다.*</p>\n<p><strong>통합 테스트는 자신감을 심어주는 역할 대비 속도/비용을 부담하는 정도를 아주 균형있게 가지고 있습니다.</strong> 그래서 여러분이 <em>대부분</em>(혹시 몰라 말씀드리지만 전부는 아닙니다)의 시간을 통합 테스트에 투자하라는 조언을 드리는 겁니다.</p>\n<hr>\n<p><strong>통합 테스트를 더 많이 작성하는 방법</strong></p>\n<p>통합 테스트와 단위 테스트 사이의 경계는 약간 모호합니다. 어느 쪽이든 더 많은 통합 테스트를 작성하기 위해 가장 도움되는 것이 무엇이냐 물으신다면 <strong>일단 너무 많은 것을 모킹(mocking)하지 않기를 권합니다.</strong> <em>무언가를 모킹할 때, 테스트하고자 하는 것과 모킹된 것 사이의 통합테스트 신뢰도는 떨어지게 됩니다.</em> 때로는 이 방법이 도움 되지 않을 수 있습니다(<a href="https://www.youtube.com/watch?v=EaxDl5NPuCA&#x26;feature=youtu.be">반대하는 사람도 있지만요</a>). 실제로 매 테스트마다 이메일을 발송하거나 신용카드 결제를 할 필요는 없지만, 대부분의 경우 모킹을 피하면 테스팅을 더 잘 하게 되리라 생각합니다.</p>\n<p><strong>만약 리액트로 개발을 하고 계시다면, 얕은 랜더링(<a href="http://airbnb.io/enzyme/docs/api/shallow.html">shallow rendering</a>)도 포함됩니다.</strong> 저는 오랜 시간동안 얕은 랜더링은 세부 구현을 테스트하는 것이나 마찬가지라고 이야기해왔습니다. 이 부분을 <a href="https://www.briefs.fm/3-minutes-with-kent/49">3분 짜리 팟캐스트</a>에서(그리고 리액트 테스팅에 대한 다른 팁도 포함해서) 다루고 있습니다.</p>\n<p>도움이 되셨길 바라며 모두 행운을 빕니다! 👍</p>',id:"/home/circleci/repo/src/pages/posts/2018-01-15-write-mostly-integration-test-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-15",path:"/posts/write-mostly-integration-test-kr",title:"[번역] 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.",tags:["Translation","Testing","TDD"],category:"Testing"}},{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>요즘 개인적으로 “가능한한 내 코드에 모두 테스트를 작성하겠다” 라는 목표를 가지고 있습니다. 하지만 테스트에 대해 두루뭉술한 개념만 가지고 있고, 지금은 상대적으로 쉬운 함수만 테스트를 작성할 수 있는 수준입니다.</p>\n<p>하지만 실제 개발하고 있는 애플리케이션은 ‘리액트 + 리덕스(혹은 MobX) + 기타등등’ 의 구성으로 되어있기 때문에 조금만 테스트를 제대로 해 보려고 하면 어디부터 손을 대야할지 전혀 감을 못 잡는 상태입니다.</p>\n<p>그래서 실전에 최대한 도움이 될 수 있도록 유용한 글을 몇개 추려서 단계별로 보기 좋은 참고서가 될 수있도록 번역하는 사이드 프로젝트를 진행하고 있습니다. 이 글을 보시는 분들도 리액트로 만드는 애플리케이션을 테스트하는데 도움이 되었으면 좋겠습니다.</p>\n<p>그 첫 번째 단계로 <strong>테스트가 대체 뭐냐?</strong> 라는 질문에 가벼운 답이 될 수 있는 글의 번역부터 시작합니다.</p>\n<p><a href="https://blog.kentcdodds.com/but-really-what-is-a-javascript-test-46fe5f3fad77">원문은 여기서 읽어보실 수 있습니다.</a></p>\n<hr>\n<p><em>일단 한 발짝 물러서서 시작부터 자바스크립트 자동화 테스트를 이해해 보도록 하겠습니다.</em></p>\n<p>소프트웨어를 테스트하는 이유는 수도 없이 많습니다. 저는 크게 두 가지 이유를 가지고 있습니다.</p>\n<ol>\n<li>전체 작업 흐름의 속도를 올려서 개발을 빠르게 한다.</li>\n<li>변경 사항이 있을 때 기존 코드를 무너트리지 않는다는 확신을 갖도록 도와준다.</li>\n</ol>\n<p>그래서 그런데, 저는 여러분에게 몇 가지 여쭈어 보고 싶은게 있습니다. (트위터 투표로 미리 물어보았죠)</p>\n<ul>\n<li><a href="https://twitter.com/kentcdodds/status/942625485829181441">자바스크립트 테스트를 작성해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625486638759938">자바스크립트 테스팅 프레임워크를 사용해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625487511154688">자바스크립트 테스팅 프레임워크를 밑바닥부터 설정해 보신 적 있습니까?</a></li>\n<li><a href="https://twitter.com/kentcdodds/status/942625489348280320">테스팅 프레임워크를 충분히 이해하고 있고, 아주 간단한 테스팅 프레임워크라도 직접 만들어 보실 수 있습니까?</a></li>\n</ul>\n<p>이 글의 목적은 당신이 마지막 질문에 “네” 라고 대답할 수 있도록 돕는 것입니다. 결과적으로 자바스크립트를 테스트한다는게 무엇인지 알아야 더 좋은 테스트를 작성할 수 있으니까요.</p>\n<p>이제 간단한 <code class="language-text">math.js</code> 모듈을 만들어서 그 안에 두 함수를 작성한 다음에 내보내겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b\n<span class="token keyword">const</span> <span class="token function-variable function">subtract</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">-</span> b\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> sum<span class="token punctuation">,</span> subtract <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><strong>작성하는 모든 코드는 <a href="https://github.com/kentcdodds/js-test-example">Github에</a> 올려두었으니 참고하시면 됩니다</strong> 🐙😸</p>\n<h2 id="1단계"><a href="#1%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1단계</h2>\n<p>제가 생각할 수 있는 가장 기본적인 테스트 형식을 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// basic-test.js</span>\n<span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token boolean">true</span>\n<span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token boolean">false</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'${actual} is not ${expected}\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>터미널에서 <code class="language-text">node basic-test.js</code> 라고 입력하시면 이 테스트 코드를 실행할 수 있습니다. 이게 테스트입니다!</p>\n<p><strong>테스트는 기대하던 결과값과 실제 출력된 값이 맞지 않으면 에러를 일으키는 코드입니다.</strong> 만약 특정한 상태값 설정을 해야하는 등(예를 들자면 컴포넌트가 테스트 실행 전에 그려져야(Rendered on Document) 브라우저 이벤트를 확인해볼 수 있다던가, 데이터베이스에 있는 사용자를 가져온다던가) 특수한 경우에는 더 복잡해질 수 있습니다. 하지만 <code class="language-text">math.js</code> 모듈 같은 순수한 함수(Pure function - 입력값에 따른 출력값이 동일하며 외부의 상태에 영향을 미치지 않는 함수)은 상대적으로 쉽습니다.</p>\n<p><strong>코드의 <code class="language-text">actual !== expected</code> 부분을 “단언(assertion)” 이라고 합니다.</strong> 단언은 어떤 것이 특정한 값으로 되어있어야 한다거나 특정 테스트를 통과해야한다고 코드로 표현하는 것을 뜻합니다. <code class="language-text">actual</code> 부분이 어떠한 정규표현식에 일치해야하거나, 배열이 특정한 길이를 가지고 있어야 한다고 표현하는 것이 단언이 됩니다. 중요한 점은 만약 우리가 작성한 단언이 실패하면 에러가 일어나야 한다는 것입니다.</p>\n<p>그래서 <code class="language-text">math.js</code> 를 가장 기본적인 형태로 테스트 해 본다면 이렇게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 1.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>짜잔! 이 파일을 <code class="language-text">node</code> 커맨드로 실행해보면 에러 없이 실행되고 종료됩니다. 이제 <code class="language-text">sum</code> 함수의 <code class="language-text">+</code> 연산을 <code class="language-text">-</code> 연산으로 바꾸고 다시 실행해서 테스트를 깨지도록 만들어보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 1.js\n/Users/kdodds/Desktop/js-test-example/1.js:8\n  throw new Error(`${result} is not equal to ${expected}`)\n  ^\nError: -4 is not equal to 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/1.js:8:9)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>좋습니다! 우리는 벌써 기본적인 테스트를 사용해서 이득을 보고 있어요! 이제 테스트를 변경하지 않는 이상 <code class="language-text">sum</code> 함수를 마음대로 바꿀 수 없습니다. 쩌네요(Neato)!</p>\n<p><strong>테스팅 프레임워크(혹은 단언 라이브러리)의 가장 중요한 부분은 에러 메세지를 최대한 도움이 되도록 표현하는 겁니다.</strong> 테스트가 실패할 때마다 여러분이 제일 먼저 에러 메세지를 보게 됩니다. 만약 에러 메세지를 보고 어떤 문제가 밑에 깔려있는지 단박에 파악하지 못한다면, 몇분씩 코드를 직접 들여다보면서 뭐가 잘못됐는지 찾아야 합니다. 에러 메세지의 질은 여러분이 주어진 테스팅 프레임워크를 얼마나 잘 이해하고 적절한 단언을 사용하느냐에 따라서 크게 달라집니다.</p>\n<h2 id="2단계"><a href="#2%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2단계</h2>\n<p>사실 Node.js 가 위에서 만들어본 <a href="https://nodejs.org/api/assert.html#assert_assert"><code class="language-text">assert</code></a> 모듈을 내장하고 있다는 걸 알고 계셨나요🤔? 이 모듈을 써서 리팩터링을 해 보겠습니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 2.js</span>\n<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'assert\'</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\nassert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> expected<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>좋아요! 저번에 작성했던 코드와 기능적으로 완전히 동일한 테스트 모듈을 작성해보았습니다. 딱 하나 다른게 있다면 에러 메세지입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 2.js\nassert.js:42\n  throw new errors.AssertionError({\n  ^\nAssertionError [ERR_ASSERTION]: -4 === 10\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/2.js:8:8)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>내용을 보시면 아쉽게도 에러가 더 이상 코드 내용을 보여주지 않고 있습니다. 😦 일단 계속 가보죠.</p>\n<h2 id="3단계"><a href="#3%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3단계</h2>\n<p>더 나아가서 직접 테스팅 “프레임워크” 와 단언 라이브러리를 작성해보겠습니다. 먼저 단언 라이브러리부터 시작해보죠. Node의 내장 <code class="language-text">assert</code> 모듈 대신에 <code class="language-text">expect</code> 라는 라이브러리를 만들어보겠습니다. 변경된 코드는 아래와 같습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 3.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">let</span> result<span class="token punctuation">,</span> expected\n\nresult <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\nresult <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\nexpected <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 원하는대로 단언을 추가하고 객체를 리턴하도록 만들 수 있습니다(<code class="language-text">toMatchRegex</code>, <code class="language-text">toHaveLength</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 3.js\n/Users/kdodds/Desktop/js-test-example/3.js:17\n        throw new Error(`${actual} is not equal to ${expected}`)\n        ^\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/3.js:17:15)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/3.js:7:16)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n    at startup (bootstrap_node.js:187:16)\n    at bootstrap_node.js:608:3</code></pre>\n      </div>\n<p>훨씬 보기 좋아졌네요.</p>\n<h2 id="4단계"><a href="#4%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4단계</h2>\n<p>그런데 만약 에러 메세지가 나온다 해도 정확하게 <code class="language-text">sum</code> 함수에 문제가 생겼다고 파악하려면 어떻게 해야할까요😖? 저 파일 안에는 <code class="language-text">subtract</code> 함수도 있는데 말이죠. 게다가 테스트 파일의 코드는 각각의 테스트를 적절히 분리하지 못하고 있습니다(시각적으로 + 기능적으로). </p>\n<p>그래서 헬퍼 함수를 만들어서 분리해보았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 4.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">try</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`- [x] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`✕ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">function</span> <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>actual <span class="token operator">!==</span> expected<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>actual<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not equal to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이제 특정 테스트에 관련된 내용은 전부 “test” 콜백 안에 집어넣고, 테스트에 제목을 매길 수 있습니다. 그리고 <code class="language-text">test</code> 함수에 유용한 에러 메세지를 출력하도록 할 뿐만 아니라 모든 테스트를 한번에 실행할 수 있게 되었습니다(첫 번째 테스트에서 에러가 발생한다고 멈추지 않구요)!</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node 4.js\n✕ sum adds numbers\nError: -4 is not equal to 10\n    at Object.toBe (/Users/kdodds/Desktop/js-test-example/4.js:29:15)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:6:18)\n    at test (/Users/kdodds/Desktop/js-test-example/4.js:17:5)\n    at Object.&lt;anonymous&gt; (/Users/kdodds/Desktop/js-test-example/4.js:3:1)\n    at Module._compile (module.js:635:30)\n    at Object.Module._extensions..js (module.js:646:10)\n    at Module.load (module.js:554:32)\n    at tryModuleLoad (module.js:497:12)\n    at Function.Module._load (module.js:489:3)\n    at Function.Module.runMain (module.js:676:10)\n- [x] subtract subtracts numbers</code></pre>\n      </div>\n<p>좋아요! 이제 에러 메세지 <em>뿐만 아니라</em> 어떤 부분을 고쳐야하는지 테스트 제목을 보고 찾아갈 수 있습니다.</p>\n<h2 id="5단계"><a href="#5%EB%8B%A8%EA%B3%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5단계</h2>\n<p>마지막 단계로 모든 테스트 파일을 찾아서 실행하는 <a href="https://blog.kentcdodds.com/tips-for-making-a-cli-based-tool-with-node-9903255c2a3b">CLI 도구를 작성하기만 하면 됩니다!</a> 처음엔 쉽겠지만 그 위에 해야하는 일들이 굉장히 많아서 좀 어렵습니다 . 😅</p>\n<p>현재 시점에서 우리는 테스팅 프레임워크와 테스트 실행기(runner)를 만들었습니다. 다행히도 이미 만들어진 도구가 산더미같이 많습니다! 저는 모든 테스팅 도구를 사용해보았고 다 괜찮았습니다. 그래도 제 요구 사항을 가장 만족하는 도구는 Jest 뿐이었습니다. Jest는 아주 대단한 도구입니다. (<a href="http://kcd.im/egghead-jest">Jest를 더 알아보시려면 이 링크를 확인하세요</a>)</p>\n<p>그러니 이제 직접 프레임워크를 작성하는 대신 테스트 파일을 Jest 용으로 바꾸어 보겠습니다. 이를 어쩌죠? 안바꿔도 되는데요!? Jest는 <code class="language-text">test</code>, <code class="language-text">expect</code> 를 글로벌 객체로 가지고 있기 때문에 그냥 이전에 작성한 <code class="language-text">test</code> 와 <code class="language-text">expect</code> 의 구현체를 지우기만 하면 됩니다!</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 5.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span>sum<span class="token punctuation">,</span> subtract<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./math\'</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'sum adds numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">10</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">\'subtract subtracts numbers\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token number">4</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>Jest로 이 파일을 실행하면 다음과 같은 결과가 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ jest\n FAIL  ./5.js\n  ✕ sum adds numbers (5ms)\n  - [x] subtract subtracts numbers (1ms)\n● sum adds numbers\nexpect(received).toBe(expected)\n    \n    Expected value to be (using Object.is):\n      10\n    Received:\n      -4\n      4 |   const result = sum(3, 7)\n      5 |   const expected = 10\n    &gt; 6 |   expect(result).toBe(expected)\n      7 | })\n      8 | \n      9 | test(&#39;subtract subtracts numbers&#39;, () =&gt; {\n      \n      at Object.&lt;anonymous&gt;.test (5.js:6:18)\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 passed, 2 total\nSnapshots:   0 total\nTime:        0.6s, estimated 1s\nRan all test suites.</code></pre>\n      </div>\n<p>텍스트만 보아서는 알 수 없지만 사실 결과는 컬러로 출력됩니다. 이미지로 보시면 이렇게 나옵니다.</p>\n<p><img src="https://cl.ly/302i0B3V0J45/what-is-javascript-testing-1.png"></p>\n<p>컬러로 출력되면 관련된 부분을 살펴볼 때 큰 도움이 됩니다. <strong>그리고 에러가 발생하는 부분의 코드를 직접 보여줍니다! 이게 “도움이 되는” 에러 메세지죠!</strong></p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>그래서 자바스크립트 테스트가 뭐라고 했죠? 단순히 특정 상태를 설정해놓은 코드를 가지고 특정 동작을 수행한 뒤, 새 상태를 확인하는 단언을 만드는 겁니다. 이번 시간에는 <a href="https://facebook.github.io/jest/docs/en/api.html#beforeeachfn-timeout"><code class="language-text">beforeEach</code></a>, <a href="https://facebook.github.io/jest/docs/en/api.html#describename-fn"><code class="language-text">describe</code></a> 같은 <a href="https://facebook.github.io/jest/docs/en/api.html">프레임워크 공용으로 사용되는 헬퍼 함수</a>에 대한 이야기는 하지 않았지만, <a href="https://facebook.github.io/jest/docs/en/expect.html#tomatchobjectobject"><code class="language-text">toMatchObject</code></a>, <a href="https://facebook.github.io/jest/docs/en/expect.html#tocontainitem"><code class="language-text">toContain</code></a> 같이 사용할 수 있는 단언이 아주 많이 있습니다. 적어도 이 글이 여러분들에게 자바스크립트로 테스트하는데 기본적인 개념을 제시해주길 바랍니다.</p>\n<p>도움이 되었으면 좋겠군요. 행운을 빕니다! 👍</p>\n<p><strong>놓치지 말고 참고할만한 글 목록(영어 자료)</strong></p>\n<ul>\n<li><a href="https://twitter.com/horse_js/status/942658114209316864">Horse JS on Twitter: “But really, what is a JavaScript”</a> - 문맥을 빗겨가게 끊어진 글을 트윗하는 아주 재밌는 계정입니다.</li>\n<li><a href="https://twitter.com/NTulswani/status/942079674527518720">Introducing React Performance Devtool!! - by Nitin Tulswani</a></li>\n<li><a href="https://www.javascriptjanuary.com">JavaScript January</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2018-01-14-what-is-testing-javascript-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-14",path:"/posts/what-is-testing-javascript-kr",title:"[번역] 그래서, 자바스크립트 테스트가 뭔가요?",tags:["Translation","Javascript","Testing"],category:"Testing"}},{excerpt:"이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다. 원문을 보시려면  이 링크 를 클릭해주세요. 안녕하세요, Boostnote 개발자  kazup  입니다. 예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다. What is Boostnote? 프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 15…",html:'<ul>\n<li>이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다.</li>\n<li>원문을 보시려면 <a href="http://boostnote.hatenablog.com/entry/2017/08/09/130721">이 링크</a>를 클릭해주세요.</li>\n</ul>\n<hr>\n<p>안녕하세요, Boostnote 개발자 <a href="https://twitter.com/kazup_bot">kazup</a> 입니다.</p>\n<p>예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다.</p>\n<h2 id="what-is-boostnote"><a href="#what-is-boostnote" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Boostnote?</h2>\n<p>프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 150가지가 넘는 언어의 Syntax Highlighting 및 스니펫을 저장하는 기능도 있습니다.</p>\n<p>개발자를 위한 특화 기능으로 vim 키맵을 사용하거나 마크다운 안에 작성해둔 코드를 원터치로 저장하는 등 개발자들이 즐겁게 사용할만한 기능들이 포함되어 있습니다.</p>\n<p>또한 에버노트에서 데이터를 가져오는 <a href="https://github.com/BoostIO/ever2boost">ever2boost</a> 등의 서드파티 도구들도 여럿 있어서 간단하게 이용하실 수 있습니다.</p>\n<h2 id="what-is-notes"><a href="#what-is-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Notes?</h2>\n<p>여러분의 친숙한 애플 순정 메모 어플리케이션입니다. Boostnote와 달리 누구나 즐겁게 사용할 수 있게 만들어져 있습니다.</p>\n<p>가볍게 동작하기 때문에 사소한 메모를 남겨두고 싶을 때 편리하게 이용할 수 있습니다.</p>\n<h2 id="the-key-differences-of-boostnote-vs-notes"><a href="#the-key-differences-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The key differences of Boostnote vs Notes</h2>\n<p>가장 큰 차이점은 대상 사용자입니다. Boostnote는 명확하게 개발자를 대상으로 삼고 있지만 Notes는 누구나 부담없이 사용할 수 있게 만들어져 있습니다.</p>\n<p>예를 들어 Notes는 플레인 텍스트(Plain text)만 지원하는 반면, Boostnote는 마크다운과 스니펫을 저장할 수 있습니다.</p>\n<p>또한 커스터마이즈 가능한 부분도 큰 차이가 나는데, Boostnote가 단축키부터 컬러 테마, 앞서 말씀드린 키맵(vim 등)의 변경이 가능한 반면 Notes는 어디까지나 간단하면서 일관된 경험을 제공합니다.</p>\n<h2 id="a-comparison-of-boostnote-vs-notes"><a href="#a-comparison-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A comparison of Boostnote vs Notes</h2>\n<p>주요 차이점을 정리해보았습니다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Boostnote</th>\n<th>Notes</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>노트북 포맷</td>\n<td>Markdown and snippet</td>\n<td>Plain text</td>\n</tr>\n<tr>\n<td>가격</td>\n<td>무료</td>\n<td>무료</td>\n</tr>\n<tr>\n<td>데이터 저장소</td>\n<td>Local, Dropbox, Google Drive 등</td>\n<td>Local, iCloud, Google</td>\n</tr>\n<tr>\n<td>플랫폼</td>\n<td>Windows, Mac, Linux (iOS, Android 출시 예정)</td>\n<td>Mac, iOS</td>\n</tr>\n<tr>\n<td>주요 대상</td>\n<td>Developer</td>\n<td>Everyone</td>\n</tr>\n<tr>\n<td>사용자 정의</td>\n<td>Color, Code Block and Editor theme, Keymap, Hotkey</td>\n<td>X</td>\n</tr>\n<tr>\n<td>노트 공유</td>\n<td><a href="https://10hz.io/">10hz</a></td>\n<td>via iCloud</td>\n</tr>\n</tbody>\n</table>\n<h2 id="wrapping-it-up"><a href="#wrapping-it-up" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrapping it up.</h2>\n<p>이상 Boostnote와 Notes를 비교해보았습니다. 둘 다 겉으로 보기에는 아주 단순해보이지만, 그 단순함 속에 숨겨진 기능이나 구조의 차이가 있어서 비교해보니 꽤 재밌었습니다.</p>\n<p>Boostnote는 훨씬 더 개발자지향적이고 무엇보다 <a href="https://github.com/BoostIO/Boostnote">오픈소스입니다</a>! 널리 개발자들에게 사용되어 다양한 수정을 거쳐 기회가 된다면 풀 리퀘스트를 주고받고 싶습니다.</p>\n<p>서두에서 말씀드린대로 Notes에서 갈아타는 분들이 많이 보이고 있으니 주변에 쓸만한 노트 앱을 찾고 계신 개발자분들이 계시다면 Boostnote를 추천해 주세요!</p>\n<p>또한 <a href="https://boostnote.io/team/">팀 단위로 노트로 기획된 10hz</a>도 현재 베타버전으로 배포되고 있으니 한번 살펴봐주시기 바랍니다.</p>\n<hr>\n<p>사실 일본어는 간단하게 말을 주고받는 정도만 할 수 있을 뿐이지, 실제로 잘 읽을 수 있는 수준은 아니라 번역기와 사전의 도움을 받아가며 작업했습니다. 그래도 내용이 어렵지 않아서 오래 걸리지 않았네요.</p>\n<p>노트를 다양한 플랫폼으로 여기저기 작성해보면서 가장 맞는 스타일의 앱을 찾고 있는데 현재로서 Boostnote가 제가 생각하는 개발노트용 앱으로 가장 알맞다고 생각하여 이렇게 소개하는 글을 번역해 보았습니다.</p>\n<p>마크다운 문법만 익숙하시다면 사용하는게 그리 어렵지 않을테니 가벼운 마음으로 한번 시도해보세요 :)</p>',id:"/home/circleci/repo/src/pages/posts/2017-08-09-boostnote-vs-notes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-08-09",path:"/posts/boostnote-vs-notes-kor",title:"[번역] Boostnote vs Notes: Choosing a note-taking Tool",tags:["Markdown","Tools","OSS","Translation"],category:"Translation"}},{excerpt:"이 글의 원문은  Michał Konarski…",html:'<ul>\n<li>이 글의 원문은 <a href="http://mjk.space/how-to-avoid-inheritance-in-ruby/">Michał Konarski</a>가 작성하였습니다.</li>\n<li>번역 실수 및 용어 사용의 지적 등은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>상속이 왜 문제가 될까요? 예를 하나 들어드리겠습니다.</p>\n<p>여러분의 고객이 \'교통 상황 시뮬레이터\'를 만들어달라고 요청했다고 해보죠. 고객은 몇몇 자동차가 움직이는 모습을 실험해보고 싶어합니다. 만약 루비같은 객체지향 언어를 사용한다면 먼저 모든 로직과 속성을 담고 있는 모델 클래스를 떠올리게 됩니다. 이렇게요.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 136px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50.73529411764706%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABlUlEQVQoz62SyU4CQRRF8bNc+AGu/BDWim4YNiQaV67QsDFqHIgyis2ktHHCCIgM3dD0wKAoIsqgkFRSz6oGGhJXJnRy0q9e7r016qJCYEY3pS/IuQZZ7tTebIhzm0Ocx0BY+Q9h3mMIcm6LI26f05KvpaipAXUQW0VQupKKTOmIE0yMhxoK9VBvmPeuaoE3MmuQ2kXIvmb6BJSppRFXz6HCR16Db3Ao3+CR0Cwg7p1TNVRLPVJbhEj+1DwOlNhlpSvDMAzn6lnM3J3hQ+YAn0SOsevCiYP3AczEGLV3X4zh3FsWUy31KN8yCfRZJleoBaZfnjBZBfiuvGBZN4NxzQj2IztYN6ywuW8D/aIeyCRANVRLPaU/gRK7JLYEIDP26VZG2yEGFFce1DpZTqh1ohRHqeojGh0N+ffEtgAR3mfSAm/lS9MnNMkhK1D5KQ/oUSrw3K+qdbU/qClV0h9plI4CX8R7nvePL8WfccyT97jDCkEbYWtEtBBQYYWAVo97ms4WLTC7zuT2ghrWRmha71pX6zR0v7xe4phLYWhMAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle Class"\n        title=""\n        src="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png"\n        srcset="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png 136w"\n        sizes="(max-width: 136px) 100vw, 136px"\n      />\n    </span>\n  </span>\n  </p>\n<p>완성된 결과물을 고객에게 보여주었습니다. 다 괜찮았는데 이제 고객이 자동차가 \'승용차\' 혹은 \'트럭\' 으로 나뉘었으면 좋겠다고 합니다. 이런 경우 두 차종은 최소한 일부 행동을 공유하고 있있는데다, 코드를 반복해서 작성하는 것도 별로 내키지 않습니다. 문제 없어요! 상속을 활용하면 되죠! 지금 마주친 경우는 아주 적절한 \'-이다(is-a)\' 관계입니다. 안 될 것 있나요?</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 424px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.443396226415096%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB30lEQVQoz2NgQAMn7h9mBNFH7+23OvPoRMvll+drrr29XHvpxfmaUw+PNR25u1cOLH93PyMDMeDEnaMsIPr0w+PNP/9//3/h8fn/J24d+3/j9fX/X/9//n/83iFXkPzhG/uZsRpw7P4Bhr1XtjP8//8fzAfSTCD6zJPjcWcfnrp7+PrBS8dvHTl79Mbhy2cenrx19tlxA2R1IH3bz25kOPnoMMP2K2tQzAZ5AWQrSCGLlp0sM7cQu7CilqwQSFJaWVyYW4hNSF5XHCwPVYfpygXnOtgqp2dxWLkbi1r7GAmYu+sLCEsIcAOluICYDU05B0hcTl2Kx9LTQMA52FrQKcBa5NjvNazdm8vYJu2tZmK48PTs7TMPTp44cfvomcsvLp688OzsidNPD+tAvcPYPq2F4cqbCwxrD6wE88Hh+/ho4OXnF64Cg+T4MWBwnHt05vTFp+fOHri1I4jh7/8//2++ufn/7P0z/18B4bPfT/8fu3vAAaRx68kNcC8xMjIyHLx0EMw/9eBY0c//P/7ffnfr/8lbJ/7f/3z//1sgPHxnbyFQ8uiU04+OtwNxJzBmO08+ONKx7+Y2eZBGoI3wpLHp4lIGoBow/9Cd3RbAJDTx7OMTYH1ANgh37b6+yRwAIIsHylqv15gAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with inheritance"\n        title=""\n        src="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png"\n        srcset="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-20168.png 198w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-b3d3b.png 395w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png 424w"\n        sizes="(max-width: 424px) 100vw, 424px"\n      />\n    </span>\n  </span>\n  </p>\n<p>고객은 결과물에 또 만족했지만, 또 다른 추가사항을 요구했습니다. 이 자동차들이 다른 종류의 엔진을 탑재했으면 한다고 합니다. 예를 들어 석유 엔진과 전기 엔진으로요. 다시 한번 상속을 사용해서 문제를 해결해보겠습니다!</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 562px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACUUlEQVQoz6VSS2sTURSeJhXbjVECYrXQ1C5cZNOdIiio1F1EEFy70aJVpOBGhFr9AW7agiBBMAYj2DTapHnPjJn3TCaZmbwzySSTZJz0IYIiZlG9zqRuWrLzwOXc+z0O595zIWhAvPywNGTmcM5vFzT+DSUT74zlEzq8O5xbPWZyS74XQ4O8EF6H+5lsIhCtEFYddCwAAKuJ0Ro6nvsiAapCArpKAUkTeqyOnjQ5U6ODtoWu41ZKRf7VSu4vejCmzztH55/POaP5jxNhcc3xcPGu88z01MggLVZL7t8g5chRvsNcTYpRF15BXakKfHnm+qXhg8b7T2YPYVXkClpIurAS4jI8M3A5fMTkUrUEBLEqYTEPRA29oO9qoLRdBO1eC0h6tgfLoX43SDFmwWXEsmeK2SRd2FW+10FhMw9avSYg6+hZk2OauMXssP+4ua/pE2mVebROBJ4mstEFscvfTm9hwyueZYjtYBCtpvo6uo0eljYzd+KZ6ELg8+oi32LnpR3u+N5tE4MH9V8Rq/ptsBwc9ybdkykl4oiVAjasGbMbQ5jywu6J/E967D3pHvHzntHiL27ME3/liEhrp5FayE5pSRu/jTvcwZVJWodPoWrQBglaxlfaKoIoE/nd+KEAqZt9zKucR+yIIMHHgfytAkQ9czPT5m6Vd0p9rNDNg2yHf80o5DNJEwEiwH/EtgAYhfJC6Rb9gGvQ60QFe2vkCNcir3EqdY+WiRBZxb2sQm1wLeocq5IXDcOGiTF1MmT4ZukGdoOS8bDx6U3sE9Mg5v4CEGx46+zImFIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with even more inheritance"\n        title=""\n        src="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png"\n        srcset="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-8c8bd.png 198w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-e07aa.png 395w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png 562w"\n        sizes="(max-width: 562px) 100vw, 562px"\n      />\n    </span>\n  </span>\n  </p>\n<p>여러분의 고객은 \'지금은\' 아주 행복합니다. 하지만 또 세분화를 요구한다면 어떻게 될까요? 전용차라던가, 경찰차라던가, 소방트럭이나 앰뷸런스 등 이보다 더 많은 세분화를 요구한다면? 우리의 상속 트리는 점점 커지고 복잡해지게 됩니다. 반복되는 코드를 줄이는 대신에 결국 같은 로직을 여러군데 복사-붙여넣기 하게 될 것입니다. 심지어 <a href="https://en.wikipedia.org/wiki/Combinatorial_explosion">위키피디아에도</a> 이 현상이 기재되어 있습니다.</p>\n<p>위에서 말씀드린 사례는 제가 가볍게 지어낸 경우가 아닙니다. 저는 전문 개발자로 일하면서 오래된 코드에 새로운 기능이나 행동을 추가하려 할 때마다 이런 상황을 여러 번 접했습니다. 특히 여러분이 레일즈를 사용하면서 더 자주 접하실\n수 있습니다. <code class="language-text">ApplicationRecord</code> 나 <code class="language-text">ApplicationController</code> 를 상속하도록 강제하는 경우가 많기 때문입니다.</p>\n<p>상속이 발생하는 코드를 예로 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Truck</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 코드를 더 낫게 만들 수 있을까요? 가능합니다.</p>\n<h2 id="아마도-믹스인mixin을-쓰면"><a href="#%EC%95%84%EB%A7%88%EB%8F%84-%EB%AF%B9%EC%8A%A4%EC%9D%B8mixin%EC%9D%84-%EC%93%B0%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>아마도 믹스인(Mixin)을 쓰면?</h2>\n<p>수 많은 루비 프로그래머들이 상속이 문제를 해결할 수 없다고 깨닫는 순간, 가장 먼저 떠오르는 해결책은 믹스인일 겁니다. 믹스인이 뭘까요? 기본적으로 메서드들이 정의된 모듈을 클래스에 포함하여 그 클래스의 일부로 사용하는 기법입니다. 우리는 간단히 공통된 로직을 추출하여 코드의 재사용을 피할 수 있습니다. </p>\n<p>믹스인을 사용하면 코드가 어떻게 바뀔까요? 먼저 <code class="language-text">include</code> 하게 될 모듈을 만들겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 믹스인할 대상이 되는 클래스를 만듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">PetrolCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>좀 보기 좋습니다. 코드가 반복되지도 않았고, 새로운 종류의 특성을 넣어서 어떤 종류의 차량이라도 만들어낼 수 있게 되었습니다. 게다가 차량이 어떤 기능을 가지고 있는지도 눈에 잘 들어옵니다.</p>\n<p>하지만 여전히 문제가 남아있습니다. 클래스를 살펴보면 포함된 행동들이 어떻게 사용되는지 명확하지 않습니다. 믹스인으로 새로운 메서드들이 추가되었지만 이 메서드들이 무엇을 하는지, 클래스가 어떻게 메서드와 영향을 주고받는지, 실행되는 과정은 어떻게 되는지 바로 파악할 수 없습니다. 만에 하나 같은 이름을 가지고 있는 두 모듈을 가져와 사용한다면 문제가 발생하게 됩니다. 한 모듈이 다른 모듈에 있는 메서드를 \'조용히\' 가져와서 사용하게 되겠지요. 상속 할 클래스가 늘어나면서 생기는 문제와 비슷한 방식으로 코드가 엉망이 되기 시작합니다.</p>\n<p>믹스인은 확실히 좋은 사용처가 있기 때문에 그렇게 나쁜 방법은 아닙니다. 제 의견으로는 로깅, 인증, 유효성 검사 등 클래스의\n메타행위(meta behavior)를 정의할 때는 아주 잘 동작한다고 생각합니다. 믹스인은 코드를 깔끔하고 작은 규모로 유지할 수 있다는 명확한 장점이 있습니다. 여러분이 모듈에 정의되어 있는 구현을 믿고 있고, 서로 다른 로직을 무너뜨리지 않는 지점을 파악하고 있는 한 괜찮습니다. 기억하셔야 할 점은 이는 단지 <strong>루비가 은연중에 다중 상속을 구현하는 방법</strong>에 불과하다는 점입니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">In OOP there’s this thing to prefer composition over inheritance. And in Ruby people constantly forget that modules == multiple inheritance</p>&mdash; Piotr Solnica (@_solnic_) <a href="https://twitter.com/_solnic_/status/623224611212251136">July 20, 2015</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>이 문제를 개선할 수 있을까요? Yes, we can!</p>\n<h2 id="조합"><a href="#%EC%A1%B0%ED%95%A9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조합</h2>\n<p>조합은 저도 오래전에 알고 있었지만 최근에야 사용하기 시작한 용어입니다. 단지 조합을 충분히 편하게 사용할만큼 좋다는 <em>느낌을 받지 못했습니다.</em> 그러던 어느 날 Sandi Metz의 <a href="https://www.youtube.com/watch?v=OMPfEXIlTVE">\'Nothing is Something\'</a> 이라는 아주 환상적인 발표를 보게 되었습니다. 다른 것 보다 그녀는 조합에 대해 이야기하면서 제가 예를 들었던 문제(교통 상황 시뮬레이터)를 풀어냈습니다.</p>\n<p>조합은 어떤 방식으로 동작할까요? 클래스 사이에 <strong>같은</strong> 행위를 공유하려 하기보다, 어떤 요소가 <strong>다른</strong>지 알아낸 뒤에 이름을 붙이고, 개별 클래스로 추출해낸 뒤에 마지막에 하나의 객체로 합치는 방식으로  동작하게 됩니다.</p>\n<p>상속이 \'-이다(is-a)\' 관계를 나타낸다면 조합은 \'-를 가지고 있다(has-a)\' 관계를 나타냅니다. 그러므로 조합을 활용하기 위해서 문제의 구조를 바꾸어야 합니다. 우리의 차량은 더 이상 전기자동차가 아니라, 전기 엔진을 가진 자동차 입니다(Our vehicle <strong>is not</strong> an electric vehicle anymore but rather it <strong>has</strong> an electric engine). 트럭은 그냥 트럭이 아니고 자동차가 트럭의 몸체를 가진 것입니다(It <strong>is not</strong> a truck but it <strong>has</strong> a truck body). 이렇게 우리는 두 가지 개념을 잡아냈습니다. 바로 <strong>엔진</strong> 과 <strong>몸체</strong> 입니다.</p>\n<p>우리의 애플리케이션은 이제 아래와 같은 모습이 되었습니다. 엔진과 몸체 컨셉을 구현한 뒤에 <code class="language-text">Vehicle</code> 클래스 안에 엔진과 몸체가 들어갈 자리를 마련했습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 373px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 76.67560321715818%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADhElEQVQ4y5WU34sbVRTHJ10CEfwPBNEHX8UX8UVsUV9EQQVXiw9aLOiT0LqwYhfUsrD1qSLaBREfLNqyKD5I3UXbJrv5NZlkJpP5sROT+T2ZH8nm90w26e4kc7x3dIW+CL1w+N5zBj5z7nfOXIJ4gAUAsVaUybLchdVmFy7IPbiI9hfq3uLjDN9/mrhOfrV0o3ztoZ+oa6kt5tsUHdxJ1e7tpu5av6R+JL9J3Sxvpm6UN9Hz75ZOwFUt4OrOEdCNXhyVv7rQngGU5ck6UdJz51ibtmtOla/ZjFTWShKlkhJtliVUwyGiul7QMq+dAGv69FdK6oxytVYry1puuqK2qvLQLzWCDwnaolY7URsavQbIgyak2TTskNuQFbKgjVVo9hvgHNlAGYXzGHZ+42wiX/c/EF24iuKK6MEXUgc2uNbiy+2yd4aoWORHxqEOYps/Er3aXPBqC8HFwS5wjurHyrCJgPl3T3wsiO09UnQgX7PCXVpb7FX1Y8EIgJKDVdzhijnVQbBb4b4ziCRvAPX2CCR3AKI9iHjbmKu+jDs8h4HLCEhKPYpVx1DgHaDqXcjQGoitGRTr4zWCaVErxqGKAKOw4UJ0m5Th910RcqwDygFEgt2Zq2PcYTEGfr+9eaqszp5SR/C8MoDTzT6cQfvTch9e+JM5eDTu0DhEb7DbYd2dRqzWBVpuA2+iTlEu2DbqEAML8ZH3O/zS/84WbZVWrKkBgseHvMtFSCEOlwecix4/18bKfx6KHXbp4eeuLD22/EPyxbVK8qXLXPKJt28mU89uJB9/ffNUDIw9dNQQdRPtew40ugeAFfkaCY58n4fEI0SC1afXRWumsJrPs6ovCuaUk5xjPS8N3yMY6x8PRbsfotNGBd6NbmX4iFX8SI09bN/nIV6SG0rDBUBRcCBbNdBwdwGvUsO/jD/KReyRaPdmcgdCTvfDHBoHrDgXbO9ec1DHwHcw7OXPzibKcrAuWEe/ccZsC+nPNWO6xZmzW7tC/1WiYpJrIxiAOjZAnzhgTT00yF0wkeqBA1pgQg8OAP1R72PgK2tvJaim/zWt+EVGDe6WG6MMrQR3kA1Umuu9SeTV9DMIus60yE/oVvESbRUuVcx8rAzOcd0qfZ6Vbz95cuS6O5ecCQDT7OHhRmECSoHRZp8SD3bbmIl/b5urvDXbY1R/h9UmfzDKeIczDnNZcfjG37JmJTRNQVyIAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Composition in action"\n        title=""\n        src="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png"\n        srcset="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-c12ac.png 198w,\n/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png 373w"\n        sizes="(max-width: 373px) 100vw, 373px"\n      />\n    </span>\n  </span>\n  </p>\n<p>실제 코드는 어떻게 될까요? 핵심 클래스부터 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span><span class="token punctuation">)</span>\n    <span class="token variable">@engine</span> <span class="token operator">=</span> engine\n    <span class="token variable">@body</span> <span class="token operator">=</span> body\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> run\n    <span class="token variable">@engine</span><span class="token punctuation">.</span>refill\n    <span class="token variable">@body</span><span class="token punctuation">.</span>load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이제 우리는 컨셉에 맞는 구현을 한 뒤에 <code class="language-text">Vehicle</code> 객체에 주입하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TruckBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">CarBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>마지막으로 모두 한 곳에 넣으면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">petrol_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\npetrol_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>이 접근방식은 많은 이점이 있습니다. <code class="language-text">Vehicle</code> 클래스가 외부 로직을 사용하는 방식은 첫 눈에 명확하게 들어옵니다. 이름이 꼬이는 문제도 없습니다. 각각의 클래스는 정확히 한 가지 일을 하고 있습니다(<a href="https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9D%BC_%EC%B1%85%EC%9E%84_%EC%9B%90%EC%B9%99">단일 책임 원칙</a>을 만족합니다). 그래서 이 클래스들이 자신에게 주어진 일을 얼마나 제대로 하는지 확인하는 테스트를 쉽게 할 수 있습니다.</p>\n<p>우리는 높은 응집력(관련있는 로직을 같이 두는 것)을 달성하면서 동시에 결합도(클래스의 의존성을 낮게 만드는 것)는 낮추었습니다. 이제 인터페이스 전체를 바꾸지 않는 한, 고객의 요구에 걱정하지 않고 코드에 사용되는 엔진이나 몸체를 바꿀 수 있습니다.</p>\n<p>조합 기법에도 문제점이 있을까요? 물론 있습니다. 이 방식은 코드를 더 길게 쓰도록 합니다. 특히 모든 의존성들을 최종 객체에 주입하게 될 때 눈에 띄게 길어집니다. 여러분은 추가적인 보일러플레이트(여기서는 코드를 생산해내는 템플릿 함수)를 만들어서 참조 위치를 저장하고, 어디에 위임을 할지 설정하며 정확한 실행 흐름을 제어할 수 있도록 만들어야 합니다. 문제의 처방전으로 여러분은 여러 가지 <a href="https://en.wikipedia.org/wiki/Creational_pattern">제작 패턴</a>을 활용할 수 있습니다. 팩토리(Factory)나 빌더(Builder) 처럼요.</p>\n<p>제가 조합을 활용하려고 할 때 제일 어려웠던 점은 제 사고 방식을 조합을 응용하기에 알맞는 방식으로 고치는 것이었습니다. 예상밖으로 <strong>Go</strong> 언어를 가지고 놀 때 많은 도움을 받았습니다. 이 프로그래밍 언어는 상속을 받지 않도록 설계되어 있지만 객체지향 방식으로 코드를 작성할 수 있게 되어있습니다. 또한 프로그래머들에게 조합을 사용하도록 권장하는 기능들이 담겨있습니다. (역주: <a href="http://hackthology.com/object-oriented-inheritance-in-go.html">이 글</a>이 Go 언어에서 조합을 사용하는 예를 보여주는 좋은 글로 보입니다) 제가 Go를 조금 가지고 놀다가 갑자기 조합을 사용하는데 훨씬 익숙해졌다는 사실을 깨달았습니다. 다음 포스팅에 이 이야기를 자세히 쓰고자 합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 여러분께 코드를 구축하는 세 가지 다른 접근 방식을 보여드렸습니다. 상속, 믹스인, 조합 말씀입니다. <strong>상속</strong>은 많은 프로그래머들의 첫 번째 선택지이지만, 저에게는 심하게 과용되고 코드를 복잡하게 만드는데다 유지보수도 힘들게 만들었습니다. <strong>믹스인</strong>은 더 똑똑하고 강력한 대체제로 보이지만 사실은 다중 상속의 한 방법에 불과하고 코드의 복잡도를 늘릴 수도 있습니다. <strong>조합</strong>은 코드 양은 제일 길어지겠지만 클래스 사이에 의존성을 관리하는데 가장 직관적이며 깔끔한 접근방식을 가지고 있습니다. 조합은 코드를 작고 분리된 조각으로 유지하며 테스트하기도 쉽습니다. 그래서 제가 가장 선호하는 방법입니다.</p>\n<p>객체 지향 프로그래밍은 일부 프로그래머들이 다른 프로그래머들이 처한 문제를 조금 더 쉽게 해결하도록 돕고자 만든 하나의 협약에 지나지 않는다는 점을 잊으시면 안됩니다. 규약에 얽매이지 마세요. 여러분이 처한 상황에 가장 잘 맞는 해결책을 선택하세요.</p>\n<p>그리고 마지막으로, 이 말을 새겨두시기 바랍니다.</p>\n<blockquote>\n<p>객체 지향 소프트웨어를 설계하는 일은 어렵다. 그리고 재사용 가능한 객체 지향 소프트웨어를 설계하는 일은 훨씬 더 어렵다. - Gang of Four</p>\n</blockquote>\n<p>이 말을 경험을 통해 알게 되실 겁니다.</p>\n<h2 id="원문의-참고-자료"><a href="#%EC%9B%90%EB%AC%B8%EC%9D%98-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>원문의 참고 자료</h2>\n<ul>\n<li>RailsConf 2015 - Nothing is Something</li>\n<li><a href="https://learnrubythehardway.org/book/ex44.html">https://learnrubythehardway.org/book/ex44.html</a></li>\n<li><a href="https://robots.thoughtbot.com/reusable-oo-inheritance">https://robots.thoughtbot.com/reusable-oo-inheritance</a></li>\n<li><a href="https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose">https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose</a></li>\n</ul>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>어느정도 일상과 공부와 번역 등의 밸런스가 틀이 잡혀가면서 한달에 한 개 정도 포스팅하는 방향으로 굳어지고 있나봅니다. 적어도 한달에 두어개는 작성하고 싶은데.. 좋은 글은 매일 탐독하고 있지만 제대로 써먹지 못하면서 알려봤자 뭐가 좋나? 라는 생각이 들 때도 있습니다.</p>\n<p>이전에 의존성 주입에 관한 글을 번역했을 때도 그렇지만 조합 패턴은 루비를 사용하면서, 혹은 자바스크립트를 사용하면서도 아주 중요한 패턴 중 하나라고 생각합니다. 반드시 자유자재로 다루고 싶은 패턴이긴 한데 \'평범하게\' 레일즈를 사용하게 되면 아마 쉽게 익숙해지긴 힘든 패턴이라 생각합니다. 그래서 개인적으로 루비로 API 백엔드를 구축하는 토이 프로젝트를 하시게 된다면 하나미(hanamirb)를 이용해서 만들어보시는걸 강력하게 권장하고 싶습니다. 레일즈는 구조 특성상 이런 형태의 조합을 사용하기 쉽지 않다고 생각하기 때문입니다. (<code class="language-text">ActiveSupport::Concern</code>, <code class="language-text">Single Inheritance Table</code> 등)</p>\n<p>자바스크립트에서 조합을 사용하는 것을 권장하는 글도 최근에 읽고 큰 감명을 받았는데, 한번 살펴보시길 권하면서 링크를 남깁니다.</p>\n<ul>\n<li><a href="https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0">https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0</a></li>\n<li><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3">https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-07-16-how-to-avoid-inheritance-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-07-16",path:"/posts/how-to-avoid-inheritance-in-ruby-kor",title:"[번역] 루비에서 상속을 피하는 방법",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"이 글의 원문은  Yegor Bugayenko가 작성하였습니다. 오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다. 코드 평가 (다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development…",html:'<ul>\n<li>이 글의 원문은 <a href="http://www.yegor256.com/2015/02/09/serious-code-reviewer.html">Yegor Bugayenko가 작성하였습니다.</a></li>\n<li>오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p><a href="http://en.wikipedia.org/wiki/Code_review">코드 평가</a>(다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development 브랜치에 우연찮은 실수가 <a href="http://www.yegor256.com/2014/07/21/read-only-master-branch.html">덮어씌워지지 않도록</a> 하고, 어떤 팀은 머지가 된 후에 버그나 어긋나는 점을 발견하기 위해 코드의 작성자와 <a href="http://www.yegor256.com/2014/12/18/independent-technical-reviews.html">일반적인 평가</a>를 합니다. 어떤 팀은 둘 다 하기도 합니다. 코드 평가는 평가자가 소프트웨어 전체 소스의 접근 권한을 가지고 결점을 찾아내는 <a href="https://ko.wikipedia.org/wiki/%ED%99%94%EC%9D%B4%ED%8A%B8%EB%B0%95%EC%8A%A4_%EA%B2%80%EC%82%AC">화이트박스 평가</a> 기술과 아주 유사합니다. 어느 경우든 코드 평가는 퀄리티 향상 및 팀의 동기 부여를 위한 좋은 도구가 됩니다.</p>\n<p>하지만 코드 평가를 제대로 하기는 어렵습니다. 오히려 잘못 하기가 훨씬 쉽다고 말씀드리고 싶습니다. 제가 여태까지 본 바로는 대부분의 코드 평가와 평가자는 비슷한 실수를 반복해왔습니다. 그래서 제가 알고 있는 좋은 코드 평가자들이 가지고 있는 네 가지 기본 원칙을 정리하는 글을 작성하게 되었습니다. 이 글이 도움이 되길 바랍니다.</p>\n<h2 id="두려움을-가지지-않기no-fear"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EC%A7%80-%EC%95%8A%EA%B8%B0no-fear" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지지 않기(No Fear)</h2>\n<p>진짜배기 코드 평가자라면 갖지 말아야 할 몇 가지 두려움이 있습니다. 첫 번째이자 가장 유명한 두려움은 코드의 작성자를 공격하는 일입니다. <em>"오늘은 그냥 눈을 감고 저 버그를 못 본척 하면 내일 작성자는 내 실수(버그를 못 봄)를 알아차리지 못할거야."</em> - 이런 태도가 만들어내는 두려움입니다. 말할 필요도 없겠지만 이는 비생산적이고 코드 퀄리티와 팀의 사기를 낮추는 일입니다. 조언을 드리자면 직설적이고, 솔직하고, 간결하게 이야기하세요. 당신이 이 코드가 맘에 들지 않는다면 말 그대로 맘에 들지 않는겁니다. 당신의 의견이 코드의 작성자에게 어떻게 받아들여질지 신경쓸 필요가 없습니다.</p>\n<p>만약 당신이 동료를 향해 신경쓰이는 기분이 든다면 회사 혹은 팀의 경영 측면에서 문제가 있는 겁니다. 되려 못하는 사람에게 "팀 플레이어가 아니다" 라는 낙인찍힐까봐 두려워하고 있는 겁니다. 평가를 해야 하는 사람은 프로젝트 스폰서입니다. 스폰서는 당신이 제품의 질을 신경쓰지 않는 다른사람을 불쾌하게 한다고 얼마나 개선이 될 지 신경쓰지 않습니다. 그저 제품을 생산하여 사용자들로부터 돈을 벌어오길 원합니다. 스폰서는 당신이 <a href="http://www.yegor256.com/2015/10/06/how-to-be-good-office-slave.html">회사에서</a> 친구를 사귀라고 급여를 주는 게 아닙니다.</p>\n<p>다른 종류의 두려움은 이런 식으로 나타납니다. <em>"내가 이 코드를 거부하면 제품 발매(release)가 늦어질거야."</em> - 다시 한 번, 이런 태도는 프로젝트 전체에 커다란 해가 된다는 말씀을 드리고 싶습니다. 당신은 코드에서 마음에 들지 않는 부분을 눈 감고 외면한 뒤에 승인을 합니다. 코드는 다음 배포판에 포함될 예정이고 더 빨리 출시할 수 있게 되었습니다. 발매를 늦추는 병목현상도 없었으며 아무도 당신에게 \'저 지멋대로인 코드 평가자 때문에 발매가 늦춰지고 돈을 덜 벌게 되었다\' 는 말을 하지 않습니다. 당신은 좋은 팀 플레이어입니다. 그럴까요? 그럴리가요!</p>\n<p>지난 번 <a href="http://www.yegor256.com/2015/01/15/how-to-cut-corners.html">제가 언급했듯이</a>, 전문적인 팀 플레이어는 자신의 역할이 다른 사람 뒤를 봐주는 일이 아니라는 것을 알고 있습니다. <a href="http://www.yegor256.com/2015/11/24/imprisonment-for-irresponsible-coding.html">나쁜 코드</a>를 거부하여 발매가 늦어진다면, 이는 코드 작성자의 잘못입니다. 전문가로서 당신의 책임은 이런 결점을 찾아내는 것입니다. 이렇게 팀의 학습과 발전을 위해 도움을 주어야 합니다.</p>\n<p>저는 팀의 학습과 성장을 위해서 가장 먼저 해야할 일이 나쁜 프로그래머를 없애고 좋은 프로그래머를 끌어올리는 것이라 생각합니다. 솔직하고 두려움 없는 코드 평가자들은 팀의 학습과 성장을 돕습니다.</p>\n<p>또 이런 두려움도 있습니다. <em>"내가 잘못 본거라면 다른 사람들에게 놀림받을 거야"</em> - 더 심하면 다른 사람들이 당신이 부족한 지식을 가지고 있다고 지적할 수도 있고, 당신이 \'내가 대체 뭘 하고 있는지 모르겠다\' 는 표정을 짓고 있는 모습을 볼 수도 있습니다. 그렇다면 그냥 조용히 앉아서 버그를 못본 척 할 수도 있습니다. 최소한 멍청한 코멘트를 달았다고 당황하진 않을 테니까요. 당신은 더 똑똑해 보이기 위해 입을 다무는게 낫겠지요. 그렇겠지요? 틀렸다니까요!</p>\n<p>프로젝트(스폰서)는 괜찮은 모습을 보이라고 급여를 주는 게 아닙니다. 당신은 팀원에게 사랑받기 때문에 급여를 받는 게 아니라 매일 제품을 만들기 위해 급여를 받는 겁니다. 전문가로서 당신의 책임은 프로젝트를 위해 최선을 다하고, 그러기 위해 모두의 의견을 무시할 수도 있어야 합니다. 상급자의 의견도 포함해서요. <a href="http://www.yegor256.com/2015/01/26/happy-boss-false-objective.html">"행복한 상급자(대표) 만들기는 잘못된 목표다"</a> 라는 글의 내용과 비슷하게, \'팀에서 존경받는 사람 되기\'는 잘못된 목표라는 말씀을 드리고 싶습니다. 존경을 구걸하는 대신 깔끔한 코드를 짜면 자연스레 존경받게 됩니다.</p>\n<p>다시 한번 말씀드리자면 다른 사람의 코드에 잘못되거나 멍청한 코멘트를 달았다고 당황하게 되는 일을 두려워하지 마십시오. 다른 사람이 당신에게 가지고 있는 기대를 위하지 말고 프로젝트를 위해 최선을 다하십시오. 팀원들은 당신이 똑똑하고 총명하게 보이길 바랄 수 있겠지만, 프로젝트는 당신이 이 코드를 어떻게 생각하는지 말해주길 바랍니다. 그러니까 그런 사람들의 의견은 무시하세요. 당신이 올바르다고 생각하는 일을 하세요.</p>\n<h2 id="타협하지-않기no-compomise"><a href="#%ED%83%80%ED%98%91%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-compomise" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>타협하지 않기(No Compomise)</h2>\n<p>자, 당신은 두려움 없이 특정 코드에 대한 생각을 말하고 거부하였습니다. 당신이 평가하고 있던 브랜치는 좋지 않았고 그 이유도 설명했습니다. 그리고 작성자에게 이 부분은 고치고(Refactor) 저 부분은 다시 쓰라고 지시하였습니다. 그 다음은요?</p>\n<p>그/그녀는 당신과 거래를 하려고 할 겁니다. 이는 자연스러운 현상이고 저희 팀에서 제가 살펴보는 대부분의 브랜치에서 일어납니다. 코드의 작성자도 마찬가지로 전문 개발자이며 마찬가지로 두려움이 없습니다. 그래서 자신의 구현 방법이 옳았고 당신의 생각이 틀렸다고 주정합니다. 전문적인 코드 평가자라면 이 경우에 어떻게 해야할까요?</p>\n<p>가장 최악의 갈등 해결 방법은 \'\'타협하기\'\' 입니다. 나쁜 코드를 작성하는 것 보다 더 빠르게 제품의 질을 망치는 길입니다. 타협은 갈등 해결을 위해 양측이 원하는 것을 갖지 않기로(혹은 하지 않기로) 합의하는 방식의 갈등 조절 기술입니다. 다른 말로 표현하자면 <em>"우리 그만 싸우고 평화롭게 지내자"</em> 인데, 문제 해결 측면에서 최악의 방식입니다.</p>\n<p>좋지도 않은 타협을 하기보다, 전문가로서 코드 자체를 위해 실천할 수 있는 세 가지 방법이 있습니다.</p>\n<ul>\n<li><em>"당신 말이 맞아요, 제 생각을 철회합니다."</em>: 보통 이런 일이 자주 일어납니다. 당신은 자신의 실수를 인정할 준비가 되어있어야 합니다. 코드가 맘에 들지 않았지만 코드의 작성자가 이 코드를 적용할 때 생기는 이익을 설명하였고 당신은 그 로직을 받아들인 겁니다. 절대로 \'싸우기 싫어서\' 가 아니라 진정 로직을 이해하고 받아들이는 겁니다. 기꺼이 \'내가 틀렸습니다.\' 라고 말하는 것은 성숙하고 진지한 개발자의 첫 번째 덕목입니다.</li>\n<li><em>"난 절대 영원히 인정할 수 없어!"</em>: 어떤 코드는 이럴 수도 있는데, 이렇게 갈등을 해결하는 방법이 잘못된 것은 아닙니다. 상대방은 이 상황을 받아들이고 전부 다시 작성하게 되겠지요. 그리고 새로운 것도 배울 수 있을겁니다.</li>\n<li><em>"설계자가 뭐라고 하는지 들어보자!"</em>: 모든 프로젝트에는 최종적인 결정을 내리는 <a href="http://www.yegor256.com/2014/10/12/who-is-software-architect.html">소프트웨어 설계자</a>가 있습니다. 이 사람에게 말하고 최종적인 결정을 내려달라고 부탁해 보세요. 토론이 벌어지고 있는 상황에서 설계자를 대려온 다음 한쪽 편을 들어달라고 이야기하는 겁니다. 그 사람이 당신이 잘못되었다고 이야기한다면 그 결정을 받아들이고, 이번 경험에서 새로이 무언가를 배우도록 노력해보세요.</li>\n</ul>\n<p>이와 같이 당신의 의견을 고수하며 싸우거나 잘못되었음을 인정하세요. 한 쪽을 고르되 절대 타협하지 마십시오!</p>\n<p>제 말을 잘못 받아들이지 마시길 바랍니다. 고집불통이 되라거나 나쁜 패를 죽어도 놓지 않는(holding your cards no matter how bad they are) 사람이 되라는 이야기가 아닙니다. 유연하게 생각하고 배울 점은 배우세요. 당신의 입장은 협의를 하면서 얼마든지 변할 수 있습니다만, 맘에 들지 않는 어떤 것이라도 받아들이면 안됩니다. 당신은 상대가 옳았음을 완전히 받아들이거나 (아니면 그 반대), 설계자가 \'이렇게 해라\' 라고 말했을 때만 갈등에서 빠져나올 수 있습니다. 중간 지점은 없습니다.</p>\n<h2 id="개소리하지-않기no-bullshit"><a href="#%EA%B0%9C%EC%86%8C%EB%A6%AC%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-bullshit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>개소리하지 않기(No Bullshit)</h2>\n<p>이제 당신은 특정 메서드가 다르게 디자인 되어야한다고 고민없이 지적했습니다. 코드의 작성자는 그렇게 생각하지 않는다고 답변했지요. 그 코드를 다시 살펴보고 나서 자신의 주장을 굽히지 말아야겠다고 생각했다 칩시다. 당신은 여전히 자신이 옳다고 생각하고 타협할 생각도 없습니다. 이제 어떡할까요? 설계자를 부르기에 너무 이르기 때문에 상대방을 설득해보기로 했습니다.</p>\n<p>대부분의 경우 설득하는 일은 가르치는 일입니다. 당신은 상대방이 모르는 것을 알고 있기 때문에 그 메서드가 맘에 안든다고 생각했을 겁니다. 그 사람은 추가적인 교육이 필요한 상태이구요. 이제 동료를 가르칠 수 있는 기회가 왔습니다. 효과적인 가르침을 위해선 증거가 필요합니다. 당신은 자신의 논리를 단단히 하여 상대방이 이해하고 받아들일 수 있도록 해야합니다.</p>\n<p>링크나 기사, 책, 보고서, 예시 등을 준비하세요. <em>"나는 자바를 15년이나 써 왔으니 이걸 알고 있다"</em> 같은 소리는 도움이 되지 않습니다. 게다가 이런 방식의 논쟁은 당신의 설득력을 떨어뜨릴 뿐입니다.</p>\n<p>만약 설득하기 위한 증거가 충분하지 않다면 다시 생각해보세요. 당신이 틀렸을 수도 있습니다.</p>\n<p>그리고 당신이 하는 일은 평가하고 있는 코드가 잘못되었음을 증명하는 겁니다. 코드의 작성자는 아무것도 증명할 필요가 없습니다. 그/그녀의 코드는 기본적으로 훌륭하겠지요. 평가자는 어떻게, 왜 이 코드가 잘못된 경우인지 보여주어야 합니다. 다르게 말하자면 당신은 고소인이고 상대방은 피고소인이 되겠지요. 그 반대는 성립하지 않습니다(Not the other way around).</p>\n<h2 id="모욕하지-않기no-offense"><a href="#%EB%AA%A8%EC%9A%95%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-offense" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모욕하지 않기(No Offense)</h2>\n<p>제일 마지막이자 제일 어려운 원칙을 알려드리겠습니다. 아무리 코드가 형편 없고 코드의 작성자가 고집불통이라도 전문가의 태도를 유지하세요. 솔직히 말씀드리자면 때로는 저도 이렇게 하기 아주 어렵다고 생각합니다. <a href="http://www.teamed.io/">teamd.io는</a> 광범위한 팀으로 작업을 하고 있고 매주 몇 명의 새로운 사람들을 고용합니다. 그들 중 일부는 <a href="http://www.yegor256.com/2014/10/29/how-much-do-you-cost.html">우리의 심사 기준</a>에도 불구하고 다소 어리석게 대처하는 것 처럼 보입니다.</p>\n<p>약 1년 전에, 새로 온 개발자가 이미 있는 자바 라이브러리에 작지만 새로운 기능(약 20~30줄 짜리 코드)을 추가해야 했습니다. 저는 그 때 웃긴 일을 겪었습니다. 그는 수백줄 짜리 코드를 작성한 뒤에 저에게 풀 리퀘스트를 보냈습니다(제가 코드 평가자였습니다). 그 코드는 완전 쓰레기였으며 심지어 그 사람이 작성한 것도 아니었습니다. 저는 보자마자 이 사람이 어딘가에서 찾아낸 코드를 복사했다는 사실을 간파했습니다. 그런데 제가 어떻게 했을까요? 어떻게 \'당신의 태도는 전문적인 개발자로서 용납될 수 없다\' 며 길길이 날뛰지 않고 이 코드를 거부할 수 있었을까요? 저는 시간을 좀 내서 객관적으로 그의 코드를 비판했습니다. 스타일, 디자인 등 수많은 진지한 코멘트를 달아서 그에게 전부 고치라고 말했고, 그 사람은 쓰레기를 전부 지운 뒤에 바닥부터 다시 코드를 작성했습니다. 그 작업 이후에 그 사람을 다시 보는 일은 없었습니다.</p>\n<p>제가 말씀드리고 싶은 것은 전문가를 다룰 때는 전문가다운 생각을 하기 쉽지만 <em>(역주: 제대로된 코드를 보면 사람답게 대화할 수 있다는 뜻으로 보입니다)</em>, 언제나 다른 경우를 접할 수도 있습니다. 하지만 아무리 당신이 보고 있는 코드가 형편없더라도 참을성을 가지고 설득력 있게 대하십시오.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>정말 오랜만에 새 번역을 하게 되었습니다. 진작에 한번 읽어놓고 \'다음에 번역할 글은 너로 정했다!\' 라고 생각해놓고 모셔두었지만 어느새 시간이.. 바쁘다는 핑계는 댈 것도 없으며 제 자신의 게으름을 탓하게 됩니다.</p>\n<p>코드 리뷰(코드 평가)를 할 때 다른 분들은 어떻게 하는지 모르겠지만 여러 가지 이야기가 오가게 될 겁니다. 그 와중에 타협을 하는 경우도 적지 않게 많이 있을 테고, 아예 코드 리뷰 자체를 안하는 팀이 있을지도 모르겠네요. 타협과 관한 부분에서 특히 느낀 점이 많았습니다.</p>\n<p>아무쪼록 팀 단위로 작업을 하실 때 더 좋은 결과물을 만드는데 도움이 될 수 있기를 바랍니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-05-27-four-nos-of-serious-code-reviewer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-05-27",path:"/posts/four-nos-of-serious-code-reviewer-kor",title:"[번역] 진짜배기 코드 평가자라면 하지 말아야 할 네 가지",tags:["Programming","Code Review","Translation"],category:"Translation"}},{excerpt:"이 글의 원문은  Simone Carletti가 작성하였습니다. 오역 지적 및 피드백은 더 나은 번역을 위한 밑거름이 됩니다. 저는 제 자신을 활발한  StackOverflow  사용자라고 생각합니다. 사이트 활동이 하루의 업무량에 크게 좌지우지되긴 하지만요. 2009년에 StackOverflow에 가입하여 이 글을 쓰는 시점(2016년 12월)까지,  저는 12만 4천의 명성치를 얻었고  상위 30…",html:'<ul>\n<li><strong>이 글의 원문은 <a href="https://simonecarletti.com/blog/2016/12/how-i-use-stackoverflow/">Simone Carletti가 작성하였습니다.</a></strong></li>\n<li><strong>오역 지적 및 피드백은 더 나은 번역을 위한 밑거름이 됩니다.</strong></li>\n</ul>\n<hr>\n<p>저는 제 자신을 활발한 <a href="https://stackoverflow.com/">StackOverflow</a> 사용자라고 생각합니다. 사이트 활동이 하루의 업무량에 크게 좌지우지되긴 하지만요. 2009년에 StackOverflow에 가입하여 이 글을 쓰는 시점(2016년 12월)까지, <a href="https://stackoverflow.com/users/123527/simone-carletti">저는 12만 4천의 명성치를 얻었고</a> 상위 300명의 사용자 랭킹에 올랐습니다.</p>\n<p>가끔씩 다른 프로그래머들이 <em>어떻게 이렇게 활발히 활동할 수 있나요?</em> 혹은 <em>정말 StackOverflow가 좋은건가요 아니면 그냥 눈에 띄고 싶어서 그러는건가요?</em>, <em>하루에 StackOverflow에서 얼마나 시간을 보내시나요?</em> 같은 질문을 하곤 합니다. 저는 이번 포스트를 통해 다양한 질문들을 모아 대답하고 <em>제가 StackOverflow를 어떻게 사용하는지</em> 설명해보고자 합니다.</p>\n<h2 id="정말-가치있는-일인가"><a href="#%EC%A0%95%EB%A7%90-%EA%B0%80%EC%B9%98%EC%9E%88%EB%8A%94-%EC%9D%BC%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정말 가치있는 일인가?</h2>\n<p>솔직히 말씀드리겠습니다. (거의) 모든 사람은 가치 없는 일에 매달리지 않습니다(nobody does something for nothing). 우리 모두는 어떤 행동이 가장 중요한지 기대치에 따라 결정을 내립니다.</p>\n<p>하지만 우리 모두 행동의 가치를 매기는 기준이 다릅니다. 어떤 사람은 돈을 받는게 유일한 보상이라고 여기기도 하고, 반대로 어떤 사람은 다른 이들의 눈에 띄거나 명성을 얻는게 돈을 버는 일보다 가치있다고 여깁니다. 특정인들에게 행복이란 단어는 부와 명예와 같은 의미이고, 나머지 사람들에게는 삶의 방식과 직접적으로 연관된 의미입니다.</p>\n<p>이 개념을 프로그래밍의 특정 주제에 적용할 수 있습니다. 바로 오픈 소스입니다. 저는 오픈 소스에 기여하는게 가치 없는 일이고, 그 이유가 <em>돈이 안되어서</em> 라고 말하는 사람들을 많이 보았습니다. 하지만 제게 <a href="https://github.com/weppos">오픈 소스에 기여</a>하는 이유를 물으신다면, 이 일이 저를 더 나은 프로그래머로 만들어주고 제 경력에 긍정적인 도움이 되기 때문이라고 대답할 겁니다. 제가 오늘 직업을 가지고 있는 이유 중 하나가 오픈 소스에 기여하기 때문이며, 뿐만 아니라 여지껏 대단한 사람들과 함께 놀라운 코딩 여정을 함께할 수 있는 기회도 얻었습니다.</p>\n<p>다시 StackOverflow 이야기로 돌아와서, 저는 StackOverflow 안에서 어떤 가치를 발견했기 때문에 참여하기 시작했습니다. 요즘 가입하는 대부분의 신규 사용자들과 달리, 저는 그 때 별다른 도움이 필요치 않았습니다. 사실 가입하고 몇달이 지나서야 처음 질문을 올릴 정도였으니까요.</p>\n<p>2009년에 저는 이미 꽤 쓸만한 개발자였습니다만, 제 활동의 대부분은 이탈리아 커뮤니티에 한정되어 있었습니다. 제가 StackOverflow에서 발견한 것은 바로 세계적인 커뮤니티 안에서 경험과 명성을 얻고, 눈에 띌 수 있는 기회였습니다.</p>\n<p>이렇게 제가 StackOverflow에 가입한 이유를 설명드렸습니다. 하지만 제가 7년이나 계속 답변들을 달게 된 이유는 더 있습니다.</p>\n<h2 id="끊임없는-두뇌-훈련"><a href="#%EB%81%8A%EC%9E%84%EC%97%86%EB%8A%94-%EB%91%90%EB%87%8C-%ED%9B%88%EB%A0%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>끊임없는 두뇌 훈련</h2>\n<p>제가 StackOverflow에 엄청난 양의 시간을 투자한 이유 중 단연 첫 번째는 끊임없는 두뇌 훈련을 위해서입니다.</p>\n<p>어떤 사람들은 두뇌 훈련을 위해 십자말풀이를 하거나, <a href="https://ko.wikipedia.org/wiki/%EC%8A%A4%EB%8F%84%EC%BF%A0">스도쿠</a>를 하기도 합니다. 개인적으로 저는 알고리즘, 데이터 마이닝, 프로그래밍 언어와 같이 각기 다른 분야에 걸쳐있는 작은 프로그래밍 문제들을 해결하면서 두뇌 훈련을 하는게 좋습니다.</p>\n<p>그래서 일반적으로 가능한 구현의 변수가 많거나 많은 양의 계층에 걸쳐진 문제같이(예를 들자면 Ruby on Rails와 관련된 질문인데 뷰, 컨트롤러, 데이터베이스의 코드가 다 담겨있는 경우) 큰 규모의 질문은 무시합니다. 대신 작고 잘 정의되어있는 질문은 10분 안에 충분히 답을 할 수 있어서 좋아합니다.</p>\n<h2 id="디버깅-기술-향상"><a href="#%EB%94%94%EB%B2%84%EA%B9%85-%EA%B8%B0%EC%88%A0-%ED%96%A5%EC%83%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>디버깅 기술 향상</h2>\n<p>적절하게 소프트웨어의 일부를 디버그하는 능력은 소프트웨어 엔지니어에게 아주 가치있는 기술 중 하나입니다.</p>\n<p>만약 자신의 코드를 디버깅하는게 힘들다면, 다른 사람의 코드를 디버깅하는 일은 더욱 힘들겁니다. 게다가 실제로 만날 수도 없는 상태이다보니, 의사소통이 훨씬 더 복잡해집니다. 여러분은 디버깅에 필요한 정보를 빨리 얻기 위해 최대한 적절한 질문을 떠올려야 합니다.</p>\n<p>StackOverflow의 질문들은 \'언제나 디버깅할 거리는 무수히 많다\'는 점을 보여줍니다. 시간을 들여 답변하기에 적절한 질문을 고르는 기술도 익히게 됩니다.</p>\n<p>때로는 제가 쓰지 않는 라이브러리나 제가 모르는 내용을 디버깅하는 질문에 뛰어들기도 합니다. 이를 통해 저는 <a href="https://simonecarletti.com/blog/2009/09/inside-ruby-on-rails-reading-StackOverflowurce-code/">계속 다른 사람의 코드를 읽는 훈련을 했습니다.</a> 웃긴 이야기를 하나 해 드리겠습니다. 제가 사용하고 있는 특정 라이브러리에 관한 해결책을 찾고 있을 때, 저는 제가 겪었던 문제와 정확히 똑같은 질문을 StackOverflow에서 찾았고 그 질문은 제대로 답변도 달려있었습니다. 별 이상한 점은 없었습니다. 그 답변을 달았던 사람이 저였다는걸 깨닫기 전까지는 말이죠! 비슷한 일이 몇번 있었습니다.</p>\n<h2 id="새로운-언어를-배우고-자신의-진도를-확인하기"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%96%B8%EC%96%B4%EB%A5%BC-%EB%B0%B0%EC%9A%B0%EA%B3%A0-%EC%9E%90%EC%8B%A0%EC%9D%98-%EC%A7%84%EB%8F%84%EB%A5%BC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 언어를 배우고 자신의 진도를 확인하기</h2>\n<p>저는 새로운 프로그래밍 언어나 기술을 배우기 좋아합니다. 이때는 절대로 StackOverflow를 사용하지 않고, 책이나 온라인 자료에 의지합니다. 하지만 StackOverflow는 자신의 진도를 테스트하는데 아주 좋은 수단이라는 사실을 깨달았습니다.</p>\n<p>불과 몇주 전에 자신이 배우기 시작한 분야에 다른 사람이 질문을 올렸는데, 그 질문에 답변을 할 수 있다면 엄청나게 뿌듯한 기분이 듭니다.</p>\n<p>요즘에는 StackOverflow에 올라온 질문에 답변을 달고, 그 답변이 채택되는 일이 그렇게 간단하지 않습니다. 엄청난 수의 전문가들이 매일 접속해있으니까요. 간단한 질문은 빠르면 몇 분 이내에 답변이 달리기도 하고, 심지어 여러분이 문제를 다 읽기도 전에 답변이 달릴 때도 있습니다. 대신 더 복잡한 질문은 시간이 걸리겠지만, 새로운 주제를 배우고 있는 상태에서 건드리기엔 너무 어렵습니다.</p>\n<p>따라서 적절한 질문을 선택한 뒤, 합리적인 시간 안에 올바른 해결책을 제시하는 일은 새로운 주제를 배우면서 진도를 테스트하는 좋은 방법입니다.</p>\n<p>저는 개인적으로 세 단계의 학습 과정을 가지고 있습니다.</p>\n<ol>\n<li>첫 번째 단계로 열심히 학습하는 동안 간단한 질문들을 읽고 답변을 떠올리지만, <em>실제로는 답변하지 않습니다.</em></li>\n<li>두 번째로 충분한 지식 기반을 쌓았을 때, 좀 쉬운 질문에만 답변을 쓰려고 하거나 이미 알맞은 해결책이 존재한다면 링크를 제공하기도 합니다. <em>제가 정말 이 답이 맞다고 자신있게 생각한다면</em> 직접 답변을 달기도 합니다. 저는 손쉽게 +1을 얻고자 하는게 아니기 때문에 진짜 적절한 해결책이라는 자신이 없다면 답변을 달지 않습니다. 보통 두 번째 단계가 가장 긴 단계인데, 이후 세 번째 단계로 자연스레 이어지게 됩니다.</li>\n<li>세 번째는 해당 주제에 상당한 양의 지식을 갖게 되고, 관련된 대부분의 질문에 대답을 하거나 디버깅할 수 있는 단계입니다. 물론 이 단계에 이르기까지 많은 시간이 들 뿐 아니라, 모든 프로그래밍 관련 주제에서 이 단계까지 다다를 필요는 없을 겁니다.</li>\n</ol>\n<p>일반적으로 두 번째 단계를 목표로 하셔야 합니다. 특정 주제에 관한 질문을 이해하고 괜찮은 수준의 답변을 할 수 있을 정도가 되어야 합니다. 비록 대부분의 경우 여러분이 올바른 해결책을 떠올리기까지 걸리는 시간이 다른 숙련된 개발자들에 비해 느리다고 하더라도 괜찮습니다. 답변을 다는 시간을 줄이는 능력은 더 많은 경험에서 우러나오기 마련인데, 반드시 시간 줄이기를 목표로 삼을 필요는 없습니다.</p>\n<h2 id="사용자-지원"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A7%80%EC%9B%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 지원</h2>\n<p>가끔 누군가가 <a href="https://dnsimple.com/">DNSimple(작성자가 몸 담고 있는 서비스)</a>과 관련된 질문을 올릴 때도 있습니다. 대부분의 질문은 자신의 소프트웨어를 연결하거나 도메인을 등록하는 등 DNSimple이 하나의 구성요소인 경우가 많습니다.</p>\n<p>질문에 이미 제시된 답변이 없는 경우 저는 가능한 한 대화에 끼어들어 답을 제공하려 합니다. 만약 필요한 지식을 모르고 있다면 다른 DNSimple 팀원을 불러 그 사람과 함께 알맞은 해결책을 작성해봅니다.</p>\n<p>저는 StackOverflow에서 <a href="https://stackoverflow.com/questions/tagged/dnsimple">dnsimple</a> 태그를 구독해두었습니다. 그리고 때로는 <a href="https://serverfault.com/">ServerFault</a>와 <a href="https://webmasters.stackexchange.com/">Webmasters Stack Exchange</a>에서 <code class="language-text">dnsimple</code> 키워드를 찾아보기도 합니다.</p>\n<h2 id="온라인-평판"><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%ED%8F%89%ED%8C%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>온라인 평판</h2>\n<p>작년에 저는 <em>온라인 평판</em>을 쌓는 것이 중요하다는 이야기를 많이 들었습니다. 이게 SEM(Search Engine Marketing) 회사들이 다른 회사들더러 온라인 활동에 투자하도록 꼬드기는 가장 일반적인 방법 중 하나입니다.</p>\n<p>온라인 평판은 마찬가지로 사람에게도 중요합니다. 특히 여러분의 주 활동 영역이 어떻게든 컴퓨터나 프로그래밍, 혹은 인터넷이랑 직접적인 연관이 있는 분야라면 말입니다.</p>\n<p>StackOverflow는 <a href="https://en.wikipedia.org/wiki/Show,_don&#x27;t_tell"><em>말하지 말고 행동으로 보이라</em></a> 는 접근 방식으로 온라인 평판을 쌓는 아주 좋은 방법입니다. StackOverflow에 있는 질문에 적절히 답을 하면서 여러분은 자신의 경험을 내보일 수 있습니다. 경험이 있는 척 하거나 다른 사람에게 무엇을 잘 한다고 말만 하고 다니는 것보다 훨씬 직접적입니다. 물론 다른 결과가 나올 수도 있습니다. 질문과 답변은 공개되어있고 몇 년 뒤에도 지워지지 않기 때문에, 자신의 기술 혹은 소통 능력의 약점을 드러낼 수 있기 때문입니다.</p>\n<p>예전부터 저는 최소한 두 가지 유형의 StackOverflow 프로필을 가지고 있는 사람들과 이야기해왔습니다. 첫 번째는 자신들의 온라인 평판에 긍정적인 영향을 미치는 방식으로 소통을 해온 사람들이고, 두 번째는 자신이 <em>너무 멍청하다고</em> 자책하며 질문을 올리는 사람들이었습니다.</p>\n<p>기억하세요. 바보같은 질문은 없습니다. 아무리 질문이 쉽다 하더라도 정말 중요한 것은 질문하는 방식(그리고 여러분이 적절한 답을 찾아보거나 최소한 노력이라도 했는지) 입니다. 저는 특정 분야에 제가 지식이 부족하다는 이야기를 하면서 질문하는데 아무런 거리낌이 없습니다. 제가 <a href="https://dba.stackexchange.com/">DBA</a>나 <a href="https://vi.stackexchange.com/">Vim</a> 사이트에 올린 질문들은 대부분 제 자신이 해당 분야의 전문가가 아니지만, 더 배우고 발전하고자 하는 의지를 보이고 있습니다.</p>\n<h2 id="온라인-노출도"><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%EB%85%B8%EC%B6%9C%EB%8F%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>온라인 노출도</h2>\n<p>온라인 평판이 여러분의 프로필을 발전시키는데 직접적으로 연관되어 있다면, 온라인 노출도는 여러분이 온라인에서 보여지는 횟수를 뜻합니다.</p>\n<p>Github는 프로그래머에게 온라인 평판(인터뷰에 지원할 때 자신의 오픈 소스 기여를 링크로 제공할 수 있기 때문에)과 온라인 노출도를 기르는 최적의 장소입니다. 하지만 Github와 비교하면 StackOverflow는 일반적으로 검색 엔진에서 많이 보이게 됩니다. 저는 여지껏 검색 엔진을 이용해서 StackOverflow에 있는 문제와 해결책을 찾는 데 어려움을 겪었다는 프로그래머를 본 적이 없습니다.</p>\n<p>StackOverflow는 검색 엔진에서 높은 우선순위를 가지고 있기 때문에, StackOverflow에서 명성을 얻는 일은 아마 여러분의 온라인 노출도에 직접적, 간접적으로 영향을 주게 됩니다. 직접적으로는 StackOverflow의 랭킹이 올라가고, 간접적으로 여러분이 답변을 달았던 질문이 검색 엔진의 결과 페이지에 나타나기 때문입니다.</p>\n<h2 id="영어-배움터"><a href="#%EC%98%81%EC%96%B4-%EB%B0%B0%EC%9B%80%ED%84%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영어 배움터</h2>\n<p>저는 영어 원어민이 아닙니다. 영어로 글을 쓰는 일은 저에게 여전히 어렵고, 이탈리아어로 쓰는 일보다 훨씬 어려우며, 다른 사람이 영어로 쓴 글을 읽는 일보다 더욱 어렵습니다.</p>\n<p>StackOverflow는 제 영어 쓰기 실력을 기르는데 아주 좋은 기회를 제공해줍니다. 누구나 제 답변을 수정하거나 오타를 교정할 수 있기 때문입니다. StackOverflow는 모든 변경 사항의 이력을 가지고 보존하기 떄문에, 저는 언제나 제 글에 다른 사람들이 도움을 준 부분을 살펴볼 수 있습니다. 실수로부터 배우는 일은 저에게 아주 좋은 방법입니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>StackOverflow에 있는 질문에 답변을 작성하는 것은 <em>일반적으로</em> 저에게 기쁜 경험입니다. 저의 태도와 개인적인 역량에 긍정적인 영향을 주기 때문입니다. 하지만 긍정적인 경험이 짜증나는 일이 되도록 하지 않기 위해 이 일을 의무로 여기지 않고 있습니다.</p>\n<p>저는 최소 몇시간 혹은 최소 몇일에 한번 답변을 해야한다거나, 하루에 얼마만큼의 명성을 쌓아야 한다고 목표치를 정해놓지 않았습니다. 마지막으로 로그인한 시간이 좀 지났다 하더라도 찝찝한 기분이 들지도 않습니다.</p>\n<p>저는 하루 일과와 StackOverflow에 머물러 있는 시간의 균형을 유지하려고 노력합니다. 주로 테스트나 배포가 끝나길 기다리는 동안 하루에 30분에서 한 시간정도만 머물러 있습니다.</p>\n<p>StackOverflow에 기여하는 일은 두뇌를 단련하고, 소프트웨어 엔지니어로서 자신의 기술을 끌어올리며, 저의 온라인 평판과 노출도를 항샹시키는 긍정적인 부가 효과도 있습니다. 이 모든 이유가 제가 7년 동안 질문에 답하기 위해 <em>투자한</em> 시간을 정당화합니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>글 내용이 꽤 길어서 힘들었지만 유익한 내용이었습니다. 저를 비롯한 많은 개발자들이 StackOverflow에서 이미 답변된 질문 위주로 검색을 하고, 답을 얻어서 문제를 해결할 생각은 하겠지만 직접 질문을 올리거나 답변을 작성할 생각은 별로 해 본적이 없을겁니다. 영어라는 장벽 때문이겠지요. 거기다 \'바빠 죽겠는데 이런데 글 쓰고 앉아있을 시간이 어디 있겠느냐\' 같은 생각도 할 수 있겠네요.</p>\n<p>이 글을 읽고 나니 StackOverflow를 적극적으로 사용하는 일은 Github으로 참여하는 오픈 소스 생태계와 비슷한 점이 많다고 느꼈습니다. 보통은 자신의 코드가 직접적으로 남는 Github쪽을 선호하겠지만, 오히려 무리해서 \'<a href="https://blog.outsider.ne.kr/1193">일일 커밋</a>\'을 하기보단 차근차근 StackOverflow에 적극적으로 참여하는 것도 개발자의 실력을 갈고닦는데 큰 도움이 되겠습니다.</p>\n<p>그리고 다른 어느 부분보다 글의 결론 부분이 와 닿았습니다. 우리는 보통 각자의 생업이 있고, 아무리 좋은 의도를 가진 행동도 의무가 되어야 할 필요는 없다고 생각합니다. 스타워즈의 요다 선생이 <strong>"Do. Or do not. There is no try."</strong> 라고 말씀하셨지만, 이번 경우에는 정 반대로 생각해보면 마음이 한결 편해집니다. <strong>"아예 안하는 것 보다는 시도라도 해 보는게 낫지 않을까"</strong></p>',id:"/home/circleci/repo/src/pages/posts/2017-04-15-how-i-use-stackoverflow-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-15",path:"/posts/how-i-use-stackoverflow-kor",title:"[번역] 내가 StackOverflow를 사용하는 방법",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 포스트는  Alex Kotliarskyi 의  글 을 번역한 것입니다. 오역 지적 및 피드백은 언제나 환영합니다. 저는 드디어  Cheng Lou 가 ReactConf'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요. 요약:  언어가 있으면  메타언어 (고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE…",html:'<ul>\n<li><strong>이 포스트는 <a href="http://frantic.im/">Alex Kotliarskyi</a>의 <a href="http://frantic.im/meta-language">글</a>을 번역한 것입니다.</strong></li>\n<li><strong>오역 지적 및 피드백은 언제나 환영합니다.</strong></li>\n</ul>\n<hr>\n<p>저는 드디어 <a href="https://twitter.com/_chenglou">Cheng Lou</a>가 ReactConf\'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요.</p>\n<iframe width="560" height="315" src="https://www.youtube.com/embed/_0T5OSSzxms" frameborder="0" allowfullscreen></iframe>\n<p><strong>요약:</strong> 언어가 있으면 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%ED%83%80_%EC%96%B8%EC%96%B4">메타언어</a>(고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE 기능, 문서, 예제, 튜토리얼, 블로그 글, 책, 비디오, 컨퍼런스 등의 기술 발표 등)을 뜻한다. 우리는 언어를 배우기 위해 메타언어를 사용한다. 우리가 메타언어의 개념을 언어 자체로 끌어내리면, 우리가 다루는 개념은 더욱 유연해지고 점차 새로운 메타언어를 만들어나갈 수 있게 된다. 새로운 메타언어는 같은 에너지를 쏟아도 기존 메타언어에 비해 더 고차원적이고 풍부한 형태를 가질 수 있게 된다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 49.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQoz4WS226DMAyG+/7vtk2atHU3k3qBOLQhQCFRIHb+OZmg6WFdJCsG2Z9/O97hjxNCSDcRgewE6hQWrTCfTuB5vorJ/d3qxPuRERNsPeL0UsEWGjwO4GW5y1m/d7eV8orxNwuwqRy+9xPOZ4KjAE7xF8g80wWY05n5TiFLy9Vo8aE6vNUtDnpaWQkaWIDuAdAYg+PxKCrOKMsSRVHAOQe/eCin8Dl8JRsWLXM1opI3yOL+UZgeQixIEnnG5Gqo4R2t2OhKmFkJ8ALxMz+f4TboGCwt+b6GPbyC+gbwtHb723IUkAMfPX1+fFQ6jkDTgMoK3PeJtXUmBRdD1wpzWJxbL0ld18F7n8xYi0FmG/IOcp/Dc2DbtlBKFln2LdooCrXW2xhu9y/P/wHyLxHJM3AJqAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="The Flow"\n        title=""\n        src="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png"\n        srcset="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-d16f8.png 198w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-f21b1.png 395w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png 790w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-81e7e.png 1185w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-c6d11.png 1200w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>이 그림의 이해를 돕기 위해 다양한 예제를 준비해왔습니다.</p>\n<h2 id="어셈블리-명령어-→-변수명"><a href="#%EC%96%B4%EC%85%88%EB%B8%94%EB%A6%AC-%EB%AA%85%EB%A0%B9%EC%96%B4-%E2%86%92-%EB%B3%80%EC%88%98%EB%AA%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어셈블리 명령어 → 변수명</h2>\n<p>우주 산업 분야에서 행성으로부터의 <a href="https://ko.wikipedia.org/wiki/%ED%83%88%EC%B6%9C_%EC%86%8D%EB%8F%84">탈출 속도(escape velocity)</a>를 구하기 위해 사용되는 코드 일부를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-assembly"><code class="language-assembly">.SUB_0_21:\n    ; Computes escape velocity\n    ; register xmm0 - planet mass\n    ; retister xmm1 - planet radius\n    mulsd   xmm0, qword ptr [rip + .LCPI0_0]\n    divsd   xmm0, xmm1\n    xorps   xmm1, xmm1\n    sqrtsd  xmm1, xmm0\n    ucomisd xmm1, xmm1\n    jp      .LBB0_2\n    movapd  xmm0, xmm1\n    ret\n.LBB0_2:\n    jmp     sqrt                    ; TAILCALL\n.LCPI0_0:\n    .quad   4459223850755291651     ; double 1.334816E-10</code></pre>\n      </div>\n<p>코드의 상당수가 메타언어에 기대고 있습니다. 이 코드에 대한 주석이나 문서(여기엔 보이지 않지만) 말입니다. 위 코드와 비교해서 C로 작성된 예를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> GRAVITY_CONSTANT 6.67408e-11</span>\n<span class="token keyword">double</span> <span class="token function">escape_velocity</span><span class="token punctuation">(</span><span class="token keyword">double</span> mass<span class="token punctuation">,</span> <span class="token keyword">double</span> radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> GRAVITY_CONSTANT <span class="token operator">*</span> mass <span class="token operator">/</span> radius<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그저 변수에 이름을 지정해주었을 뿐인데 메타언어에 기대고 있던 정보를 언어 자체로 끌어내릴 수 있게 됐습니다.</p>\n<h2 id="변수명-→-심화-타입advanced-types"><a href="#%EB%B3%80%EC%88%98%EB%AA%85-%E2%86%92-%EC%8B%AC%ED%99%94-%ED%83%80%EC%9E%85advanced-types" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변수명 → 심화 타입(Advanced Types)</h2>\n<p>C 버전의 코드는 어셈블리로 작성된 코드보다 훨씬 많은 정보를 가지고 있고, 메타언어도 더 높은 수준으로 이루어져 있습니다. 이제 우리는 반복 작성을 하거나 코드 안의 내용이 무엇인지 문서화할 필요가 없어졌습니다. 이 함수가 2개의 인자를 받아야 하며 첫 번째 인자는 질량, 두 번째 인자는 반경이라는 내용 말입니다.</p>\n<p>하지만 아직 문맥상 코드에 부족한 부분이 있습니다. 이 함수가 어느 단위 위에서 동작하는지 알 수가 없다는 겁니다. 당장은 라이브러리의 문서(메타언어)에 기댈 수 밖에 없습니다.</p>\n<p>우리는 인자 이름을 <code class="language-text">mass_kilograms</code>, <code class="language-text">radius_meters</code> 같은 이름으로 바꾸는 간단한 트릭을 써 볼수 있지만, 언어 자체에서 \'이 함수는 반드시 킬로그램과 미터를 입력해야한다\'고 보장해주는 장치가 없습니다.</p>\n<p>이제 더 복잡한 타입을 지원하는 언어의 예를 살펴보겠습니다. 저는 OCaml을 사용하겠지만 대부분의 ML-계열 언어들(하스켈, 스위프트 등)은 이런 기능을 지원합니다. (<a href="https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/units-of-measure">그리고 F#은 아예 단위에 대해 가장 높은 우선 순위로 지원을 하고 있습니다.</a>)</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">=</span> <span class="token number">6.67408e-11</span>\n\n<span class="token keyword">type</span> mass <span class="token operator">=</span> Kilograms <span class="token keyword">of</span> float\n<span class="token keyword">type</span> length <span class="token operator">=</span> Meters <span class="token keyword">of</span> float\n<span class="token keyword">type</span> velocity <span class="token operator">=</span> MetersPerSecond <span class="token keyword">of</span> float\n\n<span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token punctuation">(</span>Kilograms mass<span class="token punctuation">)</span> <span class="token punctuation">(</span>Meters radius<span class="token punctuation">)</span> <span class="token operator">=</span>\n    MetersPerSecond <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*.</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">*.</span> mass <span class="token operator">/.</span> radius <span class="token operator">|></span> sqrt<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p><em>실은 지구로부터의 탈출 속도를 계산할 때 제 구현체에서 버그를 발견했습니다. 질량을 엉뚱한 단위로 입력하고 있었어요.</em></p>\n<p>위의 코드에서 <code class="language-text">length</code> 와 <code class="language-text">mass</code> 는 단순한 숫자가 아니라 1급 객체(first class citizen)입니다. 덕분에 더욱 안전하고 유지보수가 용이하며 코드를 발전시키기 쉬워졌지요. 예를 들어 우리가 야드파운드법을 지원하고자 한다면(왜 그래야하는지는 모르겠지만), <code class="language-text">mass</code> 타입을 이렇게 바꾸면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">type</span> mass <span class="token operator">=</span>\n  <span class="token operator">|</span> Kilograms <span class="token keyword">of</span> float\n  <span class="token operator">|</span> Pounds <span class="token keyword">of</span> float\n</code></pre>\n      </div>\n<p>이러면 타입 체커가 기존 코드에서 새 단위를 적용하기 위해 수정해야 할 부분을 낱낱이 지적해줄 겁니다.</p>\n<h2 id="사용되지-않을-경우deprecation와-다른-메타정보들"><a href="#%EC%82%AC%EC%9A%A9%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%84-%EA%B2%BD%EC%9A%B0deprecation%EC%99%80-%EB%8B%A4%EB%A5%B8-%EB%A9%94%ED%83%80%EC%A0%95%EB%B3%B4%EB%93%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용되지 않을 경우(Deprecation)와 다른 메타정보들</h2>\n<p>우리가 기존의 탈출 속도보다 훨씬 정확한 값을 구할 수 있는 새로운 공식을 발견했다고 칩시다. 그렇다면 기존의 함수가 더 이상 사용되지 않는다고 표시하려면 어떻게 해야할까요?</p>\n<p>이럴 때 보통 주석이나 문서를 추가하거나 Medium에 글을 쓰는 등 메타언어를 구축할 것입니다. 하지만 메타언어로 구성된 정보들을 코드 자체로 끌어내리는게 훨씬 더 생산적인 방법입니다.</p>\n<p>전에 썼던 트릭처럼 C 함수의 이름을 바꾸어 <code class="language-text">escape_velocity</code> 를 <code class="language-text">escape_velocity_DEPRECATED</code> 나 <a href="https://github.com/facebook/react/blob/80bff5397bf854750dbe7c286f61654ea58938c5/src/umd/ReactUMDEntry.js#L21">이렇게 괴상한 이름으로 바꿀 수도 있습니다</a>. 하지만 이는 우리의 API가 변경되면서 클라이언트의 코드가 동작하지 않게 되고, 표준적인 방법도 아닙니다(누구나 자신만의 접미사를 붙일 수 있으니까요). 그리고 새로이 사용해야 할 메서드를 제대로 추천하지 않고 있습니다.</p>\n<p>만약 언어 자체가 이 메타정보를 알아서 알려주는 기능을 지원한다면 어떨까요?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">[</span><span class="token operator">@</span>ocaml<span class="token punctuation">.</span>deprecated <span class="token string">"Please use `quantum_escape` instead"</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<h2 id="추가-예시"><a href="#%EC%B6%94%EA%B0%80-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>추가 예시</h2>\n<p>지금까지 메타적 공간에 있던 많은 정보를 언어 자체에 심어주는 하나의 방법을 보여드렸습니다. 다른 예들을 보여드리겠습니다.</p>\n<p><strong><a href="https://ko.wikipedia.org/wiki/%EB%B9%84%EC%A7%80%ED%84%B0_%ED%8C%A8%ED%84%B4">방문자 패턴(Visitor Pattern)</a>과 <code class="language-text">for</code> 루프 → map/filter/reduce:</strong> 제가 대학에 다닐 땐 방문자 패턴을 배웠지만, 이젠 이 패턴이 많은 언어에서 기본 라이브러리로 손쉽게 제공되고 있습니다.</p>\n<p><strong>상태(state) 불러오기:</strong> 저는 종종 사람들이 리액트 컴포넌트를 만들면서 상태를 이렇게 설정해두는 것을 보게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript">state <span class="token operator">=</span> <span class="token punctuation">{</span>\n  data<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  error<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이 경우 <code class="language-text">loading</code> 이 <code class="language-text">false</code> 라면 <code class="language-text">data</code> 나 <code class="language-text">error</code> 중에 하나가 <code class="language-text">null</code> 이 되어서는 안된다는 안내를 하려면 메타언어를 사용할 수 밖에 없습니다. 그 대신 우리는 Flow나 타입스크립트(Typescript)를 사용하여 언어 단위에서 제약을 걸 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> State <span class="token operator">=</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'loading\'</span> <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'done\'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> Object <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'error\'</span><span class="token punctuation">,</span> error<span class="token punctuation">:</span> Error <span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>리덕스(Redux)와 불변성(Immutability):</strong> 현재는 문서, 블로그 포스트, 비디오, 컨퍼런스 발표 등에서 리덕스를 사용할 때 변수나 객체에 직접적으로 변화를 주지 않을 것을(lack of direct mutation) 전제하고 있습니다. 만약 자바스크립트가 기본적으로 불변 데이터 타입과 타입 선언(type annotations)을 제공한다면 위에서 말하는 전제를 코드에서 바로 표현할 수 있지 않을까요?</p>\n<p><strong>프로미스(Promises)와 옵저버블(Observables):</strong> 자바스크립트에서 프로미스 패턴은 라이브러리에서 제공하는 기능이었지만 이제 코어 기능으로 자리잡았습니다. <a href="https://github.com/tc39/proposal-observable">옵저버블</a>에도 같은 과정이 진행중입니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>아무리 메타언어를 언어로 끌어내린다 하더라도 사람 사이에 의사소통하는 부분을 해결할 수는 없다는 것을 새겨두시는게 좋습니다. 하지만 언어의 진화와 함께 우리는 더 효과적인 의사소통의 기회를 열어가고 있습니다.</p>\n<p>반드시 어딘가엔 복잡한 부분이 존재합니다. 만약 언어가 아주 단순하다면, 복잡한 부분은 메타언어에 머무르게 됩니다.</p>\n<p>참고로  <a href="https://www.youtube.com/watch?v=4anAwXYqLG8">Sebastian Markbåge의 최소한의 API 표현 범위(minimal API surface area)에 관한 발표와</a>, <a href="https://www.youtube.com/watch?v=V1po0BT7kac">Jared Forsyth의 타입 시스템에 대한 발표</a>를 살펴보세요. 아 그리고 영화 <a href="http://movie.daum.net/moviedb/main?movieId=105570">컨택트(Arrival, 2016)</a>도 꼭 보세요. 강추합니다!</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>처음 이 글을 접하게 된 계기는 이 코드 때문이었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// explicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n\n<span class="token comment">// implicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>보고 계시는 자바스크립트 코드에서 위쪽에 제시된 코드가 평균적으로 최대 15%까지 처리 속도가 빠르다고 합니다. <a href="https://twitter.com/dhh/status/846627223176167424">DHH는 트위터에서</a> \'어차피 15%라고 해봤자 실제로는 몇 밀리초 이하일텐데 왜 기계에게 맞추려고 하느냐\' 같은 내용의 비판을 쏟아내었지요. 코드를 어떻게 작성하실건지는 여러분의 취향에 맡기겠습니다.</p>\n<p>하지만 오늘 제가 드리고픈 말씀은 아래 트윗에 다 있기 때문에 후기를 짧게 줄이고자 합니다.</p>\n<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/dhh">@dhh</a> Code is not a conversation between a dev and a machine.&#13;&#13;Code is a conversation between a developer AND THE NEXT DEVELOPER.</p>&mdash; Don Schenck (@DonSchenck) <a href="https://twitter.com/DonSchenck/status/846675893909180416">March 28, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>',
id:"/home/circleci/repo/src/pages/posts/2017-04-04-understanding-taming-the-meta-language-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-04",path:"/posts/understanding-taming-the-meta-language-kor",title:"[번역] 메타언어 길들이기",tags:["Programming","Learning","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Aaron Patterson 의  포스트 의 번역본입니다. 기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다. 피드백은 언제나 환영합니다. 저는 콘솔 디버거입니다  (역주1: 원 제목의 'puts debuggerer'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging…",html:'<ul>\n<li>본 포스트는 <a href="https://twitter.com/tenderlove">Aaron Patterson</a>의 <a href="https://tenderlovemaking.com/2016/02/05/i-am-a-puts-debuggerer.html">포스트</a>의 번역본입니다.</li>\n<li>기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다.</li>\n<li>피드백은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>저는 콘솔 디버거입니다 <em>(역주1: 원 제목의 \'puts debuggerer\'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging은 모두 콘솔 디버깅으로 번역하겠습니다)</em>. 진짜 디버거( <code class="language-text">pry</code> , <code class="language-text">byebug</code> 등)를 사용하는 사람들을 폄하하고자 이 이야기를 하는게 아닙니다. 진짜 디버거는 아주 좋다고 생각하지만, 저는 하나라도 제대로 배울 시간을 들이지 못했습니다. 매번 한 개라도 써보려고 하다가 결국엔 한동안 사용하지 않고, 다시 사용방법을 배워야만 합니다. 어쨌든, 이번 기회에 여러분에게 콘솔 디버깅을 할 때 사용하는 트릭을 좀 알려드리고자 합니다. 저는 이 트릭들을 무언가가 어떻게 작동하는지 이해가 되지 않을때나 작동 원리를 더 알고싶을 때 사용합니다. 아래에 이야기하게 될 대부분의 것들은 <em>절대로</em> 최선의 방법(best practice)가 아니며 여러분들은 디버깅 세션이 끝나면 절대 이 코드들을 남겨두어선 안됩니다. 그러나 여러분이 <strong>무엇을 디버깅하던지</strong> 아주 유용하다고 생각합니다. 정말로 뭐든지요. 전역 변수, 메서드 재정의, 조건문 추가, 불러오기 경로 수정, 몽키 패칭, 콜 스택 출력 등 <strong>뭐든지요</strong>.</p>\n<p>저는 이 포스트에서 최대한 실제 접하는 예시들을 보여드리고 싶었습니다. 하지만 대부분의 예시들은 제가 레일즈의 보안 이슈를 디버깅하려고 할 때 나온 것들이라서, 이 코드의 테크닉은 재활용하셔도 좋지만 <strong>코드 전체를 그대로 쓰시면 안됩니다.</strong> 제가 디버깅하려는 코드들은 정상적으로 동작하지 않습니다. 거기다 이 코드를 사용하시는걸 원치도 않습니다.</p>\n<p>매 섹션에 제가 겪었던 문제들을 제목으로 적어두었으며, 내용 부분에 제가 사용한 해결책을 적어두었습니다.</p>\n<h2 id="어디에-문제가-있는진-알겠는데-어떻게-거기까지-가야할지-모르겠다"><a href="#%EC%96%B4%EB%94%94%EC%97%90-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%9E%88%EB%8A%94%EC%A7%84-%EC%95%8C%EA%B2%A0%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B1%B0%EA%B8%B0%EA%B9%8C%EC%A7%80-%EA%B0%80%EC%95%BC%ED%95%A0%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다</h2>\n<p>가끔 저는 문제가 어딨는지는 알지만 어떻게 그 부분까지 가는지 모르는 이슈들을 디버깅할 때가 있습니다. 이럴 때마다 저는 <code class="language-text">puts caller</code> 를 넣어서 콜 스택을 끄집어냅니다.</p>\n<p>예를 들어 제가 이런 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span> h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>여기서 저는 기본 블록이 어떻게 호출되는지 알고 싶을 때 이렇게 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 90개의 해시 태그를 출력하고 콜 스택을 출력한 뒤에, 나머지 90개의 해시 태그를 출력할 겁니다. 해시 태그는 여러번 호출될 때를 대비해서 콜 스택을 쉽게 구분하기 위해 넣어두었습니다. 참고로 이걸 "해시 태그"라고 부르는건 여러분을 골려주려고 그러는 겁니다.</p>\n<p>저는 이 방법을 꽤 자주 사용하기 때문에 Vim 단축키를 지정해두었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">&quot; puts the caller\nnnoremap &lt;leader&gt;wtf oputs &quot;#&quot; * 90&lt;c-m&gt;puts caller&lt;c-m&gt;puts &quot;#&quot; * 90&lt;esc&gt;</code></pre>\n      </div>\n<p>이렇게 하면 <code class="language-text">&lt;leader&gt;wtf</code> 키 조합으로 커서가 있는 위치 바로 밑에 디버깅 코드를 삽입합니다.</p>\n<h3 id="콜-스택을-한-번만-출력하고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%95%9C-%EB%B2%88%EB%A7%8C-%EC%B6%9C%EB%A0%A5%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 한 번만 출력하고 싶어</h3>\n<p>그냥 콜 스택을 출력한 뒤에 <code class="language-text">exit!</code> 를 사용하거나, <code class="language-text">raise</code> 를 호출하세요. <code class="language-text">raise</code> 는 예외를 출력할거고, 어쨌든 콜 스택을 볼 수 있을겁니다.</p>\n<h3 id="콜-스택을-특정-경우에만-보고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%8A%B9%EC%A0%95-%EA%B2%BD%EC%9A%B0%EC%97%90%EB%A7%8C-%EB%B3%B4%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 특정 경우에만 보고 싶어</h3>\n<p>이건 그냥 디버깅 코드니까 여러분이 하고싶은대로 하시면 됩니다. 예를 들어 제가 해시에 무언가를 추가할 때마다 콜 스택을 호출하고 싶다고 한다면, 이렇게 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>어차피 전 이 코드를 없애버릴거니까 어떤 이상한 조건문도 마음대로 추가할 수 있지요!</p>\n<h2 id="메서드를-호출했는데-이게-어디에-있는건지-모르겠다"><a href="#%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메서드를 호출했는데, 이게 어디에 있는건지 모르겠다</h2>\n<p>메서드를 호출했는데 그 메서드가 어디에 구현되어있는지 모를 때, 저는 <code class="language-text">source_location</code> 메서드와 함께 <code class="language-text">method</code> 메서드를 사용합니다. 예를 들어 (레일즈) 컨트롤러 안에 있는 액션이 <code class="language-text">render</code> 메서드를 호출하고 있을 때, 저는 그 메서드를 어디서 호출하는지 알고 싶었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿔보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>호출해보도록 하지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl http://localhost:3000/users/xxxx</code></pre>\n      </div>\n<p>그러면 로그에는 이렇게 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/instrumentation.rb&quot;, 40]\nCompleted 500 Internal Server Error in 35ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제 저는 <code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L40">instrumentation.rb 파일의 40번째 줄</a>에 있다는 것을 알게 되었습니다.</p>\n<h2 id="code-classlanguage-textsupercode-메서드를-호출했는데-그게-어디에-있는건지-모르겠다"><a href="#code-classlanguage-textsupercode-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EA%B7%B8%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">super</code> 메서드를 호출했는데 그게 어디에 있는건지 모르겠다</h2>\n<p><code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L43">super를 호출한다는 걸</a> 알게 되었습니다만, 저는 그게 어디에 구현되어있는지 모릅니다. 이 경우에 <code class="language-text">method</code> 의 리턴 값에 <code class="language-text">super_method</code> 를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿉니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>super_method<span class="token punctuation">.</span>source_location\n  redner params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>같은 요청을 해 보면 이런 결과를 얻을 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/rendering.rb&quot;, 34]\nCompleted 500 Internal Server Error in 34ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제야 <code class="language-text">super</code> 가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/rendering.rb#L34">여기로 가는 게</a> 보입니다. 이 메서드는 마찬가지로 <code class="language-text">super</code> 를 호출하지만, 그냥 위의 작업을 반복하여(아니면 그냥 loop를 쓰면 됩니다!) 제가 진짜 알아보고자 하는 메서드를 찾을 수 있습니다.</p>\n<h2 id="code-classlanguage-textmethodcode-메서드의-구현체를-찾고자-한다면"><a href="#code-classlanguage-textmethodcode-%EB%A9%94%EC%84%9C%EB%93%9C%EC%9D%98-%EA%B5%AC%ED%98%84%EC%B2%B4%EB%A5%BC-%EC%B0%BE%EA%B3%A0%EC%9E%90-%ED%95%9C%EB%8B%A4%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">method</code> 메서드의 구현체를 찾고자 한다면?</h2>\n<p>때때로 <code class="language-text">method</code> 를 이용한 트릭이 작동하지 않을 때가 있습니다. 제가 알아보려는 객체가 자신만의 <code class="language-text">method</code> 메서드를 구현하고 있기 때문입니다. 예를 들어 저는 <code class="language-text">request</code> 객체에 <code class="language-text">headers</code> 메서드가 구현된 위치를 찾고자 할 때 이런 코드를 사용했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p request<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>제가 요청을 보내면 이런 에러가 뜹니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">ArgumentError (wrong number of arguments (given 1, expected 0)):\n  app/controllers/users_controller.rb:5:in `index&#39;</code></pre>\n      </div>\n<p>이 경우는 <code class="language-text">request</code> 객체가 자신만의 <code class="language-text">method</code> 를 따로 구현하고 있기 때문입니다. <code class="language-text">headers</code>  메서드를 찾아내기 위해 메서드를 <code class="language-text">Kernel</code> 로부터 분리하고 <code class="language-text">request</code> 객체에 다시 바인드 한 뒤 실행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>요청을 다시 해보면 결과가 다르게 나옵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#index as */*\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_dispatch/http/request.rb&quot;, 201]</code></pre>\n      </div>\n<p>이제서야 <code class="language-text">headers</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_dispatch/http/request.rb#L201">여기에</a> 구현되어 있다는 것을 발견했습니다.</p>\n<p>심지어 <code class="language-text">method</code> 메서드의 구현체를 찾을 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="또-뭔가-호출했는데-이게-어딨는지-모르겠다"><a href="#%EB%98%90-%EB%AD%94%EA%B0%80-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%A8%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>(또) 뭔가 호출했는데 이게 어딨는지 모르겠다</h2>\n<p>가끔 당장 사용하고 있는 메서드가 실제로는 문제의 본질이 아닐 수 있습니다. 그래서 <code class="language-text">method</code> 메서드를 사용하는 트릭은 별 도움이 안될 겁니다. 이럴 때엔 저는 <code class="language-text">TracePoint</code> 라고 하는 더 큰 추적기(a larger hammer)를 사용합니다. <code class="language-text">render</code> 메서드로부터 호출 된 <em>모든</em> 메서드의 리스트를 추출하기 위해 다시 한번 예를 들어보겠습니다. 리스트에 보이는 메서드들은 <code class="language-text">render</code> 메서드가 직접 호출한 것은 아니지만 어딘가로부터 호출 된 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># GET /users</span>\n<span class="token comment"># GET /users.json</span>\n<span class="token keyword">def</span> index\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n  tp <span class="token operator">=</span> <span class="token constant">TracePoint</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:call</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>x<span class="token operator">|</span>\n    p x\n  <span class="token keyword">end</span>\n  tp<span class="token punctuation">.</span>enable\n  render <span class="token string">\'index\'</span>\n<span class="token keyword">ensure</span>\n  tp<span class="token punctuation">.</span>disable\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>저기 위치한 <code class="language-text">TracePoint</code> 는 모든 "호출(<code class="language-text">:call</code>)" 이벤트마다 작동하고, 블록은 메서드 이름과 호출된 위치를 출력할 것입니다. 여기서 "호출" 이라 함은 루비 메서드가 호출되는 경우를 말합니다(C 메서드는 제외). 만약 C 메서드가 호출되는 것을 보고 싶으시다면 <code class="language-text">:c_call</code> 을 사용하세요. 이 예시는 <em>엄청난 양의</em> 결과가 출력될겁니다. 저는 호출될 메서드가 꽤 적거나, 도대체 어디부터 찾아봐야 할지 모를 때 이 방법을 사용합니다.</p>\n<h2 id="예외가-일어나는-것은-알겠지만-어디서-발생하는지-모르겠다"><a href="#%EC%98%88%EC%99%B8%EA%B0%80-%EC%9D%BC%EC%96%B4%EB%82%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%95%8C%EA%B2%A0%EC%A7%80%EB%A7%8C-%EC%96%B4%EB%94%94%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>예외가 일어나는 것은 알겠지만, 어디서 발생하는지 모르겠다</h2>\n<p>예외가 발생할 때 <em>실제로</em> 어디서 예외가 발생했는지 모를 때가 있습니다. 이 예시는 레일즈 3.0.0을 기준으로 작성되었지만(참고로 이 문제는 수정되었습니다), 일단 이런 코드가 있다고 해보죠.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> <span class="token constant">Logger</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token variable">$stdout</span>\n<span class="token constant">User</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>execute <span class="token string">"oh no!"</span>\n</code></pre>\n      </div>\n<p>SQL은 작동하지 않을 테고, 예외가 일어날 겁니다. 그렇다면 예외가 어떻게 발생하는지 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>여러분이 추적 내역(backtrace) 을 읽어보셨다면 <em>(역주2: backtrace하면 역추적 이라는 말이 직역하기는 좋지만, 보통 루비에서 backtrace를 떠올릴 때 콘솔에 뜨는 십수 줄의 추적 내역이 연상될 때가 많아서 추적 내역으로 번역하였습니다)</em>, 예외가 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L202">abstract_adapter.rb의 202번째 줄</a>에서 발생했다는 것을 알 수 있습니다. 그러나 이 코드는 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L199-L202">예외가 발생한 상황에서 다시 예외를 일으키도록</a> 되어있는게 보일 겁니다. 그렇다면 실제로는 어디서 예외가 일어난 걸까요? 정답을 찾기 위해 <code class="language-text">puts</code> 를 사용하거나 루비의 <code class="language-text">-d</code> 플래그를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ bundle exec ruby -d script/rails runner test.rb</code></pre>\n      </div>\n<p><code class="language-text">-d</code> 플래그는 경고를 활성화하고 모든 예외 발생을 출력합니다. 네, 실제로는 엄청나게 많은 양의 결과물이 출력되겠지요. 그러나 끝부분을 살펴보시면 이렇게 되어있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `NameError&#39; at activesupport-3.0.0/lib/active_support/core_ext/module/remove_method.rb:3 - method `_validators&#39; not defined in Class\nException `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error\nException `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error\n  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at railties-3.0.0/lib/rails/commands/runner.rb:48 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>실제 예외는 여기서 발생했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>그리고 여기서 다시 예외가 일어났지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>예외가 발생할 때 래핑된 뒤 다시 예외가 발생하는 경우에는 <em>반드시</em> 본래의 추적 내역을 노출해야 합니다. 그러므로 이 경우는 명백히 버그지만, 실제로 버그는 고쳐졌으며, 우리는 언젠가 또 이런 경우가 발생했을 때 해결하는 법을 알게 되었습니다.</p>\n<h3 id="커맨드-라인-도구를-code-classlanguage-text-dcode-플래그와-함께-사용하여-실행"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C-%EB%9D%BC%EC%9D%B8-%EB%8F%84%EA%B5%AC%EB%A5%BC-code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%8B%A4%ED%96%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드 라인 도구를 <code class="language-text">-d</code> 플래그와 함께 사용하여 실행</h3>\n<p>위의 기술을 RSpec 테스트에 적용하고 싶으시다면 이렇게 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -d -S rspec</code></pre>\n      </div>\n<h3 id="code-classlanguage-text-dcode-플래그는-사용하고-싶은데-프로세스를-실행하는-방법을-모르겠다"><a href="#code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EB%8A%94-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80%EB%8D%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%9D%84-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">-d</code> 플래그는 사용하고 싶은데 프로세스를 실행하는 방법을 모르겠다</h3>\n<p>Rake 테스트 작업은 기본적으로 <a href="https://github.com/ruby/rake/blob/3c4fe3e25e5ab6b052f9e81bc2920ca4b4fc1094/lib/rake/testtask.rb#L105">서브 프로세스 안에서 당신의 테스트를 실행합니다</a>. 말인 즉슨 <code class="language-text">ruby -d -S rake</code> 같은 커맨드를 입력해도 서브 프로세스 안에 있는 여러분의 테스트에는 플래그가 적용되지 않는다는 뜻입니다. 이 경우 저는 <code class="language-text">RUBYOPT</code> 환경 변수를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ RUBYOPT=-d bundle exec rake test</code></pre>\n      </div>\n<p><code class="language-text">RUBYOPT</code> 환경 변수는 쉘에서 실행된 모든 루비 프로그램에 적용되고, 심지어 rake로부터 호출 된 서브 쉘에도 적용됩니다. 이를 응용하면 <code class="language-text">rspec</code> 커맨드를 이렇게 다시 써볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=-d rspec</code></pre>\n      </div>\n<h2 id="이-객체는-어디에서-온-걸까"><a href="#%EC%9D%B4-%EA%B0%9D%EC%B2%B4%EB%8A%94-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%98%A8-%EA%B1%B8%EA%B9%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이 객체는 어디에서 온 걸까?</h2>\n<p>보통은 콜 스택을 출력하여 객체가 어디에서 왔는지 찾습니다. 하지만 가끔 객체가 콜 스택 바깥에 위치한 경우도 있습니다. 이럴 때는 객체가 어디에서 호출된 건지 찾기 힘듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  p x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>이전에 "어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다" 파트에서 <code class="language-text">caller</code> 를 사용하는 방법, "wtf  트릭" <em>(역주3: 글쓴이는 해당 방법을 소개할 때 Vim 단축키를 <code class="language-text">&lt;leader&gt;wtf</code> 으로 설정하였습니다. 그래서 이를 "wtf trick"으로 명명한 것으로 보입니다)</em>을 보여드렸습니다.  여기서 저는 <code class="language-text">x</code> 라는 값이 어떻게 할당되었는지 신경쓰였는데요, <code class="language-text">foo</code> 메서드를 따라가다보면 <code class="language-text">baz</code> 메서드에서 값을 가져오는 것을 볼 수 있습니다. 거대한 코드 베이스에서는 형제 트리에서 모든 호출과 로직을 따라가는게 아주 어렵습니다(코드를 자료구조의 그래프라고 생각한다면, <code class="language-text">foo</code> 메서드는 두 개의 자손이 있는 겁니다. <code class="language-text">baz</code> 와 <code class="language-text">bar</code> 이죠. 그래서 <code class="language-text">baz</code>가 <code class="language-text">bar</code> 의 형제라고 여길 수 있습니다). 저는 게으르기 때문에 객체가 어디서 왔는지 찾기 위해 모든 메서드를 뒤지고 싶지 않았습니다. 그래서 저는 루비의 객체 할당 추적기(object allocation tracer)를 사용하는걸 좋아합니다. 루비의 할당 추적기는 루비 2.1버전부터 사용할 수 있습니다(확실한 것은 아닙니다). 제가 이 방법을 사용할 때는 가능한 빨리 <code class="language-text">require</code> 한 뒤에 활성화합니다. 그러면 제가 찾고자 하는 할당 위치를 찾을 수 있지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n\n<span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  p <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>프로그램을 실행하면 이런 결과를 얻습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby x.rb\n{&quot;x.rb&quot;=&gt;14}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p><code class="language-text">x</code> 객체가 해당 파일의 14번째 줄에 있다는 것을 알게 되었습니다. 그러면 해당 라인으로 가서 "wtf 트릭" 을 반복하거나 프로그램에 무슨 문제가 있는지 발견할 때 까지 이 방법을 반복합니다.</p>\n<p>저는 보통 객체 추적을 가능한 빠르게 시작합니다. 제 객체가 어디에 할당되었는지 모르니까요. 이런 추적은 프로그램의 속도를 떨어뜨리지만, 디버깅 중에는 신경쓸 필요가 없습니다.</p>\n<h2 id="나는-code-classlanguage-textrequirecode-를-진짜-진짜-빨리-하고-싶어"><a href="#%EB%82%98%EB%8A%94-code-classlanguage-textrequirecode-%EB%A5%BC-%EC%A7%84%EC%A7%9C-%EC%A7%84%EC%A7%9C-%EB%B9%A8%EB%A6%AC-%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나는 <code class="language-text">require</code> 를 진짜 진짜 빨리 하고 싶어</h2>\n<p>바로 위에 보여드린 기술은 오로지 객체가 <code class="language-text">trace_object_allocations_start</code> 메서드가 호출되고 난 뒤에 할당된 이후의 정보만 제공합니다. 파일이 <code class="language-text">require</code> 되는 순간에 객체가 할당되어서, 도대체 무슨 파일이고 <em>어디에 있는지</em> 모를 때가 있습니다. 그래서  프레임워크 안에 있는 어떤 파일이라도 로드되기 전에 코드를 좀 실행시킬 필요가 있습니다. 이럴 때 저는 <code class="language-text">-r</code> 플래그를 사용한 뒤 스크립트를 작성합니다.</p>\n<p>우리가 <code class="language-text">User::BLACKLISTED_CLASS_METHODS</code> 의 할당 위치를 찾는 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'active_record\'</span>\n\n<span class="token constant">AciveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>establish_connection adapter<span class="token punctuation">:</span> <span class="token string">\'sqlite3\'</span><span class="token punctuation">,</span> databse<span class="token punctuation">:</span> <span class="token string">\':memory:\'</span>\n\n<span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>instance_eval <span class="token keyword">do</span>\n  create_table <span class="token symbol">:users</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">;</span> <span class="token keyword">end</span>\np <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>그런데 우리는 이 어떤 파일이 이 상수를 할당했는지 모르고, 찾는 방법을 떠올리고 싶지도 않을 때가 있습니다(네, 이건 좀 억지로 꾸며낸 경우입니다). 이럴 때 <code class="language-text">y.rb</code> 라는 파일을 작성해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n</code></pre>\n      </div>\n<p>그리고 저는 루비의 커맨드 라인 인자를 넣어서 이 파일을 실행할 때 바로 <code class="language-text">require</code> 하도록 만들었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby -I. -ry x.rb\n{&quot;/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/activerecord-5.0.0.beta1/lib/active_record/attribute_methods.rb&quot;=&gt;35}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p>인자들을 찬찬히 살펴보면 <code class="language-text">-I.</code> 는 ". 를 불러오기 경로로 추가하고", <code class="language-text">-ry</code> 는 <code class="language-text">require &#39;y&#39;</code> 와 같으며, 이후에 <code class="language-text">x.rb</code> 를 실행하는 겁니다. 그러니 <code class="language-text">.</code> 가 불러오기 경로로 추가되었고, <code class="language-text">x.rb</code> 가 실행되기도 전에 <code class="language-text">y.rb</code> 파일이 <code class="language-text">require</code> 되었습니다. 그 결과로 <code class="language-text">BLACKLISTED_CLASS_METHODS</code> 가 <code class="language-text">attribute_methods.rb</code> 의 35번째 줄에 에 할당되어 있다는 사실을 알 수 있습니다. 만약 서브 프로세스 안에서 실행되는 코드에 이 기술을 적용하고자 한다면 <code class="language-text">RUBYOPT</code> 를 함께 쓰면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=&#39;-I. -ry&#39; rake test</code></pre>\n      </div>\n<h2 id="객체가-어딘가에서-수정되었는데mutated-그-위치를-모르겠다"><a href="#%EA%B0%9D%EC%B2%B4%EA%B0%80-%EC%96%B4%EB%94%98%EA%B0%80%EC%97%90%EC%84%9C-%EC%88%98%EC%A0%95%EB%90%98%EC%97%88%EB%8A%94%EB%8D%B0mutated-%EA%B7%B8-%EC%9C%84%EC%B9%98%EB%A5%BC-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체가 어딘가에서 수정되었는데(mutated), 그 위치를 모르겠다</h2>\n<p>객체를 살펴보다 보면 이게 수정되고 있다는건 알겠는데, 어디서 수정되고 있는 지 모를 때가 있습니다. 이 때는 객체에 <code class="language-text">freeze</code> 를 호출한 뒤에, 테스트를 실행해보고, 어디서 예외가 발생하는지 살펴보면 됩니다. 그 예로, 제가 <a href="https://github.com/rails/rails/blob/38b5af6595338cb2212980062d9aaf51241878cc/activesupport/lib/active_support/concurrency/share_lock.rb#L28">어디에서 특정 변수가 수정되는지 알고 싶을 때</a>가 있습니다. 코드를 살펴보니 이 변수가 수정된다는 것은 알고 있었지만, 어디서부터 수정이 일어나는지 알지 못했습니다. 그래서 코드를 이렇게 수정해봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> initialize\n  <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n  <span class="token variable">@cv</span> <span class="token operator">=</span> new_cond\n\n  <span class="token variable">@sharing</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n  <span class="token variable">@sharing</span><span class="token punctuation">.</span>freeze\n  <span class="token variable">@waiting</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n  <span class="token variable">@exclusive_thread</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n  <span class="token variable">@exclusive_depth</span> <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 나서 레일즈 서버를 실행하면 예외가 발생하며 추적 내역이 보여집니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">active_support/concurrency/share_lock.rb:151:in `delete&#39;: can&#39;t modify frozen Hash (RuntimeError)\n\tfrom active_support/concurrency/share_lock.rb:151:in `yield_shares&#39;\n\tfrom active_support/concurrency/share_lock.rb:79:in `block in stop_exclusive&#39;</code></pre>\n      </div>\n<p>이제 처음에 수정이 발생한 곳을 발견했습니다. 만약 이 부분이 여러분이 찾고자 하는 부분이 아니라면 작성해둔 <code class="language-text">freeze</code> 를 삭제한 뒤에 내역을 따라가서 수정된 부분 이후에 다시 덧붙이면 됩니다.</p>\n<h2 id="교착-상태deadlock에-빠졌는데-어디서-문제가-생겼는지-모르겠다"><a href="#%EA%B5%90%EC%B0%A9-%EC%83%81%ED%83%9Cdeadlock%EC%97%90-%EB%B9%A0%EC%A1%8C%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%94%94%EC%84%9C-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%83%9D%EA%B2%BC%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>교착 상태(deadlock)에 빠졌는데, 어디서 문제가 생겼는지 모르겠다</h2>\n<p>저에게 스레드와 관련된 이슈가 발생했고, 문제를 어디에서 해결해야할 지 몰랐을 때, 저는 살아있는 스레드를 검사해보기 위해 코드를 좀 추가했습니다. 예를 들어 저는 <a href="https://github.com/rails/rails/issues/23503">이 이슈를 디버깅하고 있었습니다</a>. 애플리케이션 서버가 막혀있는데, 대체 어디서 문제가 발생했는지 몰랐습니다. 그래서 어디서 스레드가 막혀있는지 찾기 위해 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token builtin">Thread</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    p t\n    puts t<span class="token punctuation">.</span>backtrace\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 이렇게 실행했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -I. -rx bin/rails s</code></pre>\n      </div>\n<p>이제 앱 서버가 막혔을 때, 컨트롤+T 키를 누르면(죄송하지만 OS X에서만 작동합니다, 리눅스에서는 <code class="language-text">kill</code> 을 사용해야 합니다), 모든 스레드의 추적 내역을 볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">##########################################################################################\n#&lt;Thread:0x007f90bc07cb38 run&gt;\nomglolwut/x.rb:7:in `backtrace&#39;\nomglolwut/x.rb:7:in `block (2 levels) in &lt;top (required)&gt;&#39;\nomglolwut/x.rb:4:in `each&#39;\nomglolwut/x.rb:4:in `block in &lt;top (required)&gt;&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `join&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `run&#39;\ngems/rack-2.0.0.alpha/lib/rack/server.rb:296:in `start&#39;\nrails/commands/server.rb:78:in `start&#39;\nrails/commands/commands_tasks.rb:90:in `block in server&#39;\nrails/commands/commands_tasks.rb:85:in `tap&#39;\nrails/commands/commands_tasks.rb:85:in `server&#39;\nrails/commands/commands_tasks.rb:49:in `run_command!&#39;\nrails/command.rb:20:in `run&#39;\nrails/commands.rb:19:in `&lt;top (required)&gt;&#39;\nbin/rails:4:in `require&#39;\nbin/rails:4:in `&lt;main&gt;&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b668@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/reactor.rb:136 sleep&gt;\nlib/puma/reactor.rb:29:in `select&#39;\nlib/puma/reactor.rb:29:in `run_internal&#39;\nlib/puma/reactor.rb:138:in `block in run_in_thread&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b500@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:216 sleep&gt;\nlib/puma/thread_pool.rb:219:in `sleep&#39;\nlib/puma/thread_pool.rb:219:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b3c0@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:187 sleep&gt;\nlib/puma/thread_pool.rb:190:in `sleep&#39;\nlib/puma/thread_pool.rb:190:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b258@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/server.rb:296 sleep&gt;\nlib/puma/server.rb:322:in `select&#39;\nlib/puma/server.rb:322:in `handle_servers&#39;\nlib/puma/server.rb:296:in `block in run&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90c1ef9a08@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:61 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:132:in `wait_until&#39;\naction_dispatch/http/response.rb:170:in `block in await_commit&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\naction_dispatch/http/response.rb:169:in `await_commit&#39;\naction_controller/metal/live.rb:270:in `process&#39;\naction_controller/metal.rb:193:in `dispatch&#39;\naction_controller/metal.rb:265:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:50:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:32:in `serve&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bd1d5f38@/Users/aaron/git/rails/actionpack/lib/action_controller/metal/live.rb:279 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:123:in `wait_while&#39;\nactive_support/concurrency/share_lock.rb:57:in `block (2 levels) in start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:154:in `yield_shares&#39;\nactive_support/concurrency/share_lock.rb:56:in `block in start_exclusive&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\nactive_support/concurrency/share_lock.rb:51:in `start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:113:in `exclusive&#39;\nactive_support/dependencies/interlock.rb:12:in `loading&#39;\nactive_support/dependencies.rb:37:in `load_interlock&#39;\nactive_support/dependencies.rb:369:in `require_or_load&#39;\nactive_support/dependencies.rb:529:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\nactive_support/dependencies.rb:561:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\napp/controllers/users_controller.rb:9:in `index&#39;\n##########################################################################################</code></pre>\n      </div>\n<p>가독성을 위해 결과물을 조금 잘라냈습니다만, 여러분은 이제 각각의 스레드가 무엇을 하는지 볼 수 있습니다. 그리고 어느 스레드 두 개가 교착 상태에 빠졌는지 쉽게 발견할 수 있습니다(정답은 마지막 두 개입니다).</p>\n<h2 id="특정한-시간에만-언제-메서드가-실행되는지-알고-싶다"><a href="#%ED%8A%B9%EC%A0%95%ED%95%9C-%EC%8B%9C%EA%B0%84%EC%97%90%EB%A7%8C-%EC%96%B8%EC%A0%9C-%EB%A9%94%EC%84%9C%EB%93%9C%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94%EC%A7%80-%EC%95%8C%EA%B3%A0-%EC%8B%B6%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정한 시간에만 언제 메서드가 실행되는지 알고 싶다</h2>\n<p>일정 시간 뒤에 메서드가 언제 실행되었는지 알고 싶을 때가 있습니다. 저는 애플리케이션이 <em>구동된 뒤에</em>  <code class="language-text">start_exclusive</code> 메서드가 언제 호출되는지 알고 싶었습니다. 이럴 때 위에 보여드린 <code class="language-text">trap</code> 트릭과 전역 변수를 조합하여 해결했습니다.</p>\n<p>먼저 <code class="language-text">start_exclusive</code> 를 이렇게 수정했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">start_exclusive</span><span class="token punctuation">(</span>purpose<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> compatible<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> no_wait<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token variable">$foo</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n  <span class="token comment"># ..</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  puts <span class="token string">"turning on debugging!"</span>\n  <span class="token variable">$foo</span> <span class="token operator">=</span> <span class="token keyword">true</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 구동하고 모든 요소가 준비되면 컨트롤+T를 눌러서 제 전역 변수를 <code class="language-text">true</code> 로 바꿉니다. 그리고 로그 메세지들을 살펴볼 수 있게 됩니다.</p>\n<h2 id="끝"><a href="#%EB%81%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>끝</h2>\n<p>이게 제가 지금 생각해 낼 수 있는 방법의 전부입니다. 그리고 <a href="http://www.schneems.com/2016/01/25/ruby-debugging-magic-cheat-sheet.html">Richard의 puts 디버깅에 관한 글도 읽어보세요</a>. 좋은 하루 되시길. 끝.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>간만에 엄청나게 긴 양의 글을 번역했습니다. 그래도 맘 잡고 하니 생각보다 오래 걸리지도 않고, 초벌번역의 퀄리티도 조금씩 올라가고 있다고 느끼고 있습니다.</p>\n<p>이번에 소개해 드린 글은 콘솔에 디버깅 하는 방법을 소개하는 글입니다. 보통은 디버깅 툴로 <code class="language-text">byebug</code>, <code class="language-text">pry-byebug</code> 등을 사용하실 겁니다. 저도 어지간한 디버깅을 그렇게 처리하고 있지만.. 본문의 내용처럼 좀 깊은 부분을 들여다볼 때는 일일히 깊숙하게 파고들기 힘들 때가 많습니다. 좀 더 자신이 사용하고 있는 코드의 깊은 부분을 들여보고자 할 때 아주 유용한 테크닉이 될 것이라 생각합니다.</p>\n<p>번역된 챕터 제목들의 말투가 조금 이상하다고 느끼실텐데, 들어가는 글에서 원 저자가 \'어차피 블로그 포스트니까 신경 안쓰고 말투를 편하게 한다\'는 식으로 쓰여있길래 그 느낌을 가능한 한 살려서 작성해보았습니다.</p>\n<p>글을 읽다 보면 레일즈같은 거대한 오픈 소스에 기여하는 분들은 \'어떻게 이 방대한 코드를 다 고려하면서 개발을 하는걸까?\' 하는 생각에 더욱 존경심이 들더군요. 레일즈 뿐 아니라 다른 오픈소스 프레임웍들도 마찬가지입니다. 언젠가는 오픈소스에 기여했다는 족적을 꼭 남겨 보고 싶습니다.</p>\n<p>현재 Hanami 기반으로 개발을 하고 있다보니 문서화가 덜 되어 \'소스를 까볼\' 일이 많은데 이런 기술을 더 유용하게 사용해볼 수 있겠습니다. 이 글을 보는 다른 분들은 어떻게 \'프로그램의 소스를 살펴 보시는지\' 궁금하기도 하고, 더 유용한 디버깅 팁이 있는지도 궁금해집니다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-03-19-I-am-a-puts-debuggerer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-03-19",path:"/posts/i-am-a-puts-debuggerer-kor",title:"[번역] 나는 'puts' 디버거다",tags:["Ruby","Debugging","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Gerald Weinberg 의  포스팅 의 번역본입니다 피드백은 언제나 환영합니다 제가 처음 이 질문을 Quora에서 보았을 때, 이미 4…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://en.wikipedia.org/wiki/Gerald_Weinberg">Gerald Weinberg</a>의 <a href="http://secretsofconsulting.blogspot.kr/2017/02/should-i-learn-c-or-python.html">포스팅</a>의 번역본입니다</strong></li>\n<li><strong>피드백은 언제나 환영합니다</strong></li>\n</ul>\n<hr>\n<p>제가 처음 이 질문을 Quora에서 보았을 때, 이미 47개 정도의 답변이 달려있었고 대부분의 답은 잘못되어 있었습니다. 하지만 이 많은 답변들은 여러분에게 무언가 시사하는 바가 있습니다. 프로그래밍 언어를 선택하는 것은 기술적이라기보단 종교적인 질문에 가깝다는 겁니다. 사실 당신이 전문적인 프로그래머가 되고자 한다면 두 언어를 동시에 배워야 합니다.</p>\n<p>우리가 프로그래밍을 가르칠 때는 언제나 두 언어를 동시에 가르칩니다. 과제는 반드시 두 가지(혹은 그 이상의) 언어로 작성되어야 하며, 왜 언어마다 해결법이 다른지, 혹은 왜 같은지 설명하는 에세이를 같이 첨부하도록 합니다. 이 방법으로 여러분의 전문적 코딩 지식과 성숙도를 발전시킬 수 있습니다.</p>\n<p>일부 답변자들은 프로그래밍 언어는 도구에 불과하다고 주장합니다. 만약 그 비유가 맞다면, 목수가 되고자 하는 사람들이 이런 질문을 할 때 어떻게 대답해야 할까요?</p>\n<blockquote>\n<p>"제가 톱질하는 법을 배워야 할까요? 아니면 나사돌리개 쓰는 법을 배워야 할까요?"</p>\n</blockquote>\n<p>둘 중에 하나만 배운 사람이 최고 수준의 목수가 될 수 있을까요?</p>\n<p>그러니 이 결론이 날 리 없고 유사종교스러운 논란을 멀리하는 대신에, 여러분의 소중한 시간을 가능한한 많은 프로그래밍 언어를 배우는데 쓰도록 하십시오. 최소한 다섯 개에서 여섯 개 정도를 배우세요. 모든 언어를 반드시 사용할 필요는 없지만, 언어별로 다른 접근방식을 알게 되면 이런 바보같은 말은 하지 않게 될 것입니다: </p>\n<blockquote>\n<p>"저는 X라는 언어만 알고 있어요, 그리고 여전히 이 언어가 세상에서 가장 뛰어난 언어라고 생각합니다."</p>\n</blockquote>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>요즘은 시간이 너무나 빨리 지나가버려서 1주일에 한 개 정도 번역을 하겠다는 다짐을 지키지 못하게 되는 때가 잦습니다. 다시 번역에 시동을 걸면서 이번에는 짧지만 의미있는 글을 번역해보았습니다.</p>\n<p>우연히 이 글을 보게 되었을 때 \'이 나이 지긋한 어르신은 누구신가\' 하고 찾아보니 명망있는 IT 컨설턴트시더군요. 병환으로 사경을 헤메신 적이 있다고 하는데 아직까지는 잘 계십니다. 최근 트윗을 보니 병원에 다시 투병중이신가 봅니다. 쾌차하시길 바랍니다.</p>\n<p>\'프로그래밍 언어는 도구에 불과하다\' 라는 말을 다른 분에게 들었을 때는 이 글에서 이야기하고자 하는 뉘앙스와 약간 달랐습니다. \'개발에 필요한 원리를 숙지하고, 실무에서 필요한(혹은 가장 빠르게 적용 가능한) 언어를 익혀서 금방금방 적용할 수 있어야 한다.\' 라는 뜻으로 말씀을 하셨었지요. 어느 쪽이든, 결론적으로 다양한 언어를 접하는 것은 프로그래머로서 사고의 폭을 넓히기 때문에 도움이 된다는 뜻이라고 생각합니다.</p>\n<p>취지는 좋지만 현실적인 문제를 생각해보면.. 시간이 부족하다는 장벽이 있겠지요. 이럴 때는 조급한 마음가짐을 잠시 내려놓고 배움의 호흡을 길게 가져가야 할 것 같습니다. 제가 이 글의 번역을 하겠다고 허락을 구하기 위해 메일을 보낼 때 주고받았던 메일 일부를 발췌해 보았습니다.</p>\n<blockquote>\n<p>Rinae: (중략) 저는 루비와 자바스크립트라도 동시에 익혀나가고 있습니다. 하지만 쉽지는 않네요.</p>\n<p>Gerald: 음, 그 두개면, 충분히 제가 추천한 방식대로 하고 있군요. 앞서 언급했듯이 같은 일을 양쪽 언어로 구현해보세요. 그렇다고 무조건 구체적으로 작성할 필요도 없지만, 최소한 서로 다른 두 언어가 어떻게 다른지 이해하고 최소한의 스케치라도 디자인할 수 있을 정도가 되어야 합니다.</p>\n<p>그리고 이렇게 하는 게 아주 어렵다고 느껴진다면 최소한 앞의 두 언어가 익숙해질 때 까지는 세 번째 언어를 배우지 않도록 하세요.</p>\n</blockquote>\n<blockquote>\n<p>Rinae: 새로 배울 언어를 추천해주실 수 있나요?</p>\n<p>Gerald: 기존에 알고 있던 언어와 가능한한 다른 언어를 고르세요. 다른 언어를 고르기 위해 인터넷에서 찾아보거나 프로그래머 지인들에게 그 사람들이 알고 있는 언어를 물어보세요. 그 대신에 지금 알고 있는 언어와 너무 비슷한 언어를 고르게 된다면 헷갈리기만 할 겁니다<em>(역주: 언어의 문법이 다른 정도만 헷갈리고 나머지는 별 의미 없을 것이라는 의미로 보입니다)</em>.</p>\n</blockquote>\n<p>이 글의 저자는 이후에 다른 글 <a href="http://secretsofconsulting.blogspot.kr/2017/02/how-long-can-i-remain-ruby-java-c.html">\'How Long Can I Remain a [Ruby, Java, C++, Python, …]  Programmer?\'</a> 를 작성하여 더 깊게 생각할 거리를 던져주었습니다. 이 글의 후속편이라고 할 수 있겠지만, 굳이 번역하지는 않을거라 한번 읽어보시면 좋겠습니다. 저 글의 한줄 요약을 남겨드리자면 이렇습니다.</p>\n<blockquote>\n<p>"특정 언어의 프로그래머로 몇년 먹고살 수 있을지 전전긍긍하지 말고 ‘Programmer’ or ‘Problem-solver’ 같은 사람이 되어 살아남을 생각을 하라\'\'</p>\n</blockquote>',id:"/home/circleci/repo/src/pages/posts/2017-03-11-should-i-learn-c++-or-python-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-03-11",path:"/posts/should-i-learn-cpp-or-python-kor",title:"[번역] C++와 Python 중 무엇을 먼저 배울까?",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 포스트는  Ian C. Anderson…",html:'<ul>\n<li><strong>이 포스트는 <a href="https://twitter.com/IanCAnderson">Ian C. Anderson</a>의 <a href="https://robots.thoughtbot.com/beginners-mind">글</a>을 번역한 것입니다</strong></li>\n<li><strong>번역에 관한 감상 및 피드백은 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>저는 루비 프로그래머입니다. 저는 이 언어를 즐겨 쓰며, 직업적으로 소프트웨어를 만들면서 루비가 저의 호기심과 흥미를 충족시켜준다고 믿고 있습니다. 저는 매일 끊임없이 루비와 레일즈에 대해 배우고 있지만 이 언어와 플랫폼에 대해서는 잘 이해하고 있습니다.</p>\n<p>그러다가 최근에 하스켈을 배우기 시작했습니다. <a href="https://thoughtbot.com/">Thoughtbot</a>의 하스켈 프로젝트에 기여하고 싶었고, 제 시야를 확장해보고 싶었기 때문입니다.</p>\n<p>하스켈은 근본적으로 루비와 다릅니다. 순수한 함수형 언어이며 엄격한 정적 타입을 요구합니다. 루비가 동적 타입을 가지고 있고 함수형과는 거리가 먼 객체지향 언어라는 것과는 다릅니다. 제가 함수형 언어를 다루는 수준은 아주 미약합니다. 그래서 함수형 언어의 여러 개념과 하스켈이란 언어 자체가 저에게는 생소합니다.</p>\n<p>현 시점에서 하스켈 세계는 신비롭고 경이롭게 느껴집니다. 그래서 그런지 배우고자 하는 사람들에게는 동기부여와 흥분되는 기분을 가져다 줄 겁니다.</p>\n<h2 id="무한한-가능성"><a href="#%EB%AC%B4%ED%95%9C%ED%95%9C-%EA%B0%80%EB%8A%A5%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무한한 가능성</h2>\n<blockquote>\n<p>초심자의 마음속에는 많은 가능성이 자리잡고 있다, 그러나 전문가들은 그 가능성이 적다.(In the beginner’s mind there are many possibilities, but in the expert’s there are few.)</p>\n<p>— <em>Shunryu Suzuki, <a href="https://www.amazon.com/Zen-Mind-Beginners-Shunryu-Suzuki/dp/1590308492">Zen Mind, Beginner\'s Mind.</a></em></p>\n</blockquote>\n<p>이 인용문은 당신이 공부하고 있는 주제에 익숙해질 수록 점점 좁은 시야를 가지게 되는 것을 경계하고 있습니다. 저의 경우엔 문제 해결을 위한 만능 도구로서 루비를 갈고 닦으면서도, 언제나 제 기술적 선택에 만족하지 않도록 신경씁니다. 언제든지 더 나은 방법이 있다고 <em>믿으며</em> 그 방법을 찾아야 합니다.</p>\n<h2 id="전문가의-모순"><a href="#%EC%A0%84%EB%AC%B8%EA%B0%80%EC%9D%98-%EB%AA%A8%EC%88%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전문가의 모순</h2>\n<blockquote>\n<p>모순되게도 마치 좁은 시야와 선입견을 가지게 되는 것처럼, 아주 탄탄하게 쌓아올린 전문 지식은 퍼포먼스의 저하를 초래할 수 있다.(Paradoxically, the very underpinning of expertise can entail degradation in performance as well, such as tunnel vision and biases.)</p>\n<p>— <em>Itiel E. Dror, <a href="https://core.ac.uk/download/pdf/1717017.pdf">The paradox of human expertise: Why experts get it wrong</a></em></p>\n</blockquote>\n<p>지식이 늘어날 수록 무엇이 어떻게 동작하는 지에 대해 추측하는 일도 늘어납니다. 이런 선입견들은 전문가로서 효율적으로 정보를 처리하고 문제를 푸는데 능숙하게 만들어 줄 수도 있습니다. 그러나 "기본적인(defaults)" 해답은 전문가들에게 주어진 문제를 해결하기 위한 더 적절한 답을 고민하지 못하게 만들 수 있습니다. 전문가들의 뇌는 특정 분야에 특화되어 있습니다. 말하자면 좁고 엄격한 마음가짐을 가지게 된다는 겁니다.</p>\n<h2 id="정신적-기민함의-가치"><a href="#%EC%A0%95%EC%8B%A0%EC%A0%81-%EA%B8%B0%EB%AF%BC%ED%95%A8%EC%9D%98-%EA%B0%80%EC%B9%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정신적 기민함의 가치</h2>\n<blockquote>\n<p>지능의 척도는 변화할 수 있는 능력이다.(The measure of intelligence is the ability to change.)</p>\n<p>— <em>Albert Einstein</em></p>\n</blockquote>\n<p>저는 thoughbot의 <a href="https://thoughtbot.com/playbook#research">Research Trello board</a>가 생각났습니다. 우리는 이 장소를 우리가 진행하는 일이나 기술 스택의 변화를 실험하는 장소로 사용합니다. 우리는 어떤 툴을 사용하고 어떻게 사용하는지에 대해 고집스럽게 굴지만<em>(역주: 예를 들면 Thoughtbot의 개발자들은 대부분 Vim을 사용한다고 합니다)</em>, 언젠가 더 좋은 도구가 있다면 기꺼이 갈아탈 용의가 있습니다.  과학적 방법을 통해 지속적으로 우리 자신의 가설에 도전하는 것은, 우리가 주어진 문제를 해결하기 위해 현재와 미래에 걸쳐 최선의 도구와 기술을 사용하고 있다는 확신을 들게 합니다. 기술 분야에서 변화는 피할수 없습니다. 그러므로 이런 정신적 기민함은 굉장히 가치있는 자산입니다.</p>\n<h2 id="당신의-지혜-주머니를-키워라"><a href="#%EB%8B%B9%EC%8B%A0%EC%9D%98-%EC%A7%80%ED%98%9C-%EC%A3%BC%EB%A8%B8%EB%8B%88%EB%A5%BC-%ED%82%A4%EC%9B%8C%EB%9D%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>당신의 지혜 주머니를 키워라</h2>\n<blockquote>\n<p>… 몇몇 경우에 지혜롭게 모나드의 힘을 적용하면 우리는 중첩된 콜백을 풀어낼 수 있고, 코드의 일부분을 재사용가능하게 만들며, 전반적으로 우리의 프로그램을 더 좋게 만듭니다.</p>\n<p>— Tom Stuart, <a href="http://codon.com/refactoring-ruby-with-monads">Refactoring Ruby with Monads</a></p>\n</blockquote>\n<p><a href="https://en.wikipedia.org/wiki/Monad_(functional_programming)">모나드</a>는 함수형 프로그래밍의 추상 개념인데 하스켈에서 필수적입니다. <a href="http://codon.com/refactoring-ruby-with-monads">Tom의 발표</a>에서 모나드를 이용하여 이상한 루비 코드 덩어리들을 멋진 해법으로 바꾸는 세 가지 실전적인 예시를 볼 수 있습니다. Tom의 코드가 그가 경험한 함수형 프로그래밍의 도움을 받았다는 것은 자명합니다. 그는 평상시의 문제를 해결하기 위해 다른 개념을 빌려올 수 있다는 것을 보여주었습니다. 이상적인 루비 코딩 스타일을 유지하면서요.</p>\n<p>제가 하스켈 전문가가 될 수 있을까요? 아니면 제가 하스켈 프로젝트를 풀 타임으로 다루게 될까요? <a href="https://robots.thoughtbot.com/if-you-gaze-into-nil-nil-gazes-also-into-you">아마도요</a>. 만약 아니라고 해도 하스켈을 배운 경험이 무의미하다고 생각하진 않을 겁니다. 저는 제 지혜 주머니를 키우고 있고(I am adding to my bag of tricks), 그래서 다각도로 문제를 해결해볼 수 있습니다. 제가 어떤 레일즈 앱의 기능을 구현할 때 함수형 프로그래밍의 접근 방식이 저의 평소 객체지향적 코드보다 더 나을지 생각해 볼 것입니다.</p>\n<p>전문가가 되기 위해 분투하는 것은 가치있는 일입니다. 그 비결은 끊임없이 특정 경우에 더 나을 수도 있는 대안을 찾아가면서, 더욱 많은 지식과 경험을 흡수하는 것입니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>저도 루비 프로그래머입니다(쑥스럽지만 원본 글 첫머리를 빌려서 한마디 적어봅니다). 매일 새로운 것을 1이라도 알면 그 뒤에 알아야 할 것들이 10이 넘는 하루하루를 보내고 있습니다. 하지만 나름 재미있지요. 당장 저의 주력 언어라고 말 할 수 있는 루비는 아직 잘 다룬다고 생각하지 않아서 더 깊게, 깊게 파고들어야 한다고 생각하고 있었습니다.</p>\n<p>물론 이 글에서 말하고자 하는 주제는 이미 알고 있었습니다만 언제나 \'아직은 다른 언어나 개념을 접하기엔 좀 부족해..\' 라는 생각을 하면서 고개를 돌리지 않고 있습니다. 올해 안에는 적어도 Elixir나 Scala에 도전해보고 싶긴 합니다. 물론 루비 이외에 다른 도전은 언제나 하고 있지요. 바로 자바스크립트입니다.</p>\n<p>저에게는 너무나 변화가 빠른 언어이고, 겉으로 보기에는 별거 없어 보이지만 다루고자 하면 굉장히 복잡하고(+골때리고) 코드를 잘 짜기 위한 고민을 계속 해도 잘 되지 않는 언어입니다. 지금은 이 두 언어를 번갈아 익히는 것 만으로도 벅차네요.</p>\n<p>제가 본격적으로 제 자신을 \'개발자\' 라고 지칭할만한 일을 하게 된지 이제 1년이 되었습니다. 이 시점에서 이번 글은 다시 한번 끊임없는 향상심에 대해 환기시켜주는 글이었습니다. 다음 해에는 어떤 글을 남길 수 있을지 제 자신에게 조금 더 기대를 걸어봅니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-02-20-beginners-mind-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-20",path:"/posts/beginners-mind-kor",title:"[번역] 초심자의 마음가짐",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 글은  Joël Quenneville 의  글 을 번역한 것입니다 번역 및 내용에 관한 피드백은 언제나 환영합니다 수 년에 걸쳐 저는  Elm 을 배워왔습니다. 보통 저는 새로운 언어를 배울 때 이러저러한 과정을 거칩니다: 튜토리얼을 따라가본다 많은 토이 프로젝트를 만든다 블로그 글을 읽는다 해당 언어의 주간 뉴스레터를 구독한다 그런데 기대하지 않던 순간에 제 고정관념을 바꾸는 일이 생겼습니다. 저는  elm-lang…",html:'<ul>\n<li>이 글은 <a href="https://twitter.com/joelquen">Joël Quenneville</a>의 <a href="https://robots.thoughtbot.com/learning-by-helping">글</a>을 번역한 것입니다</li>\n<li>번역 및 내용에 관한 피드백은 언제나 환영합니다</li>\n</ul>\n<hr>\n<p>수 년에 걸쳐 저는 <a href="http://elm-lang.org">Elm</a>을 배워왔습니다. 보통 저는 새로운 언어를 배울 때 이러저러한 과정을 거칩니다:</p>\n<ul>\n<li>튜토리얼을 따라가본다</li>\n<li>많은 토이 프로젝트를 만든다</li>\n<li>블로그 글을 읽는다</li>\n<li>해당 언어의 주간 뉴스레터를 구독한다</li>\n</ul>\n<p>그런데 기대하지 않던 순간에 제 고정관념을 바꾸는 일이 생겼습니다.</p>\n<p>저는 <a href="https://elmlang.herokuapp.com">elm-lang 슬랙 커뮤니티</a>에 가입하여 <code class="language-text">#beginners</code> 채널을 둘러보기 시작했습니다. 대부분의 질문이 "X를 위한 문법이 뭐죠?" 이거나 "Y를 하려면 어떻게 하죠?" 같은 질문이었습니다. 대부분은 공식 문서에 답이 적혀있는 질문들이었습니다.</p>\n<p>소프트웨어 산업에서 짬이 찬 대부분의 사람들과 같이, 저는 몇가지 기술을 연마해왔습니다:</p>\n<ul>\n<li>구글을 뒤적인다</li>\n<li>문서를 읽는다</li>\n<li>가설을 테스트하기 위한 작은 실험을 디자인한다</li>\n</ul>\n<p>![]({{ site.baseurl }}/assets/2017-02-13-sc1.png)</p>\n<p>사람들에게 그냥 "제발 그놈의 메뉴얼을 읽어보세요(<a href="https://ko.wikipedia.org/wiki/RTFM">RTFM</a>)", "구글은 여러분의 친구입니다" 혹은 "REPL(콘솔)에서 한번 쳐보세요" 같은 말을 하는게 편할 수도 있습니다. 그러나 이는 공감하기 힘들거나 자각하기 힘든 답변이 됩니다. 여러분이 당연하게 여기는 기술들은 다른 사람에게는 그렇지 않습니다. 특히 <code class="language-text">#beginners</code>  채널 같은곳에서 질문을 하는 사람들에게는요.</p>\n<p>그 대신에 저는 문서를 찾아서 해당 질문에 대해 적절한 답이 될 수 있는 부분의 링크를 공유해 주었습니다. 필요하다면 설명도 곁들였습니다. 그러면서 단순히 문법이나 함수에 대해 찾아주는 것을 넘어 더 개념적인 질문을 돕기 시작 했습니다:</p>\n<blockquote>\n<p>왜 컴파일러는 이벤트 핸들러를 위한 스니펫으로 타입 <code class="language-text">Html a</code> 를 쓰는 것을 좋아하지 않을까요?</p>\n</blockquote>\n<blockquote>\n<p><code class="language-text">&lt;select&gt;</code> 에다 이벤트를 어떻게 집어넣을 수 있나요?</p>\n</blockquote>\n<blockquote>\n<p><code class="language-text">type User = User String Int</code> 같은 중복은 어떻게 처리되나요?</p>\n</blockquote>\n<p>결과적으로 저는 빠르게 Elm의 문법과 코어 라이브러리에 관한 지식을 다질 수 있었습니다. 그리고 최근에 생겨난 <a href="https://robots.thoughtbot.com/elms-universal-pattern">패턴</a>에 대해 살펴보기 시작했습니다. 제가 전혀 몰랐던 라이브러리에 관해 도울 수도 있게 되었습니다.</p>\n<p>간단하게 <a href="https://ko.wikipedia.org/wiki/%ED%8D%BC%EC%A7%95">퍼즈 테스터</a>를 만들려면 어떻게 해야할까요? <code class="language-text">map</code> 작동에 대해서 알아야겠군요. JSON 디코더 3개를 엮으려 하신다구요? 아마 <code class="language-text">Json.Decode.map3</code> 함수가 있을걸요?</p>\n<p>점점 이런 작업이 편해지면서, 저는 단순히 문서만 살펴보는게 아니라 소스를 파고들어 왜 특정 행동이 특정 방법으로 작동하는지 설명하고자 하였습니다.</p>\n<p>시간이 흘러, 자주 질문이 들어온다고 느끼는 주제에 대해서 블로그 글도 작성했습니다. 이를테면 <a href="https://robots.thoughtbot.com/building-custom-dom-event-handlers-in-elm">\'커스텀 DOM 이벤트 핸들러를 작성하는 방법\'</a>처럼요.</p>\n<p>이러한 과정을 거치는 동안 <a href="https://robots.thoughtbot.com/beginners-mind">초심자의 마음가짐</a>을 유지하는 것은 중요합니다. 때때로, 질문에 대답하는 것은 함께 배워나가는 과정이었습니다. 저는 처음에는 답을 몰랐거나 아주 모호하게 이해하고 있었을 뿐이었지만 토론을 거쳐가면서 지식을 발전시킬 수 있었습니다. 다른 때엔 제가 대답할수 없었지만 지금은 알게 된 개념에 대해 설명하려고 노력했습니다. 겸손함과 \'잘 모르겠습니다\' 라고 말하는 능력은 질문 받는 상황(these situations)을 배움의 기회로 바꿀 수 있습니다.</p>\n<p>다른사람에게 조언하거나 도움을 주기 위해 "전문가"가 될 때까지 기다리지 마세요. 당신이 초보자라 하더라도 그 결과는 엄청납니다(The payoffs are massive). 끊임없이 배우고, 끊임없이 지식을 나누세요.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>사실 저는 Elm을 들어는 봤지만 제대로 사용해본 적은 없습니다. 함수형 프로그래밍의 개념에 대해서 가볍게 알아보고자 할 때 이러한게 있다 까지는 보았고, 호기심에 가벼운 튜토리얼을 따라가보았지만 아직 저에겐 너무 어려웠습니다.</p>\n<p>하지만 이 글의 내용은 Elm이랑 크게 관련 있는 것은 아니고, 개발자로서 끊임없이 배움의 과정을 걷는 사람들에게 생각할 거리를 준다는 느낌을 받아 번역을 해 보았습니다. 그래서 위의 Elm관련 번역은 부적절한 번역일 수 있으니 Elm을 사용해본 분들의 많은 조언 부탁드립니다.</p>\n<p>저 자신도 RORLAB 슬랙의 <code class="language-text">#question_answer</code> 채널에 질문이 올라오면 당장 제가 모르는 내용이라도 검색을 해 봅니다. 제가  답변했던 내용들 일부는 제가 실제로 해 본 것도 아니고, 구글에서 적절하게 검색하여 찾은 내용이지만 해당 질문을 한 회원은 문제를 해결할 수 있었습니다. 그러면서 제가 몰랐던 지식도 조금씩 알아나갈 수 있었고 개발 문서만 보는 것을 넘어서 소스를 들여다 보는데 거부감이 많이 줄어들게 되었습니다.</p>\n<p>이 글의 핵심은 마지막 문장이라 생각합니다. 저도 당연히 \'번역의 전문가\'가 아님에도 이러저러한 글을 번역해서 올리고 있습니다. 분명 더 예전에 번역했던 글들의 퀄리티를 생각하면 다시 하고 싶지만..시간상.. 넘어가도록 하고, 조금씩 찾아가고 물어가면서 퀄리티를 향상시키고자 하고 있습니다. 제가 작성하는 코드도 그렇게 되었으면 하는 바람입니다.</p>\n<p>다음에는 <a href="https://robots.thoughtbot.com/beginners-mind">\'초심가의 마음가짐\'</a>에 대한 글을 번역해보려 합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-02-13-learning-by-helping-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-13",path:"/posts/learning-by-helping-kor",title:"[번역] 도우면서 배우기",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Piotr Solnica 의  글 을 번역한 것입니다 번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다 저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://twitter.com/_solnic_">Piotr Solnica</a>의 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">글</a>을 번역한 것입니다</strong></li>\n<li><strong>번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma)을 비판하는 내용이었습니다. 이 글을 작성하기까지 오랜 시간동안 머리속으로 생각만 하고 있었지만, 이 주제가 아마도.. 알려져 있다는 것을 알고 있었습니다. 그래서 글을 작성하기 전에 구글에 검색을 해 보기로 마음먹었지요. 구글에 "ruby dependency injection"을 입력하면 이런 결과를 얻었습니다:</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 580px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 69.13793103448276%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVQ4y3VTiZKiQAzl//dr9jdmBl3EW+5DkQZUoLnxbRodC8exq14lXZCXl3QiGXYIe7eB5TgIggCmacGyLDiuC9dxkWUZ8jwf8NNP0wxVkUHzU/z5e4K8iSHlvMT5nOKScZR5Nvx4uaSDFSjLElVVDajrergLNE0zoOtaXPIGslEiPFWQMDodC9EJAgpsmxZt2z4IBKEgKIpiwPV6HWLu5nEk8aEnCNvUQsUtsG2FgpoUdHh3rvc4ga4nHoL0/UGcvRthO3dhbn1oKw++zaiP1FfDg771sFu7CI8JeFWAF5xI+pck0ncGcSzLgDyRoagK1IWK5WoJzdhBXZG/XWK5EXcNtmuDxRE450LOk9InwjQtwViKJM4JHDFZnnfUCjxAb/BS9riZT4RihCaqieXag6wYUBY2pnT/t9DJ1yHPNlgbNFa+iQM7PPp7Hb3MD4VnRFGIJGGkNCAcSWWIYxggDA/Y773BT7N0mEXxeOPHeSFkUY7FmsGwEhr0E0z7BM2M4e85DX2NiDVw7AKWWVDykborficMKPuOHsEjJZq5g+la0G2dElCJB6FwjziJiUwMfor23tC3JV9OOY5+jDik0oMzjl6C0E9w8CL4TojAjwb/nGRIWAaeVqOSfyF0XR/qfIX5fInpdAZVIX+2hqIs8Pk1wcenjC95itV6A1N3kERnMTTve5jTLjNavyhiNxszlDTEFaEsaZh5PmxS33cU09OG9aMVvNn/HCEucTH4uRcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc1"\n        title=""\n        src="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png"\n        srcset="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-0ca6d.png 198w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-45e8e.png 395w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png 580w"\n        sizes="(max-width: 580px) 100vw, 580px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>역주: 이 글은 2013년 12월에 작성되었으며, 현재 같은 검색어로 검색하면 결과물의 순서 및 노출되는 글이 다릅니다.</em></p>\n<p>저는 <a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">DHH(David Heinmeier Hansson, Ruby on Rails의 창시자)의 블로그</a>로 들어가 글을 다시 읽어보았습니다. 그 글에 대해 희미한 기억만 남아있었기 때문입니다. 그리고 나서야 저는 세상이 루비의 의존성 주입에 대한 다른 글이 필요하다는 것을 깨달았습니다. 왜 그럴까요? 대개 저 글을 읽고 많은 루비스트들이 루비의 의존성 주입에 대해 잘못된 인식을 가질 우려가 있기 때문입니다. 또한 의존성 주입이 뭔지 배워보고자 하는 사람들은 DHH의 블로그 글을 발견할테고, 루비에서의 의존성 주입이 "필요 없다" 라는 크게 잘못된 생각을 가질 수 있습니다. 네, 정말로 걱정되는 부분입니다.</p>\n<p>제가 이 글의 제목을 "루비의 의존성 주입"이라고 작성한 이유는 <strong>"루비의"</strong> 라는 부분이 꽤 중요하기 때문입니다. 루비의 의존성 주입은 아주 직관적인 실체를 가지고 있으며 여러가지 장점을 가지고 있습니다.</p>\n<p>아, 간단히 정리하자면:</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 외부 라이브러리도 쓸 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 설정도 할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드의 단순함을 희생할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드를 더 작성해야 할 필요가 없습니다.</p>\n<h2 id="루비의-의존성-주입은-아주-쉽다"><a href="#%EB%A3%A8%EB%B9%84%EC%9D%98-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85%EC%9D%80-%EC%95%84%EC%A3%BC-%EC%89%BD%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루비의 의존성 주입은 아주 쉽다</h2>\n<p>별로 대단한 건 없어요. 정말로요. 하지만 당신의 코드에 큰 영향을 줍니다. 자신만의 의존성을 갖는 객체를 만드는 것 보다 객체에 의존성을 주입 할 때 유연성은 증가하고 결합도는 낮아집니다. 더 나은 디자인을 채용하게 된 덤으로 테스트 하기도 쉬워지지요. 자주 일어나는 일입니다.</p>\n<p>한번 살펴보시죠:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 일반적인 접근</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> initialize\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n\n<span class="token comment"># 그리고 의존성 주입의 경우</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 뭔가 멋진 의존성 주입 라이브러리를 사용했나요? 아니죠. 우리가 코드를 더 작성했나요? 글쎄요. 아니면 코드가 더 복잡해졌나요? 확실히 아닙니다.</p>\n<p>작은 변화에 불과했지만 여러분의 코드에 <strong>큰 영향을 미칩니다.</strong> <code class="language-text">Hacker</code> 클래스는 더 이상 키보드를 만드는 방법에 종속될 필요가 없습니다. 그저 주어진 인터페이스를 사용하게 될 뿐이며, 우리는 키보드 인터페이스를 구현하기만 하면 어떤 것이든 편하게 집어넣을 수 있게 되었습니다. 이게 유연성이 증가하고 결합도가 낮아진다는 것을 뜻합니다.</p>\n<p>다 좋은데 그렇다면 키보드의 의존성은 어디서 만들어야 할까요? 분명 어디선가 만들어져야 할 텐데요?</p>\n<p>제가 사용하는 패턴은 이렇습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>layout <span class="token operator">=</span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> layout<span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>잠깐만요, 제가 코드를 더 작성하지 않아도 된다고 했나요? 제가 거짓말을 했네요. <code class="language-text">build</code> 메서드를 쓰기 위해 코드를 두 줄 정도 더 써버렸습니다. 들켰네요.</p>\n<p>그래도 일단 좋은 면만 보도록 합시다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 우리는 hacker 인스턴스를 아주 작은 노력으로 만들 수 있습니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">\'us\'</span><span class="token punctuation">)</span>\n\n<span class="token comment"># 만약 우리가 이미 키보드 객체를 가지고 있다면 이 방식으로도 작동합니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard_we_already_had<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>우리가 의존성을 명시적으로 드러냈기 때문에 테스트하기도 쉬워졌습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token comment"># 여기서는 키보드 객체가 큰 의존성을 가지고 있어서 그냥 mock으로 만든다고 칩시다</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>의존성 주입이 없었다면 어떤 모양으로 보일 지 생각해봅시다. 제가 끔찍한 예를 하나 들어보겠습니다. 그리고 저는 여전히 사람들이 이런 코드를 작성하는 것을 보곤 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n\t<span class="token comment"># 우웩!</span>\n    <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token function">should_receive</span><span class="token punctuation">(</span><span class="token symbol">:new</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">with</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">and_return</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><em>역주: 윗부분에서 <code class="language-text">Hacker</code> 클래스를 의존성 주입 없이 사용하는 예를 살펴보시면 ,<code class="language-text">Hacker</code> 클래스의 인스턴스를 작성할 때 동시에 <code class="language-text">Keyboard</code> 클래스의 인스턴스를 만든다는 것을 볼 수 있습니다. 그래서 <code class="language-text">keyboard</code> 라는 객체가 의도대로 생성되는지를 테스트하기 위해 이런 복잡한 코드가 들어가게 되었다고 생각합니다.</em></p>\n<h2 id="더-나아가서"><a href="#%EB%8D%94-%EB%82%98%EC%95%84%EA%B0%80%EC%84%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>더 나아가서</h2>\n<p>루비의 의존성 주입을 연습할 때 저는 몇몇 작은 패턴과 규칙을 정해놓고 따르고 있습니다.</p>\n<ul>\n<li><code class="language-text">.new</code> 메서드를 깔끔하게 유지하고, 오버라이드 하지 말 것. 단순한 의존성만 인자로 받아들인다</li>\n<li>빌더 메서드를 분리하여 만들고 이 메서드가 "모양빠지는" 입력들을 받아서, 해당 클래스의 객체가 필요로 하는 모든 것을 만들 수 있게한다</li>\n<li>빌더 메서드가 너무 복잡해지게 되면 빌드 로직을 서로 다른 객체로 분리한다</li>\n<li>생성자에 옵션 해시를 전달하는 것을 피한다</li>\n</ul>\n<p>이 규칙들은 제가 작성하는 코드에 크게 긍정적인 영향을 주었습니다. 결합도를 낮추었고, 유연성을 높였으며, 리팩토링도 쉬워졌습니다.</p>\n<p>사실 제가 이 글을 통해 작성한 간단한 예제만으로 위의 규칙이 말이 된다고 설득하는 것은 어렵습니다. 그러므로 일단 루비의 의존성 주입을 사용해보라고 권하고 싶습니다. 의존성 주입을 사용하는게 단순히 테스트할 때 이득을 보기 위해서라고 여기지 말아주세요. 제발요 :)</p>\n<p>제가 말하고 싶은 것은 루비의 의존성 주입은 하나의 미덕이라는 점입니다. 루비는 복잡한 일들을 간단한 방법으로 구현할 수 있는 아름다운 언어입니다. 반면에 테스트 할 때 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 을 사용하는 것은 그렇게 영리한 방법은 아닙니다.<em>(역주: <code class="language-text">stub</code> 메서드는 Rspec에서 일종의 객체 목업을 생성해주는 메서드로 알고 있습니다. 굳이 글쓴이가 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 메서드를 사용한다는 이야기를 꺼낸 것은 이 예시가 DHH의 포스트에 언급되어 있기 때문입니다.)</em></p>\n<p>물론 여러분이 루비의 의존성 주입을 사용하지 않을 수도 있지만, 실제로 사용해 보시면 더 깔끔하고 명시적인 코드를 작성하실 수 있습니다. 여러분의 코드는 더 좋아질 겁니다.</p>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>저는 언제나 기본적인 컴퓨터 과학 및 좋은 프로그래밍 방법론에 대한 지식이 부족하다는 점을 통감하고 있습니다. 단순히 전공자가 아니기 때문인 것도 있지만, 지속적으로 개발을 제대로 하려면 이러한 지식이 반드시 필요하다고 생각하고 있기 때문입니다. 이런 점에서 최근에 좀 더 알아보고 싶던 주제가 \'의존성 주입\' 입니다.</p>\n<p>자바 스프링 프레임워크를 사용할 때 주로 \'의존성 주입\' 이라는 단어가 많이 나왔을겁니다. 그런데 제가 제대로 쓸 수 있는(정말일까?) 유일한 언어인 루비는 어떻게 의존성 주입을 사용하는지 궁금하여 찾아보다 이 글을 발견하게 되었습니다.</p>\n<p>번역 과정 자체는 무난했는데 후반부에 "Stub Time.now" 라는 말의 뜻을 이해하지 못하겠더군요. 알고보니 두 가지 문제가 있었습니다.</p>\n<ol>\n<li>RSpec을 제대로 써 보지 않았다</li>\n<li>DHH의 글을 먼저 읽어보지 않았다</li>\n</ol>\n<p>글 작성자에게 더 자세한 설명을 부탁했더니 이런 답변을 받았습니다. 참고하시기 바랍니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 94.36619718309859%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACa0lEQVQ4y3WUSY7bQAxFfaoE2TSycLctz7Ykz5ItWZ4yLAIEyKKBIAfIKifITRk+uijIcGdBsarE+kV+/qrWcj6Xn6+vslosZDoeSxrHskhTSdTHs5kkapPRSPpRJINe78FY538Sz2TY70sr225lk8Yym0wkzzJJk8SA3QgmMOp0pNft1t6N+WgwsP0c0GLx49OTdF9eZL1cylwBxwpCwHg4NEAHj6dTy5gx//nHGnOADZAPJ+C3m41cLxepylJOx6NZdSjloHPWL6dTbdfzWc4hhiRIrAZ0fsr9Xs4aXB0OBsqGi27MoWW1Mp7hnEoYQxcZdp6faz5rQIxNgJJpsdvJLs9lp7wuFKRZCQav7BkpLZTs87sMOXW7XkumgJ7RhrlmUuhBZMo4b87D4VPllLLvAPmZhw1k5pvxlMl/DtmHzKmGKvZUo/M7DkmZQBrAifCIZ+2oYzYBgIfnt9Tw0BQvGaAbh9ktG7IInv9lUVjJNAhg1hjXHLqR1efr1QIokSCMm+NzdIg3EE3gARAiETUTbgnNYMwaYsUYu/kcqTTXah2mo0j+/vmt/BTGB2Wb3oInA/hFHuNgyMfG4VqiRWINcBFP5NePb7aRLh6UH+xYVXJS40bQlE96UxA66zTHGwS3ANUZ9rqRtNttK3Ot5RKAsJGBd9bGKEAPQkbcIjj1cpsvUYsJfOAh18XqmgQMceMpy8HzoEOsCNlaU7g2XHx4gEO6yJvY9MQ4f/6kufbsLQzvpmWIpr5//XKTSLgF9oypVADE2ARHZODvoN9/SqY5xNkDy+KH9++MD7ijBE5vPqT/e62br7bH/QPWe/MwJaRjfAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc2"\n        title=""\n        src="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png"\n        srcset="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-d16f8.png 198w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-f21b1.png 395w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png 790w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ee9f1.png 994w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>루비의 의존성 주입에 대한 이야기는 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a> 책에도 조금 설명되어 있습니다. 루비로 프로그래밍을 하신다면 두번 이상은 읽어보시길 추천드립니다.</p>\n<p>참고 링크:</p>\n<ul>\n<li><a href="http://www.slideshare.net/hnki0104/ss-42101768">주니어 개발자도 이해할 수 있는 의존성 주입</a></li>\n<li><a href="https://medium.com/@Bakku1505/introduction-to-dependency-injection-in-ruby-dc238655a278#.ywoosbc3h">Introduction to dependency injection in Ruby</a></li>\n<li><a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">Dependency injection is not a virtue</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-02-04-the-world-needs-another-post-about-dependency-injection-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-04",path:"/posts/the-world-needs-another-post-about-dependency-injection-in-ruby-kor",title:"[번역] 세상은 루비의 의존성 주입에 대한 다른 글을 원한다",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Cezar Halmagean…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://twitter.com/chalmagean">Cezar Halmagean</a>의 <a href="https://mixandgo.com/blog/mastering-ruby-blocks-in-less-than-5-minutes">포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>블록은 루비에서 가장 강력한 기능이지만 대수롭지 않게 여겨지는 기능이기도 합니다. 고백컨데 저도 루비 블록이 어떻게 동작하는지, 그리고 실제로 어떻게 유용하게 사용될 수 있는지 알아내는데 시간이 좀 걸렸습니다.</p>\n<p>처음에 블록을 이해하는데 굉장히 어렵게 만드는 요소로 <code class="language-text">yield</code> 등의 개념이 있습니다. 저는 블록의 일부 개념에 대해 이야기하고 몇몇 예시를 들어서 글 마지막에는 여러분이 루비 블록을 명확하게 이해하도록 돕겠습니다.</p>\n<h2 id="무엇을-배울-것인가"><a href="#%EB%AC%B4%EC%97%87%EC%9D%84-%EB%B0%B0%EC%9A%B8-%EA%B2%83%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무엇을 배울 것인가</h2>\n<ol>\n<li>\n<p>기초: 루비 블록이란?</p>\n</li>\n<li>\n<p><code class="language-text">yield</code> 가 동작하는 방법</p>\n<ul>\n<li>블록을 메서드로 전달하기</li>\n<li><code class="language-text">yield</code> 도 매개변수를 받는다</li>\n</ul>\n</li>\n<li>\n<p><code class="language-text">&amp;block</code> 은 무엇을 의미하는가?</p>\n</li>\n<li>\n<p>값의 반환</p>\n</li>\n<li>\n<p><code class="language-text">.map(&amp;:something)</code> 은 어떻게 동작하는가?</p>\n</li>\n<li>\n<p>반복자, 그리고 여러분의 반복자를 직접 만들기</p>\n</li>\n<li>\n<p>블록을 이용하여 기본값으로 객체를 초기화하기</p>\n</li>\n<li>\n<p>루비 블록 예시</p>\n<p>​</p>\n</li>\n</ol>\n<h2 id="기초-루비-블록이란"><a href="#%EA%B8%B0%EC%B4%88-%EB%A3%A8%EB%B9%84-%EB%B8%94%EB%A1%9D%EC%9D%B4%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기초: 루비 블록이란?</h2>\n<p>블록은 기본적으로 <code class="language-text">do</code> 와 <code class="language-text">end</code> 사이에 들어가는 코드입니다. 그게 다에요. <em>"그럼 마법같은 일(Magic)은 어디서 일어나는거죠?"</em> 라고 질문하실 수 있겠습니다. 우리는 몇 분 이내에 그 부분을 파고들겠지만 차례대로 설명하겠습니다(but first things first).</p>\n<p>여러분은 블록을 두 가지 방법으로 작성할 수 있습니다. 1. 멀티-라인으로 작성할 때는 <code class="language-text">do</code> 와 <code class="language-text">end</code> 사이에 코드를 작성하고, 2. 인라인으로 작성할 땐 <code class="language-text">{</code> 와 <code class="language-text">}</code> 사이에 코드를 작성하면 됩니다.</p>\n<p>이 두 가지 작성 방법은 정확하게 똑같이 작동합니다. 그래서 어느 방법을 고를 지는 여러분의 선택에 달려 있습니다. 일반적인 스타일 가이드에 의하면 가독성을 위해 코드가 한줄 이상 넘어가면 <code class="language-text">do</code> ~ <code class="language-text">end</code> 를 이용하여 작성하는 것이 좋습니다.</p>\n<p>멀티 라인 블록의 기본적인 예시는 이렇습니다: <code class="language-text">[1, 2, 3].each do |n| puts &quot;Number #{n}&quot; end</code></p>\n<p>이 블록이 멀티 라인 블록이라 불리는 이유는 한 줄 이상으로 코드가 작성되어서가 아니고 인라인 블록이 아니기 때문입니다. 같은 예시를 인라인으로 작성할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token punctuation">{</span> <span class="token operator">|</span>n<span class="token operator">|</span> puts <span class="token string">"Number <span class="token interpolation"><span class="token delimiter tag">#{</span>n<span class="token delimiter tag">}</span></span>"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>두 가지 버전 모두 1, 2, 3을 순서대로 출력할 겁니다. 파이프 사이에 있는 소문자 n(<code class="language-text">|n|</code>)은 <strong>블록 매개변수(block parameter)</strong> 라고 불리고, 이 예시에서는 배열 안에 있는 각각의 번호가 순서대로 나오게됩니다. 그래서 처음 반복 시에 <code class="language-text">n</code> 의 값은 1이 되고, 두번째 반복에서는 2가 되고 그 다음엔 3이 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nNumber 1\nNumber 2\nNumber 3\n =&gt; [1, 2, 3]</code></pre>\n      </div>\n<h2 id="yield가-동작하는-방법"><a href="#yield%EA%B0%80-%EB%8F%99%EC%9E%91%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yield가 동작하는 방법</h2>\n<p>이제 위험한 녀석이 왔습니다(Here\'s bad wolf). 이 녀석이 루비 블록의 마법스러움과 혼란스러움을 가져다주는 주범이지요. 제 생각엔 대부분 <code class="language-text">yield</code> 가 블록을 호출하는 방법과 어떻게 매개변수를 전달하는지가 어렵게 보일 것이라 생각합니다. 우리는 이 섹션에서 두 가지 시나리오를 모두 살펴볼겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> my_method\n  puts <span class="token string">"reached the top"</span>\n  <span class="token keyword">yield</span>\n  puts <span class="token string">"reached the bottom"</span>\n<span class="token keyword">end</span>\n\nmy_method <span class="token keyword">do</span>\n  puts <span class="token string">"reached yield"</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nreached the top\nreached yield\nreached the bottom\n =&gt; nil</code></pre>\n      </div>\n<p>기본적으로 <code class="language-text">my_method</code> 메서드가 실행되고 <code class="language-text">yield</code> 를 호출하는 줄에 도달하면, 블록 안에 있는 코드가 실행됩니다. 그리고 블록 안의 코드가 끝나면 <code class="language-text">my_method</code> 메서드가 계속 실행됩니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 492px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 42.07317073170732%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVQoz32R2U7DMBRE8///hQRCFYtQS6GlNdlIGy9xFsd2msHXooiH0iuNLCfO8egkQZjT6YRBDbC6hWsVnKjhGonJOXhnMY4mxpghnv1v5nlGct6UrARbr5AWb3jfPWGfvWKvCmTNF5wfMZ8mWGvQdV2Aj9Bao23bGHo2TVPkJN778IHFITuAPWY4hGZFX6PqBEp9jFFDE88QkHMOKSUYY0jTFEVRIM9zVFUV2yfWWkzh9mKXY7f+QKZKbGoGJnPsf7LhnzBugLNjaKTR9/0vWCkVQ3tiJS54orpGGvjRk4lw0wQfGpE/Z2l1cSWP5OnaRCBVlUpACI48S8GrI8bWxEYUG5zRD6GcXRH4UiJQSIHl8gWLxT1unu9wu3rAtkixFSE8eGrIjw8NB5Dzq0B6SVCeCui6gZ0ttG3RGA3VN5C9Qme6qICAfxtemm+oSGlJM6/67gAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 01 26 sc1"\n        title=""\n        src="/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-806d2.png"\n        srcset="/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-e0e3b.png 198w,\n/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-4f7b9.png 395w,\n/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-806d2.png 492w"\n        sizes="(max-width: 492px) 100vw, 492px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="블록을-메서드로-전달하기"><a href="#%EB%B8%94%EB%A1%9D%EC%9D%84-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A1%9C-%EC%A0%84%EB%8B%AC%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블록을 메서드로 전달하기</h3>\n<p>블록을 매개변수로 받기 위해 메서드에 특별히 무언가를 정의할 필요는 없습니다. 그냥 블록을 함수(메서드)로 전달할 수 있습니다. 하지만 그 함수가 <code class="language-text">yield</code> 를 호출하지 않으면 블록은 실행되지 않을겁니다.</p>\n<p>반면에 메서드에 <code class="language-text">yield</code> 를 호출하도록 해놓으면 블록을 인자로 전달하는 것이 강제됩니다. 이 메서드가 블록을 매개변수로 받지 않는다면 에러가 발생하게 됩니다.</p>\n<p>만약 블록을 매개변수로 받는 것을 가변적으로 처리하고 싶다면 <code class="language-text">block_given?</code> 메서드를 사용할 수 있습니다. 이 메서드는 블록이 메서드로 전달되었는지를 따져 true나 false를 리턴합니다.</p>\n<h3 id="code-classlanguage-textyieldcode-도-매개변수를-받는다"><a href="#code-classlanguage-textyield%1Ccode-%EB%8F%84-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%EB%A5%BC-%EB%B0%9B%EB%8A%94%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">yield</code> 도 매개변수를 받는다</h3>\n<p>어떠한 매개변수든지  <code class="language-text">yield</code> 로 전달되면 블록의 매개변수처럼 동작할 것입니다. 그래서 블록이 실행될 때 원래 메서드로(yield를 호출하는 메서드)부터 전달되는 매개변수를 사용할 수 있습니다. 즉 매개변수는 <code class="language-text">yield</code> 가 자리잡고 있는 메서드의 지역 변수가 될 수도 있다는 뜻입니다.</p>\n<p>전달되는 매개변수의 순서는 중요합니다. 왜냐면 여러분이 전달하는 매개변수의 순서가 블록이 매개변수를 전달받는 순서와 일치하기 때문입니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 475px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 43.15789473684211%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACF0lEQVQoz2NYPnGm+LKZEfzLpyUKbuqLEl0+LUtw2uJ2vnmz+wXmzO3jnzu3TwCI+WfP7hPs7W3lZQCCBQumMuAERxsPO12s6XO6UNdtd7mqzvN8Q6f53iVbxbfv6+ffsX2W4I4dMwRAeOfOOcKVlXkSID3////HbeCp2ite5xpvmJ1tvap7puWO4dmeiypnZhySPP2qi+PYoXk8R47M5Dl1ag732bNLeWtqCkQZCIENXetUWvZEc3dsTeHt3B7HM2V1Jf/CtT0CSxdNFd6wYZ7gli2LBJYvnyq4cuVMkbKyfBGCLgSB5c5PGC9N+s9Q4nOAkYEBrIcFiJmAWBiIQd5kB2KgHAOruLgoSJyhoqKCob29naGtrQ2MYWyG5fMW8s/o6+LtyS3hW9U8hffo1M28XpaOCjNLWvjbsssF61PyhVpzCvjbi0oFU9MSeQh6WUVb3EhVT8lSylbJISIx2Wpp1zaLhc0b7aZ1rjBf1bLLsWvGTNWYjelihasqpObOmSheWdnM3N7RxgF0DR/QVSCaB4h5gWwQzcKQ75Pr4hLmoGy+MFbTdFq4js2saHWbmTEaelNDjKymR2tbzIjUMp8Rqek2J0F17pR+mfqmZqDmNnGgZlkgFgZiGSCWA/GBhnIxHOg5qrZ300q+gwvm8x1ctJBv18K5fLuB+BCQvWPhbL49C+fx7V04n2/zvFmCU6Z28xLyMQBX/95WW5u5bgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 01 26 sc2"\n        title=""\n        src="/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-7203d.png"\n        srcset="/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-93713.png 198w,\n/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-ae0be.png 395w,\n/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-7203d.png 475w"\n        sizes="(max-width: 475px) 100vw, 475px"\n      />\n    </span>\n  </span>\n  </p>\n<p>한가지 유의하셔야 할 점은 블록 안의 매개변수는 블록에만 한정된 지역 변수가 된다는 겁니다. (메서드에 있던 지역 변수를 블록으로 전달할 때와는 다릅니다)</p>\n<h2 id="block은-무엇을-의미하는가-ampersand-parameter"><a href="#block%EC%9D%80-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%9D%98%EB%AF%B8%ED%95%98%EB%8A%94%EA%B0%80-ampersand-parameter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>&#x26;block은 무엇을 의미하는가? (ampersand parameter)</h2>\n<p>여러분은 아마 다른 루비 코드 여기저기에 <code class="language-text">&amp;block</code> 이 사용된 것을 보셨을 겁니다. 이 것은 지역 변수 대신에 블록에 대한 참조(reference) 자체를 메서드로 전달하는 방식입니다. 사실 <strong>루비는 블록처럼 작동하는 어떠한 객체라도 메서드에 전달되는걸 허용합니다.</strong> 메서드가 전달받은 객체가 블록이라면 이 블록을 사용하려 할 것이지만, <em>만약 블록이 아니라면 그 객체에 <code class="language-text">to_proc</code> 메서드를 호출하여</em> 블록으로 변환하려고 시도할 것입니다.</p>\n<p>또 참고하셔야 할 점은 <code class="language-text">block</code> 이라는 이름은(ampersend(&#x26;) 기호 이외의 부분) 단지 참조를 위한 이름일 뿐입니다. 여러분이 좋아하는 어떠한 이름이라도 사용하실 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">my_method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>block<span class="token punctuation">)</span>\n  puts block\n  block<span class="token punctuation">.</span>call\n<span class="token keyword">end</span>\n\nmy_method <span class="token punctuation">{</span> puts <span class="token string">"Hello!"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n#&lt;Proc:0x0000010124e5a8@tmp/example.rb:6&gt;\nHello!</code></pre>\n      </div>\n<p>위의 예를 보시다시피, <code class="language-text">my_method</code> 안에 있는 <code class="language-text">block</code> 변수는 블록의 참조이고, 이 블록은 <code class="language-text">call</code> 메서드를 통해 실행될 수 있습니다. 블록에 <code class="language-text">call</code> 을 하는 것은 <code class="language-text">yield</code> 와 똑같은 겁니다. 일부 사람들은 가독성을 위해 <code class="language-text">yield</code> 대신에 <code class="language-text">block.call</code> 을 사용합니다.</p>\n<h2 id="값의-반환"><a href="#%EA%B0%92%EC%9D%98-%EB%B0%98%ED%99%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>값의 반환</h2>\n<p><code class="language-text">yield</code> 는 블록 안에서 마지막으로 평가된 값(last evaluated expression)이 반환됩니다. 달리 말하면 <code class="language-text">yield</code> 가 리턴하는 값은 블록이 리턴하는 값이라는 겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> my_method\n  value <span class="token operator">=</span> <span class="token keyword">yield</span>\n  puts <span class="token string">"value is: <span class="token interpolation"><span class="token delimiter tag">#{</span>value<span class="token delimiter tag">}</span></span>"</span>\n<span class="token keyword">end</span>\n\nmy_method <span class="token keyword">do</span>\n  <span class="token number">2</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nvalue is 2\n=&gt; nil</code></pre>\n      </div>\n<h2 id="mapsomething은-어떻게-동작하는가"><a href="#mapsomething%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%8A%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.map(&#x26;:something)은 어떻게 동작하는가?</h2>\n<p>여러분은 아마 <code class="language-text">.map(&amp;:capitalize)</code> 같은 단축 표현을 많이 쓰셨을 겁니다. 특히 레일즈로 코딩을 좀 해보셨다면 말이죠.  <code class="language-text">.map { |title| title.capitalize }</code> 에 비하면 아주 깔끔한 단축 표현입니다.</p>\n<p><strong>그런데 이게 어떻게 작동하는걸까요?</strong></p>\n<p>실제로는 <a href="http://ruby-doc.org/core-2.2.0/Symbol.html#method-i-to_proc">심볼 클래스가</a> <code class="language-text">to_proc</code> 을 메서드를 구현하고 있기 때문에, 단축 표현을 풀어서 실제의 긴 표현식으로 변환해주는 겁니다. 멋지죠?</p>\n<h2 id="반복자-그리고-여러분의-반복자를-직접-만들기"><a href="#%EB%B0%98%EB%B3%B5%EC%9E%90-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%97%AC%EB%9F%AC%EB%B6%84%EC%9D%98-%EB%B0%98%EB%B3%B5%EC%9E%90%EB%A5%BC-%EC%A7%81%EC%A0%91-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>반복자, 그리고 여러분의 반복자를 직접 만들기</h2>\n<p>여러분은 메서드 안에 있는 <code class="language-text">yield</code> 를 원하시는 대로 몇번이든 부를 수 있습니다. 그게 기본적으로 반복자(iterator)가 동작하는 원리입니다. <code class="language-text">yield</code> 를 배열 안에 있는 각 요소마다 호출하면 루비에서 기본적으로 제공하는 반복자를 흉내낼 수 있습니다.</p>\n<p>루비의 <code class="language-text">map</code> 메서드와 비슷한 메서드를 작성하는 방법을 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">my_map</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span>\n  new_array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n  <span class="token keyword">for</span> element <span class="token keyword">in</span> array\n    new_array<span class="token punctuation">.</span>push <span class="token keyword">yield</span> element\n  <span class="token keyword">end</span>\n\n  new_array\n<span class="token keyword">end</span>\n\n<span class="token function">my_map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>number<span class="token operator">|</span>\n  number <span class="token operator">*</span> <span class="token number">2</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n[2, 4, 6]</code></pre>\n      </div>\n<h2 id="블록을-이용하여-객체를-기본값과-함께-초기화하기"><a href="#%EB%B8%94%EB%A1%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EA%B8%B0%EB%B3%B8%EA%B0%92%EA%B3%BC-%ED%95%A8%EA%BB%98-%EC%B4%88%EA%B8%B0%ED%99%94%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블록을 이용하여 객체를 기본값과 함께 초기화하기</h2>\n<p>루비 블록을 사용할 수 있는 멋진 패턴 중 하나는 객체를 기본값과 함께 초기화하는 것입니다. 한번이라도 아무 루비 젬에서나 <code class="language-text">.gemspec</code> 파일을 살펴보았을 때 이 패턴을 보셨을겁니다.</p>\n<p>작동하는 원리는 이렇습니다. <code class="language-text">initialize</code> 메서드 안에 <code class="language-text">yield(self)</code> 를 호출하는 초기화 도구(initializer)를 넣어두는 겁니다. 여기서 <code class="language-text">self</code> 는 초기화되는 객체 자신입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Car</span>\n  attr_accessor <span class="token symbol">:color</span><span class="token punctuation">,</span> <span class="token symbol">:doors</span>\n\n  <span class="token keyword">def</span> initialize\n    <span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\ncar <span class="token operator">=</span> <span class="token constant">Car</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">do</span> <span class="token operator">|</span>c<span class="token operator">|</span>\n  c<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span>\n  c<span class="token punctuation">.</span>doors <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token keyword">end</span>\n\nputs <span class="token string">"My car\'s color is <span class="token interpolation"><span class="token delimiter tag">#{</span>car<span class="token punctuation">.</span>color<span class="token delimiter tag">}</span></span> and it\'s got <span class="token interpolation"><span class="token delimiter tag">#{</span>car<span class="token punctuation">.</span>doors<span class="token delimiter tag">}</span></span> doors."</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nMy car&#39;s color is Red and it&#39;s got 4 doors.</code></pre>\n      </div>\n<h2 id="루비-블록-예시"><a href="#%EB%A3%A8%EB%B9%84-%EB%B8%94%EB%A1%9D-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루비 블록 예시</h2>\n<p>요즘은 예시로 보여주는게 대세(all the rage these days)인만큼 실제 세계에서(혹은 실제 세계와 최대한 가까운) 블록을 사용하는 몇가지 흥미로운 시나리오를 보여드리겠습니다.</p>\n<h3 id="텍스트를-html-태그로-감싸기"><a href="#%ED%85%8D%EC%8A%A4%ED%8A%B8%EB%A5%BC-html-%ED%83%9C%EA%B7%B8%EB%A1%9C-%EA%B0%90%EC%8B%B8%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>텍스트를 HTML 태그로 감싸기</h3>\n<p>여러분이 다양한 코드 덩어리를 약간의 고정된 코드로 감싸고자 할 때 블록은 최고의 도구입니다. 예를 들자면 여러분이 어떤 텍스트를 감싸고 있는 HTML 태그를 만들고자 한다면, 텍스트는 가변적이고(왜냐면 아직 당신은 무엇을 태그로 감쌀지 전혀 모르니까요) 태그는 고정적인 부분입니다. 이 형태는 변하지 않습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> wrap_in_h1\n  <span class="token string">"&lt;h1><span class="token interpolation"><span class="token delimiter tag">#{</span><span class="token keyword">yield</span><span class="token delimiter tag">}</span></span>&lt;/h1>"</span>\n<span class="token keyword">end</span>\n\nwrap_in_h1 <span class="token punctuation">{</span> <span class="token string">"Here\'s my heading"</span> <span class="token punctuation">}</span>\n\n<span class="token comment"># => "&lt;h1>Here\'s my heading&lt;/h1>"</span>\n\nwrap_in_h1 <span class="token punctuation">{</span> <span class="token string">"Ha"</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token punctuation">}</span>\n\n<span class="token comment"># => "&lt;h1>HaHaHa&lt;/h1>"</span>\n</code></pre>\n      </div>\n<p>메서드에 블록을 넘기는 방법은 여러분이 특정 행동을 재사용하고 싶지만 살짝 다르게 쓰고 싶을 때 유용하다는 점을 알아두시기 바랍니다. 이번엔 우리가 HTML 태그로 감싸고 싶은 문자열이 있고, 이걸 조금 다른 용도로 사용하는 경우를 봅시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">wrap_in_tags</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> text<span class="token punctuation">)</span>\n  html <span class="token operator">=</span> <span class="token string">"&lt;<span class="token interpolation"><span class="token delimiter tag">#{</span>tag<span class="token delimiter tag">}</span></span>><span class="token interpolation"><span class="token delimiter tag">#{</span>text<span class="token delimiter tag">}</span></span>&lt;/<span class="token interpolation"><span class="token delimiter tag">#{</span>tag<span class="token delimiter tag">}</span></span>>"</span>\n  <span class="token keyword">yield</span> html\n<span class="token keyword">end</span>\n\n<span class="token function">wrap_in_tags</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>html<span class="token operator">|</span> <span class="token constant">Mailer</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token function">wrap_in_tags</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>html<span class="token operator">|</span> <span class="token constant">Page</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token symbol">:body</span> <span class="token operator">=</span><span class="token operator">></span> html<span class="token punctuation">)</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>첫 번째 경우에는 <code class="language-text">&lt;title&gt;Hello&lt;/title&gt;</code> 이라는 문자열을 이메일로 보냈고, 두 번째 경우에는 <code class="language-text">Page</code>  레코드를 만듭니다. 두 경우 모두 같은 메서드를 사용했지만 다른 일을 했습니다.</p>\n<h3 id="노트-작성하기"><a href="#%EB%85%B8%ED%8A%B8-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>노트 작성하기</h3>\n<p>우리가 생각(아이디어)을 데이터베이스 테이블로 저장하는 방법을 빠르게 개발한다고 생각해보겠습니다. 이 도구가 바르게 작동하려면 우리는 노트의 내용을 전달하고 메서드가 데이터베이스 연결을 다루도록 해야 합니다. 이상적으로 우리는 <code class="language-text">Note.create { &quot;Nice day today&quot; }</code> 라고 호출하고 나면 데이터베이스 연결을 열고 닫는데 일일이 신경 쓰고 싶지 않을 것입니다. 그럼 한번 보시죠.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Note</span>\n  attr_accessor <span class="token symbol">:note</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>note<span class="token operator">=</span><span class="token keyword">nil</span><span class="token punctuation">)</span>\n    <span class="token variable">@note</span> <span class="token operator">=</span> note\n    puts <span class="token string">"@note is <span class="token interpolation"><span class="token delimiter tag">#{</span>@note<span class="token delimiter tag">}</span></span>"</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>create\n    <span class="token keyword">self</span><span class="token punctuation">.</span>connect\n    note <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token keyword">yield</span><span class="token punctuation">)</span>\n    note<span class="token punctuation">.</span>write\n    <span class="token keyword">self</span><span class="token punctuation">.</span>disconnect\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> write\n    puts <span class="token string">"Writing \\"<span class="token interpolation"><span class="token delimiter tag">#{</span>@note<span class="token delimiter tag">}</span></span>\\" to the database."</span>\n  <span class="token keyword">end</span>\n\n<span class="token keyword">private</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>connect\n    puts <span class="token string">"Connecting to the database..."</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>disconnect\n    puts <span class="token string">"Disconnecting from the database..."</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token constant">Note</span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> <span class="token string">"Foo"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nConnecting to the database...\n@note is Foo\nWriting &quot;Foo&quot; to the database.\nDisconnecting from the database...</code></pre>\n      </div>\n<p>데이터베이스 연결, 노트 작성, 그리고 연결을 종료하는 기능의 구체적인 구현은 이 글에서 다루는 범위를 넘어가는 것이라 설명하지 않겠습니다.</p>\n<h3 id="배열에서-나눌-수-있는divisible-요소를-찾기"><a href="#%EB%B0%B0%EC%97%B4%EC%97%90%EC%84%9C-%EB%82%98%EB%88%8C-%EC%88%98-%EC%9E%88%EB%8A%94divisible-%EC%9A%94%EC%86%8C%EB%A5%BC-%EC%B0%BE%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>배열에서 나눌 수 있는(divisible) 요소를 찾기</h3>\n<p>제가 점점 "실제 시나리오" 와 멀어진 설명을 하고 있는 것 같습니다만, 마지막 예시를 보여드리도록 하겠습니다. 만약 배열 안에 있는 모든 요소 중에서 3으로 나뉘는 요소를 가져온다고 할 때(어떤 숫자를 생각하셔도 상관없습니다), 루비 블록을 어떻게 활용할 수 있을까요?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Fixnum</span>\n  <span class="token keyword">def</span> to_proc\n    <span class="token builtin">Proc</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">do</span> <span class="token operator">|</span>obj<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token operator">|</span>\n      obj <span class="token operator">%</span> <span class="token keyword">self</span> <span class="token operator">==</span> <span class="token number">0</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">)</span>\nputs numbers\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n3\n6\n9</code></pre>\n      </div>\n<p>역주: 위의 코드를 간략하게 설명하자면, 글 위에 <code class="language-text">&amp;block</code> 을 설명한 부분에서 <code class="language-text">&amp;</code> 기호 뒤에 붙어있는 객체가 블록이 아니라면 <code class="language-text">to_proc</code> 으로 블록으로 변환하는 것을 시도한다는 내용이 있습니다. 그래서 <a href="https://en.wikipedia.org/wiki/Monkey_patch">몽키 패칭</a>으로 <code class="language-text">Fixnum</code> 클래스에 <code class="language-text">to_proc</code> 메서드를 정의해 두는 겁니다. 3이라는 숫자는 <code class="language-text">Fixnum</code> 클래스의 객체이기 때문입니다. (루비 2.4.0부터는 Integer 클래스에 속합니다.) 실제로 변환된 블록은 다음의 형태를 가지고 있을 겁니다. <code class="language-text">*args</code> 는 옵션입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>select <span class="token keyword">do</span> <span class="token operator">|</span>n<span class="token operator">|</span>\n  n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>블록은 단순히 <strong>코드 덩어리</strong>라고 볼 수 있고, <code class="language-text">yield</code> 는 메서드 어딘가에 그 코드를 <em>주입</em>할 수 있도록 만들어줍니다. 말인 즉슨 여러분은 한 가지 메서드를 다양한 방법으로 조작할 수 있다는 뜻입니다. 그래서 여러 메서드를 작성할 필요가 없어지게 됩니다. (한 메서드를 재사용하여 여러 가지를 할 수 있다는 겁니다.)</p>\n<p>수고하셨습니다! 이 포스트를 통해 여러분은 루비 블록을 더 유용하게 활용하는 방법을 익히셨을 겁니다. 만약 여전히 혼란스러운 부분이 있거나 이 글에서 뭔가 놓친 부분이 있다면 <a href="https://mixandgo.com/blog/mastering-ruby-blocks-in-less-than-5-minutes">댓글을 남겨주세요</a>.</p>\n<p>또는 루비 블록에 대해 새로 배운게 있다면 이 글을 공유해주세요.</p>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>회사에서 개발을 하면서 필요한 기능에 맞추어 메서드를 만들다가 무언가 반복되는 부분이 발견되었습니다. 처음엔 메서드를 쪼개서 한 메서드를 여러 메서드가 공유하는 방식으로 사용했었는데, 생각해보니 그렇게까지 할 것도 없더군요. 분명 머리속엔 <code class="language-text">yield</code> 라는 게 있다고 기억은 하고 있었는데.. 자세한 용도를 다시 살펴보고자 검색을 하니 이 포스팅을 발견하였고, 내용이 너무 좋아서 바로 번역을 해도 되겠냐고 저자에게 물었습니다. 하지만 실제 번역된 결과물을 내기까지 생각보다 시간이 걸렸습니다.</p>\n<p>포스팅에 작성 된 예제 말고도 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%ED%83%80_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D">메타프로그래밍</a> 등 블록이 사용될 수 있는 부분은 무궁무진하게 많습니다. 이 글을 시작으로 간단하게 블록을 사용하여 이미 작성한 메서드를 개량하는 것부터 시작해보시는게 어떨까요?</p>\n<p>여담이지만 아직까지는 번역을 하면서 존대어를 쓰는 번역도 있고 경어를 쓰는 번역도 있습니다. 제 자신도 실력이 부족하고, 표현에 대해서 큰 고민을 하지 않고 의미 전달에만 초점을 두다 보니 이런 뒤죽박죽인 결과가 나왔네요. 번역 퀄리티가 점점 더 발전할 수 있도록 노력하겠습니다. 물론 좋은 글들을 흡수하여 제 자신이 더 좋은 코드를 작성하는 것도 신경 써야겠지요 :)</p>',
id:"/home/circleci/repo/src/pages/posts/2017-01-26-mastering-ruby-blocks-in-less-than-5minutes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-01-26",path:"/posts/mastering-ruby-blocks-in-less-than-5minutes-kor",title:"[번역] 루비 블록을 5분 이내에 마스터하기",tags:["Ruby","Translation"],category:"Translation"}},{excerpt:"이 번역글은  Justin Weiss의 포스팅 을 번역한 글입니다 오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요 당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development…",html:'<ul>\n<li><strong>이 번역글은 <a href="http://www.justinweiss.com/articles/how-do-you-take-an-app-from-test-less-to-tdd/">Justin Weiss의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요</strong></li>\n</ul>\n<hr>\n<p>당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development) 방법론을 적용하여 코드를 쓰고 싶었지만, 어디부터 시작해야 할지 전혀 몰라서 막혀버렸다. 어디부터 시작해야 할 것인가? <strong>어떻게 하면 테스트가 없는 앱을 가지고 TDD를 이용한 앱을 작성할 수 있을까?</strong></p>\n<h2 id="이미-작성한-코드를-테스트하라"><a href="#%EC%9D%B4%EB%AF%B8-%EC%9E%91%EC%84%B1%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%9D%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이미 작성한 코드를 테스트하라</h2>\n<p>당신은 테스트가 없는 코드 뭉치를 가지고 있다. 그렇다고 <em>당장</em> 기존의 코드를 가지고 테스트를 작성할 수 없다는 뜻은 아니다. 이미 가지고 있는 코드를 테스트하는 것 부터 시작해보라. 기대하던대로 코드가 작동하는지 확인해보는 것이다.</p>\n<p>이건 TDD가 아니다. <strong>그러나 이미 존재하는 코드를 테스팅하는 것은 TDD를 배우는데 도움을 줄 것이다.</strong></p>\n<ul>\n<li>\n<p><strong>예외적인 경우나 에러가 발생하는 조건에 대해 생각하는 연습을 하게 된다</strong></p>\n<p>모든 가능한 입력을 테스트하느라 수 년을 허비하지 않고 테스트를 작성하기 위해서, 당신은 보통 코드의 어느 부분에서 문제가 발생하는지 생각해야 한다. 만약 문자열을 받는 메서드를 테스트한다고 할 때, 대신 심볼을 넣으면 어떤 일이 생길 것인가?  <code class="language-text">nil</code> 을 넣는다면? 혹은 숫자를 나누는 함수를 테스트한다면, 0을 입력하는 경우에 대한 테스트를 하는 것이 좋다. 하지만 아마 1과 2를 테스트 할 필요는 없을 것이다.</p>\n<p>당신은 충분한 테스트를 작성한 뒤에 메서드의 어느 부분에서 문제가 발생할지 예측하기 시작할 것이다. 그리고 한번 TDD를 시작하면 이 기술을 이용하여 탄탄한 테스트를 작성할 수 있을 것이다. 이 테스트들은 예외 사항들을 더욱 잘 처리하도록 코드를 강제하는 역할을 한다. </p>\n</li>\n<li>\n<p><strong>짜임새있는 테스트를 작성하는 연습을 하게 된다</strong></p>\n<p>이미 작성한 코드에 대한 테스트를 작성한다면, 이 테스트들을 <a href="https://www.justinweiss.com/articles/writing-better-tests-with-the-three-phase-pattern//">구조화하는 다른 패턴들</a>을 시도해볼 수도 있다. 테스트하고자 하는 코드는 이미 있다. 그러니 당신은 테스트 자체, 그리고 이 테스트가 어떤 식으로 작성되어야 하는지에 대해 집중할 수 있다. 그리고 한번 몇몇 좋은 패턴들을 익히고 나면 당신이 기댈 코드가 <em>없을</em> 때에도 더 좋은 테스트를 작성할 것이다.</p>\n</li>\n<li>\n<p><strong>코드를 테스트하기 힘들게 하는 요소들을 발견하게 된다</strong></p>\n<p>테스트들을 작성할 수록 점점 시스템 어느 부분이 테스트하기 제일 어려운지 느끼게 될 것이다. 그런 부분들을 알아차리게 되면 그 부분을 리팩터링이 필요한 부분이라고 표시해둘 수 있다. 더 나아가 처음부터 더욱 테스트하기 좋은 코드를 작성하기 시작할 것이다.</p>\n<p>테스트하기 좋은 코드가 어떤 식으로 생겼는지 알기 시작하면, 그 지식을 기반으로 TDD하기 쉬운 API를 개발할 수 있으며 더욱 빨리 앱을 개발할 수 있을 것이다.</p>\n</li>\n</ul>\n<h2 id="tdd에-익숙해지기ease-into-tdd"><a href="#tdd%EC%97%90-%EC%9D%B5%EC%88%99%ED%95%B4%EC%A7%80%EA%B8%B0ease-into-tdd" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TDD에 익숙해지기(Ease into TDD)</h2>\n<p>\'테스트를 나중에\' 기법을 TDD를 배우는데 도움이 되는 기술로 사용할 수 있다. 하지만 여전히 당신 앱의 일부에 TDD를 적용하고 싶을 것이다.<em>(역주: 테스트를 먼저 작성하고 기능을 개발하는 것을 의미하는 것이라 추정합니다)</em> <strong>그리고 기존의 코드를 가지고 TDD에 익숙해지는 간단한 방법이 있다: <a href="https://ko.wikipedia.org/wiki/%ED%9A%8C%EA%B7%80_%ED%85%8C%EC%8A%A4%ED%8A%B8">회귀 테스트를 작성하는 것이다</a></strong></p>\n<p>회귀 테스트는 이미 확정한 코드를 부수는 것을 억누른다. 아이디어 자체는 아주 간단하다. 당신이 버그를 발견할 때마다, 그 버그를 다시 만들어보기 위해 브라우저에서 여기저기 클릭해보는 대신에:</p>\n<ul>\n<li>버그를 재생성하기 위해 <strong>실패하는 테스트를 작성하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 그 테스트가 확실히 실패하는지 확인하라 (왜냐면 버그는 아직 존재하니까).</li>\n<li>가능한한 가장 간단한 방법으로 <strong>버그를 수정하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 테스트가 통과하는지 확인하라.</li>\n<li>만약 필요하다면 당신이 수정한 방법을 <strong>리팩터링하라.</strong></li>\n</ul>\n<p>이 방법은 새 시스템을 밑바닥부터 TDD로 개발하는 것 보단 훨씬 쉽다. 왜냐면 이미 작성된 코드를 단지 테스트 주도적으로 바꾸기만 하는 것이기 때문이다. 그리고 "Red, Green, Refactor" 라는 TDD의 핵심적인 루프를 습관화하게 된다. <strong>그리고 이쯤부터 당신의 TDD는 테스트가 없는 상태에서 바로 TDD로 개발하는 것에 가까워지게 된다.(And from here, TDD is a shorter step away than trying to go straight to TDD from no tests.)</strong></p>\n<h2 id="테스트가-없는-상태에서-tdd로"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%97%86%EB%8A%94-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C-tdd%EB%A1%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 없는 상태에서 TDD로</h2>\n<p>테스트가 없는 앱은 그렇게 나쁜 출발점은 아니다. 이미 작성된 코드를 테스트할 때, 당신은 좋은 TDD 테스트를 작성하기 위해 무엇이 필요한지 많이 배우게 될 것이다. \'테스트를 나중에\' 하는 것은 시작부터 TDD로 개발하는 것 보다 쉽다. 왜냐면 아직 어떻게 디자인해야할지 모르는 API들을 상상할 필요가 없기 때문이다. 그리고 자신의 앱에 한번 TDD를 도입하기로 결정했다면 회귀 테스트를 통해 익숙해질 수 있다.</p>\n<p>그러니 만약 당신이 상상하고 있는 시스템에 TDD를 어떻게 도입해야 할 지 모르겠다면, 계속 테스트를 작성하라. 비록 코드를 먼저 써야 하더라도 말이다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>2017년 첫 번역은 TDD에 관한 글입니다. TDD 혹은 BDD(Behavior Driven Development)가 개발 방법론에 있어서 절대적인 진리는 아닐 겁니다. 다만 많이 권장되는데는 이유가 있겠지요. 저는 간단하게 TDD가 확장성, 유지보수성에 큰 도움이 된다고 인지하고 있습니다.</p>\n<p>제 자신도 아직 실력이 미천하여 코드 없이 테스트를 작성한다는 것에 큰 두려움을 느끼면서 지내왔습니다. 최근에야 일부 기능에 대해 예측되는 결과를 먼저 테스트로 작성하고, 이후에 실제 기능을 작성하여 잘 작동하는지 확인하는 수준에 불과합니다.</p>\n<p>그러다가 마침 기존에 작성한 코드를 이용하여 TDD를 배워나가는 과정에 대해 간단한 포스팅이 있어 이렇게 소개를 하게 되었습니다. 음.. 당장은 기존의 코드를 이용하여 테스트를 작성하는게 꽤 부끄럽지만 (왜냐면 테스트를 작성할 것도 없이 손대야 할 부분들이 수두룩하게 보이니까요) 이런 방식으로 약간 우회하여 TDD를 습득하는 방법도 있겠지요. </p>\n<p>그럼 모두 2017년 한해에도 좋은 테스트 + 테스트를 통과하는 좋은 코드 작성이 잘 되시길 바랍니다 :)</p>\n<p>(추가) 피드백에 의해 \'You\' 라는 단어의 직역이 너무 많이 들어간 것 같아 조금 수정하였습니다. 확실히 번역할 때 \'당신\' 이라는 단어가 일일이 들어갈 필요는 없겠네요. 좋은 피드백을 주신 <a href="https://twitter.com/initnirvana">@initNirvana</a> 님께 감사드립니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-01-16-how-do-you-take-an-app-from-no-tests-to-tdd-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-01-16",path:"/posts/how-do-you-take-an-app-from-no-tests-to-tdd-kor",title:"[번역] 테스트가 없는 앱을 이용하여 TDD를 배우는 방법",tags:["Ruby","Testing","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Luca Guidi의 포스팅 을 번역한 글입니다 오역이나 잘못된 표현 지적은 언제나 환영합니다 객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기 역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 '루비 3'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다. 오늘은 주식회사 활빈당(Spectacular Foo Ltd…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://lucaguidi.com/2016/06/07/the-penguin-that-cannot-fly.html">Luca Guidi의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오역이나 잘못된 표현 지적은 언제나 환영합니다</strong></li>\n</ul>\n<hr>\n<h2 id="객체-지향-프로그래밍-인터페이스-동적-타입에-대한-짧은-이야기"><a href="#%EA%B0%9D%EC%B2%B4-%EC%A7%80%ED%96%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EB%8F%99%EC%A0%81-%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%A7%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기</h2>\n<p><em>역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 \'루비 3\'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다.</em></p>\n<p>오늘은 주식회사 활빈당(Spectacular Foo Ltd. <em>역주: 보통 임의의 사람 이름을 홍길동이라고 하다 보니 임의의 회사 이름은 무엇으로 할까 하다가...</em>)의 본사에서 일어나는 일을 이야기해보고자 한다. 이 회사는 인디 게임계에서 떠오르고 있는 회사이고, 다음 블록버스터 타이틀인 <em>흔해빠진 새들(Banal Birds)</em> 의 발매를 앞두고 있다.</p>\n<p>올해는 2019년이고, 루비 3는 세배나 빠르고, 놀랍게도 모든 문제를 해결할 수 있는 동적 타입을 가지고 있다! 조금 향수에 젖은 결정이긴 하지만 당신은 리드 개발자로서 루비를 이 프로젝트에 사용하기로 결정했다.</p>\n<p>당신은 관리자인 제인에게 최종 코드 리뷰를 부탁했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Bird</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>아이디어는 간단하지만 혁명적이었다: 플레이어는 <strong>어떤</strong> 종류의 새라도 고를 수 있고 그 새가 날아가는 것을 볼 수 있다. 이건 엄청날거야!(This is gonna be kickass!)</p>\n<p>당신은 유명한 루비 젬 <code class="language-text">acts_as_a_bird</code>(새처럼 행동하라)를 재사용했다. 이 젬은 <code class="language-text">Bird</code> 를 완벽하게 구현하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Bird</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>많은 새들 가운데서 우리는 올빼미나 벌새도 구현했다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Owl</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying owl"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Hummingbird</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying hummingbird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>소프트웨어 공학의 참으로 놀라운 부분 아닌가? 글쎄, 이 게임에 엄청난 투자를 했음에도 불구하고 문제가 하나 남아있었다: 제인이 \'그러면 펭귄은요?\' 라고 물었다. 그렇다, 펭귄은 새지만 날 수 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Penguin</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token comment"># LOL I\'m a penguin (ㅋㅋㅋ 난 펭귄인데?)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>오늘은 게임 발매 당일이고 당신은 버그를 수정하기 위한 여력이 없다. 그래도 발매는 되어야 한다(The show must go on). 그래서 당신은 게임을 발매하고 사용자들이 펭귄을 고르지 않기를 기도할 수 밖에 없다.</p>\n<p>당신은 기분이 별로다. 그리고 자기 자신에게 묻기 시작한다: <em>왜 내가 루비를 골랐지? 왜 동적 타입을 쓴걸까?</em></p>\n<p>제인은 "당신이 정말 사용해야 했던 것은 타입이 아니라 인터페이스에요." 라고 말했다. 당신은 그 말을 듣자마자 "맙소사, 자바 말인가요!?(OMG, Java!)"  라고 말했지만, 그녀는 찬찬히 시간을 들여 그 개념은 <a href="http://golangtutorials.blogspot.kr/2011/06/interfaces-in-go.html">Go(GoLang)</a>에서 빌려온 것이라고 설명하였다.</p>\n<blockquote>\n<p>"루비같이 동적 타입을 가지고 있는 언어에서, 당신이 정말 신경써야 하는 것은 <strong>행동(behavior)</strong>이에요. 당신은 객체에 <em>메세지를 보낼 수 있도록</em> 해야합니다. 그게 객체 지향 프로그래밍의 핵심이에요."</p>\n</blockquote>\n<p>그녀는 계속 설명했다: "타입을 사용하는 것은, 당신이 수행하고자 하는 일보다 과하게 많은 일을 수행하려는 객체를 받아들인다는 것과 같아요. 그리고 그건 <a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4_%EB%B6%84%EB%A6%AC_%EC%9B%90%EC%B9%99">인터페이스 분리 원칙</a>을 무너뜨립니다."</p>\n<blockquote>\n<p>"차이점은 미묘해요: 당신은 <code class="language-text">Bird</code> 클래스가 <code class="language-text">fly</code> 메서드에 반응할 것이라(respond to) 추측했지요. 하지만 언제나 그렇진 않아요. 대신 프로그래밍 언어 측에서<em>(역주: 문맥 상 프로그래머가 작성한 코드를 말하는 것으로 보입니다)</em> 주어진 객체가 특정 메서드(혹은 메서드의 모음)를 구현하고 있는 지 확인하는 도구를 제공해야 합니다."</p>\n</blockquote>\n<p>이 시점에서 당신은 충격을 받았다. 당신은 루비가 행동의 모음을 정의할 수 있는 특별한 모듈을 제공했으면 정말 좋겠다고 생각했다<em>(역주: wished라는 동사를 사용했지만 문맥상 희망하다라고 쓰기엔 딱딱해 보입니다)</em>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">interface <span class="token class-name">Flying</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying <span class="token interpolation"><span class="token delimiter tag">#{</span> name <span class="token delimiter tag">}</span></span>"</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"bird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Falcon</span>\n  include <span class="token constant">Flying</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"falcon"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Flying</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>또한 가상머신(VM)이 \'펭귄은 날 수 없다\' 같은 당황스러운 에러를 내뿜기 전에 당신을 막아주었으면 좋겠다고 생각했다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>예전에 RORLAB 슬랙의 질문 채널에서 이런 내용의 대화를 주고받은 적이 있습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 544px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 87.86764705882352%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACtklEQVQ4y31UuY7UQBScH+Ij+Af4BH6BjJSIhBghIkICMqKVWBEgEaAVYnfYGd/3+BqP7Tk9Ll4949kDFkvtvuu96qruyYezK9hB8QXAy647vjvIt9vtcTweezzw9X3/z8Jv8uLVW3y/tH4lcfgxiuLPURR1tu0giuO+KEssFimSJNE6jCL4QYCqqh4MNIHkstlsUNcNynIJ23Hgul7v+z4cx0UYhrAsG6ZpIRbgLMt0nEEkAakXiOMEXdcNGfIngEcB6GTjsW3bXuhCmPf7vVIH68Oh0zY/9rfbLdcoEOsTZf7quobneQiEjlDWiEJZs2EWy+VS5kKdZ+ZFUSjtOI41U5buTzAFbNu1bhqjjWXss95ud9jtdtpnpvfXnjJ8/uwJvn09h2HaAtxitVqdFg1UB8ABYKg3QpfgYwDWJ8D3b17jx8UFLNtWQQzDUBEM08RsNlMxqLptD8KMQqVpqiKRWZ7nN6J4riWTiZ5RluUyWehiZspzymQxN1XVSl1AFv/z5+Tp40c4P/uE65khXlugLEoFK8WDFOuwEWpCcQygtRQKlsh6CtI0zQ2gbVyrWqZQdEVpUmV7Op2KH114lgNPaHJsPjcGXwp90myaVoPQx7eMrT7U86jLCnmaIRdbcAOz4DhtRAOPlqJ9eAxj1hTvDiDpmZbcBHrN9TXT+XyumSR+KOPRSbDLyyvNnAKxP7riDiDPiuoxGwJ7nq8bCOxSVQHlmO8HcATMkjXMkna5LcjJ2Ov1Gp7roc5KNLEoneYKVhVCK19qoOGWBPpIsLDPILw1fwPKwxDNHSycANOfVwpuGKYWX9oEvxZP0lqOUB/ABgHZ5nmPtBWQaukZ8pkSD6YiDAvVT2kPCiZBmQUNPD4SY1b3ni/oy5GomrFeftY0MSmxzcI2fUdxwjDSPQzC63gb/DfqqlBeKJlTYwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="slack_conversation"\n        title=""\n        src="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png"\n        srcset="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-5510e.png 198w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-f5670.png 395w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png 544w"\n        sizes="(max-width: 544px) 100vw, 544px"\n      />\n    </span>\n  </span>\n  </p>\n<p>마침 이 글을 읽은 직후라 비유를 <code class="language-text">fly</code> 로 사용했었던 것이 기억나네요. 보통 동적 타입을 사용하는 언어들의 단점으로 여러가지가 거론되지만 \'실행하기 전에는 무슨 일이 일어날 지 바로 알 수 없다\' 라는 단점을 본 적이 있습니다.</p>\n<p>하지만 본문에서 설명한 개념으로 그런 단점을 최소화하는게 가능하겠지요. 핵심은 프로그래머가 자신의 프로그램이 어떻게 동작할지를 면밀하게 설계할 필요가 있다는 것입니다.</p>\n<p>위 개념을 조금 더 적극적으로 활용하고자 하시는 루비 프로그래머분들은 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a>의 5, 6, 7장을 찬찬히 살펴보시면 많은 도움이 될 것입니다.</p>\n<p>2016년의 마지막 날, 이 글을 읽는 분들에게 조그마한 새해 선물이 되었이 되었으면 좋곘고 새해에도 많은 분들과 더 좋은 내용의 글을 주고받을 수 있도록 개발자로서의 역량을 갈고 닦고 싶습니다 :)</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-31-the-penguin-that-cannot-fly-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-31",path:"/posts/the-penguin-that-cannot-fly-kor",title:"[번역] 펭귄은 날 수 없다(The Penguin That Can't Fly)",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Luca Guidi의 포스팅을  번역한 글입니다 문제를 설명하는데 나온 하나미(Hanami…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://lucaguidi.com/2016/12/27/isolate-global-state.html">Luca Guidi의 포스팅을</a> 번역한 글입니다</strong></li>\n<li><strong>문제를 설명하는데 나온 하나미(Hanami)에 대해서는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction">이 포스팅</a>을 참조해주세요</strong></li>\n<li><strong>전문 번역이 아니기에 부족한 표현이나 오역은 언제든지 지적해주세요</strong></li>\n</ul>\n<hr>\n<p>소프트웨어 프로그램에서 전역 상태를 사용하는건 개발하기엔 쉽지만 유지보수 할 때는 악몽이 된다. 예상치 못한 상황에서 발생하여 추적하기도 어려운 버그가 되기 쉽상이다.</p>\n<p>왜 그렇게 되는지, 그리고 어떻게 그 문제를 완화할 수 있을지 살펴보자.</p>\n<p><em>역주: 이 글에서 전역 상태는 전역 변수와 거의 동일한 의미로 사용되는 것으로 추정됩니다.</em></p>\n<h2 id="문제의-예시"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 예시</h2>\n<p>예를 들자면 하나미의 코드 베이스 안에서 우리는 환경 변수에 따라 어떻게 프레임워크가 설정되는지 테스트 할 필요가 있다.</p>\n<p>우리<em>(역주: 하나미 개발팀으로 보입니다)</em>는 보통 테스트를 이런 식으로 작성한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  before <span class="token keyword">do</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'RACK_ENV\'</span><span class="token punctuation">]</span>    <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_HOST\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_PORT\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    before <span class="token keyword">do</span>\n      <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'production\'</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span>\n    <span class="token class-name">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리는 보통 각각의 테스트를 실행하기 전에 모든 환경 변수를 초기화해왔다. 그리고 우리가 필요로 하는 특별한 상황(the edge case)에서만 하나씩 설정했다.</p>\n<p>이러한 접근 방식을 사용할 때의 <strong>문제는</strong> 이 방법이 루비 프로세스의 전역 상태를 <strong>더럽힌다는</strong> 것이다. 우리가 테스트 파일을 단독으로 실행할 때는  <code class="language-text">before</code> 블록이 환경 변수를 리셋하기 때문에 잘 작동한다.</p>\n<p>그러나 모든 테스트를 한번에 실행할 때, 테스트는 꼬이게 될 것이다. 환경 변수 초기화가 언제나 작동하진 않기 때문이다.</p>\n<p>만약 한 테스트가 <code class="language-text">ENV</code> 속성을 변환하고 나서 뒷정리를 하지 않으면, 그 다음 테스트는 기존의 <code class="language-text">ENV</code> 값의 변화를 <strong>물려받아서</strong> 우리가 기대하던대로 작동하지 않을 수 있다.</p>\n<p>때때로 위의 예시 처럼 눈에 띄는 부분에서 변화를 준 경우에는 우리가 <code class="language-text">after</code> 블록을 설정하여 뒷정리를 할 수 있다. 그러나 다른 때엔 변환한 것(the mutation)이 우리 눈에 보이지 않는 부분에서 부작용을 초래할 수 있다.</p>\n<p>이건 소스의 버그다. 그리고 이 버그는 엉킨 실타래처럼 되어 디버그하기 힘들다.</p>\n<p><strong>오랜 시간동안, 여러 가지 전역 상태의 조합하는 것은 하나미를 지속적 통합 개발(<a href="https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9">CI builds</a>)이 힘들도록 만들고 여러 버그를 일으켰다.</strong></p>\n<p>개발자로서의 내 경험으로 미루어보아(<em>역주: Luca Guidi는 숙련된 웹 개발자입니다</em>) 이런 형태의 문제를 완화할 수 있는 유일한 방법은 <strong>전역 상태를 격리하거나, 전역 상태를 사용하는 것을 아예 피하는 것이다.</strong> 우리는 <strong>가능한한 전역 상태를 사용하는 것을 줄이도록</strong> 하나미의 내부 구현을 바꾸고 있다.</p>\n<h2 id="문제의-해법"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%ED%95%B4%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 해법</h2>\n<p>앞서 이야기한 특별한 경우를 위해 우리는 환경 변수를 격리할 수 있는 새로운 객체를 선보였다. 이는 <code class="language-text">Hanami::Env</code> 라고 불린다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Env</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> env\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>구현 자체는 별 것 아니다: <code class="language-text">ENV</code> 에 접근하는 것을 캡슐화하는 것이다.</p>\n<p>우리는 환경 변수를 관리하기 위해 자체 인터페이스를 정의했다. 우리는 명시적인 구현(concrete implementation)을 사용하기보다(<code class="language-text">ENV</code>) 추상화(<code class="language-text">Hanami::Env</code>)에 의존하고 있다(<a href="https://ko.wikipedia.org/wiki/%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84_%EC%97%AD%EC%A0%84_%EC%9B%90%EC%B9%99">의존관계 역전 원칙 참고</a>). </p>\n<p><code class="language-text">Hanami::Environment</code> 는 프로젝트의 환경 변수를 설정하는 책임을 가지고 있는데, 우리는 이런 방식으로 사용한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Environment</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>\n      opts <span class="token operator">=</span> options<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>dup\n      <span class="token variable">@env</span> <span class="token operator">=</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Env</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> opts<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n\n      <span class="token comment"># ...</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 하나미 프로젝트를 사용할 때, <code class="language-text">:env</code> 옵션은 설정되지 않은 상태이다. 이로 인해 <code class="language-text">@env</code> 는 <code class="language-text">ENV</code> 를 참조하여 루비 프로세스의 진짜 환경 변수를 읽거나 쓰게 된다.</p>\n<p>이렇게 우리는 <code class="language-text">Hanami::Environment</code> 의 테스트 중에 많은 양의 코드를 단순화하고, <strong>공유되고 변화 가능한 상태(shared mutable state, 즉 <code class="language-text">ENV</code> 말이다)의 사용을 피할 수 있었다.</strong> 아래 코드에서 우리는 <code class="language-text">ENV</code> 와 유사하게 동작하는 <code class="language-text">:env</code> 를 객체의 옵션으로 전달하지만, 이 것은 실제로 <code class="language-text">ENV</code>가 아니다: 그냥 <code class="language-text">Hash</code> 이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token builtin">Hash</span><span class="token punctuation">[</span><span class="token string">"HANAMI_ENV"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"production"</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n\n    it <span class="token string">"tests something interesting"</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> env<span class="token punctuation">)</span>  \n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p><a href="https://ko.wikipedia.org/wiki/%EC%BA%A1%EC%8A%90%ED%99%94">캡슐화</a>와 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">의존성 주입</a>을 적절하게 사용하여, 각각의 테스트에서 발생할 수 있는 변화는 나머지 테스트에서는 보이지 않게 되었다. 결과적으로 안정적인 테스트 수행을 할 수 있게 되었고, 하나미 내부를 <a href="https://ko.wikipedia.org/wiki/SOLID">SOLID 디자인</a>에 맞게 구성할 수 있었다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>보통 루비 프로젝트에서 <code class="language-text">dotenv</code> 같은 젬으로 환경 변수를 관리합니다. 사실 이 환경 변수라는 개념도 저에게 아직 모호한 개념이지만, 객체지향 프로그래밍의 핵심적인 주제인 캡슐화와 의존성 주입을 어떤 식으로 활용하는지 좋은 예를 보여준 것 같아 한번 번역해보게 되었습니다.</p>\n<p>특히 제가 요즘에야 테스트를 작성해보기 시작했는데, 테스트를 개별로 실행할 때는 몰라도 전체 테스트를 실행할 때 원인을 알 수 없는 오류가 생길 때가 종종 있었습니다. 이 글을 통해 약간의 힌트를 얻었다는 생각도 듭니다. </p>',
id:"/home/circleci/repo/src/pages/posts/2016-12-30-isolate-global-state-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-30",path:"/posts/isolate-global-state-kor",title:"[번역] 전역 상태를 격리하라",tags:["Ruby","Hanami","Testing","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Justin Weiss의 블로그 포스팅 을 허가 아래 번역한 글입니다 본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다 표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요 Thom Parkin…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://www.justinweiss.com/articles/the-easiest-way-to-get-into-open-source/">Justin Weiss의 블로그 포스팅</a>을 허가 아래 번역한 글입니다</strong></li>\n<li><strong>본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다</strong></li>\n<li><strong>표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요</strong></li>\n</ul>\n<hr>\n<p>Thom Parkin이 <a href="http://www.justinweiss.com/blog/2014/10/28/how-to-go-beyond-documentation-and-learn-a-new-library/#comment-1657912979">제 지난번 글에 아주 중요한 지적을 해 주었습니다.</a></p>\n<blockquote>\n<p>좋은 조언입니다. 그러나 당신은 아주 중요하고 결정적인 포인트를 하나 놓쳤어요. 지금 하고 있는 이야기는 오픈 소스에 관한 이야기이기 때문에 당신이 한번 어떤 기능이나 함수가 문서화가 잘 안되어있다는 것을 발견한다면, <strong>당신은 그 문서를 업데이트 하고 풀 리퀘스트(Pull Request)를 제출해야 합니다.</strong> 그렇게 전체 커뮤니티가 도움을 받게 되고 더불어 당신은 그런 참여를 통해 어느 정도의 "코더 평판(coder cred)"을 얻게 됩니다.</p>\n</blockquote>\n<p><strong>나는 Thom이 이 점을 언급해주어서 기뻤습니다. 이는 아주 중요한 것이기 때문입니다.</strong> 문서를 수정하는 것은 당신이 사용하고 좋아하는 프로젝트에 기여를 시작할 수 있는 가장 쉬운 방법입니다.</p>\n<p>제가 Rails, Rubinus, Elixir에 처음 기여했던 것들은 모두 문서 수정이었습니다. 저는 작은 수정들을 가해왔습니다. 문장을 더 명확하게 하고, 코드를 직접 읽어야만 발견할 수 있는 부분들을 설명하는 작업을 하거나, 심지어 단지 포맷이 잘못된 부분을 수정하기도 했습니다. 이 모든 것들은 좀 커다란 오픈 소스 프로젝트들을 돕는 가장 빠르고 쉬운 방법들입니다. 비록 이 일들이 제가 프로젝트에 유일하게 기여한 것들이지만, 여전히 미래의 사용자들을 돕고 있습니다. 심지어 미래의 제 자신도요. 그게 바로 오픈소스죠(And that’s what open source is all about).</p>\n<h2 id="왜-문서를-수정하는-것이-그렇게-좋은-방법인가"><a href="#%EC%99%9C-%EB%AC%B8%EC%84%9C%EB%A5%BC-%EC%88%98%EC%A0%95%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-%EA%B7%B8%EB%A0%87%EA%B2%8C-%EC%A2%8B%EC%9D%80-%EB%B0%A9%EB%B2%95%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 문서를 수정하는 것이 그렇게 좋은 방법인가</h2>\n<p>Rails같이 거대한 프로젝트에선 문서를 수정하는 것이 가장 부담이 덜 되는 기여 방법입니다.</p>\n<ul>\n<li><strong>당신은 버그를 수정하기 위해 프로젝트를 세팅할 필요가 없습니다.</strong> 당신은 그저 문서를 업데이트 하는 것이기 때문에 테스트를 돌리거나 앱을 돌릴 필요가 없습니다. 심지어 당신은 자신의 컴퓨터에 프로젝트를 클론할 필요도 없습니다 - Github에서 바로 수정할 수 있어요!</li>\n<li><strong>관리자(Maintainer)가 당신의 풀 리퀘스트에 수정을 요청한다면, 보통 어법(wording)이나 취향 때문일 겁니다.</strong> 이런 변경점은 당신의 코드가 비판받는 것 보다 받아들이기 쉽습니다. 그리고 만들기도 쉽습니다. 왜냐면 당신은 테스트나 코드를 업데이트 할 필요가 없으니까요. 단지 단어들만 업데이트하면 됩니다.</li>\n<li><strong>문서화(Documentation)는 프로젝트 관리자에게는 힘든 일입니다. 그래서 업데이트는 큰 도움이 됩니다.</strong> 종종 코드의 작성자들은 자신의 코드와 너무 밀접해 있어서, 어느 부분이 혼란스러운 부분인지 잘 이해하지 못합니다. 그들은 다른, 혹은 뉴비 개발자들이 어느 부분의 문서에 도움이 필요한지 말해주길 원합니다. 당신의 프로젝트를 초보자의 시점으로 보는 건 연습이 필요합니다. 모두가 그런 기술을 가진 것은 아니거든요.</li>\n<li><strong>마지막으로, 당신은 프로젝트에 부담없는 변화를 주면서도 관리자와 관계를 형성할 수 있습니다.</strong> 당신은 프로젝트의 방향을 바꾸는 게 아닙니다. 예를 들면 당신이 전체 기능에 기여하는 것 처럼요. 그래서 당신의 변경점은 관리자가 리뷰하기 쉽고, 그들은 보통 당신에게 더 빠르게 답변 할 것입니다. 당신의 머지 요청은 "이게 정말 좋은 생각일까요?" 같은 말에 가로막히지 않을 것입니다.</li>\n</ul>\n<p>당신은 그 관계를 유지하면서 점차 신뢰받는 기여자로 보이기 시작할 것입니다. 당신의 풀 리퀘스트는 더 빠르게 리뷰될 것이고, 당신들이(당신과 관리자) 더 복잡한 기능 요청이나 버그 수정에 대해 자세하게 이야기를 나누기도 쉬워집니다.</p>\n<p>당신의 첫 기여를 <strong>시작하기도 쉽고, 하기도 쉽고, 머지도 더 빠르게 되는</strong> 문서 수정으로 해 보시는 게 어떨까요?</p>\n<h2 id="업데이트-된-문서에-다시-기여하는-방법"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%90%9C-%EB%AC%B8%EC%84%9C%EC%97%90-%EB%8B%A4%EC%8B%9C-%EA%B8%B0%EC%97%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트 된 문서에 다시 기여하는 방법</h2>\n<p>버그 수정과 마찬가지로 문서 업데이트에 기여하는 데는 유의할 점이 있습니다: <strong>둘 다 공통적으로 \'잘못되었다고 느껴지는 것들(things that feel wrong)\'에 많이 신경을 써야 한다는 점입니다.</strong> 당신은 주의를 기울여야 합니다.</p>\n<p>보통 코드가 당신이 기대하던대로 동작하지 않을 때가 문서를 업데이트 해야 할 시기입니다. 만약 당신이 코드를 직접 수정하여 문제를 해결한다면, 마찬가지로 다른 사람들에게 이에 대해 알려야 할 겁니다. 혹은 당신이 읽고 있는 문서의 잘못된 형식이나 오타가 신경쓰일 수도 있습니다. 당신이 고치지 않는다면 누가 할까요?</p>\n<p>당신이 어디를 변경하고 어떻게 말로 표현해야하는지 좋은 아이디어가 떠올랐다면, 그 부분을 변경하고 한번 Github에 풀 리퀘스트를 올려보세요.</p>\n<p>만약 당신이 문서를 업데이트 하는 가장 좋은 방법을 계속 구상중이라면 Github에 이슈를 열어보세요. 이런 식으로요:</p>\n<blockquote>\n<p>"저기요, 이건 제가 보기에 좀 헷갈리네요. 제가 이런 식으로 업데이트하는 걸 생각해 봤는데요: ... 어떻게 생각하세요? 제가 더 넣어야 할 내용이 있을까요?"</p>\n</blockquote>\n<p>이렇게 당신은 모두를 만족시키는 표현법을 함께 제안할 수 있습니다.</p>\n<p>마지막으로 당신이 답변을 얻지 못하더라도 주눅들지 마세요. 큰 프로젝트는 여러 일들이 진행됩니다. 그래서 당신의 기여는 그 사이 어딘가로 쏙 빠져버리기 쉽지요. <strong>일주일 안팎으로 당신이 아무런 답변을 듣지 못한다면, 관리자에게 다시 물어보세요.</strong></p>\n<p>보통 당신이 라이브러리를 사용하게 되면 무엇보다 먼저 마주치는 것이 문서입니다. 그러므로 문서를 자세하고 명료하게 만드는 것은 중요합니다.</p>\n<p>그러니 당신이 쓰는 코드가 혼란스러울 때나 직접 소스를 들여다 보아야 할 때, 다음 사람을 위해 보기 쉽게 만들어주세요. 간단한 업데이트를 작성하고 다시 기여하세요. 이것이 제가 알고있는 오픈 소스 기여자가 되는 가장 쉬운 방법입니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>첫 번역이라 부족한 점이 아주 많았습니다. 영어로 된 글을 읽는 것이 그래도 어느 정도는 읽을만 하다고 생각했는데, 다른 사람이 한글로 된 번역문을 읽으려면 훨씬 번역을 잘 해야하고, 우리말 문장도 매끄럽게 작성하도록 온 신경을 기울여야 한다는 점을 깨닫는 계기가 되었습니다.</p>\n<p>사실 번역을 시작해보게 된 계기는 단순합니다. 본 글의 저자인 <a href="http://www.justinweiss.com">Justin Weiss</a>의 블로그 포스팅들이 마음에 들어서 책(Practicing Rails)도 구매하고, 뉴스레터도 구독하면서 최근 뉴스레터의 내용들이 참 도움이 많이 된다고 생각하였습니다. 그래서 메일로 최근에 온 뉴스레터를 한글로 번역하여 공유해도 되겠냐고 물어보았지요.</p>\n<p>그는 조만간 그 뉴스레터를 블로그로 포스팅할 예정이고 그 포스팅이 첫 번째로 공개되는 포스팅이었으면 한다고 답변을 주었습니다. 즉 아직은 올릴 수 없다는 말이겠지요. 메일을 조금 더 주고받다가 저는 그의 좋은 포스팅들 중 첫 번역을 이 글로 시작하기로 협의했습니다.</p>\n<p>차차 Justin의 포스팅 이외에도 괜찮은 글들을 제가 번역할 기회가 주어진다면 조금씩 올려볼 예정입니다. 감사합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-19-the-easiest-way-to-get-into-open-source-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-09",path:"/posts/the-easiest-way-to-get-into-open-source-kor",title:"[번역] 오픈 소스에 참여하는 가장 쉬운 방법",tags:["Translation","Rails","OSS"],category:"Translation"}}],TDD:[{excerpt:"더 좋은 테스트를 위한 번역 시리즈 그래서, 자바스크립트 테스트가 뭔가요? 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라. 리덕스 앱을 저비용 고효율로 통합 테스트 하기 리액트 + 리덕스 앱을 Jest와 Enzyme…",html:'<p><strong>더 좋은 테스트를 위한 번역 시리즈</strong></p>\n<ol>\n<li><a href="/posts/what-is-testing-javascript-kr">그래서, 자바스크립트 테스트가 뭔가요?</a></li>\n<li><a href="/posts/write-mostly-integration-test-kr">테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</a></li>\n<li><a href="/posts/integration-tests-in-redux-apps-kr">리덕스 앱을 저비용 고효율로 통합 테스트 하기</a></li>\n<li><a href="/posts/lessons-learned-testing-react-redux-apps-with-jest-and-enzyme-kr">리액트 + 리덕스 앱을 Jest와 Enzyme으로 테스트하며 얻은 교훈</a></li>\n</ol>\n<h2 id="들어가며번역-서문"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0%EB%B2%88%EC%97%AD-%EC%84%9C%EB%AC%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며(번역 서문)</h2>\n<p>“더 좋은 테스트를 위한 번역 시리즈” 두 번째입니다. 테스트를 작성하는게 좋다는 공감대는 얻었을 지 몰라도 막상 코드 에디터 앞에서는 대략 정신이 멍해지기 일쑤입니다. 전부 다 테스트를 하자니 너무 광범위하고, 함수 단위로 유닛 테스트만 작성하자니 너무 세세해서 실제 제대로 애플리케이션이 동작하는지 파악하기도 어렵거니와 노력 대비 별로 쓸모가 없어보이기도 합니다.</p>\n<p>그 고민을 조금이나마 덜어드리고자 좋은 조언을 가져와서 번역해 보았습니다.</p>\n<p><a href="https://blog.kentcdodds.com/write-tests-not-too-many-mostly-integration-5e8c7fff591c">원문은 여기서 보실 수 있습니다.</a></p>\n<hr>\n<p>얼마 전에 <a href="https://medium.com/@rauchg">Guillermo Rauch</a>(<a href="https://socket.io">Socket.io</a>의 창시자이자 <a href="https://zeit.co">Zeit.co</a>의 설립자입니다)가 위 제목으로 <a href="https://twitter.com/rauchg/status/807626710350839808">심오한 트윗</a>을 하나 작성했습니다. </p>\n<p><img src="https://cl.ly/1w0Q053W1B1O/write-integration-test-2.png"></p>\n<blockquote>\n<p><strong>테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>짧지만 긴 내용입니다. 더 자세히 들어가보죠.</p>\n<blockquote>\n<p><strong>테스트를 작성하라.</strong></p>\n</blockquote>\n<p>네, 여러분은 대부분의 프로젝트에 자동화된 테스트를 작성해야 합니다. 특히 자신의 시간을 소중히 여긴다면요. 새벽 두 시에 버그 때문에 불려나가는 것 보다 로컬에서 버그를 잡아내는게 훨씬 낫습니다. <strong>저는 테스트를 작성하는데 시간을 들일 때 오히려 시간을 절약한다고 느낍니다.</strong> 테스트를 작성하다 보면 제가 실제로 만들고자 하는 것 보다 더 오래 걸릴 수도 있고, 그렇지 않을 수도 있지만, 저는(그리고 다른 사람들도) 거의 확실히 유지보수 하는데 드는 시간을 절약하고 있습니다.</p>\n<p>테스트를 작성할 때는 이 테스트가 프로젝트의 버그를 얼마나 줄여줄 자신이 있는지 신경쓰셔야 합니다. <a href="https://flow.org/">Flow</a>, <a href="https://eslint.org/">ESLint</a> 같은 정적 타이핑이나 린트는 의미있는 수준의 자신감을 가져다 줍니다. 혹시 써보지 않으셨다면 반드시 살펴보시길 권합니다. 하지만 <strong>아무리 강한 타입을 적용한 프로그래밍 언어라도 테스트가 있어야 합니다.</strong> 타입과 린트는 여러분의 비지니스 로직에 버그가 없도록 만들어주지 않습니다. 그러니 좋은 테스트를 작성해서 (버그를 줄인다는)자신감을 크게 끌어올릴 필요가 있습니다.</p>\n<blockquote>\n<p><strong>너무 많이는 말고.</strong></p>\n</blockquote>\n<p>저는 애플리케이션에 100%의 코드 커버리지를 달성하려는 매니저나 팀이 있다고 들었습니다. 이는 굉장히 안 좋은 생각입니다. 커버리지가 70%(제 추측입니다.. 과학적인 증거는 없어요)를 넘어가게 되면서부터 여러분이 테스트로 얻는 이익이 점감하게 되는 문제가 있습니다. 왜 그럴까요? 음, 언제나 100%를 달성하기 위해 힘을 쏟다 보면 막상 테스트 할 필요 없는 것을 테스트하는데 시간을 소모하게 됩니다. 실제 신경써야 할 로직이 없는 것들 말이죠(ESLint나 Flow로도 충분히 잡아낼 수 있는 모든 버그들). <em>이런 규모의 테스트를 유지보수하는데 엄청난 시간이 들고 여러분의 팀을 힘들게 만들 겁니다.</em></p>\n<p>그리고 테스트 환경에서 재현하기 어려운 한 줄의 코드를 위해 테스트를 작성할 때도 있습니다. 이런 경우는 <em>진짜로</em> 피하고 싶을겁니다. 왜냐면 이 테스트는 애플리케이션이 제대로 작동한다는 자신감을 별로 주지도 못하고, 리팩터링 할 때 속도를 늦출 뿐이기 때문입니다. <strong>코드를 리팩터링 할 때 테스트를 변경해야 하는 경우는 거의 없습니다.</strong></p>\n<p>제가 작성한 대부분의 오픈 소스 프로젝트는 거의 100%의 코드 커버리지를 가지고 있다는 말씀을 드려야겠군요. 대부분의 프로젝트들은 작은 라이브러리나 툴이며, 여러 다른 상황(코드가 깨진다면 심각한 상황으로 이어질 수 있는 프로젝트들이 사용하는 상황)에서 재사용하기 쉽도록 작성되었습니다. 그래서 어찌저찌 상대적으로 100%의 커버리지를 얻을 수 있었습니다.</p>\n<blockquote>\n<p><strong>통합 테스트를 많이 써라.</strong></p>\n</blockquote>\n<p>테스트의 종류는 아주 다양합니다(제가 Fluent Conf에서 <a href="https://youtu.be/Da9wfQ0frGA">“바퀴를 테스트하면서 배울 수 있는 것들”</a>이라는 제목으로 5분짜리 발표를 했습니다). 각각의 테스트는 장단점이 있습니다. 보통 자동화된 테스트를 이야기 할 때 많이 거론되는 테스트는 단위(Unit) 테스트, 통합(Integration) 테스트, E2E(End to End) 테스트입니다.</p>\n<p>여기 제가 <a href="https://frontendmasters.com/courses/testing-javascript/">“자바스크립트 애플리케이션 테스트하기”</a> 라는 Frontend Masters 워크샵에서 선보인 <a href="http://slides.com/kentcdodds/testing-workshop#/4/8">슬라이드</a>를 잠시 보시죠.</p>\n<p><img src="https://cl.ly/3x273a0A343P/write-integration-test-1.png"></p>\n<p>테스팅 피라미드는 <a href="https://martinfowler.com/bliki/TestPyramid.html">마틴 파울러의 블로그</a>와 <a href="https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html">구글 테스팅 블로그</a>에서 얻은 개념을 한데 합친 것입니다.</p>\n<p>앞서 말씀드린대로 이 피라미드는 바닥부터 꼭대기까지 단위 테스트, 통합 테스트, E2E 테스트로 이루어져 있습니다. 피라미드의 위로 올라갈수록 테스트를 실행하고 작성하는데 더 많은 시간이 들고, 실행하고 유지보수하는데 비용(시간과 자원 측면에서)이 많이 듭니다. 그림만 보면 유닛 테스트를 작성하는데 시간을 더 투자해야 하는 것 처럼 보입니다.</p>\n<p>미처 언급되지 않은 점이 있는데, 피라미드 위로 올라갈 수록 각 테스트의 신뢰성이 증가한다는 겁니다. 여러분이 생각한 것 보다 훨씬 큰 이득을 얻을 수 있습니다(You get more bang for your buck). 따라서 E2E 테스트가 단위 테스트보다 느리고 비용이 많이 들지라도, 애플리케이션이 의도대로 동작한다는 자신감은 더 크게 제공합니다.</p>\n<p><a href="https://twitter.com/kentcdodds/status/628658648001048577">제 트윗 중 가장 많이 리트윗된 트윗</a>이 단위 테스트의 주요 문제를 다루고 있습니다.</p>\n<blockquote>\n<p>아직도 이 사진을 좋아해요. 유닛 테스트만 좋아하는 사람들은 이렇게 “작동하는 것 같다” 라고 말하죠.  </p>\n</blockquote>\n<p><img src="https://cl.ly/093u1O2j0k1Y/write-integration-test-3.gif"></p>\n<p>이 사람이 방에서 달릴 수 있고, 팔굽혀펴기를 하고, 독서를 할 수 있는지 확인하기 위해 단위 테스트를 작성했지만, 이 사람은 자신의 다양한 신체 부위를 아주 효율적으로 사용하지 못하는데다 통합하지 않고 있습니다. 만약 버튼 컴포넌트가 <code class="language-text">onClick</code> 핸들러를 호출할 때 핸들러가 올바른 데이터를 제대로 요청하지 않는다면, 핸들러의 호출이 잘 되는지 확인하는 일은 그닥 중요한게 아닙니다! 각각 분리 된 부분이 자신의 역할을 제대로 수행하는지 확인하기 위해 단위 테스트를 작성하는 것은 그리 나쁜 일은 아닙니다. *분리 된 부분이 <strong>함께</strong> 제 역할을 수행하는지 확인하지 않는다면 아무 소용 없습니다.*</p>\n<p><strong>통합 테스트는 자신감을 심어주는 역할 대비 속도/비용을 부담하는 정도를 아주 균형있게 가지고 있습니다.</strong> 그래서 여러분이 <em>대부분</em>(혹시 몰라 말씀드리지만 전부는 아닙니다)의 시간을 통합 테스트에 투자하라는 조언을 드리는 겁니다.</p>\n<hr>\n<p><strong>통합 테스트를 더 많이 작성하는 방법</strong></p>\n<p>통합 테스트와 단위 테스트 사이의 경계는 약간 모호합니다. 어느 쪽이든 더 많은 통합 테스트를 작성하기 위해 가장 도움되는 것이 무엇이냐 물으신다면 <strong>일단 너무 많은 것을 모킹(mocking)하지 않기를 권합니다.</strong> <em>무언가를 모킹할 때, 테스트하고자 하는 것과 모킹된 것 사이의 통합테스트 신뢰도는 떨어지게 됩니다.</em> 때로는 이 방법이 도움 되지 않을 수 있습니다(<a href="https://www.youtube.com/watch?v=EaxDl5NPuCA&#x26;feature=youtu.be">반대하는 사람도 있지만요</a>). 실제로 매 테스트마다 이메일을 발송하거나 신용카드 결제를 할 필요는 없지만, 대부분의 경우 모킹을 피하면 테스팅을 더 잘 하게 되리라 생각합니다.</p>\n<p><strong>만약 리액트로 개발을 하고 계시다면, 얕은 랜더링(<a href="http://airbnb.io/enzyme/docs/api/shallow.html">shallow rendering</a>)도 포함됩니다.</strong> 저는 오랜 시간동안 얕은 랜더링은 세부 구현을 테스트하는 것이나 마찬가지라고 이야기해왔습니다. 이 부분을 <a href="https://www.briefs.fm/3-minutes-with-kent/49">3분 짜리 팟캐스트</a>에서(그리고 리액트 테스팅에 대한 다른 팁도 포함해서) 다루고 있습니다.</p>\n<p>도움이 되셨길 바라며 모두 행운을 빕니다! 👍</p>',id:"/home/circleci/repo/src/pages/posts/2018-01-15-write-mostly-integration-test-kr/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2018-01-15",path:"/posts/write-mostly-integration-test-kr",title:"[번역] 테스트를 작성하라. 너무 많이는 말고. 통합 테스트를 많이 써라.",tags:["Translation","Testing","TDD"],category:"Testing"}},{excerpt:"이 글은 Twitter  @ageldama 님의 TDD 조언에 관한 글타래를 허락 받고 정리한 내용입니다. 정리하면서 말씀하신 의도가 약간 달라진 부분 혹은 제 지식이 부족하여 제대로 표현하지 못한 부분도 있을 수 있습니다. 피드백환영합니다. 해당 포스팅은  Medium…",html:'<p><img src="https://cdn-images-1.medium.com/max/1600/1*jFw7ZZMoVcsEYM_fS33DBA.gif"></p>\n<p>이 글은 Twitter <a href="https://twitter.com/ageldama">@ageldama</a>님의 TDD 조언에 관한 글타래를 허락 받고 정리한 내용입니다. 정리하면서 말씀하신 의도가 약간 달라진 부분 혹은 제 지식이 부족하여 제대로 표현하지 못한 부분도 있을 수 있습니다. 피드백환영합니다. 해당 포스팅은 <a href="https://medium.com/@devRinae/tdd-test-driven-development-%EB%A5%BC-%EC%97%B0%EC%8A%B5%ED%95%98%EB%A9%B4%EC%84%9C-%EC%B0%B8%EA%B3%A0%ED%95%98%EA%B8%B0-%EC%A2%8B%EC%9D%80-%ED%8C%81-10%EA%B0%80%EC%A7%80-d8cf46ae1806">Medium에 먼저 발행되었으니</a> 댓글로 의견 공유 부탁드립니다.</p>\n<p><strong>(번호가 중요도 혹은 순서를 나타내지 않습니다)</strong></p>\n<ol>\n<li><strong>유닛 테스트를 한다면 테스트할 주제와 대상 클래스를 정하고, 대상 클래스가 사용하는 의존성(패키지일 수도 있고 특정 함수일 수도있겠지요)들은 Mock이나 Stub으로 만든다.</strong> <a href="https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub">(Mock과 Stub이란?)</a> Mocking을 어떻게 하는지는 사용하는 언어마다 주로 사용하는 테스팅 프레임워크의 레퍼런스를 참고하라. 그러고 나면 자신이 의존성을 잘 정리했는지 살펴보기 좋아지고, 이어서 테스트하기 좋은 형태가 눈에 들어오기 시작한다.</li>\n<li><strong>무엇을 테스트할지 정하기 어렵다면?</strong> 단위 테스트를 예로 들면 자신이 만든 클래스나 모듈, 함수 등의 기능이 정상적으로 동작하는지 확인하기 위해 테스트를 작성한다고 생각해보라.</li>\n<li><strong>Q: 테스트를 작성하는데 “망했다” 혹은 “잘못되었다” 는 느낌이 든다. / A:</strong> 오히려 좋은 징조인데, 당신이 작성한 테스트는 리팩토링 및 회귀 테스트 시 복구해야 할 곳이 있음을 보여주고, 제대로 복구하고 있다는 지침이 된다.</li>\n<li>처음에는 작성한 모듈이나 클래스 비율이 높게 테스트를 짜는데, 단언(assertions)은 조금 엉성하더라도 기본적인 부분만 확인하도록 작성한다. 이후 리팩토링을 하면서 다양한 경우에 대응하기 위해 단계적으로 단언을 추가한다.</li>\n<li><strong>원칙적으로 TDD인만큼</strong> 테스트를 먼저 스펙에 반영해 작성하고, 그에 따라 테스트를 충족하기 위해 코드를 작성 후 리팩토링 하는 것이 바람직하지만 <strong>실제로는 쉽지 않다</strong>. 초심자라면 코드를 어느 정도 수준까지 짜 놓고 테스트, Mock을 붙이는걸 권한다. — <a href="https://emaren84.github.io/posts/how-do-you-take-an-app-from-no-tests-to-tdd-kor">참고 포스트</a></li>\n<li>처음부터 Mocking을 하지 않아도 좋다. 입력과 기대값이 명확하게 나타나는 로직 부분일수록, 또한 다른 모듈이나 DB 등 외부 시스템과 연결이 없을 수록 테스트를 작성하기 쉽고 그 효과를 체감하기 쉽다.</li>\n<li><strong>가장 중요한 것은 테스트가 다 붙은 상황에서 리팩토링을 시작하는 것이다.</strong> 테스트가 깨지는 것을 보고 코드와 테스트를 계속 수정해나가면서 연습해보면 <strong>“테스트 먼저”</strong>를 어떻게 하게 되는지 자연스럽게 익히게 된다.</li>\n<li><strong>Q: E2E(End-to-End) 과정을 생각해서 하나씩 시나리오대로 테스트를 짜는 것이 좋지 않나? / A:</strong> 맨 처음 스펙 도출 이후 테스트 작성, 단언, Mocking 등 순차적으로 내려가는 것이 좋겠지만, 일반적인 테스팅 프레임워크를 적용해서 작은 단위로 테스트를 작성해야 단순하고 쉽게 접근할 수 있기 때문에 개별 모듈별로 먼저 단위 테스트를 시도해 보는 것을 권장한다.</li>\n<li><strong>UI를 테스트할 때는 다른 테스팅 기법과 도구들이 잘 맞을 수도 있다.</strong> 하지만 UI 테스트나 일반 테스트 모두 공통적으로 테스트를 <strong>어떻게든</strong> 만들기 위해 노력하고, 테스트 기법 및 테스트에 맞게 자신의 코드를 생각해야 한다.</li>\n<li><strong>테스트 커버리지는 모듈 단위로, 단언은 세세하게.</strong> 테스트하고자 하는 모듈의 테스트 골격을 먼저 잡아 놓으면, 이를 기반으로 더 세세한 고려 사항을 쉽게 떠올릴 수 있다. 처음부터 모든 경우를 명확하게 나열할 수 있다면 좋지만 현실적으로 변경 사항이나 버그가 나올 때마다 추가하며 더욱 명확해지도록 만드는 것이 좋다.</li>\n</ol>\n<p>TDD 가 좋은 개발 방법론 중 하나라는 것은 초짜인 저도 많이 들었던 내용이지만, 매번 테스트 한줄이라도 작성하려 하면 너무 어렵게 느껴지고 여러 가지 핑계로 제대로 도입을 하지 못하고 있었습니다. 이번에 접한 조언을 계기로 테스트 작성에 더 익숙해지면서 더 좋은 코드를 작성하고 싶습니다.</p>\n<p>자바스크립트 기본적인 문법에 익숙하신 분이라면 <a href="https://github.com/dwyl/learn-tdd">이 글</a>과 함께 TDD를 도전해보셔도 괜찮아 보입니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-11-04-tdd-practice-tips/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-11-04",path:"/posts/tdd-practice-tips",title:"TDD(Test Driven Development) 를 연습하면서 참고하기 좋은 팁 10가지",tags:["TDD","Testing"],category:"TDD"}}],MobX:[{excerpt:"MobX를 리액트에 쓰기 위해 필요한 기본 구성은  ,   패키지이다. 그리고 각각  ,   데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다. Observer 생성한 스토어가   로 구성되어 있고, 컴포넌트가   데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다. MobX…",html:'<p>MobX를 리액트에 쓰기 위해 필요한 기본 구성은 <code class="language-text">mobx</code>, <code class="language-text">mobx-react</code> 패키지이다. 그리고 각각 <code class="language-text">observable</code>, <code class="language-text">observer</code> 데코레이터(이자 그냥 함수)를 가져다 쓸 수 있다.</p>\n<h2 id="observer"><a href="#observer" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observer</h2>\n<p>생성한 스토어가 <code class="language-text">observable</code> 로 구성되어 있고, 컴포넌트가 <code class="language-text">observer</code> 데코레이터로 감싸져 있다면 스토어를 사용할 조건은 충족된다. 그래서 다음의 코드로 간단한 카운터를 만들 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> appState <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  count<span class="token punctuation">:</span> <span class="token number">0</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\nappState<span class="token punctuation">.</span><span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">--</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">handleInc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function-variable function">handleDec</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>div<span class="token operator">></span>\n        Counter<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span>count<span class="token punctuation">}</span> <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleInc<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">+</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDec<span class="token punctuation">}</span><span class="token operator">></span> <span class="token operator">-</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>MobX의 리액트 개발자 도구는 크롬 같은 브라우저의 확장으로 설치하는 것이 아니라 일종의 리액트 컴포넌트로 되어있다. 따라서 프로젝트에 <code class="language-text">mobx-react-devtools</code> 를 설치하고 <code class="language-text">&lt;Devtools /&gt;</code> 같은 컴포넌트를 컴포넌트 트리에 삽입하면 된다.\nObservable 스토어를 다룰 때 DOM을 그리는 등의 동작은 Side Effects(부가 동작)으로 처리된다. 이 때 스토어의 상태를 효율적으로 다루기 위해 <code class="language-text">computed</code> 속성을 쓰면 필요한 부분만 스토어의 변경을 감지하여 효과적인 컴포넌트 랜더링이 가능하다.</p>\n<h2 id="action"><a href="#action" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Action</h2>\n<p><code class="language-text">@action</code> 데코레이터는 리듀서의 액션 디스패치와 같은 역할을 한다. 데코레이터와 함께 메서드를 작성하고, 이에 따라 Observable 값이 변경되도록 하면 MobX가 알아서 처리 해줄 것이다. Observable한 값을 직접 변경해주는 것도 일종의 액션이다. 상태 변경의 방법을 밖으로 드러내어 실수를 미연에 방지하는 것이 액션의 역할 뿐 아니라, 상태 변경을 하나의 단위로 묶어 트랜잭션을 수행하는 역할도 가지고 있다. 또한 비동기 작업 수행을 효과적으로 제어할 때도 사용된다. 예를 들어 작업 시행 -> 작업 종료가 명료하게 동기화되어야 할 때 액션을 사용하면 의도치 않은 동작을 방지할 수 있다.</p>\n<p><code class="language-text">@action(name: string)</code> 같은 형식으로 이름을 넣어서 개발 도구에서 손쉽게 액션을 파악할 수 있다. 그리고 액션을 쓰지 않고 직접 상태를 변경하는 일을 막기 위해 <code class="language-text">useStrict</code> 함수로 strict mode를 설정할 수 있다. 이 때는 액션 데코레이터 없이는 상태 변경을 수행할 수 없다.</p>\n<h2 id="observable-data-structure"><a href="#observable-data-structure" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Observable Data Structure</h2>\n<p><code class="language-text">observable</code> 함수로 배열, 객체, Map 등을 감싸서 활용할 수 있다. 이 세 가지는 MobX에서 가장 중요하게 여기는 자료구조이다. 여기서 객체나 배열에 들어갈 값은 기존 자바스크립트에서 쓰는 단순한 객체나 원시 타입의 값일 수도 있지만, 개발자가 MobX의 기능을 활용하여 만든 상태 모델의 인스턴스를 넣어서 조작할 수도 있다. 가령 위에서 이야기한 <code class="language-text">computed</code>, <code class="language-text">action</code> 등을 활용한 임의의 클래스를 만들고, 그 클래스의 인스턴스들을 배열에다 넣어서 다룰 수 있다는 이야기다.</p>\n<p><code class="language-text">observable([])</code> 같은 명령어로 만들어진 배열은 유사 배열이기 때문에 실제 배열처럼 다루려면 <code class="language-text">toJS</code> 같은 별도의 가공이 필요하다.</p>\n<h2 id="컴포넌트를-나누어-관리하기"><a href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%A5%BC-%EB%82%98%EB%88%84%EC%96%B4-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컴포넌트를 나누어 관리하기</h2>\n<p>Observable 상태를 <code class="language-text">map</code> 함수로 순회하며 하위 컴포넌트를 생성할 때 고려해야 할 점이 있다. 아무 처리도 없이 <code class="language-text">map</code> 함수로 생성한 하위 컴포넌트에서 <code class="language-text">onClick</code> 등으로 상태를 바꾸면, 겉으로 보기에는 상태가 변한 부분만 다시 랜더링 되는 것으로 보이지만 실제로 모든 하위 컴포넌트가 다시 랜더링된다. 이런 구조가 누적되면 결과적으로 큰 자원 낭비를 초래하기 때문에 최적화헤야 한다.\n가장 간단한 방법은 <code class="language-text">map</code> 함수 안에서 생성되는 하위 컴포넌트가 <code class="language-text">@observer</code> 임을 명시해주고, 상태 변화 액션도 <code class="language-text">@action</code> 으로 관리해주면 된다. 최적화는 MobX가 알아서 해 준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n    <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n      <span class="token operator">&lt;</span>TView Key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n    <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n@observer\n<span class="token keyword">class</span> <span class="token class-name">TView</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onTempClick<span class="token punctuation">}</span><span class="token operator">></span>\n        <span class="token punctuation">{</span>t<span class="token punctuation">.</span>temperature<span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  @action <span class="token function-variable function">onTempClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>temperature<span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="provider-컴포넌트-사용하기"><a href="#provider-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provider 컴포넌트 사용하기</h2>\n<p><code class="language-text">mobx-react</code> 는 <code class="language-text">react-redux</code> 처럼 <code class="language-text">Provider</code> 컴포넌트를 제공한다. 사실 MobX의 스토어는 한번 선언되어있으면 어디서 어떻게 가져다쓰던 <code class="language-text">observer</code>, <code class="language-text">observable</code> 선언만 제대로 되어있으면 동적으로 연결된다. 하지만 기존에 리덕스를 사용할 때 처럼 최상단 컴포넌트를 Provider 컴포넌트로 감싸기만 하면 <code class="language-text">connect</code>, <code class="language-text">mapStateToProps</code> 같은 함수를 사용하지 않아도 바로 자유자재로 사용할 수 있다. 단지 <code class="language-text">@observer</code> 데코레이터 선언 시 어떤 스토어를 사용할지만 명시하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// 스토어 선언 및 Provider 감싸기</span>\n<span class="token keyword">const</span> temps <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\nReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>Provider temperatures<span class="token operator">=</span><span class="token punctuation">{</span>temps<span class="token punctuation">}</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// App 컴포넌트</span>\n<span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">observer</span><span class="token punctuation">(</span>\n  <span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">{</span> temperatures <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n    <span class="token operator">&lt;</span>ul<span class="token operator">></span>\n      <span class="token operator">&lt;</span>TemperatureInput <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">{</span>temperatures<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=></span>\n        <span class="token operator">&lt;</span>TView key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span> temperature<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n      <span class="token punctuation">)</span><span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span>DevTools <span class="token operator">/</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// temperatures를 사용하는 컴포넌트</span>\n<span class="token comment">// 위의 App 컴포넌트를 보면 알겠지만 따로 props 선언이 없었음에도 바로 사용 가능하다.</span>\n@<span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"temperatures"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">class</span> <span class="token class-name">TemperatureInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  @observable input <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>li<span class="token operator">></span>\n        Destination\n        <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">}</span>\n        value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">}</span>\n        <span class="token operator">/</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit<span class="token punctuation">}</span><span class="token operator">></span>Add<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="특정-상황에서-반응하는-액션-작성하기"><a href="#%ED%8A%B9%EC%A0%95-%EC%83%81%ED%99%A9%EC%97%90%EC%84%9C-%EB%B0%98%EC%9D%91%ED%95%98%EB%8A%94-%EC%95%A1%EC%85%98-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정 상황에서 반응하는 액션 작성하기</h2>\n<p>작성해놓은 스토어를 사용할 때 특정 조건에 맞추어 원하는 동작이 발생하도록 훅을 걸거나(<code class="language-text">when</code>), 모든 상태 변화마다 실행되는 함수를 지정할 수도 있다(<code class="language-text">autorun</code>).</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// when의 사용 예</span>\n<span class="token keyword">function</span> <span class="token function">isNice</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> t<span class="token punctuation">.</span>temperatureCelsius <span class="token operator">></span> <span class="token number">25</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">when</span><span class="token punctuation">(</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> temps<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> t <span class="token operator">=</span> temps<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>isNice<span class="token punctuation">)</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Book now! "</span> <span class="token operator">+</span> t<span class="token punctuation">.</span>location<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// autorun의 사용 예</span>\n<span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">autorun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'6\'</span>\nnumbers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// prints \'10\'</span>\n</code></pre>\n      </div>\n<p><a href="https://mobx.js.org/refguide/computed-decorator.html">공식 문서</a>에 따르면 <code class="language-text">autorun</code> 함수는 상태 값을 변화시키지 않으면서 항상 실행되어야 하는 상황(로깅, UI 업데이트)에서 사용되며 그 이외의 경우는 전부 <code class="language-text">computed</code> 사용을 권장하고 있다.</p>\n<blockquote>\n<p>Don\'t confuse computed with autorun. They are both reactively invoked expressions, but use @computed if you want to reactively produce a value that can be used by other observers and autorun if you don\'t want to produce a new value but rather want to achieve an effect. For example imperative side effects like logging, making network requests etc.</p>\n</blockquote>\n<h2 id="참고-자료"><a href="#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고 자료</h2>\n<ul>\n<li><a href="https://egghead.io/courses/manage-complex-state-in-react-apps-with-mobx">Manage Complex State in React Apps with MobX from @mweststrate on @eggheadio</a></li>\n<li><a href="https://egghead.io/courses/manage-application-state-with-mobx-state-tree">Manage Application State with Mobx-state-tree from @mweststrate on @eggheadio</a></li>\n<li><a href="https://mobx.js.org/">Mobx Documentation</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-12-31-mobx-basic-concepts/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-31",path:"/posts/mobx-basic-concepts",title:"MobX로 상태 관리하기",tags:["Javascript","MobX","React"],category:"MobX"}}],Reading:[{excerpt:"감상평을 적기에 앞서 몇 가지 가벼운 질문이 있다. 혹시 아래의 문제를 보았을 때 모르는 내용이 2가지 이상 있거나, 알더라도 바로 명확한 답변이 떠오르지 않는지 생각해보라. (ES…",html:'<p><img src="https://cl.ly/2c1k0h132v3U/%E1%84%89%E1%85%A9%E1%86%A8%E1%84%80%E1%85%B5%E1%87%81%E1%84%8B%E1%85%B3%E1%86%AB_%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B8%E1%84%90%E1%85%B3_cover.jpg" alt="속깊은 자바스크립트 표지"></p>\n<p>감상평을 적기에 앞서 몇 가지 가벼운 질문이 있다. 혹시 아래의 문제를 보았을 때 모르는 내용이 2가지 이상 있거나, 알더라도 바로 명확한 답변이 떠오르지 않는지 생각해보라. (ES5 기준)</p>\n<ul>\n<li>아래의 코드는 무엇이 잘못되었는가? 문제가 있다면 어떻게 해결할 수 있는가?</li>\n</ul>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\tdocument<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"div"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"You clicked div #"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<ul>\n<li>자바스크립트의  <code class="language-text">this</code> 가 어떤 상황에 따라 다르게 묶이는지 이해하고 있는가?</li>\n<li>자바스크립트의 변수 범위(스코프)는 어떻게 정해지는가?</li>\n<li>자바스크립트의 이벤트 루프는 무엇이며 어떤 방식으로 동작하는가?</li>\n<li>DOM을 다루는 자바스크립트 코드를 작성시 성능을 최적화하기 위한 고려 방안을 3가지 이상 알고 있는가?</li>\n<li>사용자가 브라우저로 웹 사이트 접속 시 초기 로딩의 불편함을 최소화하기 위한 자바스크립트 코드를 구상할 수 있는가?</li>\n</ul>\n<p>답을 떠올리기 힘들었다면 자신이 자바스크립트의 제대로 알고 사용하고 있는지 다시 한번 깊이 고민해 볼 필요가 있다. 다행히도 이 책의 많은 부분은 그 \'기본\' 을 충실하게 짚어주는 편이다.</p>\n<p>그래도 코뿔소 책(자바스크립트 완벽 가이드 - 데이비드 플래너건 저)처럼 방대한 내용으로 독자를 허우적거리게 만들거나, 나비 책(자바스크립트 핵심 가이드 - 더글라스 크락포드 저)처럼 겉으로 보기에 너무나 축약된 내용이라 여러번 곱씹어야 내용을 알 법한 어려운 수준의 책도 아니다.\n그렇기에 나는 방금 소개한 두 책보다 자바스크립트 기본을 익힌 다음에 이 책을 먼저 탐독하길 권하고 싶다.</p>\n<p>2017년을 보내고 2018년을 맞이하는 현재 시점에서 이 책을 읽는 독자들이 가져야 할 마음가짐은 <strong>온고지신</strong> 이다.\n아마 이 책에 적힌 유용한 예제 코드를 직접 개발을 하며 사용할 일은 거의 없으리라 생각한다.\n하지만 Babel, Typescript같은 트랜스파일러를 통해(Typescript는 약간 성격이 다르지만 결과물이 일반 자바스크립트임을 감안하여 이 글에서는 트랜스파일러라 명명한다) 변환된 코드들은 이 책의 예제 코드와 유사한 형태를 가지고 있다.\n그리고 <strong>왜</strong> 이런 형태를 가지고 있는지, 문제에 부딪힐 때 어떤 방식으로 개량할 수 있는지 생각할 수 있는 지식을 얻을 수 있다.</p>\n<p>대충 프레임워크 가져다 쓰고, 대충 ES6+ 로 코드 작성하고, 대충 Webpack + Babel 등의 문서를 참고하여 코드 변환되도록 빌드하고 배포하면 (프론트엔드) 웹 애플리케이션이 뚝딱 나온다고 생각하기 쉬운 현재 프론트엔드 생태계 속에서\n자신이 작성하는 자바스크립트 코드의 무게를 다시 생각하는 계기가 될 것이다. <a href="https://medium.com/dev-channel/the-cost-of-javascript-84009f51e99e">우리는 언제나 이 무게를 신경써야 한다.</a></p>\n<p>조금 특이하지만 나는 책의 첫 번째 챕터인 <strong>웹과 자바스크립트</strong>에서 그 옛날 자바스크립트가 어떻게 여기까지 오게 되었는지 간단히 짚어보고,\n후반부 챕터인 <strong>자바스크립트 성능과 사용자 경험 개선</strong>에서 캐싱, 미니피케이션, gzip 등의 HTTP 요청 관련 최적화로 성능을 개선하는 부분까지 웹 개발의 큰 그림을 짚어보는 구성이 마음에 들었다.\n초보 프론트엔드 개발자들이 소홀히하기 쉽고, 아무도 바로 알려주지 않는 ‘최적화’ 에 대해 고민할 수 있는 요소를 알려주기 때문에 기초 수준이나 기초를 벗어나는 수준 즈음에 이 책을 읽어보는 것을 권한다.</p>\n<p>나머지 주요 내용(클로저, 프로토타입과 프로토타입 상속, 자바스크립트만의 독특한 패턴 - 특히 이벤트 델리게이션 등)은 사실 요즘에는 키워드만 알고 검색하면 얼마든지 잘 설명된 자료를 찾아볼 수 있을 것이다.\n다만 내가 보았을 때 그 자료들은 다 영어로 쓰여있었다. 영문으로 된 글을 읽는데 익숙지 않다면 이 책의 내용이 더 유용하리라 기대한다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-12-21-javascript-in-depth-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-12-21",path:"/posts/javascript-in-depth-review",title:"'속깊은 Javascript' 감상평 및 추천사",tags:["Reading","Javascript"],category:"Review"}},{excerpt:"자바를 맛만 보고, 실질적으로 루비를 첫 프로그래밍 언어로 접하여 지금까지 사용해오고 있습니다. 어느 덧 2년이 다 되어가네요. 루비는 비교적 간단하면서도 강력한 언어이지만, 현재는 루비 온 레일즈(이하 레일즈) 라는 걸출한 웹 프레임워크의 기반이 되는 언어라는 인식 이외에는 그다지 유명세를 얻지 못하고 있습니다. 반면 비슷하게 간단하면서 강력한데다 전 세계적인 인지도를 가지고 있는 프로그래밍 언어가 있습니다. 파이썬(Python…",html:"<p>자바를 맛만 보고, 실질적으로 루비를 첫 프로그래밍 언어로 접하여 지금까지 사용해오고 있습니다. 어느 덧 2년이 다 되어가네요.<br>\n루비는 비교적 간단하면서도 강력한 언어이지만, 현재는 루비 온 레일즈(이하 레일즈) 라는 걸출한 웹 프레임워크의 기반이 되는 언어라는 인식 이외에는 그다지 유명세를 얻지 못하고 있습니다.</p>\n<p>반면 비슷하게 간단하면서 강력한데다 전 세계적인 인지도를 가지고 있는 프로그래밍 언어가 있습니다. 파이썬(Python) 입니다.<br>\n사실 언제라도 필요에 따라 마음만 먹으면 파이썬을 금방 사용할 수 있으리라 생각해 왔는데 좀처럼 그럴 기회가 없었습니다.<br>\n그래서 이번에 길벗 출판사에서 진행하는 이벤트를 통해 가볍게 파이썬을 접해보는 계기를 만들고자 '파이썬 코딩의 기술(Effective Python) 책을 리뷰하기로 했습니다.</p>\n<p>이 책을 한 마디로 표현한다면 파이썬의 <strong>'요람부터 무덤까지'</strong> 를 알려주는 책이라고 할 수 있습니다.<br>\n저자는 파이썬다운 생각을 하는 방법부터 시작하여 함수, 클래스, 병렬성, 내장 모듈, 협력, 제품화까지 파이썬으로 프로그래밍을 하는데 있어 필요한 모든 요소를 관통하며 묵직한 조언을 던져줍니다. </p>\n<p>파이썬이라는 언어는 그 자유로움 때문에 프로그래머가 각자 편한 방식으로 코딩을 하다가 성능이나 가독성, 원인을 알 수 없는 버그 등 많은 문제에 직면하기 쉽습니다. 그렇기 때문에 저는 프로그래밍 언어를 익힐 때 해당 언어의 사고방식을 체득하려는 노력을 합니다.<br>\n이 책은 그 사고방식을 익히는데 최적화되어 있으며, 평소에 잊고 있다가도 필요한 부분에 바로 적용할 수 있도록 예제 코드가 단계별로 잘 제공되어 있습니다. 특히 바로 잘 정돈된 코드만 나열하는 게 아니라 좋지 않은 예를 어떤 과정과 사고방식을 통해 개선해가는지 보여주는 점이 가장 마음에 들었습니다.</p>\n<p><strong>다만 이 책을 제대로 활용하기 위해서는 기초적인 파이썬 문법을 알고 있어야 합니다.</strong><br>\n초보자 혹은 다른 언어 기반지식을 가지고 파이썬을 가볍게 익히신 분들이라면 <strong>바로 읽어보셔야 할 책이라고 생각하며</strong>, '어떻게 하면 더 효율적인 코드를 작성할 수 있을까?' 라는 고민을 안고 있는 중급 파이썬 개발자들에게도 조심스레 추천드리고 싶습니다.</p>",id:"/home/circleci/repo/src/pages/posts/2017-06-28-effective-python-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-06-28",path:"/posts/effective-python-review",title:"파이썬 코딩의 기술(Effective Python) 리뷰",tags:["Reading","Python"],category:"Review"}},{excerpt:"Ruby on Rails(이하 레일즈) 를 쓰는 사람이라면 DHH(데이비드 하이네마이어 한슨)의 이름을 모르는 사람은 거의 없을 것이다. 레일즈 프레임워크의 창시자일 뿐 아니라 거침 없는 입담과 자신만의 확고한 방식으로 레일즈라는 거대한 프로젝트를 이끌고 있는 개발자이기 때문이다. 사실 나도 그냥 DHH의 이름을 들으면 떠오르는 점은 ‘레일즈의 창시자’ 정도밖에 없었다. 덧붙이면 그 전에는 PHP…",html:'<p>Ruby on Rails(이하 레일즈) 를 쓰는 사람이라면 DHH(데이비드 하이네마이어 한슨)의 이름을 모르는 사람은 거의 없을 것이다. 레일즈 프레임워크의 창시자일 뿐 아니라 거침 없는 입담과 자신만의 확고한 방식으로 레일즈라는 거대한 프로젝트를 이끌고 있는 개발자이기 때문이다.</p>\n<p>사실 나도 그냥 DHH의 이름을 들으면 떠오르는 점은 ‘레일즈의 창시자’ 정도밖에 없었다. 덧붙이면 그 전에는 PHP로 개발을 하다가 너무 답답해하던 중 루비라는 언어를 접하고, 사랑에 빠져(말 그대로이다. 이는 DHH가 <a href="https://harfangk.github.io/2017/01/27/quora-qna-session-with-david-heinemeier-hansson-jan-25-2017-ko.html">2017년 1월에 Quora에서 진행한 AMA</a>에서 사용한 표현이다.) 레일즈를 개발하게 되었다는 것 정도를 알고 있었다.</p>\n<p>그러다 위에 링크한 DHH의 AMA를 읽게 되었고, 글을 다 읽고 나니 ‘이 사람은 대체 어떤 사람이고, 무슨 생각을 하고 있을까? 배울 점이 있다면 배우고 싶다’ 라는 생각이 들었다. 그렇게 접하게 된 대표적인 저서가 이 <strong>Remote</strong>이다.</p>\n<p>이 책은 ‘원격근무’ 라는 것이 어떤 것인지 소개하면서 흔히 알려진 오해들을 바로잡고, 어떤 방식으로 원격근무를 적용하면 좋을 지 안내하는 가이드 역할을 하는 책이다. 실제로 DHH가 설립한 회사 37signals(현 Basecamp, 이들이 운영하고 있는 원격 근무 서비스의 이름과 같다)는 전면적인 원격 근무 체제를 도입하고 있고, 아주 성공적으로 운영하고 있는 회사 중 하나이다.</p>\n<p>‘원격 근무는 회사에 가지 않고 집에서 작업하기 때문에 관리자의 통제가 힘들다’라는 게 일반적으로 원격 근무를 바라보는 사람들의 생각일 것이다. 하지만 오히려 관리자의 통제가 정말로 필요한 경우는 어떤 것인지 다시 한번 생각해보아야 한다. 근태 관리인가? 아니면 생산성인가? ‘관리자가 직접 직원을 볼 수 없기 때문에 통제가 힘들다’ 는 것은 근태 위주의 생각이고, 근로자가 자신이 가능한한 최적의 환경에서 최고의 생산성을 낼 수 있는 작업방식으로 회사 일에 기여를 하면 자연스레 회사와 근로자 모두에게 이득이 될 것이다.</p>\n<p>더불어 출퇴근 시간으로 하루에 일정 시간을 소비하고, 시간 뿐 아니라 출퇴근 지옥 속에서 정신력까지 소모하는 생활을 살아가는 시대에 ‘출퇴근 문제’를 도려내면 삶이 얼마나 편하게 바뀔 지 상상해보라. 저절로 편안한 기분이 든다.</p>\n<p>요즘은 다양한 도구가 많이 개발되어 있어서(Basecamp, 각종 메신저, 구글 닥스 등) 세계 각지에 떨어진 사람들도 <strong>언어만 통하면</strong> 서로 협력하여 업무를 진행하는데 전혀 무리가 없다. 물론 다시 한번 강조하지만 언어가 통하는게 중요하다. 해외의 회사에 원격근무자로 취직을 한다 하더라도 주로 <strong>영어 쓰기</strong>가 큰 장벽이 될 것이다.</p>\n<p>원격근무자를 고용하는 회사에서 고려할 사항 뿐 아니라 원격근무로 일하는 사람도 고려해야 할 사항들이 여러가지 있다. 보통 집에서 혹은 근처 카페에서 작업을 한다고 하면 딴 짓을 하거나 게으르게 행동하여 생산성이 떨어질까 걱정하는 경우가 많은데, 오히려 이 책은 ‘과도하게 일에 몰입하지 않도록 주의하라’고 경고한다. 나 자신도 비슷한 일을 경험한 적이 있어서 크게 공감되었다. 간단한 작업을 돕고 마무리 지으려고 했는데, 카페에서 화장실 한번 가지 못하고 5시간을 앉아있던 뒤에야 간신히 일어날 수 있었다. 회사에서 있었다면 어떤 식으로든 몸을 일으켜 움직이는게 쉬웠을 것이다.</p>\n<p>마지막으로 이 책은 원격근무를 하는데 필요한 중요한 요소 중 하나는 \'동기’임을 강조한다. 관리자 입장에서도 원격근무자의 업무 성과가 제대로 나오지 않는 경우에 주어진 업무가 제대로 구성되어있고 동기를 부여하는 업무인지 확인하라고 말하고 있고, 원격근무자에게도 스스로를 탓하기 보다 근무환경을 다시 한 번 살펴보라고 권한다.</p>\n<p>겉으로 보기엔 형태가 달라 보이지만 거대한 오픈소스 프로젝트도 원격근무의 좋은 예가 될 수 있다. 얼굴도 마주한 적 없는 다양한 사람들이 거대한 프로젝트를 완성시켜나가는 모습은 경이롭다.</p>\n<blockquote>\n<p>우리가 개발한 웹프레임워크인 루비온레일스는 십여 년이 넘는 기간 동안 새로운 기능을 넣고 코드 품질을 개선하면서 진화시켜왔다. 이는 전 세계 십여 개 국가, 수백 개 도시에서 3천 명이 넘는 개발자들(이들은 서로 만난 적도 없는 사람들이다)이 오랜 기간 코드를 발전시킨 결과다.</p>\n<p>원격근무를 도입하는 과정에 의심이 들거나 장애물을 만날 때는 이렇게 생각하면 도움이 된다. “전 세계의 3천 명이 넘는 개발자들을 관리하고 조율하는 프로젝트도 있는데, 이 정도쯤이야!” 아마 골치 아픈 문제가 곧 해결될 수 있으리라는 안도감을 느낄 것이다.</p>\n<p>--- p183, p184</p>\n</blockquote>\n<p>모든 직종이 원격근무를 적극적으로 도입할 수는 없다. 하지만 개발자라는 직업은 지금 시대에 원격근무를 하기에 가장 탁월한 직업이라고 생각한다. 출근하러 집을 나서는 순간부터 \'아 집에 돌아가고 싶다’ 라는 생각이 들게 되는 삶 보다 자신이 하는 일을 진정 즐기면서 회사와 함께 상생할 수 있도록 원격근무를 적절히 도입하는 사례가 점점 늘어나는 모습이 기대된다. 나 또한 원격근무라는걸 제대로 해보고 싶다.</p>\n<hr>\n<ul>\n<li>책 링크: <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=50265443">알라딘</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-02-26-reading-remote/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-26",path:"/posts/remote-the-book-review",title:"‘Remote - 사무실 따윈 필요 없어!’ 를 읽고",tags:["Reading","Remote Job"],category:"Review"}}],Markdown:[{excerpt:"새로운 도전의 시작 올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다) 기존에도 프론트엔드 라이브러리로 React와 Vue.js…",html:'<h2 id="새로운-도전의-시작"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EB%8F%84%EC%A0%84%EC%9D%98-%EC%8B%9C%EC%9E%91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 도전의 시작</h2>\n<p>올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다)</p>\n<p>기존에도 프론트엔드 라이브러리로 React와 Vue.js에 많은 관심을 가지고 있었는데, 이제 본격적으로 리액트를 업무에 사용하게 되었기 때문에 <strong>리액트로 뭘 만들어볼까?</strong> 하다가 가장 만만한 블로그부터 다시 만들어 보기로 결심했습니다. 블로그를 만들고자 했던 이유는 몇 가지 더 있었습니다.</p>\n<ol>\n<li>기왕 하는거 간단한 디자인 및 프로토타이핑까지 하여 하나의 사이트 개발을 처음부터 끝까지 직접 해 보고 싶다.</li>\n<li>기존 블로그는 테마를 바로 가져다 썼는데, 충분히 좋지만 불필요한 요소나 레이아웃을 걷어내고 최대한 간소하게 만들어보고 싶다.</li>\n<li>간소하게 만들면서 관리 및 유지보수가 더 원활한 형태로 재구성하고 싶다.</li>\n</ol>\n<p>결론부터 말씀드리자면 1번은 절반의 성공만 거두고 나머지는 성공했습니다. 종이에다 어떤 모양이 나와야하는지 그려본 뒤에, 그 모습을 실제 코드로 옮기는데 성공했지만 CSS를 밑바닥부터 그려낼 실력은 되지 않아 <a href="https://bulma.io">Bulma</a>를 활용하여 만들었습니다.</p>\n<p>그러면 2, 3번은 어떻게 달성했을까요?</p>\n<h2 id="gatsby를-만나다"><a href="#gatsby%EB%A5%BC-%EB%A7%8C%EB%82%98%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby를 만나다</h2>\n<p>이전에 ‘리액트를 학습하는 과정’ 을 안내하는 포스팅을 읽은 적이 있는데 <em>기본을 익혔다면 <a href="https://www.gatsbyjs.org">Gatsby</a>같은 리액트 기반의 정적 페이지 생성기를 사용하여 리액트를 연습해보라</em> 라는 내용이 적혀있더군요. <strong>어떻게 리액트로 정적 페이지를 만들 수 있을까?</strong> 하며 궁금해하면서 이름을 기억해두고 있었습니다.</p>\n<p>보통 정적 페이지 생성기를 사용하여 블로그를 만든다고 하면 루비를 이용한 <a href="https://jekyllrb.com">Jekyll</a>과 Node.js를 이용한 <a href="https://hexo.io">Hexo</a> 등을 사용하게 됩니다. 각각의 포스팅을 마크다운으로 작성하고 생성기가 이를 html 파일로 변환해주며, 특정 정보가 삽입되어야 할 때(날짜, 사용자가 직접 입력한 정보 등)는 템플릿 엔진이 페이지 생성을 도와주는 형식으로 되어 있습니다.</p>\n<p>그런데 당시 제가 아는 수준에서 리액트로 블로그를 만드는 것은 굉장히 기술을 과하게 사용하는 일이었습니다. 먼저 블로그를 정말 메모장 대신으로 쓸 것이 아니면 검색 엔진에 노출 되는 것이 좋다고 생각하는데, 리액트로 SPA(Single Page Application)을 제작하게되면 검색엔진 봇이 내용을 수집하기 힘듭니다. 아니면 별도로 라우팅과 SSR(Server Side Rendering)을 구성해야 합니다.</p>\n<p>하지만 Gatsby의 도움을 받으면 비교적 간단하게 리액트를 활용하여 빠르고 유연한 정적 페이지를 생성할 수 있습니다. Gatsby를 활용할 때 생기는 장점 소개는 공식 사이트의 소개와 <a href="https://blog.scottnonnenberg.com/static-site-generation-with-gatsby-js/">이 포스팅</a>으로 가볍게 미루겠습니다.</p>\n<p><strong>여담이지만 이번에 Facebook에서 React 16 발매와 함께 <a href="https://reactjs.org">웹사이트</a>를 개편할 때 Gatsby를 사용했습니다</strong> 😏</p>\n<p>제가 블로그를 다시 만들면서 했던 일들은 기본적인 프로젝트 설정을 한 뒤에, 일반적인 리액트 애플리케이션 만들듯이 컴포넌트를 작성하고 배포 커맨드를 입력한 정도밖에 되지 않았습니다. (실제로는 자잘한 작업들이 더 있긴 했지만 큰 틀은 이렇습니다) 이제부터 실제로 이 블로그를 제작한 과정 일부와 문제 해결 과정을 코드와 함께 소개해 드리겠습니다.</p>\n<p><strong>아래 내용을 보시기에 앞서 <a href="https://www.gatsbyjs.org/tutorial/">Gatsby 공식 튜토리얼</a>을 참고하시기 바랍니다. 대부분은 공식 튜토리얼에서 사용한 코드 및 Gatsby로 만들어진 블로그의 코드 일부를 참고하였습니다.</strong></p>\n<p><strong>또한 아래에 정리하는 내용은 기초 수준 이상의 리액트 라이브러리의 이해를 전제로 작성하였습니다.</strong></p>\n<h2 id="프로젝트-설정"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 설정</h2>\n<p>먼저 이 블로그를 만들기 시작한 시점의 로컬 개발환경은 다음과 같습니다</p>\n<ul>\n<li><strong>Yarn</strong>: <code class="language-text">1.1.0</code> (npm은 사용하지 않았습니다)</li>\n<li><strong>Node.js</strong>: <code class="language-text">8.6.0</code></li>\n</ul>\n<p>핵심은 이 둘이고 나머지는 필요한 패키지만 설치하면 가능한 한 최신 버전으로 유지하시면서 개발하시면 됩니다.</p>\n<h3 id="gatsby-프로젝트-생성"><a href="#gatsby-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby 프로젝트 생성</h3>\n<p>먼저 Gatsby의 CLI를 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn global add gatsby-cli</code></pre>\n      </div>\n<p>그리고 레일즈 등의 프로젝트를 생성하듯이 터미널에 명령어를 <code class="language-text">gatsby new blog</code> 명령어를 입력하시면 되는데, 만약 마음에 드는 Gatsby 스타터(보일러플레이트)를 발견하시면 Git 주소를 인자로 입력하실 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 빈 프로젝트 생성\ngatsby new blog\n\n# 보일러플레이트 이용 예\ngatsby new blog https://github.com/dschau/gatsby-blog-starter-kit</code></pre>\n      </div>\n<p>그리고 <code class="language-text">blog</code> 폴더를 에디터로 열어 작업하시면 됩니다. 저는 Visual Studio Code를 사용했습니다.</p>\n<h3 id="prettier-설정"><a href="#prettier-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prettier 설정</h3>\n<p>기존에는 프로젝트에 ESLint를 활용해서 코드 스타일을 유지했는데, <a href="https://github.com/prettier/prettier">Prettier</a>를 활용하기 시작하면서 굳이 필요가 없게 되었습니다. 특히 이 트윗을 보고 나서 <code class="language-text">prettier-eslint</code> 플러그인마저 필요 없다는 사실을 뒤늦게 깨달았습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">PSA: I&#39;m no longer using prettier-eslint. I use raw prettier and disable all eslint style rules.<br><br>My life has been better ever since...</p>&mdash; Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/913760103118991361?ref_src=twsrc%5Etfw">September 29, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>여러분들도 가독성있는 코드 스타일을 유지하는데 관심이 있으시다면 다음 설정을 참고해 보시기 바랍니다.\n먼저 프로젝트에 Prettier를 추가합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn add prettier --dev</code></pre>\n      </div>\n<p>VS Code 사용자 기준으로 다음 플러그인도 설치하셔야 합니다.</p>\n<p><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier - JavaScript formatter - Visual Studio Marketplace</a></p>\n<p>그리고 커맨드 팔레트(macOS기준 Cmd+Shift+P)를 열어 <code class="language-text">Preferences: Open Workspace Settings</code> 를 선택하신 뒤에 Prettier 스타일 세팅 및 저장시 자동 적용을 활성화 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .vscode/settings.json\n<span class="token punctuation">{</span>\n  <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token property">"prettier.printWidth"</span><span class="token operator">:</span> <span class="token number">100</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>저는 스타일 기본값을 사용하고 한 줄당 길이만 100이 되도록 설정하였습니다. 앞으로는 저장 시 자동으로 파일마다 Prettier가 작동하여 코드의 스타일을 다듬어줍니다.</p>\n<h3 id="플러그인-설치"><a href="#%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>플러그인 설치</h3>\n<p>Gatsby의 다양한 플러그인을 활용하여 사용자가 더 편하게 웹페이지를 제작할 수 있습니다. 특히 보통 리액트를 사용할 때 많이 활용하는 패키지와 Gatsby가 잘 결합되도록 따로 플러그인을 만들어 배포하고 있습니다. 예를 들어 <code class="language-text">react-helmet</code> 을 사용하시려면 <code class="language-text">gatsby-plugin-react-helmet</code> 플러그인을 설치하여 설정 파일에서 불러오도록 만들어야 합니다. 사용 가능한 플러그인 리스트는 <a href="https://www.gatsbyjs.org/docs/plugins/">공식 문서</a>를 참고해주세요.</p>\n<p>저는 제 블로그를 구현하기 위한 기능을 먼저 정의한 뒤에 필요한 부분만 플러그인을 추가 &#x26; 설정하였습니다.</p>\n<ul>\n<li>유동적으로 HTML <code class="language-text">head</code> 태그가 바뀌어야 한다(제목 등) -> <code class="language-text">gatsby-react-helmet</code></li>\n<li>Sass(SCSS)를 사용한다 -> <code class="language-text">gatsby-plugin-sass</code></li>\n<li>\n<p>(당연하지만) 본문에 마크다운을 사용한다 -> <code class="language-text">gatsby-transformer-remark</code></p>\n<ul>\n<li>마크다운에 트위터 임베딩이 필요하다 -> <code class="language-text">gatsby-plugin-twitter</code></li>\n<li>마크다운에 Syntax highlighting이 필요하다 -> <code class="language-text">gatsby-remark-prismjs</code></li>\n<li>…</li>\n</ul>\n</li>\n<li>…</li>\n</ul>\n<p>실제 적용된 플러그인의 전체 목록은 소스코드를 참고해 주시기 바랍니다.</p>\n<p>플러그인은 프로젝트 폴더에 <code class="language-text">gatsby-config.js</code> 파일을 만들어서 자바스크립트 객체로 내보내시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  siteMetadata<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    siteUrl<span class="token punctuation">:</span> <span class="token string">"https://emaren84.github.io"</span><span class="token punctuation">,</span>\n    title<span class="token punctuation">:</span> <span class="token string">"rinae\'s blog"</span><span class="token punctuation">,</span>\n    description<span class="token punctuation">:</span> <span class="token string">"about Translation, Ruby, Javascript, Practical Dev etc."</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"gatsby-plugin-react-helmet"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-catch-links"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-sass"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-styled-components"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-twitter"</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n    <span class="token string">"gatsby-remark-responsive-iframe"</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="실제-블로그-포스트를-가져오기"><a href="#%EC%8B%A4%EC%A0%9C-%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실제 블로그 포스트를 가져오기</h2>\n<h3 id="프로젝트-폴더-구성"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 폴더 구성</h3>\n<p>Gatsby로 페이지를 작성하는데 필요한 폴더는 세 가지 입니다.</p>\n<ul>\n<li><code class="language-text">src/layouts</code> - 페이지의 전반적인 레이아웃을 담당. 모든 개별 페이지가 이 폴더의 <code class="language-text">index.js</code> 파일의 하위 컴포넌트로 동작함.</li>\n<li><code class="language-text">src/pages</code> - 개별 페이지를 담아두는 폴더. 블로그 포스트(마크다운)나 404, index 페이지를 작성</li>\n<li><code class="language-text">src/templates</code> - 반복되는 페이지의 템플릿을 저장 (예: 블로그 포스트의 템플릿)</li>\n</ul>\n<p>위 폴더의 구조는 얼마든지 사용자화 할 수 있습니다. 다만 저는 제시된 구조로 충분했기 때문에 특별히 변형하진 않았습니다. 추가적으로 재사용이 잦은 컴포넌트를 <code class="language-text">src/components</code> 폴더에 정의하여 사용했습니다.</p>\n<p>참고로 <code class="language-text">src/pages</code> 폴더에 저장해 둔 마크다운 파일을 불러오기 위해서 약간의 설정이 필요합니다. 위에서 언급한 <code class="language-text">gatsby-config.js</code> 파일에 다음 플러그인을 추가해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\n<span class="token comment">// ...</span>\n\tplugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token comment">// ...</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\tresolve<span class="token punctuation">:</span> <span class="token string">"gatsby-source-filesystem"</span><span class="token punctuation">,</span>\n\t\t\toptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\tpath<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/pages`</span></span><span class="token punctuation">,</span>\n\t\t\t\tname<span class="token punctuation">:</span> <span class="token string">"pages"</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t\t<span class="token comment">// ...</span>\n\t<span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="기본-레이아웃-작성"><a href="#%EA%B8%B0%EB%B3%B8-%EB%A0%88%EC%9D%B4%EC%95%84%EC%9B%83-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 레이아웃 작성</h3>\n<p><code class="language-text">src/layout/index.js</code> 파일은 대부분의 리액트 프로젝트의 <code class="language-text">index.html</code> 같은 파일입니다. 보통 <code class="language-text">index.html</code> 파일에서 favicon, head 태그 등의 공통적인 내용을 정의한 뒤에 ReactDOM이 랜더링될 위치를 지정해 주지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Helmet <span class="token keyword">from</span> <span class="token string">"react-helmet"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// import styles</span>\n<span class="token keyword">import</span> <span class="token string">"typeface-noto-sans"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"bulma"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"mdi/scss/materialdesignicons.scss"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"prismjs/themes/prism-solarizedlight.css"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"./layout-style.scss"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> favicon <span class="token keyword">from</span> <span class="token string">"../assets/favicon.ico"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TemplateWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charSet</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Rinae\'s playground<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shortcut icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>favicon<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Helmet</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span> <span class="token attr-name">toggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>toggled<span class="token punctuation">}</span></span> <span class="token attr-name">handleToggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleToggled<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Footer</span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Helmet</code> 컴포넌트는 html의 <code class="language-text">head</code> 태그를 생성해주는 역할을 합니다. 그리고 <code class="language-text">Link</code> 컴포넌트는 react-router의 <code class="language-text">Link</code> 컴포넌트와 거의 동일하게 작동합니다. 주로 특정 DOM 엘리먼트를 클릭하면 페이지 어디로 이동할지 지정해줄 때 사용합니다. 개발자 도구를 열어보면 <code class="language-text">a</code>  태그가 랜더링되지만 페이지를 다시 불러오지 않고 미리 준비된 다른 컴포넌트와 바꿔치기 하는 방식으로 동작하나 봅니다.</p>\n<p><code class="language-text">props</code> 로 내려온 <code class="language-text">children</code> 이 일반 페이지 컴포넌트들이 됩니다. 말 그대로 <code class="language-text">src/layout/index.js</code> 는 모든 페이지들의 부모 컴포넌트가 된다고 이해하시면 되겠습니다.</p>\n<h3 id="포스트-리스트-보여주기"><a href="#%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EB%A6%AC%EC%8A%A4%ED%8A%B8-%EB%B3%B4%EC%97%AC%EC%A3%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>포스트 리스트 보여주기</h3>\n<p>이번에는 <code class="language-text">src/pages/index.js</code> 파일을 살펴보겠습니다. 이 페이지는 블로그에 접속하면 가장 처음 접하게 되는 페이지로, 모든 포스트를 리스트로 가져와서 최신 순서대로 나열해주는 역할을 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> Hero <span class="token keyword">from</span> <span class="token string">"../components/Hero"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PostList <span class="token keyword">from</span> <span class="token string">"../components/PostList"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">IndexPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> edges <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> postsData <span class="token operator">=</span> edges<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>edge <span class="token operator">=></span> edge<span class="token punctuation">.</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Hero</span>\n          <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Welcome to my writing playground<span class="token punctuation">"</span></span>\n          <span class="token attr-name">subtitle</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>about Translation, Ruby, Javascript, Practical Dev etc.<span class="token punctuation">"</span></span>\n        <span class="token punctuation">/></span></span>\n\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-10-tablet is-offset-1-tablet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PostList</span> <span class="token attr-name">postsData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>postsData<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query IndexQuery {\n    allMarkdownRemark(limit: 1000, sort: { order: DESC, fields: [frontmatter___date] }) {\n      edges {\n        node {\n          excerpt(pruneLength: 250)\n          id\n          frontmatter {\n            title\n            category\n            date(formatString: "YYYY/MM/DD")\n            path\n          }\n        }\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>파일 아래 부분에 <code class="language-text">pageQuery</code>를 주목해주세요. <code class="language-text">graphql</code>? 무슨 정적 사이트 생성기에 GraphQL을 쓰지? 라는 생각을 했는데, Gatsby에서 나름 효율적으로 사용자가 원하는 자료를 가져올 수 있도록 제공된 인터페이스를 사용하는 느낌이었습니다.</p>\n<p>저도 GraphQL을 이름만 들어보고 실제로 사용해본 적은 한 번도 없었지만 공식 사이트의 튜토리얼을 참고해보고, Gatsby에서 제공하는 GraphQL IDE(개발 모드에서 <code class="language-text">localhost:8000/___graphql</code>)로 여러가지 실험을 해 보니 필요한 만큼은 이해할 수 있었습니다. 당장 GraphQL에 익숙하지 않으시더라도 저 쿼리가 대강 어떤 자료를 가져오려고 하는 지 눈에 잘 들어올겁니다. 실제 리턴받는 데이터도 저 구조대로 자바스크립트 객체 형태를 가지고 있습니다.</p>\n<hr>\n<p>미처 설명드리지 못했지만 <code class="language-text">frontmatter</code> 는 각각의 마크다운 파일 맨 처음에 작성하는 일종의 헤더로 다음과 같이 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">---\ntitle: &quot;Some title&quot;\ncategory: &quot;Example&quot;\ndate: &quot;2017/10/04&quot;\npath: &quot;/posts/some-title&quot;\n...\n---</code></pre>\n      </div>\n<hr>\n<p>쿼리하고 받은 데이터는 같은 파일에 작성된 리액트 컴포넌트에 <code class="language-text">props</code>로 자동 설정됩니다. 그래서 <code class="language-text">this.props.data.allMarkdownRemark</code> 처럼 사용할 수 있는 겁니다.</p>\n<p>그런데 마크다운으로 작성된 블로그 포스트는 어떻게 리액트 컴포넌트로 표현해주어야 할까요? <code class="language-text">http://blog.com/post/1</code> 같이 포스트마다 고유의 경로를 가져야 할 테고, 그러려면 <code class="language-text">src/pages</code> 안에 각각의 포스트마다 컴포넌트를 작성해주어야 할까요? 다행히도 그렇게 복잡한 방식을 사용할 필요는 없습니다.</p>\n<h3 id="블로그-포스트-생성하기"><a href="#%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블로그 포스트 생성하기</h3>\n<p>Gatsby는 자체 Node API를 제공하여 페이지를 생성하거나 수정하는 작업을 처리할 수 있습니다. 리액트의  Lifecycle methods 처럼 페이지 생성부터 종료까지 다양한 시점에 걸쳐 설정을 할 수 있지만, 저는 <code class="language-text">createPages</code> 메서드만 사용했습니다.</p>\n<p>자세한 내용은 <a href="https://www.gatsbyjs.org/docs/creating-and-modifying-pages/">공식 문서</a>를 참고해주세요. 또한 대부분 공식 튜토리얼 파트4에 소개되어있는 내용을 참고했습니다.</p>\n<p>먼저 프로젝트 루트에 <code class="language-text">gatsby-node.js</code> 파일을 생성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-node.js</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">boundActionCreators</code> 는 Redux로 구현된 다양한 행동 모음집(액션 디스패처들)입니다. 우리는 여기서 <code class="language-text">createPage</code> 액션 하나만 사용할 예정입니다. <code class="language-text">graphql</code> 은 GraphQL 쿼리를 실행하고 그 결과를 프로미스로 리턴하는 함수입니다. <code class="language-text">createPages</code> 함수 내부를 조금 더 자세히 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> createPage <span class="token punctuation">}</span> <span class="token operator">=</span> boundActionCreators<span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> blogPostTemplate <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`src/templates/blog-post.js`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">graphql</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n    {\n      allMarkdownRemark(sort: { order: DESC, fields: [frontmatter___date] }, limit: 1000) {\n        edges {\n          node {\n            excerpt(pruneLength: 250)\n            html\n            id\n            frontmatter {\n              date\n              path\n              title\n              tags\n              category\n            }\n          }\n        }\n      }\n    }\n  `</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">const</span> posts <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n\n    posts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> node <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        path<span class="token punctuation">:</span> node<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>path<span class="token punctuation">,</span>\n        component<span class="token punctuation">:</span> blogPostTemplate<span class="token punctuation">,</span>\n        context<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">blogPostTemplate</code> 는 블로그 포스트를 표현하기 위한 리액트 컴포넌트입니다. 조금 뒤에 살펴보겠습니다.</p>\n<p><code class="language-text">graphql</code> 함수가 쿼리를 하고 나온 결과는 <code class="language-text">result.data</code> 에 담기게 되며 아까 <code class="language-text">src/pages/index.js</code> 파일 안에서 GraphQL 쿼리 결과를 가져올 때랑 똑같이 다룰 수 있습니다.</p>\n<p>그리고 <code class="language-text">createPage</code> 라는 함수에 각각의 포스트를 인자로 넘기면 됩니다. <code class="language-text">path</code> 속성은 어떤 URL로 생성될지, <code class="language-text">component</code> 는 어떤 컴포넌트를 사용하여 페이지를 만들지 지정합니다. <code class="language-text">context</code> 는 상황에 따라 사용자 임의의 속성을 지정해줄 수 있는 기능인데, 저는 굳이 사용하지 않았습니다.</p>\n<p>중요한 점은 저 <code class="language-text">path</code> 속성이 템플릿 컴포넌트로 넘어갈때 GraphQL의 인자로 사용된다는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// src/templates/blog-post.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Template</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> markdownRemark<span class="token punctuation">:</span> post <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>tags<span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-8-tablet is-offset-2-tablet is-8-desktop is-offset-2-desktop<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span> <span class="token attr-name">title</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - Rinae\'s playground`</span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>has-text-grey-light is-size-6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>date<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> __html<span class="token punctuation">:</span> post<span class="token punctuation">.</span>html <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TagList</span> <span class="token attr-name">tags</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tags<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>About</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info is-large<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-medium<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mdi mdi-36px mdi-format-list-bulleted<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Back to All posts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query BlogPostByPath($path: String!) {\n    markdownRemark(frontmatter: { path: { eq: $path } }) {\n      html\n      frontmatter {\n        date(formatString: "YYYY/MM/DD")\n        path\n        title\n        tags\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">pageQuery</code> 의 <code class="language-text">graphql</code> 이 인자로 <code class="language-text">$path</code> 를 받는데 아까 <code class="language-text">createPage</code> 함수에서 가져온 <code class="language-text">path</code> 속성을 의미합니다. 그리고 <code class="language-text">$path</code> 를 이용하여 <strong>마크다운 파일 중에  frontmatter의 path가 <code class="language-text">$path</code> 와 같은 노드를 검색하라</strong> 라는 쿼리를 전달할 수 있는 것입니다. 나머지는 그 데이터를 그대로 컴포넌트에 넘겨주기만 하면 됩니다.</p>\n<p>그리고 마크다운 파일은 플러그인에 의해 자동으로 html로 변환되는데, 이 html을 <a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml"><code class="language-text">dangerouslySetInnerHTML</code> 속성</a>을 사용해서 주입했습니다.</p>\n<p>설명을 보시면서 생략된 부분이 많다고 느끼실 수 있지만, 앞서 언급한 공식 튜토리얼을 가볍게 진행해보시면 생각보다 쉽게 간단한 블로그정도는 만들 수 있다는 생각이 드실 겁니다.</p>\n<h2 id="자잘한-문제-해결"><a href="#%EC%9E%90%EC%9E%98%ED%95%9C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자잘한 문제 해결</h2>\n<p>하지만 공식 문서에서는 미처 언급되지 않아 제가 약간 삽질을 하면서 해결했던 문제들이 있습니다. 기록 겸 이 글을 읽으시는 분들이 만약 같은 문제를 겪으실 때 쉽게 해결하실 수 있었으면 좋겠습니다.</p>\n<h3 id="rss-feed-설정"><a href="#rss-feed-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RSS Feed 설정</h3>\n<p>Gatsby는 RSS Feed를 생성하는 플러그인을 제공합니다. 제 블로그가 아무리 대단한 내용이 없다 하더라도 RSS Feed를 제공하는 것은 기본 중의 기본이라 생각하여 설정하고 있었는데, 아무리 해도 <code class="language-text">head</code> 태그에 <code class="language-text">rss.xml</code> 파일이 제대로 된 경로로 설정되지 않았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n\t<span class="token comment">&lt;!-- rss.xml의 경로가 절대경로로만 표시된다 --></span>\n\t<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alternate<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>application/rss+xml<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/rss.xml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>이렇게 되면 제가 기존에 쓰던 블로그 주소인 <code class="language-text">https://emaren84.github.io/blog</code> 를 사용할 경우 RSS Feed를 제공할 수 없게 됩니다. 왜냐면 <code class="language-text">rss.xml</code> 의 위치는 <code class="language-text">https://emaren84.github.io/rss.xml</code> 이 되어버리기 때문입니다.</p>\n<p>플러그인 소스를 보니  <code class="language-text">pathPrefix</code> 설정을 받아들이는 부분도 없고 무조건 절대경로로 파일을 생성하도록 되어있나봅니다.</p>\n<p>결국 블로그 주소를 바꿔서 해결했지만.. 기존에 사용하던 지킬 테마에서는 피드 생성이 잘 되었다는 것을 생각해보면 나중에 수정되었으면 좋겠습니다.</p>\n<h3 id="gif-파일-표시"><a href="#gif-%ED%8C%8C%EC%9D%BC-%ED%91%9C%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GIF 파일 표시</h3>\n<p>Gatsby의 remark-images 플러그인은 jpg, png 파일은 아주 잘 처리합니다. 다만 gif파일은 처리하지 않습니다. 보통 gif 파일을 쓸 일이 없긴 하지만, 몇몇 포스트에 gif파일을 사용하기 때문에 문제를 해결해야 했습니다.</p>\n<p><code class="language-text">gatsby-remark-copy-linked-files</code> 을 추가하면 문제는 해결됩니다. 이 플러그인은 PDF 파일 등의 링크를 제공할 때 사용하는 플러그인으로 생각하고 간과하고 있었는데, 이 플러그인을 설치한 채로 gif파일의 링크를 설정하니 잘 작동합니다.</p>\n<h3 id="코드-블락의-css-오류"><a href="#%EC%BD%94%EB%93%9C-%EB%B8%94%EB%9D%BD%EC%9D%98-css-%EC%98%A4%EB%A5%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>코드 블락의 CSS 오류</h3>\n<p>개발 블로그를 작성하면서 가장 중요한게 코드의 표현인데, Gatsby로 블로그를 만들고 나니 일부 코드 블락이 이상하게 표현되었습니다. 처음에는 PrismJS 플러그인의 문제라고 생각했는데, 제가 이 블로그를 만들기 위해 사용한 CSS 프레임워크인 Bulma의 CSS와 일부 충돌하는 부분이 있었기 때문에 코드가 이상하게 나온 것이었습니다.</p>\n<p>블로그 포스트 템플릿에 CSS를 추가하여 문제를 해결했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-scss"><code class="language-scss"><span class="token comment">// ...</span>\n<span class="token comment">// resolve conflicts between bulma css preset and prismjs</span>\n<span class="token selector">pre[class*="language-"] .tag,\npre[class*="language-"] .number </span><span class="token punctuation">{</span>\n  <span class="token property">align-items</span><span class="token punctuation">:</span> stretch<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>\n  <span class="token property">font-size</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>\n  <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>\n  <span class="token property">line-height</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">white-space</span><span class="token punctuation">:</span> pre<span class="token punctuation">;</span>\n  <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>\n  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>\n  <span class="token property">vertical-align</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<hr>\n<p>제가 만든 블로그는 <a href="https://github.com/emaren84/gatsby-blog">Github에 공개 되어 있습니다</a>. 커밋 로그를 조금 살펴보시면 블로그에서 미처 언급하지 못했던 제작과정을 참고하실 수 있습니다.</p>\n<p><strong>참고자료</strong></p>\n<ul>\n<li><a href="https://www.gatsbyjs.org/tutorial/">Gatsby Tutorial</a></li>\n<li><a href="https://github.com/alxshelepenok/gatsby-starter-lumen">GitHub - alxshelepenok/gatsby-starter-lumen: Lumen is a minimal, lightweight and mobile-first starter for creating blogs uses Gatsby</a></li>\n<li><a href="https://dustinschau.com/blog/getting-started-with-gatsby">Dustin Schau - Creating a Blog with Gatsby</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-10-05-creating-new-blog-with-gatsby/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-10-05",path:"/posts/creating-new-blog-with-gatsby",title:"Gatsby를 활용한 블로그 재구성",tags:["Markdown","React","GraphQL"],category:"Gatsby"}},{excerpt:"이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다. 원문을 보시려면  이 링크 를 클릭해주세요. 안녕하세요, Boostnote 개발자  kazup  입니다. 예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다. What is Boostnote? 프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 15…",html:'<ul>\n<li>이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다.</li>\n<li>원문을 보시려면 <a href="http://boostnote.hatenablog.com/entry/2017/08/09/130721">이 링크</a>를 클릭해주세요.</li>\n</ul>\n<hr>\n<p>안녕하세요, Boostnote 개발자 <a href="https://twitter.com/kazup_bot">kazup</a> 입니다.</p>\n<p>예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다.</p>\n<h2 id="what-is-boostnote"><a href="#what-is-boostnote" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Boostnote?</h2>\n<p>프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 150가지가 넘는 언어의 Syntax Highlighting 및 스니펫을 저장하는 기능도 있습니다.</p>\n<p>개발자를 위한 특화 기능으로 vim 키맵을 사용하거나 마크다운 안에 작성해둔 코드를 원터치로 저장하는 등 개발자들이 즐겁게 사용할만한 기능들이 포함되어 있습니다.</p>\n<p>또한 에버노트에서 데이터를 가져오는 <a href="https://github.com/BoostIO/ever2boost">ever2boost</a> 등의 서드파티 도구들도 여럿 있어서 간단하게 이용하실 수 있습니다.</p>\n<h2 id="what-is-notes"><a href="#what-is-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Notes?</h2>\n<p>여러분의 친숙한 애플 순정 메모 어플리케이션입니다. Boostnote와 달리 누구나 즐겁게 사용할 수 있게 만들어져 있습니다.</p>\n<p>가볍게 동작하기 때문에 사소한 메모를 남겨두고 싶을 때 편리하게 이용할 수 있습니다.</p>\n<h2 id="the-key-differences-of-boostnote-vs-notes"><a href="#the-key-differences-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The key differences of Boostnote vs Notes</h2>\n<p>가장 큰 차이점은 대상 사용자입니다. Boostnote는 명확하게 개발자를 대상으로 삼고 있지만 Notes는 누구나 부담없이 사용할 수 있게 만들어져 있습니다.</p>\n<p>예를 들어 Notes는 플레인 텍스트(Plain text)만 지원하는 반면, Boostnote는 마크다운과 스니펫을 저장할 수 있습니다.</p>\n<p>또한 커스터마이즈 가능한 부분도 큰 차이가 나는데, Boostnote가 단축키부터 컬러 테마, 앞서 말씀드린 키맵(vim 등)의 변경이 가능한 반면 Notes는 어디까지나 간단하면서 일관된 경험을 제공합니다.</p>\n<h2 id="a-comparison-of-boostnote-vs-notes"><a href="#a-comparison-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A comparison of Boostnote vs Notes</h2>\n<p>주요 차이점을 정리해보았습니다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Boostnote</th>\n<th>Notes</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>노트북 포맷</td>\n<td>Markdown and snippet</td>\n<td>Plain text</td>\n</tr>\n<tr>\n<td>가격</td>\n<td>무료</td>\n<td>무료</td>\n</tr>\n<tr>\n<td>데이터 저장소</td>\n<td>Local, Dropbox, Google Drive 등</td>\n<td>Local, iCloud, Google</td>\n</tr>\n<tr>\n<td>플랫폼</td>\n<td>Windows, Mac, Linux (iOS, Android 출시 예정)</td>\n<td>Mac, iOS</td>\n</tr>\n<tr>\n<td>주요 대상</td>\n<td>Developer</td>\n<td>Everyone</td>\n</tr>\n<tr>\n<td>사용자 정의</td>\n<td>Color, Code Block and Editor theme, Keymap, Hotkey</td>\n<td>X</td>\n</tr>\n<tr>\n<td>노트 공유</td>\n<td><a href="https://10hz.io/">10hz</a></td>\n<td>via iCloud</td>\n</tr>\n</tbody>\n</table>\n<h2 id="wrapping-it-up"><a href="#wrapping-it-up" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrapping it up.</h2>\n<p>이상 Boostnote와 Notes를 비교해보았습니다. 둘 다 겉으로 보기에는 아주 단순해보이지만, 그 단순함 속에 숨겨진 기능이나 구조의 차이가 있어서 비교해보니 꽤 재밌었습니다.</p>\n<p>Boostnote는 훨씬 더 개발자지향적이고 무엇보다 <a href="https://github.com/BoostIO/Boostnote">오픈소스입니다</a>! 널리 개발자들에게 사용되어 다양한 수정을 거쳐 기회가 된다면 풀 리퀘스트를 주고받고 싶습니다.</p>\n<p>서두에서 말씀드린대로 Notes에서 갈아타는 분들이 많이 보이고 있으니 주변에 쓸만한 노트 앱을 찾고 계신 개발자분들이 계시다면 Boostnote를 추천해 주세요!</p>\n<p>또한 <a href="https://boostnote.io/team/">팀 단위로 노트로 기획된 10hz</a>도 현재 베타버전으로 배포되고 있으니 한번 살펴봐주시기 바랍니다.</p>\n<hr>\n<p>사실 일본어는 간단하게 말을 주고받는 정도만 할 수 있을 뿐이지, 실제로 잘 읽을 수 있는 수준은 아니라 번역기와 사전의 도움을 받아가며 작업했습니다. 그래도 내용이 어렵지 않아서 오래 걸리지 않았네요.</p>\n<p>노트를 다양한 플랫폼으로 여기저기 작성해보면서 가장 맞는 스타일의 앱을 찾고 있는데 현재로서 Boostnote가 제가 생각하는 개발노트용 앱으로 가장 알맞다고 생각하여 이렇게 소개하는 글을 번역해 보았습니다.</p>\n<p>마크다운 문법만 익숙하시다면 사용하는게 그리 어렵지 않을테니 가벼운 마음으로 한번 시도해보세요 :)</p>',id:"/home/circleci/repo/src/pages/posts/2017-08-09-boostnote-vs-notes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-08-09",path:"/posts/boostnote-vs-notes-kor",title:"[번역] Boostnote vs Notes: Choosing a note-taking Tool",tags:["Markdown","Tools","OSS","Translation"],category:"Translation"}},{excerpt:"…",html:'<h2 id="한동안-마크다운으로-노트를-작성해본-후-느끼는-아쉬움"><a href="#%ED%95%9C%EB%8F%99%EC%95%88-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4%EC%9C%BC%EB%A1%9C-%EB%85%B8%ED%8A%B8%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%B4%EB%B3%B8-%ED%9B%84-%EB%8A%90%EB%81%BC%EB%8A%94-%EC%95%84%EC%89%AC%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>한동안 마크다운으로 노트를 작성해본 후 느끼는 아쉬움</h2>\n<p>마크다운 문법을 이용한 글 작성에 조금씩 익숙해지고 있는 것은 좋은데, 조금씩 노트의 양이 늘어가니 관리하기가 힘들어질 것 같다는 걱정이 들기 시작했다.<br>\n여지껏 노트를 작성하더라도 그렇게 잘 활용하진 못한 기분이 들지만.. 이번에는 개발노트(업무일지, 스터디노트), 각종 새로 배운 내용들, 아이디어들 등을 마크다운 문서로 작성해서 보관하고자 하는 목표가 생겼다.<br>\n에버노트나 원노트 등과 비교해서 마크다운 문서를 작성했을 때의 장점이라면</p>\n<ul>\n<li>단순함</li>\n<li>다른 양식이 필요없이 텍스트만으로 작성 가능</li>\n<li>코드 적기에 용이함(이게 제일 큰 차이점)</li>\n<li>플랫폼의 구애를 받지 않음</li>\n</ul>\n<p>이정도를 들 수 있겠는데, 문제는 그 단순함에 비례한 관리의 어려움이다.\n처음에 심플노트를 쓰기 시작하고, 그와 더불어 nvALT를 알게 되면서 \'간단히 노트를 작성하고 동기화하기에 굉장히 좋구나\' 라고 생각하게 되었는데 폴더 관리 방식이 아니다보니 태그만으로는 정리하기가 좀 힘들어지고 있다.</p>\n<p>태그 정렬방식의 또 다른 문제는 심플노트와 nvALT에 종속될 수 밖에 없다는 것이다.<br>\n노트들은 폴더 하나에 텍스트파일로 죄다 들어가게 되는데 지금이야 100개 조금 넘는 정도의 노트지만, 점점 노트가 늘어갈 수록 어떤 노트가 무슨 내용을 담고 있는지 한 눈에 알아보기 힘들고 관리하기 힘들어질 수 있겠다는 생각이 들었다.</p>\n<p>특히 조금씩이지만 랩탑의 활용도가 늘고 있는데 랩탑이 맥이 아니다보니 nvALT를 사용할 수 없는 부분이 크게 작용했다.<br>\nnvPY로 유사한 인터페이스의 심플노트 싱크는 가능하지만, 드롭박스에 텍스트파일을 생성하지 않다보니 나에게는 반쪽자리 애플리케이션이었기 때문이다.</p>\n<h2 id="마크다운--심플노트--드롭박스-작업환경을-생각해보다"><a href="#%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4--%EC%8B%AC%ED%94%8C%EB%85%B8%ED%8A%B8--%EB%93%9C%EB%A1%AD%EB%B0%95%EC%8A%A4-%EC%9E%91%EC%97%85%ED%99%98%EA%B2%BD%EC%9D%84-%EC%83%9D%EA%B0%81%ED%95%B4%EB%B3%B4%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마크다운 + 심플노트 + 드롭박스 작업환경을 생각해보다</h2>\n<p>내가 생각하는 노트 동기화 환경은 드롭박스를 메인으로 하고 심플노트를 서브로 사용하는 방식으로 이용하고 싶은데 그러면 드롭박스에 생성된 텍스트 파일들이 전부 따로 제목을 가지고 있어서 문제가 된다.</p>\n<p>많은 고민과 검색 끝에 조금이나마 내놓은 대책은 <strong>제목을 태그화하는 것</strong>인데, 첫 제목(파일 이름)을 일정 형식으로 만들어서 태그를 매긴 것 처럼 보이게 하고, 텍스트 본문 첫 줄에 제목을 작성하는 형식으로 관리를 하는 것이다.</p>\n<p><strong>Sample tag names</strong></p>\n<ul>\n<li>refx - reference</li>\n<li>runx - running list</li>\n<li>rcpx - recipes</li>\n<li>mtgx - meeting notes</li>\n<li>blogx - blog entires</li>\n<li>contactx - contact information records</li>\n<li>carx - auto info</li>\n<li>notex - note taking for courses or lectures</li>\n<li>lolx - wildcard!!!</li>\n</ul>\n<p>이런 식의 태그 이름을 활용하여 제목을 <code class="language-text">refx-emacs-tutorial</code> 등으로 작성하는 것이다.\n왜 태그 이름에 X가 붙냐면 <strong>태그임을 명시</strong> 하기 위함인데, 보통 ref 등으로 검색을 하면 ref가 딸려있는 내용들이 죄다 같이 검색이 될 텐데 refx 같은 단어는 굉장히 독특하기 때문에 태그만 나올 것이기 때문이다.</p>\n<p>저런 태그를 이용하여 현재까지 작성 된 모든 노트의 이름을 형식화하는 작업을 하려고 한다.\n먼저 내가 사용하고자 하는 나만의 태그를 정의해본다면</p>\n<ul>\n<li>refx: 레퍼런스, 팁</li>\n<li>ideax: 순간의 아이디어, 구상</li>\n<li>devnotex: 개발노트</li>\n<li>studyx: 공부노트</li>\n<li>infox: 특정 정보</li>\n<li>reviewx: 리뷰</li>\n<li>blogx: 블로그 포스팅</li>\n<li>readx: 책이나 자료를 읽고 작성</li>\n</ul>\n<p>뭔가 생각나는데로 마구 작성해봤는데 많이 사용되는 태그는 위에서 4개까지일 것이라 생각된다.\n낑낑대면서 약 120개의 노트의 제목을 다시 정리하고, 원래 노트의 제목(txt 파일 이름)은 노트 본문의 첫번째 줄에다 마크다운의 h1태그를 써서 옮겨두었다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 73.36842105263158%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACQklEQVQ4y5VUzXKbMBjk/V+qOfiSHppDazu4xvwLEEKAsYHacbb7aRLaTJuZRDM7Ax6x2t1vZW///Su24RZJlCCKIsRxgjTNUNc1tNYOZVkiz3P3XFXVf/G6zwtJsN/t4fs+dv4ORWVgbIssy6CKAiWhkhg1N0/TTEzvYhxHeKvVCl/u7nB/f4+Hh2/4sd4iVyUMFbZti8vlgqfrFbenJ3xkebvdDuv1BpvNFkoplFVNaBhjaKHC6XzGZ5YnvpMkQZ7lOB6PqLSBbTvEUYjteo3HRx8F9zSmgaZ9zWdBxcN1Uf55lz105UnYQXBwgXZd5zLUJK3SGIZhi8qaZJaKTZbCkLTRFYzKCQXLYTRViZq/WxmKEMp0D4cDxH5eVGg4lKHvME8jPru8gqfEcexqISqDMHaWa6rI8gZZeUVWzEjzCam6sCItetvwsAm3283h+fl5gacoPU1Th2E4UqHmdHsekGGzfUS0P6BgVgUzToLQ7ZnHM8ZheKNMyJxCmWwYhk6lZmaKhJaEWpfYByTJJmRqXKCqCzupoXigDKtmI66s1iupJwWWDF9VhlGKtutdoX3/J28MLfYnDqWFbTpY27t+ttbizEr1jGd6qZYjLPihkGa0VMtVMxbdcUDBKiVx5Kr0kbVYlmGEYURlEYQ8V6xE0y53c55/vUvwNxaFkmEQBCxy5Catypq16WjL0nbpiOWeSoXmecb5dHbvLwwL2ZubIpYlP/nXkPxMY9nLAJrNl48H2h76HqfTyeU3LBP+l/A3mMFxiFaJs3EAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="nvALT로 제목을 모두 수정한 후"\n        title=""\n        src="/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-ffc88.png"\n        srcset="/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-d16f8.png 198w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-f21b1.png 395w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-ffc88.png 790w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-a9d0a.png 950w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>한동안은 이런 방식으로 노트를 작성해보고 차차 수정해나갈 예정이다.\n리눅스에서는 오늘 마침 <a href="https://burnsoftware.wordpress.com/p-s-notes/">P.S Notes</a>라는 꽤 괜찮은 텍스트 작성 애플리케이션을 발견했는데, 랩탑으로 노트를 작성할 일이 이 앱으로 작성하여 드롭박스와 동기화하는 방법을 사용하려고 한다.</p>\n<hr>\n<p>References</p>\n<ul>\n<li><a href="http://computers.tutsplus.com/tutorials/superpower-your-note-taking-skills-with-nvalt-and-simplenote--cms-20816">Superpower Your Note Taking Skills With nvALT and Simplenote</a></li>\n<li><a href="https://hyungrok.com/2014/07/12/nvalt/">NVALT와 글쓰기 루틴 그리고 프로젝트 지식관리</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2016-08-04-markdown-with-dropbox-workflow/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-08-04",path:"/posts/markdown-with-dropbox-workflow",title:"마크다운, nvALT, Dropbox를 활용한 노트관리 아이디어",tags:["Markdown","Tools"],category:"Idea"}}],GraphQL:[{excerpt:"새로운 도전의 시작 올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다) 기존에도 프론트엔드 라이브러리로 React와 Vue.js…",html:'<h2 id="새로운-도전의-시작"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EB%8F%84%EC%A0%84%EC%9D%98-%EC%8B%9C%EC%9E%91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 도전의 시작</h2>\n<p>올 여름 이런저런 일을 겪고 나서, 많은 고민 끝에 한동안 프론트엔드 개발자로 커리어를 쌓아가기로 결정하였습니다. 이전에는 루비 백엔드를 기반으로 한 그냥저냥한 웹 개발자였습니다만.. 오랫동안 업무에서 루비를 쓸 일이 없겠네요. (물론 여전히 루비라는 언어 자체는 사랑하고 관심은 계속 가지고 있습니다)</p>\n<p>기존에도 프론트엔드 라이브러리로 React와 Vue.js에 많은 관심을 가지고 있었는데, 이제 본격적으로 리액트를 업무에 사용하게 되었기 때문에 <strong>리액트로 뭘 만들어볼까?</strong> 하다가 가장 만만한 블로그부터 다시 만들어 보기로 결심했습니다. 블로그를 만들고자 했던 이유는 몇 가지 더 있었습니다.</p>\n<ol>\n<li>기왕 하는거 간단한 디자인 및 프로토타이핑까지 하여 하나의 사이트 개발을 처음부터 끝까지 직접 해 보고 싶다.</li>\n<li>기존 블로그는 테마를 바로 가져다 썼는데, 충분히 좋지만 불필요한 요소나 레이아웃을 걷어내고 최대한 간소하게 만들어보고 싶다.</li>\n<li>간소하게 만들면서 관리 및 유지보수가 더 원활한 형태로 재구성하고 싶다.</li>\n</ol>\n<p>결론부터 말씀드리자면 1번은 절반의 성공만 거두고 나머지는 성공했습니다. 종이에다 어떤 모양이 나와야하는지 그려본 뒤에, 그 모습을 실제 코드로 옮기는데 성공했지만 CSS를 밑바닥부터 그려낼 실력은 되지 않아 <a href="https://bulma.io">Bulma</a>를 활용하여 만들었습니다.</p>\n<p>그러면 2, 3번은 어떻게 달성했을까요?</p>\n<h2 id="gatsby를-만나다"><a href="#gatsby%EB%A5%BC-%EB%A7%8C%EB%82%98%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby를 만나다</h2>\n<p>이전에 ‘리액트를 학습하는 과정’ 을 안내하는 포스팅을 읽은 적이 있는데 <em>기본을 익혔다면 <a href="https://www.gatsbyjs.org">Gatsby</a>같은 리액트 기반의 정적 페이지 생성기를 사용하여 리액트를 연습해보라</em> 라는 내용이 적혀있더군요. <strong>어떻게 리액트로 정적 페이지를 만들 수 있을까?</strong> 하며 궁금해하면서 이름을 기억해두고 있었습니다.</p>\n<p>보통 정적 페이지 생성기를 사용하여 블로그를 만든다고 하면 루비를 이용한 <a href="https://jekyllrb.com">Jekyll</a>과 Node.js를 이용한 <a href="https://hexo.io">Hexo</a> 등을 사용하게 됩니다. 각각의 포스팅을 마크다운으로 작성하고 생성기가 이를 html 파일로 변환해주며, 특정 정보가 삽입되어야 할 때(날짜, 사용자가 직접 입력한 정보 등)는 템플릿 엔진이 페이지 생성을 도와주는 형식으로 되어 있습니다.</p>\n<p>그런데 당시 제가 아는 수준에서 리액트로 블로그를 만드는 것은 굉장히 기술을 과하게 사용하는 일이었습니다. 먼저 블로그를 정말 메모장 대신으로 쓸 것이 아니면 검색 엔진에 노출 되는 것이 좋다고 생각하는데, 리액트로 SPA(Single Page Application)을 제작하게되면 검색엔진 봇이 내용을 수집하기 힘듭니다. 아니면 별도로 라우팅과 SSR(Server Side Rendering)을 구성해야 합니다.</p>\n<p>하지만 Gatsby의 도움을 받으면 비교적 간단하게 리액트를 활용하여 빠르고 유연한 정적 페이지를 생성할 수 있습니다. Gatsby를 활용할 때 생기는 장점 소개는 공식 사이트의 소개와 <a href="https://blog.scottnonnenberg.com/static-site-generation-with-gatsby-js/">이 포스팅</a>으로 가볍게 미루겠습니다.</p>\n<p><strong>여담이지만 이번에 Facebook에서 React 16 발매와 함께 <a href="https://reactjs.org">웹사이트</a>를 개편할 때 Gatsby를 사용했습니다</strong> 😏</p>\n<p>제가 블로그를 다시 만들면서 했던 일들은 기본적인 프로젝트 설정을 한 뒤에, 일반적인 리액트 애플리케이션 만들듯이 컴포넌트를 작성하고 배포 커맨드를 입력한 정도밖에 되지 않았습니다. (실제로는 자잘한 작업들이 더 있긴 했지만 큰 틀은 이렇습니다) 이제부터 실제로 이 블로그를 제작한 과정 일부와 문제 해결 과정을 코드와 함께 소개해 드리겠습니다.</p>\n<p><strong>아래 내용을 보시기에 앞서 <a href="https://www.gatsbyjs.org/tutorial/">Gatsby 공식 튜토리얼</a>을 참고하시기 바랍니다. 대부분은 공식 튜토리얼에서 사용한 코드 및 Gatsby로 만들어진 블로그의 코드 일부를 참고하였습니다.</strong></p>\n<p><strong>또한 아래에 정리하는 내용은 기초 수준 이상의 리액트 라이브러리의 이해를 전제로 작성하였습니다.</strong></p>\n<h2 id="프로젝트-설정"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 설정</h2>\n<p>먼저 이 블로그를 만들기 시작한 시점의 로컬 개발환경은 다음과 같습니다</p>\n<ul>\n<li><strong>Yarn</strong>: <code class="language-text">1.1.0</code> (npm은 사용하지 않았습니다)</li>\n<li><strong>Node.js</strong>: <code class="language-text">8.6.0</code></li>\n</ul>\n<p>핵심은 이 둘이고 나머지는 필요한 패키지만 설치하면 가능한 한 최신 버전으로 유지하시면서 개발하시면 됩니다.</p>\n<h3 id="gatsby-프로젝트-생성"><a href="#gatsby-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gatsby 프로젝트 생성</h3>\n<p>먼저 Gatsby의 CLI를 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn global add gatsby-cli</code></pre>\n      </div>\n<p>그리고 레일즈 등의 프로젝트를 생성하듯이 터미널에 명령어를 <code class="language-text">gatsby new blog</code> 명령어를 입력하시면 되는데, 만약 마음에 드는 Gatsby 스타터(보일러플레이트)를 발견하시면 Git 주소를 인자로 입력하실 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 빈 프로젝트 생성\ngatsby new blog\n\n# 보일러플레이트 이용 예\ngatsby new blog https://github.com/dschau/gatsby-blog-starter-kit</code></pre>\n      </div>\n<p>그리고 <code class="language-text">blog</code> 폴더를 에디터로 열어 작업하시면 됩니다. 저는 Visual Studio Code를 사용했습니다.</p>\n<h3 id="prettier-설정"><a href="#prettier-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prettier 설정</h3>\n<p>기존에는 프로젝트에 ESLint를 활용해서 코드 스타일을 유지했는데, <a href="https://github.com/prettier/prettier">Prettier</a>를 활용하기 시작하면서 굳이 필요가 없게 되었습니다. 특히 이 트윗을 보고 나서 <code class="language-text">prettier-eslint</code> 플러그인마저 필요 없다는 사실을 뒤늦게 깨달았습니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">PSA: I&#39;m no longer using prettier-eslint. I use raw prettier and disable all eslint style rules.<br><br>My life has been better ever since...</p>&mdash; Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/913760103118991361?ref_src=twsrc%5Etfw">September 29, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>여러분들도 가독성있는 코드 스타일을 유지하는데 관심이 있으시다면 다음 설정을 참고해 보시기 바랍니다.\n먼저 프로젝트에 Prettier를 추가합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">yarn add prettier --dev</code></pre>\n      </div>\n<p>VS Code 사용자 기준으로 다음 플러그인도 설치하셔야 합니다.</p>\n<p><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier - JavaScript formatter - Visual Studio Marketplace</a></p>\n<p>그리고 커맨드 팔레트(macOS기준 Cmd+Shift+P)를 열어 <code class="language-text">Preferences: Open Workspace Settings</code> 를 선택하신 뒤에 Prettier 스타일 세팅 및 저장시 자동 적용을 활성화 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .vscode/settings.json\n<span class="token punctuation">{</span>\n  <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n  <span class="token property">"prettier.printWidth"</span><span class="token operator">:</span> <span class="token number">100</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>저는 스타일 기본값을 사용하고 한 줄당 길이만 100이 되도록 설정하였습니다. 앞으로는 저장 시 자동으로 파일마다 Prettier가 작동하여 코드의 스타일을 다듬어줍니다.</p>\n<h3 id="플러그인-설치"><a href="#%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>플러그인 설치</h3>\n<p>Gatsby의 다양한 플러그인을 활용하여 사용자가 더 편하게 웹페이지를 제작할 수 있습니다. 특히 보통 리액트를 사용할 때 많이 활용하는 패키지와 Gatsby가 잘 결합되도록 따로 플러그인을 만들어 배포하고 있습니다. 예를 들어 <code class="language-text">react-helmet</code> 을 사용하시려면 <code class="language-text">gatsby-plugin-react-helmet</code> 플러그인을 설치하여 설정 파일에서 불러오도록 만들어야 합니다. 사용 가능한 플러그인 리스트는 <a href="https://www.gatsbyjs.org/docs/plugins/">공식 문서</a>를 참고해주세요.</p>\n<p>저는 제 블로그를 구현하기 위한 기능을 먼저 정의한 뒤에 필요한 부분만 플러그인을 추가 &#x26; 설정하였습니다.</p>\n<ul>\n<li>유동적으로 HTML <code class="language-text">head</code> 태그가 바뀌어야 한다(제목 등) -> <code class="language-text">gatsby-react-helmet</code></li>\n<li>Sass(SCSS)를 사용한다 -> <code class="language-text">gatsby-plugin-sass</code></li>\n<li>\n<p>(당연하지만) 본문에 마크다운을 사용한다 -> <code class="language-text">gatsby-transformer-remark</code></p>\n<ul>\n<li>마크다운에 트위터 임베딩이 필요하다 -> <code class="language-text">gatsby-plugin-twitter</code></li>\n<li>마크다운에 Syntax highlighting이 필요하다 -> <code class="language-text">gatsby-remark-prismjs</code></li>\n<li>…</li>\n</ul>\n</li>\n<li>…</li>\n</ul>\n<p>실제 적용된 플러그인의 전체 목록은 소스코드를 참고해 주시기 바랍니다.</p>\n<p>플러그인은 프로젝트 폴더에 <code class="language-text">gatsby-config.js</code> 파일을 만들어서 자바스크립트 객체로 내보내시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  siteMetadata<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    siteUrl<span class="token punctuation">:</span> <span class="token string">"https://emaren84.github.io"</span><span class="token punctuation">,</span>\n    title<span class="token punctuation">:</span> <span class="token string">"rinae\'s blog"</span><span class="token punctuation">,</span>\n    description<span class="token punctuation">:</span> <span class="token string">"about Translation, Ruby, Javascript, Practical Dev etc."</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"gatsby-plugin-react-helmet"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-catch-links"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-sass"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-styled-components"</span><span class="token punctuation">,</span>\n    <span class="token string">"gatsby-plugin-twitter"</span><span class="token punctuation">,</span>\n    <span class="token comment">// ...</span>\n    <span class="token string">"gatsby-remark-responsive-iframe"</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="실제-블로그-포스트를-가져오기"><a href="#%EC%8B%A4%EC%A0%9C-%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실제 블로그 포스트를 가져오기</h2>\n<h3 id="프로젝트-폴더-구성"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝트 폴더 구성</h3>\n<p>Gatsby로 페이지를 작성하는데 필요한 폴더는 세 가지 입니다.</p>\n<ul>\n<li><code class="language-text">src/layouts</code> - 페이지의 전반적인 레이아웃을 담당. 모든 개별 페이지가 이 폴더의 <code class="language-text">index.js</code> 파일의 하위 컴포넌트로 동작함.</li>\n<li><code class="language-text">src/pages</code> - 개별 페이지를 담아두는 폴더. 블로그 포스트(마크다운)나 404, index 페이지를 작성</li>\n<li><code class="language-text">src/templates</code> - 반복되는 페이지의 템플릿을 저장 (예: 블로그 포스트의 템플릿)</li>\n</ul>\n<p>위 폴더의 구조는 얼마든지 사용자화 할 수 있습니다. 다만 저는 제시된 구조로 충분했기 때문에 특별히 변형하진 않았습니다. 추가적으로 재사용이 잦은 컴포넌트를 <code class="language-text">src/components</code> 폴더에 정의하여 사용했습니다.</p>\n<p>참고로 <code class="language-text">src/pages</code> 폴더에 저장해 둔 마크다운 파일을 불러오기 위해서 약간의 설정이 필요합니다. 위에서 언급한 <code class="language-text">gatsby-config.js</code> 파일에 다음 플러그인을 추가해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-config.js</span>\n<span class="token comment">// ...</span>\n\tplugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token comment">// ...</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\tresolve<span class="token punctuation">:</span> <span class="token string">"gatsby-source-filesystem"</span><span class="token punctuation">,</span>\n\t\t\toptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\tpath<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/pages`</span></span><span class="token punctuation">,</span>\n\t\t\t\tname<span class="token punctuation">:</span> <span class="token string">"pages"</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t\t<span class="token comment">// ...</span>\n\t<span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="기본-레이아웃-작성"><a href="#%EA%B8%B0%EB%B3%B8-%EB%A0%88%EC%9D%B4%EC%95%84%EC%9B%83-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 레이아웃 작성</h3>\n<p><code class="language-text">src/layout/index.js</code> 파일은 대부분의 리액트 프로젝트의 <code class="language-text">index.html</code> 같은 파일입니다. 보통 <code class="language-text">index.html</code> 파일에서 favicon, head 태그 등의 공통적인 내용을 정의한 뒤에 ReactDOM이 랜더링될 위치를 지정해 주지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Helmet <span class="token keyword">from</span> <span class="token string">"react-helmet"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// import styles</span>\n<span class="token keyword">import</span> <span class="token string">"typeface-noto-sans"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"bulma"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"mdi/scss/materialdesignicons.scss"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"prismjs/themes/prism-solarizedlight.css"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">"./layout-style.scss"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> favicon <span class="token keyword">from</span> <span class="token string">"../assets/favicon.ico"</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TemplateWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charSet</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Rinae\'s playground<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shortcut icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>favicon<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Helmet</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span> <span class="token attr-name">toggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>toggled<span class="token punctuation">}</span></span> <span class="token attr-name">handleToggled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleToggled<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Footer</span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Helmet</code> 컴포넌트는 html의 <code class="language-text">head</code> 태그를 생성해주는 역할을 합니다. 그리고 <code class="language-text">Link</code> 컴포넌트는 react-router의 <code class="language-text">Link</code> 컴포넌트와 거의 동일하게 작동합니다. 주로 특정 DOM 엘리먼트를 클릭하면 페이지 어디로 이동할지 지정해줄 때 사용합니다. 개발자 도구를 열어보면 <code class="language-text">a</code>  태그가 랜더링되지만 페이지를 다시 불러오지 않고 미리 준비된 다른 컴포넌트와 바꿔치기 하는 방식으로 동작하나 봅니다.</p>\n<p><code class="language-text">props</code> 로 내려온 <code class="language-text">children</code> 이 일반 페이지 컴포넌트들이 됩니다. 말 그대로 <code class="language-text">src/layout/index.js</code> 는 모든 페이지들의 부모 컴포넌트가 된다고 이해하시면 되겠습니다.</p>\n<h3 id="포스트-리스트-보여주기"><a href="#%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EB%A6%AC%EC%8A%A4%ED%8A%B8-%EB%B3%B4%EC%97%AC%EC%A3%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>포스트 리스트 보여주기</h3>\n<p>이번에는 <code class="language-text">src/pages/index.js</code> 파일을 살펴보겠습니다. 이 페이지는 블로그에 접속하면 가장 처음 접하게 되는 페이지로, 모든 포스트를 리스트로 가져와서 최신 순서대로 나열해주는 역할을 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"gatsby-link"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> Hero <span class="token keyword">from</span> <span class="token string">"../components/Hero"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> PostList <span class="token keyword">from</span> <span class="token string">"../components/PostList"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">IndexPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> edges <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> postsData <span class="token operator">=</span> edges<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>edge <span class="token operator">=></span> edge<span class="token punctuation">.</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Hero</span>\n          <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Welcome to my writing playground<span class="token punctuation">"</span></span>\n          <span class="token attr-name">subtitle</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>about Translation, Ruby, Javascript, Practical Dev etc.<span class="token punctuation">"</span></span>\n        <span class="token punctuation">/></span></span>\n\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-10-tablet is-offset-1-tablet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PostList</span> <span class="token attr-name">postsData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>postsData<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query IndexQuery {\n    allMarkdownRemark(limit: 1000, sort: { order: DESC, fields: [frontmatter___date] }) {\n      edges {\n        node {\n          excerpt(pruneLength: 250)\n          id\n          frontmatter {\n            title\n            category\n            date(formatString: "YYYY/MM/DD")\n            path\n          }\n        }\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>파일 아래 부분에 <code class="language-text">pageQuery</code>를 주목해주세요. <code class="language-text">graphql</code>? 무슨 정적 사이트 생성기에 GraphQL을 쓰지? 라는 생각을 했는데, Gatsby에서 나름 효율적으로 사용자가 원하는 자료를 가져올 수 있도록 제공된 인터페이스를 사용하는 느낌이었습니다.</p>\n<p>저도 GraphQL을 이름만 들어보고 실제로 사용해본 적은 한 번도 없었지만 공식 사이트의 튜토리얼을 참고해보고, Gatsby에서 제공하는 GraphQL IDE(개발 모드에서 <code class="language-text">localhost:8000/___graphql</code>)로 여러가지 실험을 해 보니 필요한 만큼은 이해할 수 있었습니다. 당장 GraphQL에 익숙하지 않으시더라도 저 쿼리가 대강 어떤 자료를 가져오려고 하는 지 눈에 잘 들어올겁니다. 실제 리턴받는 데이터도 저 구조대로 자바스크립트 객체 형태를 가지고 있습니다.</p>\n<hr>\n<p>미처 설명드리지 못했지만 <code class="language-text">frontmatter</code> 는 각각의 마크다운 파일 맨 처음에 작성하는 일종의 헤더로 다음과 같이 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">---\ntitle: &quot;Some title&quot;\ncategory: &quot;Example&quot;\ndate: &quot;2017/10/04&quot;\npath: &quot;/posts/some-title&quot;\n...\n---</code></pre>\n      </div>\n<hr>\n<p>쿼리하고 받은 데이터는 같은 파일에 작성된 리액트 컴포넌트에 <code class="language-text">props</code>로 자동 설정됩니다. 그래서 <code class="language-text">this.props.data.allMarkdownRemark</code> 처럼 사용할 수 있는 겁니다.</p>\n<p>그런데 마크다운으로 작성된 블로그 포스트는 어떻게 리액트 컴포넌트로 표현해주어야 할까요? <code class="language-text">http://blog.com/post/1</code> 같이 포스트마다 고유의 경로를 가져야 할 테고, 그러려면 <code class="language-text">src/pages</code> 안에 각각의 포스트마다 컴포넌트를 작성해주어야 할까요? 다행히도 그렇게 복잡한 방식을 사용할 필요는 없습니다.</p>\n<h3 id="블로그-포스트-생성하기"><a href="#%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블로그 포스트 생성하기</h3>\n<p>Gatsby는 자체 Node API를 제공하여 페이지를 생성하거나 수정하는 작업을 처리할 수 있습니다. 리액트의  Lifecycle methods 처럼 페이지 생성부터 종료까지 다양한 시점에 걸쳐 설정을 할 수 있지만, 저는 <code class="language-text">createPages</code> 메서드만 사용했습니다.</p>\n<p>자세한 내용은 <a href="https://www.gatsbyjs.org/docs/creating-and-modifying-pages/">공식 문서</a>를 참고해주세요. 또한 대부분 공식 튜토리얼 파트4에 소개되어있는 내용을 참고했습니다.</p>\n<p>먼저 프로젝트 루트에 <code class="language-text">gatsby-node.js</code> 파일을 생성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-node.js</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">boundActionCreators</code> 는 Redux로 구현된 다양한 행동 모음집(액션 디스패처들)입니다. 우리는 여기서 <code class="language-text">createPage</code> 액션 하나만 사용할 예정입니다. <code class="language-text">graphql</code> 은 GraphQL 쿼리를 실행하고 그 결과를 프로미스로 리턴하는 함수입니다. <code class="language-text">createPages</code> 함수 내부를 조금 더 자세히 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\nexports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> boundActionCreators<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> createPage <span class="token punctuation">}</span> <span class="token operator">=</span> boundActionCreators<span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> blogPostTemplate <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`src/templates/blog-post.js`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">graphql</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`\n    {\n      allMarkdownRemark(sort: { order: DESC, fields: [frontmatter___date] }, limit: 1000) {\n        edges {\n          node {\n            excerpt(pruneLength: 250)\n            html\n            id\n            frontmatter {\n              date\n              path\n              title\n              tags\n              category\n            }\n          }\n        }\n      }\n    }\n  `</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">const</span> posts <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>\n\n    posts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> node <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        path<span class="token punctuation">:</span> node<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>path<span class="token punctuation">,</span>\n        component<span class="token punctuation">:</span> blogPostTemplate<span class="token punctuation">,</span>\n        context<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">blogPostTemplate</code> 는 블로그 포스트를 표현하기 위한 리액트 컴포넌트입니다. 조금 뒤에 살펴보겠습니다.</p>\n<p><code class="language-text">graphql</code> 함수가 쿼리를 하고 나온 결과는 <code class="language-text">result.data</code> 에 담기게 되며 아까 <code class="language-text">src/pages/index.js</code> 파일 안에서 GraphQL 쿼리 결과를 가져올 때랑 똑같이 다룰 수 있습니다.</p>\n<p>그리고 <code class="language-text">createPage</code> 라는 함수에 각각의 포스트를 인자로 넘기면 됩니다. <code class="language-text">path</code> 속성은 어떤 URL로 생성될지, <code class="language-text">component</code> 는 어떤 컴포넌트를 사용하여 페이지를 만들지 지정합니다. <code class="language-text">context</code> 는 상황에 따라 사용자 임의의 속성을 지정해줄 수 있는 기능인데, 저는 굳이 사용하지 않았습니다.</p>\n<p>중요한 점은 저 <code class="language-text">path</code> 속성이 템플릿 컴포넌트로 넘어갈때 GraphQL의 인자로 사용된다는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// src/templates/blog-post.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Template</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> markdownRemark<span class="token punctuation">:</span> post <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> tags <span class="token operator">=</span> post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>tags<span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10-mobile is-offset-1-mobile is-8-tablet is-offset-2-tablet is-8-desktop is-offset-2-desktop<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Helmet</span> <span class="token attr-name">title</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - Rinae\'s playground`</span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>has-text-grey-light is-size-6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>date<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> __html<span class="token punctuation">:</span> post<span class="token punctuation">.</span>html <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TagList</span> <span class="token attr-name">tags</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tags<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>About</span> <span class="token punctuation">/></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info is-large<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-medium<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mdi mdi-36px mdi-format-list-bulleted<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Back to All posts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ButtonWrapper</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token string">`\n  query BlogPostByPath($path: String!) {\n    markdownRemark(frontmatter: { path: { eq: $path } }) {\n      html\n      frontmatter {\n        date(formatString: "YYYY/MM/DD")\n        path\n        title\n        tags\n      }\n    }\n  }\n`</span></span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">pageQuery</code> 의 <code class="language-text">graphql</code> 이 인자로 <code class="language-text">$path</code> 를 받는데 아까 <code class="language-text">createPage</code> 함수에서 가져온 <code class="language-text">path</code> 속성을 의미합니다. 그리고 <code class="language-text">$path</code> 를 이용하여 <strong>마크다운 파일 중에  frontmatter의 path가 <code class="language-text">$path</code> 와 같은 노드를 검색하라</strong> 라는 쿼리를 전달할 수 있는 것입니다. 나머지는 그 데이터를 그대로 컴포넌트에 넘겨주기만 하면 됩니다.</p>\n<p>그리고 마크다운 파일은 플러그인에 의해 자동으로 html로 변환되는데, 이 html을 <a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml"><code class="language-text">dangerouslySetInnerHTML</code> 속성</a>을 사용해서 주입했습니다.</p>\n<p>설명을 보시면서 생략된 부분이 많다고 느끼실 수 있지만, 앞서 언급한 공식 튜토리얼을 가볍게 진행해보시면 생각보다 쉽게 간단한 블로그정도는 만들 수 있다는 생각이 드실 겁니다.</p>\n<h2 id="자잘한-문제-해결"><a href="#%EC%9E%90%EC%9E%98%ED%95%9C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자잘한 문제 해결</h2>\n<p>하지만 공식 문서에서는 미처 언급되지 않아 제가 약간 삽질을 하면서 해결했던 문제들이 있습니다. 기록 겸 이 글을 읽으시는 분들이 만약 같은 문제를 겪으실 때 쉽게 해결하실 수 있었으면 좋겠습니다.</p>\n<h3 id="rss-feed-설정"><a href="#rss-feed-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RSS Feed 설정</h3>\n<p>Gatsby는 RSS Feed를 생성하는 플러그인을 제공합니다. 제 블로그가 아무리 대단한 내용이 없다 하더라도 RSS Feed를 제공하는 것은 기본 중의 기본이라 생각하여 설정하고 있었는데, 아무리 해도 <code class="language-text">head</code> 태그에 <code class="language-text">rss.xml</code> 파일이 제대로 된 경로로 설정되지 않았습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n\t<span class="token comment">&lt;!-- rss.xml의 경로가 절대경로로만 표시된다 --></span>\n\t<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alternate<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>application/rss+xml<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/rss.xml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>이렇게 되면 제가 기존에 쓰던 블로그 주소인 <code class="language-text">https://emaren84.github.io/blog</code> 를 사용할 경우 RSS Feed를 제공할 수 없게 됩니다. 왜냐면 <code class="language-text">rss.xml</code> 의 위치는 <code class="language-text">https://emaren84.github.io/rss.xml</code> 이 되어버리기 때문입니다.</p>\n<p>플러그인 소스를 보니  <code class="language-text">pathPrefix</code> 설정을 받아들이는 부분도 없고 무조건 절대경로로 파일을 생성하도록 되어있나봅니다.</p>\n<p>결국 블로그 주소를 바꿔서 해결했지만.. 기존에 사용하던 지킬 테마에서는 피드 생성이 잘 되었다는 것을 생각해보면 나중에 수정되었으면 좋겠습니다.</p>\n<h3 id="gif-파일-표시"><a href="#gif-%ED%8C%8C%EC%9D%BC-%ED%91%9C%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GIF 파일 표시</h3>\n<p>Gatsby의 remark-images 플러그인은 jpg, png 파일은 아주 잘 처리합니다. 다만 gif파일은 처리하지 않습니다. 보통 gif 파일을 쓸 일이 없긴 하지만, 몇몇 포스트에 gif파일을 사용하기 때문에 문제를 해결해야 했습니다.</p>\n<p><code class="language-text">gatsby-remark-copy-linked-files</code> 을 추가하면 문제는 해결됩니다. 이 플러그인은 PDF 파일 등의 링크를 제공할 때 사용하는 플러그인으로 생각하고 간과하고 있었는데, 이 플러그인을 설치한 채로 gif파일의 링크를 설정하니 잘 작동합니다.</p>\n<h3 id="코드-블락의-css-오류"><a href="#%EC%BD%94%EB%93%9C-%EB%B8%94%EB%9D%BD%EC%9D%98-css-%EC%98%A4%EB%A5%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>코드 블락의 CSS 오류</h3>\n<p>개발 블로그를 작성하면서 가장 중요한게 코드의 표현인데, Gatsby로 블로그를 만들고 나니 일부 코드 블락이 이상하게 표현되었습니다. 처음에는 PrismJS 플러그인의 문제라고 생각했는데, 제가 이 블로그를 만들기 위해 사용한 CSS 프레임워크인 Bulma의 CSS와 일부 충돌하는 부분이 있었기 때문에 코드가 이상하게 나온 것이었습니다.</p>\n<p>블로그 포스트 템플릿에 CSS를 추가하여 문제를 해결했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-scss"><code class="language-scss"><span class="token comment">// ...</span>\n<span class="token comment">// resolve conflicts between bulma css preset and prismjs</span>\n<span class="token selector">pre[class*="language-"] .tag,\npre[class*="language-"] .number </span><span class="token punctuation">{</span>\n  <span class="token property">align-items</span><span class="token punctuation">:</span> stretch<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>\n  <span class="token property">font-size</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>\n  <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>\n  <span class="token property">line-height</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">white-space</span><span class="token punctuation">:</span> pre<span class="token punctuation">;</span>\n  <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>\n  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>\n  <span class="token property">vertical-align</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<hr>\n<p>제가 만든 블로그는 <a href="https://github.com/emaren84/gatsby-blog">Github에 공개 되어 있습니다</a>. 커밋 로그를 조금 살펴보시면 블로그에서 미처 언급하지 못했던 제작과정을 참고하실 수 있습니다.</p>\n<p><strong>참고자료</strong></p>\n<ul>\n<li><a href="https://www.gatsbyjs.org/tutorial/">Gatsby Tutorial</a></li>\n<li><a href="https://github.com/alxshelepenok/gatsby-starter-lumen">GitHub - alxshelepenok/gatsby-starter-lumen: Lumen is a minimal, lightweight and mobile-first starter for creating blogs uses Gatsby</a></li>\n<li><a href="https://dustinschau.com/blog/getting-started-with-gatsby">Dustin Schau - Creating a Blog with Gatsby</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-10-05-creating-new-blog-with-gatsby/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-10-05",path:"/posts/creating-new-blog-with-gatsby",title:"Gatsby를 활용한 블로그 재구성",tags:["Markdown","React","GraphQL"],category:"Gatsby"}}],Tools:[{excerpt:"이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다. 원문을 보시려면  이 링크 를 클릭해주세요. 안녕하세요, Boostnote 개발자  kazup  입니다. 예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다. What is Boostnote? 프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 15…",html:'<ul>\n<li>이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다.</li>\n<li>원문을 보시려면 <a href="http://boostnote.hatenablog.com/entry/2017/08/09/130721">이 링크</a>를 클릭해주세요.</li>\n</ul>\n<hr>\n<p>안녕하세요, Boostnote 개발자 <a href="https://twitter.com/kazup_bot">kazup</a> 입니다.</p>\n<p>예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다.</p>\n<h2 id="what-is-boostnote"><a href="#what-is-boostnote" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Boostnote?</h2>\n<p>프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 150가지가 넘는 언어의 Syntax Highlighting 및 스니펫을 저장하는 기능도 있습니다.</p>\n<p>개발자를 위한 특화 기능으로 vim 키맵을 사용하거나 마크다운 안에 작성해둔 코드를 원터치로 저장하는 등 개발자들이 즐겁게 사용할만한 기능들이 포함되어 있습니다.</p>\n<p>또한 에버노트에서 데이터를 가져오는 <a href="https://github.com/BoostIO/ever2boost">ever2boost</a> 등의 서드파티 도구들도 여럿 있어서 간단하게 이용하실 수 있습니다.</p>\n<h2 id="what-is-notes"><a href="#what-is-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Notes?</h2>\n<p>여러분의 친숙한 애플 순정 메모 어플리케이션입니다. Boostnote와 달리 누구나 즐겁게 사용할 수 있게 만들어져 있습니다.</p>\n<p>가볍게 동작하기 때문에 사소한 메모를 남겨두고 싶을 때 편리하게 이용할 수 있습니다.</p>\n<h2 id="the-key-differences-of-boostnote-vs-notes"><a href="#the-key-differences-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The key differences of Boostnote vs Notes</h2>\n<p>가장 큰 차이점은 대상 사용자입니다. Boostnote는 명확하게 개발자를 대상으로 삼고 있지만 Notes는 누구나 부담없이 사용할 수 있게 만들어져 있습니다.</p>\n<p>예를 들어 Notes는 플레인 텍스트(Plain text)만 지원하는 반면, Boostnote는 마크다운과 스니펫을 저장할 수 있습니다.</p>\n<p>또한 커스터마이즈 가능한 부분도 큰 차이가 나는데, Boostnote가 단축키부터 컬러 테마, 앞서 말씀드린 키맵(vim 등)의 변경이 가능한 반면 Notes는 어디까지나 간단하면서 일관된 경험을 제공합니다.</p>\n<h2 id="a-comparison-of-boostnote-vs-notes"><a href="#a-comparison-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A comparison of Boostnote vs Notes</h2>\n<p>주요 차이점을 정리해보았습니다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Boostnote</th>\n<th>Notes</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>노트북 포맷</td>\n<td>Markdown and snippet</td>\n<td>Plain text</td>\n</tr>\n<tr>\n<td>가격</td>\n<td>무료</td>\n<td>무료</td>\n</tr>\n<tr>\n<td>데이터 저장소</td>\n<td>Local, Dropbox, Google Drive 등</td>\n<td>Local, iCloud, Google</td>\n</tr>\n<tr>\n<td>플랫폼</td>\n<td>Windows, Mac, Linux (iOS, Android 출시 예정)</td>\n<td>Mac, iOS</td>\n</tr>\n<tr>\n<td>주요 대상</td>\n<td>Developer</td>\n<td>Everyone</td>\n</tr>\n<tr>\n<td>사용자 정의</td>\n<td>Color, Code Block and Editor theme, Keymap, Hotkey</td>\n<td>X</td>\n</tr>\n<tr>\n<td>노트 공유</td>\n<td><a href="https://10hz.io/">10hz</a></td>\n<td>via iCloud</td>\n</tr>\n</tbody>\n</table>\n<h2 id="wrapping-it-up"><a href="#wrapping-it-up" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrapping it up.</h2>\n<p>이상 Boostnote와 Notes를 비교해보았습니다. 둘 다 겉으로 보기에는 아주 단순해보이지만, 그 단순함 속에 숨겨진 기능이나 구조의 차이가 있어서 비교해보니 꽤 재밌었습니다.</p>\n<p>Boostnote는 훨씬 더 개발자지향적이고 무엇보다 <a href="https://github.com/BoostIO/Boostnote">오픈소스입니다</a>! 널리 개발자들에게 사용되어 다양한 수정을 거쳐 기회가 된다면 풀 리퀘스트를 주고받고 싶습니다.</p>\n<p>서두에서 말씀드린대로 Notes에서 갈아타는 분들이 많이 보이고 있으니 주변에 쓸만한 노트 앱을 찾고 계신 개발자분들이 계시다면 Boostnote를 추천해 주세요!</p>\n<p>또한 <a href="https://boostnote.io/team/">팀 단위로 노트로 기획된 10hz</a>도 현재 베타버전으로 배포되고 있으니 한번 살펴봐주시기 바랍니다.</p>\n<hr>\n<p>사실 일본어는 간단하게 말을 주고받는 정도만 할 수 있을 뿐이지, 실제로 잘 읽을 수 있는 수준은 아니라 번역기와 사전의 도움을 받아가며 작업했습니다. 그래도 내용이 어렵지 않아서 오래 걸리지 않았네요.</p>\n<p>노트를 다양한 플랫폼으로 여기저기 작성해보면서 가장 맞는 스타일의 앱을 찾고 있는데 현재로서 Boostnote가 제가 생각하는 개발노트용 앱으로 가장 알맞다고 생각하여 이렇게 소개하는 글을 번역해 보았습니다.</p>\n<p>마크다운 문법만 익숙하시다면 사용하는게 그리 어렵지 않을테니 가벼운 마음으로 한번 시도해보세요 :)</p>',id:"/home/circleci/repo/src/pages/posts/2017-08-09-boostnote-vs-notes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-08-09",path:"/posts/boostnote-vs-notes-kor",title:"[번역] Boostnote vs Notes: Choosing a note-taking Tool",tags:["Markdown","Tools","OSS","Translation"],category:"Translation"}},{excerpt:"…",html:'<h2 id="한동안-마크다운으로-노트를-작성해본-후-느끼는-아쉬움"><a href="#%ED%95%9C%EB%8F%99%EC%95%88-%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4%EC%9C%BC%EB%A1%9C-%EB%85%B8%ED%8A%B8%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%B4%EB%B3%B8-%ED%9B%84-%EB%8A%90%EB%81%BC%EB%8A%94-%EC%95%84%EC%89%AC%EC%9B%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>한동안 마크다운으로 노트를 작성해본 후 느끼는 아쉬움</h2>\n<p>마크다운 문법을 이용한 글 작성에 조금씩 익숙해지고 있는 것은 좋은데, 조금씩 노트의 양이 늘어가니 관리하기가 힘들어질 것 같다는 걱정이 들기 시작했다.<br>\n여지껏 노트를 작성하더라도 그렇게 잘 활용하진 못한 기분이 들지만.. 이번에는 개발노트(업무일지, 스터디노트), 각종 새로 배운 내용들, 아이디어들 등을 마크다운 문서로 작성해서 보관하고자 하는 목표가 생겼다.<br>\n에버노트나 원노트 등과 비교해서 마크다운 문서를 작성했을 때의 장점이라면</p>\n<ul>\n<li>단순함</li>\n<li>다른 양식이 필요없이 텍스트만으로 작성 가능</li>\n<li>코드 적기에 용이함(이게 제일 큰 차이점)</li>\n<li>플랫폼의 구애를 받지 않음</li>\n</ul>\n<p>이정도를 들 수 있겠는데, 문제는 그 단순함에 비례한 관리의 어려움이다.\n처음에 심플노트를 쓰기 시작하고, 그와 더불어 nvALT를 알게 되면서 \'간단히 노트를 작성하고 동기화하기에 굉장히 좋구나\' 라고 생각하게 되었는데 폴더 관리 방식이 아니다보니 태그만으로는 정리하기가 좀 힘들어지고 있다.</p>\n<p>태그 정렬방식의 또 다른 문제는 심플노트와 nvALT에 종속될 수 밖에 없다는 것이다.<br>\n노트들은 폴더 하나에 텍스트파일로 죄다 들어가게 되는데 지금이야 100개 조금 넘는 정도의 노트지만, 점점 노트가 늘어갈 수록 어떤 노트가 무슨 내용을 담고 있는지 한 눈에 알아보기 힘들고 관리하기 힘들어질 수 있겠다는 생각이 들었다.</p>\n<p>특히 조금씩이지만 랩탑의 활용도가 늘고 있는데 랩탑이 맥이 아니다보니 nvALT를 사용할 수 없는 부분이 크게 작용했다.<br>\nnvPY로 유사한 인터페이스의 심플노트 싱크는 가능하지만, 드롭박스에 텍스트파일을 생성하지 않다보니 나에게는 반쪽자리 애플리케이션이었기 때문이다.</p>\n<h2 id="마크다운--심플노트--드롭박스-작업환경을-생각해보다"><a href="#%EB%A7%88%ED%81%AC%EB%8B%A4%EC%9A%B4--%EC%8B%AC%ED%94%8C%EB%85%B8%ED%8A%B8--%EB%93%9C%EB%A1%AD%EB%B0%95%EC%8A%A4-%EC%9E%91%EC%97%85%ED%99%98%EA%B2%BD%EC%9D%84-%EC%83%9D%EA%B0%81%ED%95%B4%EB%B3%B4%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마크다운 + 심플노트 + 드롭박스 작업환경을 생각해보다</h2>\n<p>내가 생각하는 노트 동기화 환경은 드롭박스를 메인으로 하고 심플노트를 서브로 사용하는 방식으로 이용하고 싶은데 그러면 드롭박스에 생성된 텍스트 파일들이 전부 따로 제목을 가지고 있어서 문제가 된다.</p>\n<p>많은 고민과 검색 끝에 조금이나마 내놓은 대책은 <strong>제목을 태그화하는 것</strong>인데, 첫 제목(파일 이름)을 일정 형식으로 만들어서 태그를 매긴 것 처럼 보이게 하고, 텍스트 본문 첫 줄에 제목을 작성하는 형식으로 관리를 하는 것이다.</p>\n<p><strong>Sample tag names</strong></p>\n<ul>\n<li>refx - reference</li>\n<li>runx - running list</li>\n<li>rcpx - recipes</li>\n<li>mtgx - meeting notes</li>\n<li>blogx - blog entires</li>\n<li>contactx - contact information records</li>\n<li>carx - auto info</li>\n<li>notex - note taking for courses or lectures</li>\n<li>lolx - wildcard!!!</li>\n</ul>\n<p>이런 식의 태그 이름을 활용하여 제목을 <code class="language-text">refx-emacs-tutorial</code> 등으로 작성하는 것이다.\n왜 태그 이름에 X가 붙냐면 <strong>태그임을 명시</strong> 하기 위함인데, 보통 ref 등으로 검색을 하면 ref가 딸려있는 내용들이 죄다 같이 검색이 될 텐데 refx 같은 단어는 굉장히 독특하기 때문에 태그만 나올 것이기 때문이다.</p>\n<p>저런 태그를 이용하여 현재까지 작성 된 모든 노트의 이름을 형식화하는 작업을 하려고 한다.\n먼저 내가 사용하고자 하는 나만의 태그를 정의해본다면</p>\n<ul>\n<li>refx: 레퍼런스, 팁</li>\n<li>ideax: 순간의 아이디어, 구상</li>\n<li>devnotex: 개발노트</li>\n<li>studyx: 공부노트</li>\n<li>infox: 특정 정보</li>\n<li>reviewx: 리뷰</li>\n<li>blogx: 블로그 포스팅</li>\n<li>readx: 책이나 자료를 읽고 작성</li>\n</ul>\n<p>뭔가 생각나는데로 마구 작성해봤는데 많이 사용되는 태그는 위에서 4개까지일 것이라 생각된다.\n낑낑대면서 약 120개의 노트의 제목을 다시 정리하고, 원래 노트의 제목(txt 파일 이름)은 노트 본문의 첫번째 줄에다 마크다운의 h1태그를 써서 옮겨두었다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 73.36842105263158%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACQklEQVQ4y5VUzXKbMBjk/V+qOfiSHppDazu4xvwLEEKAsYHacbb7aRLaTJuZRDM7Ax6x2t1vZW///Su24RZJlCCKIsRxgjTNUNc1tNYOZVkiz3P3XFXVf/G6zwtJsN/t4fs+dv4ORWVgbIssy6CKAiWhkhg1N0/TTEzvYhxHeKvVCl/u7nB/f4+Hh2/4sd4iVyUMFbZti8vlgqfrFbenJ3xkebvdDuv1BpvNFkoplFVNaBhjaKHC6XzGZ5YnvpMkQZ7lOB6PqLSBbTvEUYjteo3HRx8F9zSmgaZ9zWdBxcN1Uf55lz105UnYQXBwgXZd5zLUJK3SGIZhi8qaZJaKTZbCkLTRFYzKCQXLYTRViZq/WxmKEMp0D4cDxH5eVGg4lKHvME8jPru8gqfEcexqISqDMHaWa6rI8gZZeUVWzEjzCam6sCItetvwsAm3283h+fl5gacoPU1Th2E4UqHmdHsekGGzfUS0P6BgVgUzToLQ7ZnHM8ZheKNMyJxCmWwYhk6lZmaKhJaEWpfYByTJJmRqXKCqCzupoXigDKtmI66s1iupJwWWDF9VhlGKtutdoX3/J28MLfYnDqWFbTpY27t+ttbizEr1jGd6qZYjLPihkGa0VMtVMxbdcUDBKiVx5Kr0kbVYlmGEYURlEYQ8V6xE0y53c55/vUvwNxaFkmEQBCxy5Catypq16WjL0nbpiOWeSoXmecb5dHbvLwwL2ZubIpYlP/nXkPxMY9nLAJrNl48H2h76HqfTyeU3LBP+l/A3mMFxiFaJs3EAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="nvALT로 제목을 모두 수정한 후"\n        title=""\n        src="/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-ffc88.png"\n        srcset="/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-d16f8.png 198w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-f21b1.png 395w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-ffc88.png 790w,\n/static/2016-08-04-sc1-a7a49eb313364162edf3aaac6c78bea1-a9d0a.png 950w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>한동안은 이런 방식으로 노트를 작성해보고 차차 수정해나갈 예정이다.\n리눅스에서는 오늘 마침 <a href="https://burnsoftware.wordpress.com/p-s-notes/">P.S Notes</a>라는 꽤 괜찮은 텍스트 작성 애플리케이션을 발견했는데, 랩탑으로 노트를 작성할 일이 이 앱으로 작성하여 드롭박스와 동기화하는 방법을 사용하려고 한다.</p>\n<hr>\n<p>References</p>\n<ul>\n<li><a href="http://computers.tutsplus.com/tutorials/superpower-your-note-taking-skills-with-nvalt-and-simplenote--cms-20816">Superpower Your Note Taking Skills With nvALT and Simplenote</a></li>\n<li><a href="https://hyungrok.com/2014/07/12/nvalt/">NVALT와 글쓰기 루틴 그리고 프로젝트 지식관리</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2016-08-04-markdown-with-dropbox-workflow/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-08-04",path:"/posts/markdown-with-dropbox-workflow",title:"마크다운, nvALT, Dropbox를 활용한 노트관리 아이디어",tags:["Markdown","Tools"],category:"Idea"}}],OSS:[{excerpt:"이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다. 원문을 보시려면  이 링크 를 클릭해주세요. 안녕하세요, Boostnote 개발자  kazup  입니다. 예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다. What is Boostnote? 프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 15…",html:'<ul>\n<li>이 포스팅은 Boostnote 팀의 요청에 의하여 번역되었습니다.</li>\n<li>원문을 보시려면 <a href="http://boostnote.hatenablog.com/entry/2017/08/09/130721">이 링크</a>를 클릭해주세요.</li>\n</ul>\n<hr>\n<p>안녕하세요, Boostnote 개발자 <a href="https://twitter.com/kazup_bot">kazup</a> 입니다.</p>\n<p>예상 외로 맥의 순정 메모 어플리케이션에서 Boostnote로 갈아타는 분들이 많아보여서, 이번 기회에 두 앱을 간단히 비교하는 글을 작성해보았습니다.</p>\n<h2 id="what-is-boostnote"><a href="#what-is-boostnote" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Boostnote?</h2>\n<p>프로그래머를 위한 오픈 소스 노트입니다. 마크다운을 기본적으로 지원하고 150가지가 넘는 언어의 Syntax Highlighting 및 스니펫을 저장하는 기능도 있습니다.</p>\n<p>개발자를 위한 특화 기능으로 vim 키맵을 사용하거나 마크다운 안에 작성해둔 코드를 원터치로 저장하는 등 개발자들이 즐겁게 사용할만한 기능들이 포함되어 있습니다.</p>\n<p>또한 에버노트에서 데이터를 가져오는 <a href="https://github.com/BoostIO/ever2boost">ever2boost</a> 등의 서드파티 도구들도 여럿 있어서 간단하게 이용하실 수 있습니다.</p>\n<h2 id="what-is-notes"><a href="#what-is-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Notes?</h2>\n<p>여러분의 친숙한 애플 순정 메모 어플리케이션입니다. Boostnote와 달리 누구나 즐겁게 사용할 수 있게 만들어져 있습니다.</p>\n<p>가볍게 동작하기 때문에 사소한 메모를 남겨두고 싶을 때 편리하게 이용할 수 있습니다.</p>\n<h2 id="the-key-differences-of-boostnote-vs-notes"><a href="#the-key-differences-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The key differences of Boostnote vs Notes</h2>\n<p>가장 큰 차이점은 대상 사용자입니다. Boostnote는 명확하게 개발자를 대상으로 삼고 있지만 Notes는 누구나 부담없이 사용할 수 있게 만들어져 있습니다.</p>\n<p>예를 들어 Notes는 플레인 텍스트(Plain text)만 지원하는 반면, Boostnote는 마크다운과 스니펫을 저장할 수 있습니다.</p>\n<p>또한 커스터마이즈 가능한 부분도 큰 차이가 나는데, Boostnote가 단축키부터 컬러 테마, 앞서 말씀드린 키맵(vim 등)의 변경이 가능한 반면 Notes는 어디까지나 간단하면서 일관된 경험을 제공합니다.</p>\n<h2 id="a-comparison-of-boostnote-vs-notes"><a href="#a-comparison-of-boostnote-vs-notes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A comparison of Boostnote vs Notes</h2>\n<p>주요 차이점을 정리해보았습니다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Boostnote</th>\n<th>Notes</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>노트북 포맷</td>\n<td>Markdown and snippet</td>\n<td>Plain text</td>\n</tr>\n<tr>\n<td>가격</td>\n<td>무료</td>\n<td>무료</td>\n</tr>\n<tr>\n<td>데이터 저장소</td>\n<td>Local, Dropbox, Google Drive 등</td>\n<td>Local, iCloud, Google</td>\n</tr>\n<tr>\n<td>플랫폼</td>\n<td>Windows, Mac, Linux (iOS, Android 출시 예정)</td>\n<td>Mac, iOS</td>\n</tr>\n<tr>\n<td>주요 대상</td>\n<td>Developer</td>\n<td>Everyone</td>\n</tr>\n<tr>\n<td>사용자 정의</td>\n<td>Color, Code Block and Editor theme, Keymap, Hotkey</td>\n<td>X</td>\n</tr>\n<tr>\n<td>노트 공유</td>\n<td><a href="https://10hz.io/">10hz</a></td>\n<td>via iCloud</td>\n</tr>\n</tbody>\n</table>\n<h2 id="wrapping-it-up"><a href="#wrapping-it-up" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrapping it up.</h2>\n<p>이상 Boostnote와 Notes를 비교해보았습니다. 둘 다 겉으로 보기에는 아주 단순해보이지만, 그 단순함 속에 숨겨진 기능이나 구조의 차이가 있어서 비교해보니 꽤 재밌었습니다.</p>\n<p>Boostnote는 훨씬 더 개발자지향적이고 무엇보다 <a href="https://github.com/BoostIO/Boostnote">오픈소스입니다</a>! 널리 개발자들에게 사용되어 다양한 수정을 거쳐 기회가 된다면 풀 리퀘스트를 주고받고 싶습니다.</p>\n<p>서두에서 말씀드린대로 Notes에서 갈아타는 분들이 많이 보이고 있으니 주변에 쓸만한 노트 앱을 찾고 계신 개발자분들이 계시다면 Boostnote를 추천해 주세요!</p>\n<p>또한 <a href="https://boostnote.io/team/">팀 단위로 노트로 기획된 10hz</a>도 현재 베타버전으로 배포되고 있으니 한번 살펴봐주시기 바랍니다.</p>\n<hr>\n<p>사실 일본어는 간단하게 말을 주고받는 정도만 할 수 있을 뿐이지, 실제로 잘 읽을 수 있는 수준은 아니라 번역기와 사전의 도움을 받아가며 작업했습니다. 그래도 내용이 어렵지 않아서 오래 걸리지 않았네요.</p>\n<p>노트를 다양한 플랫폼으로 여기저기 작성해보면서 가장 맞는 스타일의 앱을 찾고 있는데 현재로서 Boostnote가 제가 생각하는 개발노트용 앱으로 가장 알맞다고 생각하여 이렇게 소개하는 글을 번역해 보았습니다.</p>\n<p>마크다운 문법만 익숙하시다면 사용하는게 그리 어렵지 않을테니 가벼운 마음으로 한번 시도해보세요 :)</p>',id:"/home/circleci/repo/src/pages/posts/2017-08-09-boostnote-vs-notes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-08-09",path:"/posts/boostnote-vs-notes-kor",title:"[번역] Boostnote vs Notes: Choosing a note-taking Tool",tags:["Markdown","Tools","OSS","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Justin Weiss의 블로그 포스팅 을 허가 아래 번역한 글입니다 본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다 표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요 Thom Parkin…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://www.justinweiss.com/articles/the-easiest-way-to-get-into-open-source/">Justin Weiss의 블로그 포스팅</a>을 허가 아래 번역한 글입니다</strong></li>\n<li><strong>본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다</strong></li>\n<li><strong>표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요</strong></li>\n</ul>\n<hr>\n<p>Thom Parkin이 <a href="http://www.justinweiss.com/blog/2014/10/28/how-to-go-beyond-documentation-and-learn-a-new-library/#comment-1657912979">제 지난번 글에 아주 중요한 지적을 해 주었습니다.</a></p>\n<blockquote>\n<p>좋은 조언입니다. 그러나 당신은 아주 중요하고 결정적인 포인트를 하나 놓쳤어요. 지금 하고 있는 이야기는 오픈 소스에 관한 이야기이기 때문에 당신이 한번 어떤 기능이나 함수가 문서화가 잘 안되어있다는 것을 발견한다면, <strong>당신은 그 문서를 업데이트 하고 풀 리퀘스트(Pull Request)를 제출해야 합니다.</strong> 그렇게 전체 커뮤니티가 도움을 받게 되고 더불어 당신은 그런 참여를 통해 어느 정도의 "코더 평판(coder cred)"을 얻게 됩니다.</p>\n</blockquote>\n<p><strong>나는 Thom이 이 점을 언급해주어서 기뻤습니다. 이는 아주 중요한 것이기 때문입니다.</strong> 문서를 수정하는 것은 당신이 사용하고 좋아하는 프로젝트에 기여를 시작할 수 있는 가장 쉬운 방법입니다.</p>\n<p>제가 Rails, Rubinus, Elixir에 처음 기여했던 것들은 모두 문서 수정이었습니다. 저는 작은 수정들을 가해왔습니다. 문장을 더 명확하게 하고, 코드를 직접 읽어야만 발견할 수 있는 부분들을 설명하는 작업을 하거나, 심지어 단지 포맷이 잘못된 부분을 수정하기도 했습니다. 이 모든 것들은 좀 커다란 오픈 소스 프로젝트들을 돕는 가장 빠르고 쉬운 방법들입니다. 비록 이 일들이 제가 프로젝트에 유일하게 기여한 것들이지만, 여전히 미래의 사용자들을 돕고 있습니다. 심지어 미래의 제 자신도요. 그게 바로 오픈소스죠(And that’s what open source is all about).</p>\n<h2 id="왜-문서를-수정하는-것이-그렇게-좋은-방법인가"><a href="#%EC%99%9C-%EB%AC%B8%EC%84%9C%EB%A5%BC-%EC%88%98%EC%A0%95%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-%EA%B7%B8%EB%A0%87%EA%B2%8C-%EC%A2%8B%EC%9D%80-%EB%B0%A9%EB%B2%95%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 문서를 수정하는 것이 그렇게 좋은 방법인가</h2>\n<p>Rails같이 거대한 프로젝트에선 문서를 수정하는 것이 가장 부담이 덜 되는 기여 방법입니다.</p>\n<ul>\n<li><strong>당신은 버그를 수정하기 위해 프로젝트를 세팅할 필요가 없습니다.</strong> 당신은 그저 문서를 업데이트 하는 것이기 때문에 테스트를 돌리거나 앱을 돌릴 필요가 없습니다. 심지어 당신은 자신의 컴퓨터에 프로젝트를 클론할 필요도 없습니다 - Github에서 바로 수정할 수 있어요!</li>\n<li><strong>관리자(Maintainer)가 당신의 풀 리퀘스트에 수정을 요청한다면, 보통 어법(wording)이나 취향 때문일 겁니다.</strong> 이런 변경점은 당신의 코드가 비판받는 것 보다 받아들이기 쉽습니다. 그리고 만들기도 쉽습니다. 왜냐면 당신은 테스트나 코드를 업데이트 할 필요가 없으니까요. 단지 단어들만 업데이트하면 됩니다.</li>\n<li><strong>문서화(Documentation)는 프로젝트 관리자에게는 힘든 일입니다. 그래서 업데이트는 큰 도움이 됩니다.</strong> 종종 코드의 작성자들은 자신의 코드와 너무 밀접해 있어서, 어느 부분이 혼란스러운 부분인지 잘 이해하지 못합니다. 그들은 다른, 혹은 뉴비 개발자들이 어느 부분의 문서에 도움이 필요한지 말해주길 원합니다. 당신의 프로젝트를 초보자의 시점으로 보는 건 연습이 필요합니다. 모두가 그런 기술을 가진 것은 아니거든요.</li>\n<li><strong>마지막으로, 당신은 프로젝트에 부담없는 변화를 주면서도 관리자와 관계를 형성할 수 있습니다.</strong> 당신은 프로젝트의 방향을 바꾸는 게 아닙니다. 예를 들면 당신이 전체 기능에 기여하는 것 처럼요. 그래서 당신의 변경점은 관리자가 리뷰하기 쉽고, 그들은 보통 당신에게 더 빠르게 답변 할 것입니다. 당신의 머지 요청은 "이게 정말 좋은 생각일까요?" 같은 말에 가로막히지 않을 것입니다.</li>\n</ul>\n<p>당신은 그 관계를 유지하면서 점차 신뢰받는 기여자로 보이기 시작할 것입니다. 당신의 풀 리퀘스트는 더 빠르게 리뷰될 것이고, 당신들이(당신과 관리자) 더 복잡한 기능 요청이나 버그 수정에 대해 자세하게 이야기를 나누기도 쉬워집니다.</p>\n<p>당신의 첫 기여를 <strong>시작하기도 쉽고, 하기도 쉽고, 머지도 더 빠르게 되는</strong> 문서 수정으로 해 보시는 게 어떨까요?</p>\n<h2 id="업데이트-된-문서에-다시-기여하는-방법"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%90%9C-%EB%AC%B8%EC%84%9C%EC%97%90-%EB%8B%A4%EC%8B%9C-%EA%B8%B0%EC%97%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트 된 문서에 다시 기여하는 방법</h2>\n<p>버그 수정과 마찬가지로 문서 업데이트에 기여하는 데는 유의할 점이 있습니다: <strong>둘 다 공통적으로 \'잘못되었다고 느껴지는 것들(things that feel wrong)\'에 많이 신경을 써야 한다는 점입니다.</strong> 당신은 주의를 기울여야 합니다.</p>\n<p>보통 코드가 당신이 기대하던대로 동작하지 않을 때가 문서를 업데이트 해야 할 시기입니다. 만약 당신이 코드를 직접 수정하여 문제를 해결한다면, 마찬가지로 다른 사람들에게 이에 대해 알려야 할 겁니다. 혹은 당신이 읽고 있는 문서의 잘못된 형식이나 오타가 신경쓰일 수도 있습니다. 당신이 고치지 않는다면 누가 할까요?</p>\n<p>당신이 어디를 변경하고 어떻게 말로 표현해야하는지 좋은 아이디어가 떠올랐다면, 그 부분을 변경하고 한번 Github에 풀 리퀘스트를 올려보세요.</p>\n<p>만약 당신이 문서를 업데이트 하는 가장 좋은 방법을 계속 구상중이라면 Github에 이슈를 열어보세요. 이런 식으로요:</p>\n<blockquote>\n<p>"저기요, 이건 제가 보기에 좀 헷갈리네요. 제가 이런 식으로 업데이트하는 걸 생각해 봤는데요: ... 어떻게 생각하세요? 제가 더 넣어야 할 내용이 있을까요?"</p>\n</blockquote>\n<p>이렇게 당신은 모두를 만족시키는 표현법을 함께 제안할 수 있습니다.</p>\n<p>마지막으로 당신이 답변을 얻지 못하더라도 주눅들지 마세요. 큰 프로젝트는 여러 일들이 진행됩니다. 그래서 당신의 기여는 그 사이 어딘가로 쏙 빠져버리기 쉽지요. <strong>일주일 안팎으로 당신이 아무런 답변을 듣지 못한다면, 관리자에게 다시 물어보세요.</strong></p>\n<p>보통 당신이 라이브러리를 사용하게 되면 무엇보다 먼저 마주치는 것이 문서입니다. 그러므로 문서를 자세하고 명료하게 만드는 것은 중요합니다.</p>\n<p>그러니 당신이 쓰는 코드가 혼란스러울 때나 직접 소스를 들여다 보아야 할 때, 다음 사람을 위해 보기 쉽게 만들어주세요. 간단한 업데이트를 작성하고 다시 기여하세요. 이것이 제가 알고있는 오픈 소스 기여자가 되는 가장 쉬운 방법입니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>첫 번역이라 부족한 점이 아주 많았습니다. 영어로 된 글을 읽는 것이 그래도 어느 정도는 읽을만 하다고 생각했는데, 다른 사람이 한글로 된 번역문을 읽으려면 훨씬 번역을 잘 해야하고, 우리말 문장도 매끄럽게 작성하도록 온 신경을 기울여야 한다는 점을 깨닫는 계기가 되었습니다.</p>\n<p>사실 번역을 시작해보게 된 계기는 단순합니다. 본 글의 저자인 <a href="http://www.justinweiss.com">Justin Weiss</a>의 블로그 포스팅들이 마음에 들어서 책(Practicing Rails)도 구매하고, 뉴스레터도 구독하면서 최근 뉴스레터의 내용들이 참 도움이 많이 된다고 생각하였습니다. 그래서 메일로 최근에 온 뉴스레터를 한글로 번역하여 공유해도 되겠냐고 물어보았지요.</p>\n<p>그는 조만간 그 뉴스레터를 블로그로 포스팅할 예정이고 그 포스팅이 첫 번째로 공개되는 포스팅이었으면 한다고 답변을 주었습니다. 즉 아직은 올릴 수 없다는 말이겠지요. 메일을 조금 더 주고받다가 저는 그의 좋은 포스팅들 중 첫 번역을 이 글로 시작하기로 협의했습니다.</p>\n<p>차차 Justin의 포스팅 이외에도 괜찮은 글들을 제가 번역할 기회가 주어진다면 조금씩 올려볼 예정입니다. 감사합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-19-the-easiest-way-to-get-into-open-source-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-09",path:"/posts/the-easiest-way-to-get-into-open-source-kor",title:"[번역] 오픈 소스에 참여하는 가장 쉬운 방법",tags:["Translation","Rails","OSS"],category:"Translation"}}],Ruby:[{excerpt:"이 글의 원문은  Michał Konarski…",html:'<ul>\n<li>이 글의 원문은 <a href="http://mjk.space/how-to-avoid-inheritance-in-ruby/">Michał Konarski</a>가 작성하였습니다.</li>\n<li>번역 실수 및 용어 사용의 지적 등은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>상속이 왜 문제가 될까요? 예를 하나 들어드리겠습니다.</p>\n<p>여러분의 고객이 \'교통 상황 시뮬레이터\'를 만들어달라고 요청했다고 해보죠. 고객은 몇몇 자동차가 움직이는 모습을 실험해보고 싶어합니다. 만약 루비같은 객체지향 언어를 사용한다면 먼저 모든 로직과 속성을 담고 있는 모델 클래스를 떠올리게 됩니다. 이렇게요.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 136px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50.73529411764706%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABlUlEQVQoz62SyU4CQRRF8bNc+AGu/BDWim4YNiQaV67QsDFqHIgyis2ktHHCCIgM3dD0wKAoIsqgkFRSz6oGGhJXJnRy0q9e7r016qJCYEY3pS/IuQZZ7tTebIhzm0Ocx0BY+Q9h3mMIcm6LI26f05KvpaipAXUQW0VQupKKTOmIE0yMhxoK9VBvmPeuaoE3MmuQ2kXIvmb6BJSppRFXz6HCR16Db3Ao3+CR0Cwg7p1TNVRLPVJbhEj+1DwOlNhlpSvDMAzn6lnM3J3hQ+YAn0SOsevCiYP3AczEGLV3X4zh3FsWUy31KN8yCfRZJleoBaZfnjBZBfiuvGBZN4NxzQj2IztYN6ywuW8D/aIeyCRANVRLPaU/gRK7JLYEIDP26VZG2yEGFFce1DpZTqh1ohRHqeojGh0N+ffEtgAR3mfSAm/lS9MnNMkhK1D5KQ/oUSrw3K+qdbU/qClV0h9plI4CX8R7nvePL8WfccyT97jDCkEbYWtEtBBQYYWAVo97ms4WLTC7zuT2ghrWRmha71pX6zR0v7xe4phLYWhMAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle Class"\n        title=""\n        src="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png"\n        srcset="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png 136w"\n        sizes="(max-width: 136px) 100vw, 136px"\n      />\n    </span>\n  </span>\n  </p>\n<p>완성된 결과물을 고객에게 보여주었습니다. 다 괜찮았는데 이제 고객이 자동차가 \'승용차\' 혹은 \'트럭\' 으로 나뉘었으면 좋겠다고 합니다. 이런 경우 두 차종은 최소한 일부 행동을 공유하고 있있는데다, 코드를 반복해서 작성하는 것도 별로 내키지 않습니다. 문제 없어요! 상속을 활용하면 되죠! 지금 마주친 경우는 아주 적절한 \'-이다(is-a)\' 관계입니다. 안 될 것 있나요?</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 424px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.443396226415096%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB30lEQVQoz2NgQAMn7h9mBNFH7+23OvPoRMvll+drrr29XHvpxfmaUw+PNR25u1cOLH93PyMDMeDEnaMsIPr0w+PNP/9//3/h8fn/J24d+3/j9fX/X/9//n/83iFXkPzhG/uZsRpw7P4Bhr1XtjP8//8fzAfSTCD6zJPjcWcfnrp7+PrBS8dvHTl79Mbhy2cenrx19tlxA2R1IH3bz25kOPnoMMP2K2tQzAZ5AWQrSCGLlp0sM7cQu7CilqwQSFJaWVyYW4hNSF5XHCwPVYfpygXnOtgqp2dxWLkbi1r7GAmYu+sLCEsIcAOluICYDU05B0hcTl2Kx9LTQMA52FrQKcBa5NjvNazdm8vYJu2tZmK48PTs7TMPTp44cfvomcsvLp688OzsidNPD+tAvcPYPq2F4cqbCwxrD6wE88Hh+/ho4OXnF64Cg+T4MWBwnHt05vTFp+fOHri1I4jh7/8//2++ufn/7P0z/18B4bPfT/8fu3vAAaRx68kNcC8xMjIyHLx0EMw/9eBY0c//P/7ffnfr/8lbJ/7f/3z//1sgPHxnbyFQ8uiU04+OtwNxJzBmO08+ONKx7+Y2eZBGoI3wpLHp4lIGoBow/9Cd3RbAJDTx7OMTYH1ANgh37b6+yRwAIIsHylqv15gAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with inheritance"\n        title=""\n        src="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png"\n        srcset="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-20168.png 198w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-b3d3b.png 395w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png 424w"\n        sizes="(max-width: 424px) 100vw, 424px"\n      />\n    </span>\n  </span>\n  </p>\n<p>고객은 결과물에 또 만족했지만, 또 다른 추가사항을 요구했습니다. 이 자동차들이 다른 종류의 엔진을 탑재했으면 한다고 합니다. 예를 들어 석유 엔진과 전기 엔진으로요. 다시 한번 상속을 사용해서 문제를 해결해보겠습니다!</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 562px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACUUlEQVQoz6VSS2sTURSeJhXbjVECYrXQ1C5cZNOdIiio1F1EEFy70aJVpOBGhFr9AW7agiBBMAYj2DTapHnPjJn3TCaZmbwzySSTZJz0IYIiZlG9zqRuWrLzwOXc+z0O595zIWhAvPywNGTmcM5vFzT+DSUT74zlEzq8O5xbPWZyS74XQ4O8EF6H+5lsIhCtEFYddCwAAKuJ0Ro6nvsiAapCArpKAUkTeqyOnjQ5U6ODtoWu41ZKRf7VSu4vejCmzztH55/POaP5jxNhcc3xcPGu88z01MggLVZL7t8g5chRvsNcTYpRF15BXakKfHnm+qXhg8b7T2YPYVXkClpIurAS4jI8M3A5fMTkUrUEBLEqYTEPRA29oO9qoLRdBO1eC0h6tgfLoX43SDFmwWXEsmeK2SRd2FW+10FhMw9avSYg6+hZk2OauMXssP+4ua/pE2mVebROBJ4mstEFscvfTm9hwyueZYjtYBCtpvo6uo0eljYzd+KZ6ELg8+oi32LnpR3u+N5tE4MH9V8Rq/ptsBwc9ybdkykl4oiVAjasGbMbQ5jywu6J/E967D3pHvHzntHiL27ME3/liEhrp5FayE5pSRu/jTvcwZVJWodPoWrQBglaxlfaKoIoE/nd+KEAqZt9zKucR+yIIMHHgfytAkQ9czPT5m6Vd0p9rNDNg2yHf80o5DNJEwEiwH/EtgAYhfJC6Rb9gGvQ60QFe2vkCNcir3EqdY+WiRBZxb2sQm1wLeocq5IXDcOGiTF1MmT4ZukGdoOS8bDx6U3sE9Mg5v4CEGx46+zImFIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with even more inheritance"\n        title=""\n        src="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png"\n        srcset="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-8c8bd.png 198w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-e07aa.png 395w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png 562w"\n        sizes="(max-width: 562px) 100vw, 562px"\n      />\n    </span>\n  </span>\n  </p>\n<p>여러분의 고객은 \'지금은\' 아주 행복합니다. 하지만 또 세분화를 요구한다면 어떻게 될까요? 전용차라던가, 경찰차라던가, 소방트럭이나 앰뷸런스 등 이보다 더 많은 세분화를 요구한다면? 우리의 상속 트리는 점점 커지고 복잡해지게 됩니다. 반복되는 코드를 줄이는 대신에 결국 같은 로직을 여러군데 복사-붙여넣기 하게 될 것입니다. 심지어 <a href="https://en.wikipedia.org/wiki/Combinatorial_explosion">위키피디아에도</a> 이 현상이 기재되어 있습니다.</p>\n<p>위에서 말씀드린 사례는 제가 가볍게 지어낸 경우가 아닙니다. 저는 전문 개발자로 일하면서 오래된 코드에 새로운 기능이나 행동을 추가하려 할 때마다 이런 상황을 여러 번 접했습니다. 특히 여러분이 레일즈를 사용하면서 더 자주 접하실\n수 있습니다. <code class="language-text">ApplicationRecord</code> 나 <code class="language-text">ApplicationController</code> 를 상속하도록 강제하는 경우가 많기 때문입니다.</p>\n<p>상속이 발생하는 코드를 예로 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Truck</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 코드를 더 낫게 만들 수 있을까요? 가능합니다.</p>\n<h2 id="아마도-믹스인mixin을-쓰면"><a href="#%EC%95%84%EB%A7%88%EB%8F%84-%EB%AF%B9%EC%8A%A4%EC%9D%B8mixin%EC%9D%84-%EC%93%B0%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>아마도 믹스인(Mixin)을 쓰면?</h2>\n<p>수 많은 루비 프로그래머들이 상속이 문제를 해결할 수 없다고 깨닫는 순간, 가장 먼저 떠오르는 해결책은 믹스인일 겁니다. 믹스인이 뭘까요? 기본적으로 메서드들이 정의된 모듈을 클래스에 포함하여 그 클래스의 일부로 사용하는 기법입니다. 우리는 간단히 공통된 로직을 추출하여 코드의 재사용을 피할 수 있습니다. </p>\n<p>믹스인을 사용하면 코드가 어떻게 바뀔까요? 먼저 <code class="language-text">include</code> 하게 될 모듈을 만들겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 믹스인할 대상이 되는 클래스를 만듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">PetrolCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>좀 보기 좋습니다. 코드가 반복되지도 않았고, 새로운 종류의 특성을 넣어서 어떤 종류의 차량이라도 만들어낼 수 있게 되었습니다. 게다가 차량이 어떤 기능을 가지고 있는지도 눈에 잘 들어옵니다.</p>\n<p>하지만 여전히 문제가 남아있습니다. 클래스를 살펴보면 포함된 행동들이 어떻게 사용되는지 명확하지 않습니다. 믹스인으로 새로운 메서드들이 추가되었지만 이 메서드들이 무엇을 하는지, 클래스가 어떻게 메서드와 영향을 주고받는지, 실행되는 과정은 어떻게 되는지 바로 파악할 수 없습니다. 만에 하나 같은 이름을 가지고 있는 두 모듈을 가져와 사용한다면 문제가 발생하게 됩니다. 한 모듈이 다른 모듈에 있는 메서드를 \'조용히\' 가져와서 사용하게 되겠지요. 상속 할 클래스가 늘어나면서 생기는 문제와 비슷한 방식으로 코드가 엉망이 되기 시작합니다.</p>\n<p>믹스인은 확실히 좋은 사용처가 있기 때문에 그렇게 나쁜 방법은 아닙니다. 제 의견으로는 로깅, 인증, 유효성 검사 등 클래스의\n메타행위(meta behavior)를 정의할 때는 아주 잘 동작한다고 생각합니다. 믹스인은 코드를 깔끔하고 작은 규모로 유지할 수 있다는 명확한 장점이 있습니다. 여러분이 모듈에 정의되어 있는 구현을 믿고 있고, 서로 다른 로직을 무너뜨리지 않는 지점을 파악하고 있는 한 괜찮습니다. 기억하셔야 할 점은 이는 단지 <strong>루비가 은연중에 다중 상속을 구현하는 방법</strong>에 불과하다는 점입니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">In OOP there’s this thing to prefer composition over inheritance. And in Ruby people constantly forget that modules == multiple inheritance</p>&mdash; Piotr Solnica (@_solnic_) <a href="https://twitter.com/_solnic_/status/623224611212251136">July 20, 2015</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>이 문제를 개선할 수 있을까요? Yes, we can!</p>\n<h2 id="조합"><a href="#%EC%A1%B0%ED%95%A9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조합</h2>\n<p>조합은 저도 오래전에 알고 있었지만 최근에야 사용하기 시작한 용어입니다. 단지 조합을 충분히 편하게 사용할만큼 좋다는 <em>느낌을 받지 못했습니다.</em> 그러던 어느 날 Sandi Metz의 <a href="https://www.youtube.com/watch?v=OMPfEXIlTVE">\'Nothing is Something\'</a> 이라는 아주 환상적인 발표를 보게 되었습니다. 다른 것 보다 그녀는 조합에 대해 이야기하면서 제가 예를 들었던 문제(교통 상황 시뮬레이터)를 풀어냈습니다.</p>\n<p>조합은 어떤 방식으로 동작할까요? 클래스 사이에 <strong>같은</strong> 행위를 공유하려 하기보다, 어떤 요소가 <strong>다른</strong>지 알아낸 뒤에 이름을 붙이고, 개별 클래스로 추출해낸 뒤에 마지막에 하나의 객체로 합치는 방식으로  동작하게 됩니다.</p>\n<p>상속이 \'-이다(is-a)\' 관계를 나타낸다면 조합은 \'-를 가지고 있다(has-a)\' 관계를 나타냅니다. 그러므로 조합을 활용하기 위해서 문제의 구조를 바꾸어야 합니다. 우리의 차량은 더 이상 전기자동차가 아니라, 전기 엔진을 가진 자동차 입니다(Our vehicle <strong>is not</strong> an electric vehicle anymore but rather it <strong>has</strong> an electric engine). 트럭은 그냥 트럭이 아니고 자동차가 트럭의 몸체를 가진 것입니다(It <strong>is not</strong> a truck but it <strong>has</strong> a truck body). 이렇게 우리는 두 가지 개념을 잡아냈습니다. 바로 <strong>엔진</strong> 과 <strong>몸체</strong> 입니다.</p>\n<p>우리의 애플리케이션은 이제 아래와 같은 모습이 되었습니다. 엔진과 몸체 컨셉을 구현한 뒤에 <code class="language-text">Vehicle</code> 클래스 안에 엔진과 몸체가 들어갈 자리를 마련했습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 373px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 76.67560321715818%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADhElEQVQ4y5WU34sbVRTHJ10CEfwPBNEHX8UX8UVsUV9EQQVXiw9aLOiT0LqwYhfUsrD1qSLaBREfLNqyKD5I3UXbJrv5NZlkJpP5sROT+T2ZH8nm90w26e4kc7x3dIW+CL1w+N5zBj5z7nfOXIJ4gAUAsVaUybLchdVmFy7IPbiI9hfq3uLjDN9/mrhOfrV0o3ztoZ+oa6kt5tsUHdxJ1e7tpu5av6R+JL9J3Sxvpm6UN9Hz75ZOwFUt4OrOEdCNXhyVv7rQngGU5ck6UdJz51ibtmtOla/ZjFTWShKlkhJtliVUwyGiul7QMq+dAGv69FdK6oxytVYry1puuqK2qvLQLzWCDwnaolY7URsavQbIgyak2TTskNuQFbKgjVVo9hvgHNlAGYXzGHZ+42wiX/c/EF24iuKK6MEXUgc2uNbiy+2yd4aoWORHxqEOYps/Er3aXPBqC8HFwS5wjurHyrCJgPl3T3wsiO09UnQgX7PCXVpb7FX1Y8EIgJKDVdzhijnVQbBb4b4ziCRvAPX2CCR3AKI9iHjbmKu+jDs8h4HLCEhKPYpVx1DgHaDqXcjQGoitGRTr4zWCaVErxqGKAKOw4UJ0m5Th910RcqwDygFEgt2Zq2PcYTEGfr+9eaqszp5SR/C8MoDTzT6cQfvTch9e+JM5eDTu0DhEb7DbYd2dRqzWBVpuA2+iTlEu2DbqEAML8ZH3O/zS/84WbZVWrKkBgseHvMtFSCEOlwecix4/18bKfx6KHXbp4eeuLD22/EPyxbVK8qXLXPKJt28mU89uJB9/ffNUDIw9dNQQdRPtew40ugeAFfkaCY58n4fEI0SC1afXRWumsJrPs6ovCuaUk5xjPS8N3yMY6x8PRbsfotNGBd6NbmX4iFX8SI09bN/nIV6SG0rDBUBRcCBbNdBwdwGvUsO/jD/KReyRaPdmcgdCTvfDHBoHrDgXbO9ec1DHwHcw7OXPzibKcrAuWEe/ccZsC+nPNWO6xZmzW7tC/1WiYpJrIxiAOjZAnzhgTT00yF0wkeqBA1pgQg8OAP1R72PgK2tvJaim/zWt+EVGDe6WG6MMrQR3kA1Umuu9SeTV9DMIus60yE/oVvESbRUuVcx8rAzOcd0qfZ6Vbz95cuS6O5ecCQDT7OHhRmECSoHRZp8SD3bbmIl/b5urvDXbY1R/h9UmfzDKeIczDnNZcfjG37JmJTRNQVyIAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Composition in action"\n        title=""\n        src="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png"\n        srcset="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-c12ac.png 198w,\n/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png 373w"\n        sizes="(max-width: 373px) 100vw, 373px"\n      />\n    </span>\n  </span>\n  </p>\n<p>실제 코드는 어떻게 될까요? 핵심 클래스부터 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span><span class="token punctuation">)</span>\n    <span class="token variable">@engine</span> <span class="token operator">=</span> engine\n    <span class="token variable">@body</span> <span class="token operator">=</span> body\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> run\n    <span class="token variable">@engine</span><span class="token punctuation">.</span>refill\n    <span class="token variable">@body</span><span class="token punctuation">.</span>load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이제 우리는 컨셉에 맞는 구현을 한 뒤에 <code class="language-text">Vehicle</code> 객체에 주입하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TruckBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">CarBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>마지막으로 모두 한 곳에 넣으면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">petrol_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\npetrol_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>이 접근방식은 많은 이점이 있습니다. <code class="language-text">Vehicle</code> 클래스가 외부 로직을 사용하는 방식은 첫 눈에 명확하게 들어옵니다. 이름이 꼬이는 문제도 없습니다. 각각의 클래스는 정확히 한 가지 일을 하고 있습니다(<a href="https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9D%BC_%EC%B1%85%EC%9E%84_%EC%9B%90%EC%B9%99">단일 책임 원칙</a>을 만족합니다). 그래서 이 클래스들이 자신에게 주어진 일을 얼마나 제대로 하는지 확인하는 테스트를 쉽게 할 수 있습니다.</p>\n<p>우리는 높은 응집력(관련있는 로직을 같이 두는 것)을 달성하면서 동시에 결합도(클래스의 의존성을 낮게 만드는 것)는 낮추었습니다. 이제 인터페이스 전체를 바꾸지 않는 한, 고객의 요구에 걱정하지 않고 코드에 사용되는 엔진이나 몸체를 바꿀 수 있습니다.</p>\n<p>조합 기법에도 문제점이 있을까요? 물론 있습니다. 이 방식은 코드를 더 길게 쓰도록 합니다. 특히 모든 의존성들을 최종 객체에 주입하게 될 때 눈에 띄게 길어집니다. 여러분은 추가적인 보일러플레이트(여기서는 코드를 생산해내는 템플릿 함수)를 만들어서 참조 위치를 저장하고, 어디에 위임을 할지 설정하며 정확한 실행 흐름을 제어할 수 있도록 만들어야 합니다. 문제의 처방전으로 여러분은 여러 가지 <a href="https://en.wikipedia.org/wiki/Creational_pattern">제작 패턴</a>을 활용할 수 있습니다. 팩토리(Factory)나 빌더(Builder) 처럼요.</p>\n<p>제가 조합을 활용하려고 할 때 제일 어려웠던 점은 제 사고 방식을 조합을 응용하기에 알맞는 방식으로 고치는 것이었습니다. 예상밖으로 <strong>Go</strong> 언어를 가지고 놀 때 많은 도움을 받았습니다. 이 프로그래밍 언어는 상속을 받지 않도록 설계되어 있지만 객체지향 방식으로 코드를 작성할 수 있게 되어있습니다. 또한 프로그래머들에게 조합을 사용하도록 권장하는 기능들이 담겨있습니다. (역주: <a href="http://hackthology.com/object-oriented-inheritance-in-go.html">이 글</a>이 Go 언어에서 조합을 사용하는 예를 보여주는 좋은 글로 보입니다) 제가 Go를 조금 가지고 놀다가 갑자기 조합을 사용하는데 훨씬 익숙해졌다는 사실을 깨달았습니다. 다음 포스팅에 이 이야기를 자세히 쓰고자 합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 여러분께 코드를 구축하는 세 가지 다른 접근 방식을 보여드렸습니다. 상속, 믹스인, 조합 말씀입니다. <strong>상속</strong>은 많은 프로그래머들의 첫 번째 선택지이지만, 저에게는 심하게 과용되고 코드를 복잡하게 만드는데다 유지보수도 힘들게 만들었습니다. <strong>믹스인</strong>은 더 똑똑하고 강력한 대체제로 보이지만 사실은 다중 상속의 한 방법에 불과하고 코드의 복잡도를 늘릴 수도 있습니다. <strong>조합</strong>은 코드 양은 제일 길어지겠지만 클래스 사이에 의존성을 관리하는데 가장 직관적이며 깔끔한 접근방식을 가지고 있습니다. 조합은 코드를 작고 분리된 조각으로 유지하며 테스트하기도 쉽습니다. 그래서 제가 가장 선호하는 방법입니다.</p>\n<p>객체 지향 프로그래밍은 일부 프로그래머들이 다른 프로그래머들이 처한 문제를 조금 더 쉽게 해결하도록 돕고자 만든 하나의 협약에 지나지 않는다는 점을 잊으시면 안됩니다. 규약에 얽매이지 마세요. 여러분이 처한 상황에 가장 잘 맞는 해결책을 선택하세요.</p>\n<p>그리고 마지막으로, 이 말을 새겨두시기 바랍니다.</p>\n<blockquote>\n<p>객체 지향 소프트웨어를 설계하는 일은 어렵다. 그리고 재사용 가능한 객체 지향 소프트웨어를 설계하는 일은 훨씬 더 어렵다. - Gang of Four</p>\n</blockquote>\n<p>이 말을 경험을 통해 알게 되실 겁니다.</p>\n<h2 id="원문의-참고-자료"><a href="#%EC%9B%90%EB%AC%B8%EC%9D%98-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>원문의 참고 자료</h2>\n<ul>\n<li>RailsConf 2015 - Nothing is Something</li>\n<li><a href="https://learnrubythehardway.org/book/ex44.html">https://learnrubythehardway.org/book/ex44.html</a></li>\n<li><a href="https://robots.thoughtbot.com/reusable-oo-inheritance">https://robots.thoughtbot.com/reusable-oo-inheritance</a></li>\n<li><a href="https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose">https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose</a></li>\n</ul>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>어느정도 일상과 공부와 번역 등의 밸런스가 틀이 잡혀가면서 한달에 한 개 정도 포스팅하는 방향으로 굳어지고 있나봅니다. 적어도 한달에 두어개는 작성하고 싶은데.. 좋은 글은 매일 탐독하고 있지만 제대로 써먹지 못하면서 알려봤자 뭐가 좋나? 라는 생각이 들 때도 있습니다.</p>\n<p>이전에 의존성 주입에 관한 글을 번역했을 때도 그렇지만 조합 패턴은 루비를 사용하면서, 혹은 자바스크립트를 사용하면서도 아주 중요한 패턴 중 하나라고 생각합니다. 반드시 자유자재로 다루고 싶은 패턴이긴 한데 \'평범하게\' 레일즈를 사용하게 되면 아마 쉽게 익숙해지긴 힘든 패턴이라 생각합니다. 그래서 개인적으로 루비로 API 백엔드를 구축하는 토이 프로젝트를 하시게 된다면 하나미(hanamirb)를 이용해서 만들어보시는걸 강력하게 권장하고 싶습니다. 레일즈는 구조 특성상 이런 형태의 조합을 사용하기 쉽지 않다고 생각하기 때문입니다. (<code class="language-text">ActiveSupport::Concern</code>, <code class="language-text">Single Inheritance Table</code> 등)</p>\n<p>자바스크립트에서 조합을 사용하는 것을 권장하는 글도 최근에 읽고 큰 감명을 받았는데, 한번 살펴보시길 권하면서 링크를 남깁니다.</p>\n<ul>\n<li><a href="https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0">https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0</a></li>\n<li><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3">https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-07-16-how-to-avoid-inheritance-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-07-16",path:"/posts/how-to-avoid-inheritance-in-ruby-kor",title:"[번역] 루비에서 상속을 피하는 방법",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 업데이트 BCrypt 관련 설명 수정 (2017-05-02) 들어가며 하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p><strong>업데이트</strong></p>\n<ul>\n<li>BCrypt 관련 설명 수정 (2017-05-02)</li>\n</ul>\n<hr>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.0 버전이 발매되었고, 아직도 쓰고있다보니 감개무량합니다.</p>\n<p>요즘 프론트엔드 JS 프레임워크에 많은 관심을 가지고 ReactJS, Vue.js를 공부하고 있는데, 간단히 배운 내용을 적용해볼 겸 간단 가계부를 구현해보도록 하겠습니다. 백엔드 JSON API 서버는 하나미로 구현하고, 프론트엔드는 Vue.js로 구현하는 과정을 보여드리겠습니다.</p>\n<p>최대한 간단히 설명해드리려 노력하겠지만, 기존에 루비로 웹 개발을 해보신분이 이해하시기 쉬울 겁니다. 사실 JSON API 서버는 어떤 언어나 프레임워크로 제공해도 되니까요 :) 구현방법에 약간씩 차이가 있을 뿐이지 제가 보여드리는 정도의 앱은 그렇게 어렵지 않게 작성하실 수 있으리라 봅니다.</p>\n<h2 id="애플리케이션의-기본-구성"><a href="#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>애플리케이션의 기본 구성</h2>\n<p>처음에는 더욱 간단한 To-Do List(할일 관리) 를 구현하려고 했는데, 그러면 하나미를 다루는 부분이 너무 영양가가 없어질 것 같아서 가계부 형식의 앱으로 만들고, 다음의 기능을 구상해 보았습니다.</p>\n<ul>\n<li>\n<p>회원 등록 및 인증</p>\n<ul>\n<li>이메일과 비밀번호로 회원 가입</li>\n<li>JWT로 인증 (토큰은 LocalStorage에 저장)</li>\n</ul>\n</li>\n<li>\n<p>사용금액, 내용 입력</p>\n<ul>\n<li>수입은 녹색, 지출은 빨강색으로 표시</li>\n<li>각 아이템을 클릭하면 바로 수정 가능, 삭제 버튼을 누르면 삭제</li>\n</ul>\n</li>\n<li>수입, 지출을 필터링하여 보기</li>\n<li>가장 최신 레코드 30개를 처음에 불러온 뒤, 화면에 보이는 마지막 내역까지 스크롤 하게 되면 추가로 자료 가져오기</li>\n</ul>\n<p>이 정도의 기능을 구현해볼 예정입니다. 막상 하려니 쉽진 않겠지만 차근차근 진행해보겠습니다.</p>\n<h2 id="하나미-프로젝트-생성"><a href="#%ED%95%98%EB%82%98%EB%AF%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미 프로젝트 생성</h2>\n<p>너무나 당연하지만 하나미를 사용하기 위해서는 개발 환경에 루비가 세팅되어 있어야 합니다. 아직 루비가 설치되어있지 않은 경우에는 <a href="https://gorails.com/setup/">GoRails의 설치 가이드</a>를 따라하시면 되겠습니다. 그 다음에 하나미 젬을 설치하시면 됩니다. 이번 강좌에서는 <strong>루비 2.4.1</strong>, <strong>하나미 1.0.0</strong> 버전을 기준으로 프로젝트를 생성하겠습니다.</p>\n<p>먼저 하나미 젬을 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">gem install hanami</code></pre>\n      </div>\n<p>설치 된 이후에 프로젝트는 원하시는 이름으로 설치하시면 됩니다. 하나미는 SQLite, MySQL, PostgreSQL 등을 지원하지만, 기본적으로 PostgreSQL을 권장합니다. 또한 테스팅 프레임워크도 처음 프로젝트를 설정할 때 Minitest, RSpec 중에서 고르실 수 있습니다. 제가 아직 RSpec은 커녕 TDD를 잘 못하기 때문에 Minitest로 진행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">hanami new moneybook-api --database=postgres --test=minitest</code></pre>\n      </div>\n<p>생성된 프로젝트에서 젬파일을 살펴보시면 꽤 간단합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\nsource <span class="token string">\'https://rubygems.org\'</span>\n\ngem <span class="token string">\'rake\'</span>\ngem <span class="token string">\'hanami\'</span><span class="token punctuation">,</span>       <span class="token string">\'~> 1.0\'</span>\ngem <span class="token string">\'hanami-model\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 1.0\'</span>\n\ngem <span class="token string">\'pg\'</span>\n\ngroup <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  <span class="token comment"># Code reloading</span>\n  <span class="token comment"># See: http://hanamirb.org/guides/projects/code-reloading</span>\n  gem <span class="token string">\'shotgun\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span><span class="token punctuation">,</span> <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'dotenv\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 2.0\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'minitest\'</span>\n  gem <span class="token string">\'capybara\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:production</span> <span class="token keyword">do</span>\n  <span class="token comment"># gem \'puma\'</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 중에서 <code class="language-text">capybara</code> 젬은 뷰 테스트 용이기 떄문에 이번 프로젝트에선 굳이 없어도 됩니다. 앞으로 젬이 더 추가될테지만 필요에 따라 추가하기로 하고, <code class="language-text">bundle install</code> 커맨드로 필요한 젬을 설치해두겠습니다.</p>\n<p>참고로 PostgreSQL을 이용하시려면 <code class="language-text">.env</code> 파일에서 계정 설정을 해주셔야 합니다. SQLite를 이용하신다면 파일로 관리되기 때문에 계정 설정을 해 주실 필요는 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\nDATABASE_URL=&quot;postgresql://username:password@localhost/moneybook_api_development&quot;</code></pre>\n      </div>\n<h2 id="사용자-인증-구현"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 인증 구현</h2>\n<p>기존의 웹 페이지는 서버에서 인증 관련 정보를 들고, 세션을 이용하여 인증 상태를 유지하고 요청을 하는 경우가 많았습니다. 하지만 모바일 애플리케이션이나, 많은 인스턴스를 올려서 인증을 관리하는 경우 세션 기반 인증은 유연한 대응이 어렵습니다. JWT라는 개념을 이용하면 세션 기반 인증의 단점을 극복하고 사용자 인증을 적용할 수 있습니다.</p>\n<p>JWT 인증이 무엇인지 궁금하시다면 다음의 링크를 읽어보시길 바랍니다.</p>\n<ul>\n<li><a href="https://velopert.com/2389">JSON Web Token 소개 및 구조 - velopert</a></li>\n<li><a href="http://bcho.tistory.com/999">REST JWT 소개 - 조대협</a></li>\n<li><a href="https://jwt.io/introduction/">Introduction to JSON Web Tokens</a></li>\n</ul>\n<p>인증에 필요한 젬을 추가한 뒤, 사용자 정보를 기록하는 모델을 생성하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\n<span class="token comment"># ...</span>\ngem <span class="token string">\'bcrypt\'</span>\ngem <span class="token string">\'jwt\'</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">bcrypt</code> 젬은 비밀번호 생성에 특화된 단방향 해시 함수를 지원합니다.<br>\n간단한 사용법을 알려드리면 <code class="language-text">BCrypt::Password.create(&#39;password&#39;)</code> 로 해시 다이제스트를 생성하고, <code class="language-text">BCrypt::Password.new(digest)</code> 로 해시 다이제스트가 본래 비밀번호와 일치하는지 검사합니다.</p>\n<p>너무나 당연하면서 중요한 이야기지만 웹 개발자로서 복잡한 보안 알고리즘을 직접 구현하면 관리 및 취약점을 파악하기가 어렵기 때문에 차라리 <code class="language-text">bcrypt</code> 처럼 검증된 라이브러리를 사용하시길 추천합니다. 비슷한 예로 Rails에서 사용자 인증과 관련한 부분은 되도록이면 Devise 젬을 사용하길 권장하는 것 처럼요.</p>\n<p>패스워드 저장 매커니즘에 대해 <a href="http://d2.naver.com/helloworld/318732">이 글</a>을 읽어보시길 추천합니다.</p>\n<h3 id="사용자-모델-생성"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 모델 생성</h3>\n<p>먼저 사용자 정보를 저장하기 위한 모델을 생성하겠습니다. 간단히 이메일과 패스워드를 저장하는 테이블을 만들면 되겠네요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model user</code></pre>\n      </div>\n<p>앞으로 모든 하나미 커맨드 앞에는 <code class="language-text">bundle exec</code>  이 붙을 예정입니다. 앞으로 하나미를 자주 쓰게 되면 <code class="language-text">bashrc</code> 나  <code class="language-text">zshrc</code> 에 alias 지정을 해 두는걸 추천합니다.</p>\n<p>그리고 레일즈와 비슷하게 <code class="language-text">db/migrations</code> 폴더에 마이그레이션 파일이 있습니다. 어떤 컬럼에 어떤 정보가 들어가게 될 지 작성해주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migration/2017***_create_users.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:users</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:password_digest</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>방법에 따라서는 이메일 컬럼만 있어도 충분히 JWT 인증을 구현할 수 있다는데 아직 잘 모르겠습니다. 이제 테이블 생성을 위해 마이그레이션을 실행하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami db create # 먼저 데이터베이스 생성부터\nbundle exec hanami db migrate</code></pre>\n      </div>\n<h3 id="사용자-등록-액션"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%93%B1%EB%A1%9D-%EC%95%A1%EC%85%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 등록 액션</h3>\n<p>이제 사용자를 등록하는 액션을 생성하겠습니다. 이후에 JWT 인증하는 과정을 덧붙일 예정입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api auth#sign_in --skip-view\nbundle exec hanami generate action api auth#sign_up --skip-view</code></pre>\n      </div>\n<p>action 뒤에 <code class="language-text">api</code> 는 제가 사용할 앱 이름입니다. 기본값은 web으로 되어 있지만, <a href="http://hanamirb.org/guides/command-line/generators/">하나미 가이드의 Command Line 부분을 참고하시면</a> 다른 앱을 생성하거나 삭제하는 등 액션을 실행할 수 있습니다.</p>\n<p><code class="language-text">--skip-view</code> 는 뷰와 관련된 템플릿 파일이나 뷰 클래스 및 테스트를 생성하지 않는 커맨드입니다. 우리는 하나미를 순순히 API 서버로 사용할 것이기 때문에 미리 입력해주어야 불필요한 파일을 만들지 않게 됩니다.</p>\n<p>라우팅 파일의 내용도 변경해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\npost <span class="token string">\'/auth/sign_in\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_in\'</span>\npost <span class="token string">\'/auth/sign_up\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_up\'</span>\n</code></pre>\n      </div>\n<p>사용자를 등록하는 과정은 JWT랑은 관련이 없습니다. 단순히 이메일, 비밀번호, 비밀번호 확인을 하는 패러매터를 전달 받은 뒤, 유효성 검사에 성공하면 비밀번호를 암호화하여 데이터베이스에 저장하면 됩니다.</p>\n<p>우리는 JSON API 서버를 만들고 있기 때문에 애플리케이션의 <code class="language-text">body_parsers</code> 나 <code class="language-text">default_request_format</code> 등의 설정을 바꾸어 주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># From Line 90</span>\n      <span class="token comment"># Default format for the requests that don\'t specify an HTTP_ACCEPT header</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_request_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># Default format for responses that don\'t consider the request format</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_response_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># HTTP Body parsers</span>\n      <span class="token comment"># Parse non GET responses body for a specific mime type</span>\n      <span class="token comment"># Argument: Symbol, which represent the format of the mime type</span>\n      <span class="token comment">#             (only `:json` is supported)</span>\n      <span class="token comment">#           Object, the parser</span>\n      <span class="token comment">#</span>\n      body_parsers <span class="token symbol">:json</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>이제 안정적으로 기능을 구현하기 위해 테스트를 작성하겠습니다. 테스트 파일은 <code class="language-text">spec/</code> 폴더에 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># spec/api/controllers/auth/sign_up_spec.rb</span>\n<span class="token keyword">require</span> <span class="token string">\'spec_helper\'</span>\nrequire_relative <span class="token string">\'../../../../apps/api/controllers/auth/sign_up\'</span>\n\ndescribe <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">}</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n      user<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> <span class="token string">"foo@bar.com"</span><span class="token punctuation">,</span>\n        password<span class="token punctuation">:</span> <span class="token string">"secret"</span><span class="token punctuation">,</span>\n        password_confirmation<span class="token punctuation">:</span> <span class="token string">"secret"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  describe <span class="token string">\'with valid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'is successful\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">201</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n\n  describe <span class="token string">\'with invalid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'returns 422\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">422</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>먼저 유효성 검사부터 만들겠습니다. 하나미의 유효성 검사는 모델에서 수행하는 게 아니라 각 액션에서 수행합니다. (공통된 유효성 검사를 모듈화할 수도 있습니다)</p>\n<p><strong>작성되는 코드는 모두 테스트를 먼저 작성하고 진행하지만, 글에서 모두 보여드리지 않겠습니다. 자세한 내용은 <a href="https://github.com/emaren84/moneybook_api">Github에 올라와 있는 소스코드</a>를 살펴봐 주세요.</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">halt</code> 메서드는 인자로 받은 스테이터스 번호와 메세지를 리턴합니다. 메세지는 생략 가능합니다. 이제 올바른 패러매터가 들어왔으면  사용자를 등록하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># same file</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>interactor<span class="token punctuation">:</span> <span class="token constant">UserSignUp</span><span class="token punctuation">)</span>\n      <span class="token variable">@interactor</span> <span class="token operator">=</span> interactor\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      result <span class="token operator">=</span> <span class="token variable">@interactor</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>call\n      status <span class="token number">201</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>user<span class="token punctuation">.</span>show_info<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>뭔가 이상한 녀석이 나왔습니다. interactor라뇨? 인터렉터(Interactor)는 하나미에서 제공하는 모듈인데, 보통 다양한 비지니스 처리 로직을 분리하는 용도 혹은 재사용 가능한 비지니스 로직을 API, Web 같이 서로 다른 앱에서도 공유할 수 있도록 만들어졌습니다. <code class="language-text">lib/interactor</code> 에 해당 클래스명으로 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/interactor/user_sign_up.rb</span>\n<span class="token keyword">require</span> <span class="token string">"hanami/interactor"</span>\n<span class="token keyword">require</span> <span class="token string">"bcrypt"</span>\n\n<span class="token keyword">class</span> <span class="token class-name">UserSignUp</span>\n  include <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Interactor</span>\n  include <span class="token constant">BCrypt</span>\n\n  expose <span class="token symbol">:user</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">,</span> encryptor<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> repo<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">)</span>\n    <span class="token variable">@user_attr</span> <span class="token operator">=</span> user_attr\n    <span class="token variable">@encryptor</span> <span class="token operator">=</span> encryptor <span class="token operator">||</span> <span class="token constant">BCrypt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Password</span>\n    <span class="token variable">@repo</span> <span class="token operator">=</span> repo <span class="token operator">||</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n  <span class="token class-name">end</span>\n\n  <span class="token keyword">def</span> call\n    safe_user <span class="token operator">=</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">)</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token variable">@repo</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>safe_user<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">private</span>\n\n  attr_reader <span class="token symbol">:user_attr</span>\n\n  <span class="token keyword">def</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>attributes<span class="token punctuation">)</span>\n    password <span class="token operator">=</span> <span class="token variable">@encryptor</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>attributes<span class="token punctuation">[</span><span class="token symbol">:password</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n    <span class="token punctuation">{</span> email<span class="token punctuation">:</span> user_attr<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">,</span> password_digest<span class="token punctuation">:</span> password <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>눈여겨 보실점은 <code class="language-text">expose</code> 밖에 없고 나머지는 일반적인 사용자 등록 로직으로 구성되어 있습니다. 인터렉터는 해당 클래스의 객체를 생성하고 <code class="language-text">call</code> 메서드로 연산을 수행하는데, 그 결과값을 <code class="language-text">expose</code> 로 내보내야 합니다. 참고로 <code class="language-text">expose</code> 로 내보내려는 값은 인스턴스 변수여야 합니다. 여기서는 <code class="language-text">@user</code> 가 되겠네요. 내보낸 결과물은 메서드처럼 <code class="language-text">.user</code> 로 가져올 수 있습니다.</p>\n<p>그런데 액션 부분에 <code class="language-text">result.user.show_info.to_json</code>  이라고 되어있는 부분이 있습니다. <code class="language-text">to_json</code> 은 리턴값이 JSON이어야 되니까 그렇다 치고, <code class="language-text">show_info</code> 는 어디에 있는 녀석일까요? 방금까지 우리는 사용자를 생성했습니다. 그리고 생성된 결과값이 User Entity(엔티티)인데, 엔티티에 메서드를 정의하여 원하는 정보를 가공하여 보여줄 수 있도록 만든 것입니다. 콘솔에서 한번 확인해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami console</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[2] pry(main)&gt; UserRepository.new.create(email: &#39;foo@baz.com&#39;, password_digest: &#39;some secret&#39;)\n[moneybook_api] [INFO] [2017-04-22 14:06:37 +0900] (0.003739s) INSERT INTO &quot;users&quot; (&quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (&#39;foo@baz.com&#39;, &#39;some secret&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;) RETURNING &quot;id&quot;, &quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;\n=&gt; #&lt;User:0x007fb6a6c49348\n @attributes=\n  {:id=&gt;3, :email=&gt;&quot;foo@baz.com&quot;, :password_digest=&gt;&quot;some secret&quot;, :created_at=&gt;2017-04-22 05:06:37 UTC, :updated_at=&gt;2017-04-22 05:06:37 UTC}&gt;</code></pre>\n      </div>\n<p>저렇게 임의의 사용자를 생성하니 User 엔티티가 리턴된 것을 볼 수 있습니다. Repository가 뭐고, Entity가 무엇인지는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0">제가 전에 작성한 하나미 소개 포스트를 참고해주세요.</a></p>\n<p>엔티티 클래스 파일의 위치는 <code class="language-text">lib/moneybook_api/entities</code> 입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/entities/user.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Entity</span>\n  <span class="token keyword">def</span> show_info\n    <span class="token keyword">self</span><span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>tap <span class="token punctuation">{</span> <span class="token operator">|</span>attributes<span class="token operator">|</span> attributes<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:password_digest</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이렇게 하여 사용자 생성 후 리턴 값에는 패스워드를 뺸 나머지 정보만 보이게 됩니다.</p>\n<h3 id="토큰-생성하기"><a href="#%ED%86%A0%ED%81%B0-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 생성하기</h3>\n<p>이제부터가 본격적인 JWT 인증을 구현하는 부분입니다. 생성한 사용자가 로그인을 시도하고 요청한 이메일과 비밀번호가 맞다면 우리는 인증 토큰을 생성하여 돌려주게 되고, 사용자는 매번 로그인 할 필요 없이 그 토큰을 가지고 (유효기간이 만료할 때 까지) 자유로이 앱을 사용할 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/controllers/auth/sign_in.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignIn</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      email <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">)</span>\n      password <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:password</span><span class="token punctuation">)</span>\n\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n\n      <span class="token keyword">if</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>valid_password<span class="token operator">?</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>\n        token <span class="token operator">=</span> <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n\n        status <span class="token number">201</span><span class="token punctuation">,</span> token<span class="token punctuation">.</span>to_json\n      <span class="token keyword">else</span>\n        halt <span class="token number">401</span><span class="token punctuation">,</span> <span class="token string">\'Authentication Failed\'</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 하는 부분은 회원 등록 하는 액션에서도 적어놓았기 때문에 쉽게 알아보실 수 있을겁니다. 바로 아래에 <code class="language-text">params.get</code> 이라는 메서드는 <code class="language-text">Hash#dig</code> 메서드와 비슷한 용도를 가지고 있는데 <code class="language-text">params[:user][:email]</code> 같이 값을 검색하려다가 <code class="language-text">params[:user]</code> 가 <code class="language-text">nil</code> 인 경우 <code class="language-text">NoMethodError</code> 에러가 발생하는 일을 방지해줍니다. 대신 <code class="language-text">nil</code> 을 리턴합니다.</p>\n<p><code class="language-text">find_by_email</code> 같은 메서드는 레일즈를 하시는 분들이 보기엔 아주 친숙할겁니다. 하지만 우리는 이 메서드를 직접 구현해야 합니다. 레일즈로 개발하면서 느끼는 마법은 하나미에서는 일어나지 않습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/user_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">UserRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n    users<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> email<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token symbol">:entity</span><span class="token punctuation">)</span><span class="token punctuation">.</span>one\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><strong>모든 하나미의 쿼리 메서드는 private 입니다. 콘솔에서 바로 테스트 할 수 없습니다.</strong> 테스트를 작성하거나, 원하는 쿼리를 메서드로 정의한 뒤에 콘솔에서 돌려봐야 합니다.</p>\n<p><code class="language-text">users</code> 는 리퍼지토리와 연결되어있는 테이블명을 나타내는 규약입니다. 만약 <code class="language-text">BookRepository</code> 에서 <code class="language-text">books</code> 라는 테이블의 내용을 가져오게 된다면 우리는 <code class="language-text">books.</code> 로 시작하는 메서드를 작성하게 됩니다. 자세한 내용은 하나미 모델의 구현체인 <a href="http://rom-rb.org">ROM</a>의 문서를 참고하시는게 좋습니다.</p>\n<p>레일즈를 개발하는 분들은 보통 쿼리의 결과가 각 모델의 객체로 나오기 때문에 이후에 각 엔티티마다 메서드를 바로 사용할 수 있을겁니다. 하지만 하나미에서는 <code class="language-text">as(:entity)</code> 옵션을 적용해주지 않으면 결과물이 단순한 <code class="language-text">ROM::Struct</code> 객체를 리턴하거나. <code class="language-text">ROM::Relation</code> 객체를 리턴하는 경우가 많습니다.</p>\n<p><code class="language-text">Struct</code> 객체는 Hash처럼 되어있어서, 쿼리의 결과 레코드를 그대로 쓰는 건 가능하지만 엔티티에 정의해놓은 메서드를 사용할 수 없습니다. <code class="language-text">Relation</code> 객체는 쿼리를 아직 실행하기 전에 ROM에서 쿼리를 준비해 놓는 객체입니다. 이 객체에 <code class="language-text">to_a</code> 나 <code class="language-text">each</code> 같은 메서드를 사용해서 자료를 가공할 때 쿼리를 실행하고, 그 때 엔티티를 다룰 수 있습니다.</p>\n<p>지금은 간단한 쿼리라서 <code class="language-text">.as(:entity)</code> 부분을 빼도 결과값을 맨 앞 한개만 출력하라는 <code class="language-text">one</code> 메서드 때문에 바로 User 엔티티가 출력될겁니다. 이후에 더 복잡한 쿼리를 작성하게 되는 일이 있을 때 제가 말씀드린 내용이 도움이 되었으면 좋겠습니다.</p>\n<p><code class="language-text">user.valid_password?</code> 메서드는 <code class="language-text">BCrypt</code> 젬을 이용하여 암호화했던 비밀번호를 해독하고, 맞는지 확인하는 역할을 합니다.</p>\n<p><code class="language-text">JwtIssuer</code> 클래스는 라이브러리로 활용하기 위해 <code class="language-text">lib/moneybook_api/services</code> 폴더에 작성했습니다. 여기에 작성해 두면 다른 앱이나 액션에서 자유롭게 사용할 수 있기 때문입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/services</span>\n<span class="token keyword">class</span> <span class="token class-name">JwtIssuer</span>\n  <span class="token constant">DEFAULT_EXPIRE_TIME</span> <span class="token operator">=</span> <span class="token number">86400</span> <span class="token comment"># 24 hours</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> exp <span class="token operator">=</span> <span class="token builtin">Time</span><span class="token punctuation">.</span>now<span class="token punctuation">.</span>to_i <span class="token operator">+</span> <span class="token constant">DEFAULT_EXPIRE_TIME</span><span class="token punctuation">)</span>\n    payload <span class="token operator">=</span> <span class="token punctuation">{</span> user_id<span class="token punctuation">:</span> user_id<span class="token punctuation">,</span> iss<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_ISSUER\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> exp<span class="token punctuation">:</span> exp <span class="token punctuation">}</span>\n    token <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">\'HS256\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> auth_token<span class="token punctuation">:</span> token <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n    <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>코드의 내용은 <a href="https://github.com/jwt/ruby-jwt/blob/master/README.md#algorithms-and-usage">JWT 젬의 사용법을 따라</a> 우리가 필요한 부분을 캡슐화한 정도입니다. 토큰 생성 시점에서 24시간의 기한을 주었고, <code class="language-text">iss</code> 옵션은 발행자 옵션인데, 임의로 <code class="language-text">localhost</code> 로 지정해두었습니다. <code class="language-text">ENV[&#39;JWT_SECRET&#39;]</code> 같이 지정되어있는 환경변수를 가져오는 방법은 프로젝트 폴더에 <code class="language-text">.env.development</code> 같이 되어있는 파일에다 작성는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\n# ...\nJWT_SECRET=&quot;some secret&quot;\n# ...</code></pre>\n      </div>\n<p>비밀번호 토큰은 여러분이 원하는대로 만든 다음에, <code class="language-text">Base64</code> 나 <code class="language-text">Digest</code> 클래스를 활용하여 암호화하시길 추천합니다.</p>\n<p>인코딩에 성공하면 컨트롤러 액션은 201 스테이터스와 함께 토큰 JSON을 리턴하게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl -X POST -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/json&quot; -d &#39;{ &quot;user&quot;: { &quot;email&quot;: &quot;foo@bar.com&quot;, &quot;foo&quot;: &quot;cherryblossom&quot; } }&#39; &quot;http://localhost:2300/api/auth/sign_in&quot;\n=&gt;\n{\n  &quot;auth_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0LCJpc3MiOiJsb2NhbGhvc3QiLCJleHAiOjE0OTI5NjM2NTV9.38-CWKZkOuWD_idEOhv1gAret6_qG_ue7kk0iPftJ_M&quot;\n}</code></pre>\n      </div>\n<p>이제 사용자가 매 요청을 할 때마다 이 토큰이 유효한지 검사하는 부분을 만들어야 하는데, 가계부 기록 작성과 관련된 API를 구현한 뒤에 마저 만들어 보겠습니다.</p>\n<h2 id="가계부-api-만들기"><a href="#%EA%B0%80%EA%B3%84%EB%B6%80-api-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>가계부 API 만들기</h2>\n<p>가계부 API는 간단한 REST 형식으로 만들 예정입니다.</p>\n<table>\n<thead>\n<tr>\n<th align="center">정의</th>\n<th align="center">내용</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">/records (GET)</td>\n<td align="center">모든 레코드를 가져온다</td>\n</tr>\n<tr>\n<td align="center">/records (POST)</td>\n<td align="center">레코드를 생성한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id (PATCH)</td>\n<td align="center">해당 레코드를 수정한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id(DELETE)</td>\n<td align="center">해당 레코드를 삭제한다</td>\n</tr>\n</tbody>\n</table>\n<p>RESTful API 라면 보통 사용자가 가지고 있는 레코드를 표현해야 하니까 URL 어딘가에 <code class="language-text">user_id</code> 같은게 있어야 할 것 처럼 보입니다. 하지만 우리가 구현하고자 하는 서버에는 필요가 없습니다. JWT 토큰을 HTTP 헤더에 추가하여 요청을 하면, 서버가 토큰을 해석하여 <code class="language-text">user_id</code> 를 찾아내고 그 값을 기반으로 특정 사용자의 레코드를 검색하게 됩니다.</p>\n<h3 id="모델-생성--라우팅"><a href="#%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1--%EB%9D%BC%EC%9A%B0%ED%8C%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 생성 &#x26; 라우팅</h3>\n<p>일단 레코드 모델과 레코드를 생성하는 액션을 만들고 나서, 토큰 인증 과정을 덧붙이도록 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model record</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/2017**_create_records.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:records</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n      foreign_key <span class="token symbol">:user_id</span><span class="token punctuation">,</span> <span class="token symbol">:users</span><span class="token punctuation">,</span> on_delete<span class="token punctuation">:</span> <span class="token symbol">:cascade</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:amount</span><span class="token punctuation">,</span>      <span class="token builtin">Integer</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:description</span><span class="token punctuation">,</span> <span class="token builtin">String</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>외부 키는 컬럼 이름과, 연결해 줄 테이블 이름을 지정해줍니다. 나머지 뒤에 있는 요소들은 <a href="http://hanamirb.org/guides/migrations/create-table/">공식 문서에 자세한 설명이 있으니</a> 참조바랍니다. 그리고 마이그레이션을 실행하면 됩니다.</p>\n<p>그 다음에 액션을 생성하고 라우트를 지정하겠습니다. 다른 <code class="language-text">records</code> 관련 액션을 미리 생성해두셔도 상관 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api records#create --skip-view</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\n<span class="token comment"># ...</span>\nresources <span class="token symbol">:records</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>이 부분은 레일즈의 자동 라우팅과 아주 유사합니다. 라우팅이 어떻게 구성되었는지 확인하시려면 <code class="language-text">bundle exec hanami routes</code> 커맨드를 실행하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">    Name Method     Path                           Action\n\n         POST       /api/auth/sign_in    Api::Controllers::Auth::SignIn\n         POST       /api/auth/sign_up    Api::Controllers::Auth::SignUp\n records GET, HEAD  /api/records         Api::Controllers::Records::Index\n records POST       /api/records         Api::Controllers::Records::Create\n  record PATCH      /api/records/:id     Api::Controllers::Records::Update\n  record DELETE     /api/records/:id     Api::Controllers::Records::Destroy</code></pre>\n      </div>\n<h3 id="레코드-생성"><a href="#%EB%A0%88%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>레코드 생성</h3>\n<p>이제 세부 로직을 구현할 준비가 끝났으니 레코드 생성을 해 보겠습니다. 지금은 임의의 사용자를 지정하여 레코드를 생성하려 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>first\n      amount <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:amount</span><span class="token punctuation">)</span>\n      description <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:description</span><span class="token punctuation">)</span>\n\n      record <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>\n        user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n        amount<span class="token punctuation">:</span> amount<span class="token punctuation">,</span>\n        description<span class="token punctuation">:</span> description\n      <span class="token punctuation">)</span>\n\n      status <span class="token number">201</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>패러매터가 유효하면 레코드를 생성하고 그 정보를 JSON으로 리턴하는 간단한 내용의 코드입니다. 이제 패러매터의 유효성은 둘째치고 모든 액션에 앞서 토큰의 유효성을 검사하는 모듈이 필요합니다. 이 파일을 어디에 정의하고 어떻게 사용하는지 <a href="http://hanamirb.org/guides/actions/share-code/">가이드에 잘 설명이 되어있는데</a>, 가이드의 내용을 활용하여 만들어보겠습니다.</p>\n<h3 id="토큰-인증"><a href="#%ED%86%A0%ED%81%B0-%EC%9D%B8%EC%A6%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 인증</h3>\n<p>컨트롤러에 공통적으로 사용되는 모듈은 해당 앱의 <code class="language-text">/controllers</code> 폴더에다 바로 작성하면 됩니다. 그리고 모든 컨트롤러 액션에 공통적으로 사용하고자 하면 <code class="language-text">application.rb</code> 파일을 수정해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/authentication.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span>\n  <span class="token keyword">module</span> <span class="token constant">Authentication</span>\n    <span class="token keyword">module</span> <span class="token constant">Skip</span>\n      <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:authenticate!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      halt <span class="token number">401</span> <span class="token keyword">unless</span> authenticated<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> authenticated<span class="token operator">?</span>\n      <span class="token operator">!</span><span class="token operator">!</span>current_user\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> current_user\n      user_id <span class="token operator">=</span> validate_token <span class="token operator">?</span> validate_token<span class="token punctuation">[</span><span class="token string">\'user_id\'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">nil</span>\n      <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> validate_token\n      token_header <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">get_header</span><span class="token punctuation">(</span><span class="token string">\'HTTP_AUTHORIZATION\'</span><span class="token punctuation">)</span>\n      token <span class="token operator">=</span> token_header<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span><span class="token regex">/^Bearer\\s/</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span>\n\n      <span class="token keyword">begin</span>\n        <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n      <span class="token keyword">rescue</span>\n        <span class="token keyword">nil</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>몇 가지 이상한 녀석들이 나왔습니다. 일단 <code class="language-text">included</code> 메서드는 모듈이 특정 모듈이나 클래스에 <code class="language-text">include</code> 될 때 실행되는 훅(Hook)과 같은 메서드입니다. 인자 <code class="language-text">action</code> 은 이 모듈을 불러온 액션을 뜻합니다. 그리고 <code class="language-text">class_eval</code> 은 해당 클래스에 블락의 내용을 추가로 작성해주는 메서드라고 이해하시면 됩니다. 즉 이 모듈을 불러오는 클래스는 <code class="language-text">before :authenticate!</code> 라는 코드 라인이 추가되는겁니다. <code class="language-text">before</code> 는 레일즈의 <code class="language-text">before_action</code> 처럼 해당 액션을 실행하기 전에 먼저 실행되는 메서드를 정의합니다.</p>\n<p>마지막으로 <code class="language-text">request</code> 는 <code class="language-text">Rack::Request</code> 에 정의되어 있는 객체입니다 <a href="http://hanamirb.org/guides/actions/request-and-response/">가이드에 간단한 사용법이 있지만</a> 더 자세한 사용법을 보시려면 <a href="http://www.rubydoc.info/gems/rack/Rack/Request">직접 문서를 보셔야 합니다</a>.</p>\n<p>사용자는 발급받은 토큰을 매 HTTP 헤더에 실어서 보내야 합니다. 그 형식은 <code class="language-text">Authorization =&gt; Bearer {token}</code> 이 되도록 지정했습니다.</p>\n<p>이제 애플리케이션 설정 파일에서 이 모듈을 공통적으로 불러오게 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># ...</span>\nrequire_relative <span class="token string">\'./controllers/authentication\'</span>\n<span class="token comment"># ...</span>\n      controller<span class="token punctuation">.</span>prepare <span class="token keyword">do</span>\n        include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span> <span class="token comment"># included in all the actions</span>\n      <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>약 260번째 줄 부근에 해당 코드가 있습니다. 모든 컨트롤러 액션에 이 블록 안의 코드가 추가됩니다. 맨 윗줄에 <code class="language-text">require_relative</code> 로 파일을 불러오는 걸 잊어버리시면 안됩니다.</p>\n<p>그 다음 <code class="language-text">records#create</code> 액션의 코드를 수정해줍시다. 한 줄이면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token comment"># ...</span>\nuser <span class="token operator">=</span> current_user\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>테스트를 잘 작성해오셨다면 전혀 뜬금없이 회원 가입, 로그인 액션에서 오류가 납니다. 인증 토큰을 요구할 필요가 없는 액션에서도 토큰을 요구하고 있기 때문입니다. 하지만 위에 인증을 스킵할 수 있도록 오버라이드용 메서드를 정의해 두었으니 <code class="language-text">Api::Authentication::Skip</code> 모듈을 불러오기만 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Skip</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h3 id="나머지-액션들-작성"><a href="#%EB%82%98%EB%A8%B8%EC%A7%80-%EC%95%A1%EC%85%98%EB%93%A4-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나머지 액션들 작성</h3>\n<p>이제 레코드를 만들고, 인증하는 과정을 만들었으니 나머지 액션들은 비교적 간단합니다. 간단하게 작성한 코드를 참고해주세요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      status <span class="token number">200</span><span class="token punctuation">,</span> get_records<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span>\n\n    <span class="token keyword">def</span> get_records\n      records <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">by_user</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token operator">|</span>record<span class="token operator">|</span> record<span class="token punctuation">.</span>to_h <span class="token punctuation">}</span>\n\n      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>tap <span class="token keyword">do</span> <span class="token operator">|</span>hash<span class="token operator">|</span>\n        hash<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token symbol">:records</span><span class="token punctuation">,</span> records<span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">by_user</code> 메서드는 <code class="language-text">RecordRepository</code> 에 정의되어 있습니다. 사실 레일즈 사용자분들이라면 모델에 <code class="language-text">has_many</code> 같은 메서드를 사용하여 1:N 관계를 정의하는 경우가 보편적일텐데요. 하나미도 <a href="http://hanamirb.org/guides/models/associations/">최근에 그런 기능을 지원하기 시작헀지만</a> 아직 실험적인 기능이기 때문에 직접 구현했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/record_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">RecordRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">by_user</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n    records<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후의 결과물은 완성된 Hash나 Array가 아니라 <code class="language-text">Enumerator</code> 같은 객체라서 원하는 결과물을 반복 메서드를 사용하여 다양하게 다룰 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">require_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Update</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      <span class="token keyword">begin</span>\n        updated_record <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">,</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        status <span class="token number">200</span><span class="token punctuation">,</span> updated_record<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There was a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">SetRecord</code> 모듈도 <a href="http://hanamirb.org/guides/actions/share-code/">공식 가이드의 내용</a>을 참고하여 만들었습니다. Update와 Destroy 액션에서 공통적으로 레코드를 찾는 과정이 필요한데, 모듈에다 구현해두고 여러 액션에서 재활용할 수 있도록 만든겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/set_record.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">module</span> <span class="token constant">SetRecord</span>\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:set_record</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> set_record\n      <span class="token variable">@record</span> <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n      halt <span class="token number">404</span> <span class="token keyword">unless</span> <span class="token variable">@record</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/destroy.rb</span>\nrequire_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Destroy</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">begin</span>\n        repo<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n        status <span class="token number">204</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token string">\'Successfully Removed\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There is a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>축하합니다. 여러분은 하나미로 간단 API 서버를 가독성 높고 모듈화하기 용이한 루비 코드로 작성하였습니다.</p>\n<hr>\n<p>사실 더 개선할 부분들은 많습니다. 예를 들면 Interactor 를 활용한 로직 분리, 명확한 의존성 주입으로 테스트 효율 높이기 + 더 짜임새 있는 테스트 작성 등을 고려해야겠지요. 마침 <a href="https://github.com/nickgnd/hanami-jwt-example">비슷한 내용의 예제 코드가 아주아주 높은 퀄리티로 작성되어 있어서</a> 이번 튜토리얼을 구현해보면서 기본 개념을 익히신 다음에, 다른 예제를 참고하시면 큰 도움이 될 것이라 생각합니다.</p>\n<ul>\n<li>Source Code: <a href="https://github.com/emaren84/moneybook_api">Github</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-04-27-hanami-vuejs-moneybook-api-server/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-27",path:"/posts/hanami-vuejs-moneybook-api-server",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (API 서버 편)",tags:["Ruby","Hanami","Vue.js"],category:"Hanami"}},{excerpt:"기존에  Learn Vue.js 2  강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다. application.rb…",html:'<p>기존에 <a href="https://laracasts.com/series/learn-vue-2-step-by-step/">Learn Vue.js 2</a> 강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다.</p>\n<h2 id="applicationrb-설정하기"><a href="#applicationrb-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>application.rb 설정하기</h2>\n<p>프로젝트를 작성하고 레일즈로 작성해놓았던 코드도 옮기고 한 건 좋은데 제대로 돌아가는 게 하나도 없었다. 브라우저 콘솔에 나타난 에러를 가만히 들여다보니 Content Security Policy를 미리 설정해둘 필요가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># application.rb</span>\n<span class="token comment"># ...</span>\n      security<span class="token punctuation">.</span>content_security_policy <span class="token string">%{\n        form-action \'self\';\n        frame-ancestors \'self\';\n        base-uri \'self\';\n        default-src \'none\';\n        script-src \'self\' \'unsafe-inline\' \'unsafe-eval\' https:;\n        connect-src \'self\';\n        img-src \'self\' https: data:;\n        style-src \'self\' \'unsafe-inline\' https:;\n        font-src \'self\';\n        object-src \'none\';\n        plugin-types application/pdf;\n        child-src \'self\';\n        frame-src \'self\';\n        media-src \'self\'\n      }</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">script-src</code> 부분에 주목해야한다. <code class="language-text">unsafe-inline</code> 뿐 아니라 <code class="language-text">unsafe-eval</code> 도 추가해주어야 한다. 그리고 애셋을 하나미에서 컴파일하지 않도록 설정해주어야 한다. 그렇지 않으면 자동적으로 하나미가 컴파일되지 않은 파일을 <code class="language-text">public</code> 폴더로 옮겨버린다. 나중에 다시 설정하는 법을 찾을 수 있을지 모르겠지만 <code class="language-text">fingerprint</code> 도 사용하지 않도록 체크해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">    <span class="token comment">##</span>\n    <span class="token comment"># DEVELOPMENT</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:development</span> <span class="token keyword">do</span>\n      <span class="token comment"># Don\'t handle exceptions, render the stack trace</span>\n      handle_exceptions <span class="token keyword">false</span>\n\n      assets <span class="token keyword">do</span>\n        compile <span class="token keyword">false</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n\t<span class="token comment"># ...</span>\n\n    <span class="token comment">##</span>\n    <span class="token comment"># PRODUCTION</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:production</span> <span class="token keyword">do</span>\n      <span class="token comment"># scheme \'https\'</span>\n      <span class="token comment"># host   \'example.org\'</span>\n      <span class="token comment"># port   443</span>\n\n      assets <span class="token keyword">do</span>\n        <span class="token comment"># Don\'t compile static assets in production mode (eg. Sass, ES6)</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://www.rubydoc.info/gems/hanami-assets#Configuration</span>\n        compile <span class="token keyword">false</span>\n        \n        <span class="token comment"># Use fingerprint file name for asset paths</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://hanamirb.org/guides/assets/overview</span>\n        fingerprint <span class="token keyword">false</span>\n        \n        <span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h2 id="yarn-init"><a href="#yarn-init" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn init</h2>\n<p>현재로서 <code class="language-text">npm</code> 보다 <code class="language-text">yarn</code> 이 더 나아보이니까 한번 적용해보았다. 이번 프로젝트와 관련된 모듈들은 다음의 커맨드로 설치하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 필수 모듈\n$ yarn add axios vue\n\n# 개발용 모듈\n$ yarn add webpack babel-core babel-loader babel-preset-es2015 --dev</code></pre>\n      </div>\n<h2 id="webpack-설정-파일-생성"><a href="#webpack-%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack 설정 파일 생성</h2>\n<p>다음은 webpack을 설정하는 파일을 작성할 차례이다. 처음엔 아주 간단한 부분만 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascript/app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// 타겟 파일 지정</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  \tpath<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 번들된 파일 저장 위치, path 모듈을 불러와야한다.</span>\n  \tfilename<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// bundle.js를 많이 쓰는 경향이 있는데 이번엔 app.js로 지정</span>\n  \tpublicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 설정을 해 주고 <code class="language-text">app.js</code> 파일이 엔트리 포인트가 되도록 각 모듈 사이의 <code class="language-text">import</code> 나 <code class="language-text">export</code> 를 지정해준다.</p>\n<p>번들된 파일을 생성하기 위해선 다음 커맨드를 입력해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node_modules/.bin/webpack --hide-modules\n# 계속 변화를 감지하기 위한 커맨드는 다음과 같다.\n$ node_modules/.bin/webpack --hide-modules --watch</code></pre>\n      </div>\n<p>하지만 저 커맨드를 굳이 매번 입력해 줄 필요는 없다. <code class="language-text">package.json</code> 파일에 스크립트를 설정해줄 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// package.json\n<span class="token punctuation">{</span>\n  // ...\n  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules"</span><span class="token punctuation">,</span>\n    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules --watch"</span><span class="token punctuation">,</span>\n    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=production webpack --hide-modules"</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">NODE_ENV</code> 에 대해서는 나중에 살펴 볼 것이다.</p>\n<p>하나미의 <code class="language-text">application.html.erb</code> 파일에서는 <code class="language-text">javascript</code> 뷰 헬퍼로 자바스크립트 파일을 불러오는데, body  태그 마지막에 불러오도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p>대신 css 파일은 수동으로 옮겨주어야 할 것이다. <code class="language-text">scss</code> 같은 preprocessing이 필요한 파일들은 어떻게 처리하는지 아직 실험해보지 못했다. 어차피 전부 webpack으로 해결할 수 있다.</p>\n<p>하지만 막상 번들된 파일을 불러와도 크롬에서 에러를 뿜으면서 랜더링이 되지 않았다. 왜인지 살펴보니 뷰의 모든 구성요소를 컴포넌트로 만들지 않고(Runtime-only), 기존에 작성한 html에 속성을 적용하려면(Full version) <a href="https://kr.vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only">별도의 설정</a>을 해 주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'vue$\'</span><span class="token punctuation">:</span> <span class="token string">\'vue/dist/vue.esm.js\'</span> <span class="token comment">// \'vue/dist/vue.common.js\'  webpack 1용 입니다</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 생각하던대로 작동한다. 나중에 다른 프로젝트에서 Vue 컴포넌트로만 빌드를 하게 되면 이 설정은 입력할 필요가 없을 것이다.</p>\n<h2 id="환경-변수-관리"><a href="#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EA%B4%80%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>환경 변수 관리</h2>\n<p>윗부분에서 <code class="language-text">NODE_ENV</code> 와 관련된 스크립트를 언급했는데, 프로덕션 모드에서는 번들된 패키지를 더 압축해주고, 프로덕션 모드임을 지정해주는 설정이 가능하다. 별도로 패키지를 설정해 줄 필요는 없고, webpack 설정 파일 제일 아랫부분에 스크립트를 더 추가해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">\'production\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        warnings<span class="token punctuation">:</span> <span class="token boolean">false</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token string">\'process_env\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        NODE_ENV<span class="token punctuation">:</span> <span class="token string">\'"production"\'</span> <span class="token comment">// 오타가 아니고 따옴표 안에 겹따옴표 들어가는거 맞다</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="babel-적용하기"><a href="#babel-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>babel 적용하기</h2>\n<p>최신 버전 크롬은 ES6 문법 대부분을 지원하기 때문에 별 신경을 쓰지 않아도 되곘지만.. 그래도 바벨을 적용해두는게 좋을 것이다. </p>\n<p>위에서 필요한 모듈은 설치되어있으니 <code class="language-text">.babelrc</code> 파일부터 지정해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .babelrc\n<span class="token punctuation">{</span>\n  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">"modules"</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 바벨에서 제공하는 <a href="http://babeljs.io/docs/setup/#installation">공식 문서를 따라</a> webpack 설정 파일에 다음 코드를 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n      \ttest<span class="token punctuation">:</span> <span class="token regex">/\\.js$/</span><span class="token punctuation">,</span>\n      \texclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>\n      \tloader<span class="token punctuation">:</span> <span class="token string">"babel-loader"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제부터 webpack을 실행하면 바벨로 변환된 결과물이 나온다.</p>\n<h2 id="라이브러리-나누어서-적용하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EB%82%98%EB%88%84%EC%96%B4%EC%84%9C-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리 나누어서 적용하기</h2>\n<p>만약에 내가 자바스크립트 파일을 작성하다가 아주 일부분만 수정하고 다시 빌드를 해야하는 일이 있다고 할 때 계속 시간을 잡아먹는게 상당히 짜증날 것이다. 일단 기본적인 라이브러리는 내용이 변할 일이 없기 때문에 별도로 합쳐지도록 적용하고, 내가 실제로 작성하는 파일만 변화가 있을 때 다시 번들되도록 만들면 많은 시간을 단축할 수 있을 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascripts/app.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'vue\'</span><span class="token punctuation">,</span> <span class="token string">\'axios\'</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].js\'</span><span class="token punctuation">,</span> <span class="token comment">// entry에 지정된 name(app, vendor)로 번들된 파일이 생성된다.</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunckPlugin</span><span class="token punctuation">(</span>\n      <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'vendor\'</span> <span class="token punctuation">}</span> <span class="token comment">// vendor 파일 덩어리를 따로 보관하고 캐싱한다.</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이러고 나서 빌드를 마치고 나면 <code class="language-text">public/assets</code> 폴더에는 <code class="language-text">app.js</code>, <code class="language-text">vendor.js</code> 두 개의 파일이 생성된다. 당연하게 레이아웃 페이지에서 <code class="language-text">vendor.js</code> 파일도 로딩해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'vendor\', \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<h2 id="css-파일도-관리하자"><a href="#css-%ED%8C%8C%EC%9D%BC%EB%8F%84-%EA%B4%80%EB%A6%AC%ED%95%98%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 파일도 관리하자</h2>\n<p>이래저래 잘 작동하길래 슬슬 코드를 올려볼까 했더니 CSS 파일이 문제가 되었다. 물론 CSS 파일의 내용은 몇 줄 없지만, 매번 내용을 수정한 다음에 일일이 파일을 <code class="language-text">public</code> 폴더로 옮기는건 아주 비효율적이다. 당연히 webpack이 CSS 파일도 모아줄 수 있다.</p>\n<p>먼저 필요한 모듈을 설치한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ yarn add css-loader extract-text-webpack-plugin --dev</code></pre>\n      </div>\n<p>그리고 설정파일에 CSS 관련 모듈 규칙과 플러그인을 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'extract-text-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// ...</span>\n      <span class="token punctuation">{</span>\n        test<span class="token punctuation">:</span> <span class="token regex">/\\.css$/</span><span class="token punctuation">,</span>\n        loader<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          use<span class="token punctuation">:</span> <span class="token string">\'css-loader\'</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">\'styles.css\'</span><span class="token punctuation">)</span> <span class="token comment">// 원하는 이름으로 지정</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이후 webpack을 실행하면 <code class="language-text">public/assets</code> 폴더에 <code class="language-text">styles.css</code> 파일이 추가된다. 나머지는 레이아웃 파일에서 이 파일을 불러오도록 만들면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    &lt;%= stylesheet \'https://cdnjs.cloudflare.com/ajax/libs/bulma/0.3.1/css/bulma.min.css\' %>\n    &lt;%= stylesheet \'styles\' %>\n    <span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 내용을 기반으로 작성한 간단한 프로젝트는 <a href="https://github.com/emaren84/hanami-webpack-config-example">Github</a>에 업로드 되어있다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-04-09-hanami-webpack-config/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-09",path:"/posts/hanami-webpack-config",title:"하나미 프로젝트에서 webpack 설정하기",tags:["Ruby","Hanami","Javascript","Webpack"],category:"Webpack"}},{excerpt:"본 포스트는  Aaron Patterson 의  포스트 의 번역본입니다. 기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다. 피드백은 언제나 환영합니다. 저는 콘솔 디버거입니다  (역주1: 원 제목의 'puts debuggerer'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging…",html:'<ul>\n<li>본 포스트는 <a href="https://twitter.com/tenderlove">Aaron Patterson</a>의 <a href="https://tenderlovemaking.com/2016/02/05/i-am-a-puts-debuggerer.html">포스트</a>의 번역본입니다.</li>\n<li>기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다.</li>\n<li>피드백은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>저는 콘솔 디버거입니다 <em>(역주1: 원 제목의 \'puts debuggerer\'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging은 모두 콘솔 디버깅으로 번역하겠습니다)</em>. 진짜 디버거( <code class="language-text">pry</code> , <code class="language-text">byebug</code> 등)를 사용하는 사람들을 폄하하고자 이 이야기를 하는게 아닙니다. 진짜 디버거는 아주 좋다고 생각하지만, 저는 하나라도 제대로 배울 시간을 들이지 못했습니다. 매번 한 개라도 써보려고 하다가 결국엔 한동안 사용하지 않고, 다시 사용방법을 배워야만 합니다. 어쨌든, 이번 기회에 여러분에게 콘솔 디버깅을 할 때 사용하는 트릭을 좀 알려드리고자 합니다. 저는 이 트릭들을 무언가가 어떻게 작동하는지 이해가 되지 않을때나 작동 원리를 더 알고싶을 때 사용합니다. 아래에 이야기하게 될 대부분의 것들은 <em>절대로</em> 최선의 방법(best practice)가 아니며 여러분들은 디버깅 세션이 끝나면 절대 이 코드들을 남겨두어선 안됩니다. 그러나 여러분이 <strong>무엇을 디버깅하던지</strong> 아주 유용하다고 생각합니다. 정말로 뭐든지요. 전역 변수, 메서드 재정의, 조건문 추가, 불러오기 경로 수정, 몽키 패칭, 콜 스택 출력 등 <strong>뭐든지요</strong>.</p>\n<p>저는 이 포스트에서 최대한 실제 접하는 예시들을 보여드리고 싶었습니다. 하지만 대부분의 예시들은 제가 레일즈의 보안 이슈를 디버깅하려고 할 때 나온 것들이라서, 이 코드의 테크닉은 재활용하셔도 좋지만 <strong>코드 전체를 그대로 쓰시면 안됩니다.</strong> 제가 디버깅하려는 코드들은 정상적으로 동작하지 않습니다. 거기다 이 코드를 사용하시는걸 원치도 않습니다.</p>\n<p>매 섹션에 제가 겪었던 문제들을 제목으로 적어두었으며, 내용 부분에 제가 사용한 해결책을 적어두었습니다.</p>\n<h2 id="어디에-문제가-있는진-알겠는데-어떻게-거기까지-가야할지-모르겠다"><a href="#%EC%96%B4%EB%94%94%EC%97%90-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%9E%88%EB%8A%94%EC%A7%84-%EC%95%8C%EA%B2%A0%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B1%B0%EA%B8%B0%EA%B9%8C%EC%A7%80-%EA%B0%80%EC%95%BC%ED%95%A0%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다</h2>\n<p>가끔 저는 문제가 어딨는지는 알지만 어떻게 그 부분까지 가는지 모르는 이슈들을 디버깅할 때가 있습니다. 이럴 때마다 저는 <code class="language-text">puts caller</code> 를 넣어서 콜 스택을 끄집어냅니다.</p>\n<p>예를 들어 제가 이런 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span> h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>여기서 저는 기본 블록이 어떻게 호출되는지 알고 싶을 때 이렇게 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 90개의 해시 태그를 출력하고 콜 스택을 출력한 뒤에, 나머지 90개의 해시 태그를 출력할 겁니다. 해시 태그는 여러번 호출될 때를 대비해서 콜 스택을 쉽게 구분하기 위해 넣어두었습니다. 참고로 이걸 "해시 태그"라고 부르는건 여러분을 골려주려고 그러는 겁니다.</p>\n<p>저는 이 방법을 꽤 자주 사용하기 때문에 Vim 단축키를 지정해두었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">&quot; puts the caller\nnnoremap &lt;leader&gt;wtf oputs &quot;#&quot; * 90&lt;c-m&gt;puts caller&lt;c-m&gt;puts &quot;#&quot; * 90&lt;esc&gt;</code></pre>\n      </div>\n<p>이렇게 하면 <code class="language-text">&lt;leader&gt;wtf</code> 키 조합으로 커서가 있는 위치 바로 밑에 디버깅 코드를 삽입합니다.</p>\n<h3 id="콜-스택을-한-번만-출력하고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%95%9C-%EB%B2%88%EB%A7%8C-%EC%B6%9C%EB%A0%A5%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 한 번만 출력하고 싶어</h3>\n<p>그냥 콜 스택을 출력한 뒤에 <code class="language-text">exit!</code> 를 사용하거나, <code class="language-text">raise</code> 를 호출하세요. <code class="language-text">raise</code> 는 예외를 출력할거고, 어쨌든 콜 스택을 볼 수 있을겁니다.</p>\n<h3 id="콜-스택을-특정-경우에만-보고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%8A%B9%EC%A0%95-%EA%B2%BD%EC%9A%B0%EC%97%90%EB%A7%8C-%EB%B3%B4%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 특정 경우에만 보고 싶어</h3>\n<p>이건 그냥 디버깅 코드니까 여러분이 하고싶은대로 하시면 됩니다. 예를 들어 제가 해시에 무언가를 추가할 때마다 콜 스택을 호출하고 싶다고 한다면, 이렇게 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>어차피 전 이 코드를 없애버릴거니까 어떤 이상한 조건문도 마음대로 추가할 수 있지요!</p>\n<h2 id="메서드를-호출했는데-이게-어디에-있는건지-모르겠다"><a href="#%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메서드를 호출했는데, 이게 어디에 있는건지 모르겠다</h2>\n<p>메서드를 호출했는데 그 메서드가 어디에 구현되어있는지 모를 때, 저는 <code class="language-text">source_location</code> 메서드와 함께 <code class="language-text">method</code> 메서드를 사용합니다. 예를 들어 (레일즈) 컨트롤러 안에 있는 액션이 <code class="language-text">render</code> 메서드를 호출하고 있을 때, 저는 그 메서드를 어디서 호출하는지 알고 싶었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿔보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>호출해보도록 하지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl http://localhost:3000/users/xxxx</code></pre>\n      </div>\n<p>그러면 로그에는 이렇게 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/instrumentation.rb&quot;, 40]\nCompleted 500 Internal Server Error in 35ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제 저는 <code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L40">instrumentation.rb 파일의 40번째 줄</a>에 있다는 것을 알게 되었습니다.</p>\n<h2 id="code-classlanguage-textsupercode-메서드를-호출했는데-그게-어디에-있는건지-모르겠다"><a href="#code-classlanguage-textsupercode-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EA%B7%B8%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">super</code> 메서드를 호출했는데 그게 어디에 있는건지 모르겠다</h2>\n<p><code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L43">super를 호출한다는 걸</a> 알게 되었습니다만, 저는 그게 어디에 구현되어있는지 모릅니다. 이 경우에 <code class="language-text">method</code> 의 리턴 값에 <code class="language-text">super_method</code> 를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿉니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>super_method<span class="token punctuation">.</span>source_location\n  redner params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>같은 요청을 해 보면 이런 결과를 얻을 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/rendering.rb&quot;, 34]\nCompleted 500 Internal Server Error in 34ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제야 <code class="language-text">super</code> 가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/rendering.rb#L34">여기로 가는 게</a> 보입니다. 이 메서드는 마찬가지로 <code class="language-text">super</code> 를 호출하지만, 그냥 위의 작업을 반복하여(아니면 그냥 loop를 쓰면 됩니다!) 제가 진짜 알아보고자 하는 메서드를 찾을 수 있습니다.</p>\n<h2 id="code-classlanguage-textmethodcode-메서드의-구현체를-찾고자-한다면"><a href="#code-classlanguage-textmethodcode-%EB%A9%94%EC%84%9C%EB%93%9C%EC%9D%98-%EA%B5%AC%ED%98%84%EC%B2%B4%EB%A5%BC-%EC%B0%BE%EA%B3%A0%EC%9E%90-%ED%95%9C%EB%8B%A4%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">method</code> 메서드의 구현체를 찾고자 한다면?</h2>\n<p>때때로 <code class="language-text">method</code> 를 이용한 트릭이 작동하지 않을 때가 있습니다. 제가 알아보려는 객체가 자신만의 <code class="language-text">method</code> 메서드를 구현하고 있기 때문입니다. 예를 들어 저는 <code class="language-text">request</code> 객체에 <code class="language-text">headers</code> 메서드가 구현된 위치를 찾고자 할 때 이런 코드를 사용했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p request<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>제가 요청을 보내면 이런 에러가 뜹니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">ArgumentError (wrong number of arguments (given 1, expected 0)):\n  app/controllers/users_controller.rb:5:in `index&#39;</code></pre>\n      </div>\n<p>이 경우는 <code class="language-text">request</code> 객체가 자신만의 <code class="language-text">method</code> 를 따로 구현하고 있기 때문입니다. <code class="language-text">headers</code>  메서드를 찾아내기 위해 메서드를 <code class="language-text">Kernel</code> 로부터 분리하고 <code class="language-text">request</code> 객체에 다시 바인드 한 뒤 실행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>요청을 다시 해보면 결과가 다르게 나옵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#index as */*\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_dispatch/http/request.rb&quot;, 201]</code></pre>\n      </div>\n<p>이제서야 <code class="language-text">headers</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_dispatch/http/request.rb#L201">여기에</a> 구현되어 있다는 것을 발견했습니다.</p>\n<p>심지어 <code class="language-text">method</code> 메서드의 구현체를 찾을 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="또-뭔가-호출했는데-이게-어딨는지-모르겠다"><a href="#%EB%98%90-%EB%AD%94%EA%B0%80-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%A8%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>(또) 뭔가 호출했는데 이게 어딨는지 모르겠다</h2>\n<p>가끔 당장 사용하고 있는 메서드가 실제로는 문제의 본질이 아닐 수 있습니다. 그래서 <code class="language-text">method</code> 메서드를 사용하는 트릭은 별 도움이 안될 겁니다. 이럴 때엔 저는 <code class="language-text">TracePoint</code> 라고 하는 더 큰 추적기(a larger hammer)를 사용합니다. <code class="language-text">render</code> 메서드로부터 호출 된 <em>모든</em> 메서드의 리스트를 추출하기 위해 다시 한번 예를 들어보겠습니다. 리스트에 보이는 메서드들은 <code class="language-text">render</code> 메서드가 직접 호출한 것은 아니지만 어딘가로부터 호출 된 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># GET /users</span>\n<span class="token comment"># GET /users.json</span>\n<span class="token keyword">def</span> index\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n  tp <span class="token operator">=</span> <span class="token constant">TracePoint</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:call</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>x<span class="token operator">|</span>\n    p x\n  <span class="token keyword">end</span>\n  tp<span class="token punctuation">.</span>enable\n  render <span class="token string">\'index\'</span>\n<span class="token keyword">ensure</span>\n  tp<span class="token punctuation">.</span>disable\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>저기 위치한 <code class="language-text">TracePoint</code> 는 모든 "호출(<code class="language-text">:call</code>)" 이벤트마다 작동하고, 블록은 메서드 이름과 호출된 위치를 출력할 것입니다. 여기서 "호출" 이라 함은 루비 메서드가 호출되는 경우를 말합니다(C 메서드는 제외). 만약 C 메서드가 호출되는 것을 보고 싶으시다면 <code class="language-text">:c_call</code> 을 사용하세요. 이 예시는 <em>엄청난 양의</em> 결과가 출력될겁니다. 저는 호출될 메서드가 꽤 적거나, 도대체 어디부터 찾아봐야 할지 모를 때 이 방법을 사용합니다.</p>\n<h2 id="예외가-일어나는-것은-알겠지만-어디서-발생하는지-모르겠다"><a href="#%EC%98%88%EC%99%B8%EA%B0%80-%EC%9D%BC%EC%96%B4%EB%82%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%95%8C%EA%B2%A0%EC%A7%80%EB%A7%8C-%EC%96%B4%EB%94%94%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>예외가 일어나는 것은 알겠지만, 어디서 발생하는지 모르겠다</h2>\n<p>예외가 발생할 때 <em>실제로</em> 어디서 예외가 발생했는지 모를 때가 있습니다. 이 예시는 레일즈 3.0.0을 기준으로 작성되었지만(참고로 이 문제는 수정되었습니다), 일단 이런 코드가 있다고 해보죠.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> <span class="token constant">Logger</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token variable">$stdout</span>\n<span class="token constant">User</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>execute <span class="token string">"oh no!"</span>\n</code></pre>\n      </div>\n<p>SQL은 작동하지 않을 테고, 예외가 일어날 겁니다. 그렇다면 예외가 어떻게 발생하는지 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>여러분이 추적 내역(backtrace) 을 읽어보셨다면 <em>(역주2: backtrace하면 역추적 이라는 말이 직역하기는 좋지만, 보통 루비에서 backtrace를 떠올릴 때 콘솔에 뜨는 십수 줄의 추적 내역이 연상될 때가 많아서 추적 내역으로 번역하였습니다)</em>, 예외가 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L202">abstract_adapter.rb의 202번째 줄</a>에서 발생했다는 것을 알 수 있습니다. 그러나 이 코드는 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L199-L202">예외가 발생한 상황에서 다시 예외를 일으키도록</a> 되어있는게 보일 겁니다. 그렇다면 실제로는 어디서 예외가 일어난 걸까요? 정답을 찾기 위해 <code class="language-text">puts</code> 를 사용하거나 루비의 <code class="language-text">-d</code> 플래그를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ bundle exec ruby -d script/rails runner test.rb</code></pre>\n      </div>\n<p><code class="language-text">-d</code> 플래그는 경고를 활성화하고 모든 예외 발생을 출력합니다. 네, 실제로는 엄청나게 많은 양의 결과물이 출력되겠지요. 그러나 끝부분을 살펴보시면 이렇게 되어있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `NameError&#39; at activesupport-3.0.0/lib/active_support/core_ext/module/remove_method.rb:3 - method `_validators&#39; not defined in Class\nException `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error\nException `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error\n  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at railties-3.0.0/lib/rails/commands/runner.rb:48 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>실제 예외는 여기서 발생했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>그리고 여기서 다시 예외가 일어났지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>예외가 발생할 때 래핑된 뒤 다시 예외가 발생하는 경우에는 <em>반드시</em> 본래의 추적 내역을 노출해야 합니다. 그러므로 이 경우는 명백히 버그지만, 실제로 버그는 고쳐졌으며, 우리는 언젠가 또 이런 경우가 발생했을 때 해결하는 법을 알게 되었습니다.</p>\n<h3 id="커맨드-라인-도구를-code-classlanguage-text-dcode-플래그와-함께-사용하여-실행"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C-%EB%9D%BC%EC%9D%B8-%EB%8F%84%EA%B5%AC%EB%A5%BC-code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%8B%A4%ED%96%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드 라인 도구를 <code class="language-text">-d</code> 플래그와 함께 사용하여 실행</h3>\n<p>위의 기술을 RSpec 테스트에 적용하고 싶으시다면 이렇게 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -d -S rspec</code></pre>\n      </div>\n<h3 id="code-classlanguage-text-dcode-플래그는-사용하고-싶은데-프로세스를-실행하는-방법을-모르겠다"><a href="#code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EB%8A%94-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80%EB%8D%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%9D%84-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">-d</code> 플래그는 사용하고 싶은데 프로세스를 실행하는 방법을 모르겠다</h3>\n<p>Rake 테스트 작업은 기본적으로 <a href="https://github.com/ruby/rake/blob/3c4fe3e25e5ab6b052f9e81bc2920ca4b4fc1094/lib/rake/testtask.rb#L105">서브 프로세스 안에서 당신의 테스트를 실행합니다</a>. 말인 즉슨 <code class="language-text">ruby -d -S rake</code> 같은 커맨드를 입력해도 서브 프로세스 안에 있는 여러분의 테스트에는 플래그가 적용되지 않는다는 뜻입니다. 이 경우 저는 <code class="language-text">RUBYOPT</code> 환경 변수를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ RUBYOPT=-d bundle exec rake test</code></pre>\n      </div>\n<p><code class="language-text">RUBYOPT</code> 환경 변수는 쉘에서 실행된 모든 루비 프로그램에 적용되고, 심지어 rake로부터 호출 된 서브 쉘에도 적용됩니다. 이를 응용하면 <code class="language-text">rspec</code> 커맨드를 이렇게 다시 써볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=-d rspec</code></pre>\n      </div>\n<h2 id="이-객체는-어디에서-온-걸까"><a href="#%EC%9D%B4-%EA%B0%9D%EC%B2%B4%EB%8A%94-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%98%A8-%EA%B1%B8%EA%B9%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이 객체는 어디에서 온 걸까?</h2>\n<p>보통은 콜 스택을 출력하여 객체가 어디에서 왔는지 찾습니다. 하지만 가끔 객체가 콜 스택 바깥에 위치한 경우도 있습니다. 이럴 때는 객체가 어디에서 호출된 건지 찾기 힘듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  p x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>이전에 "어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다" 파트에서 <code class="language-text">caller</code> 를 사용하는 방법, "wtf  트릭" <em>(역주3: 글쓴이는 해당 방법을 소개할 때 Vim 단축키를 <code class="language-text">&lt;leader&gt;wtf</code> 으로 설정하였습니다. 그래서 이를 "wtf trick"으로 명명한 것으로 보입니다)</em>을 보여드렸습니다.  여기서 저는 <code class="language-text">x</code> 라는 값이 어떻게 할당되었는지 신경쓰였는데요, <code class="language-text">foo</code> 메서드를 따라가다보면 <code class="language-text">baz</code> 메서드에서 값을 가져오는 것을 볼 수 있습니다. 거대한 코드 베이스에서는 형제 트리에서 모든 호출과 로직을 따라가는게 아주 어렵습니다(코드를 자료구조의 그래프라고 생각한다면, <code class="language-text">foo</code> 메서드는 두 개의 자손이 있는 겁니다. <code class="language-text">baz</code> 와 <code class="language-text">bar</code> 이죠. 그래서 <code class="language-text">baz</code>가 <code class="language-text">bar</code> 의 형제라고 여길 수 있습니다). 저는 게으르기 때문에 객체가 어디서 왔는지 찾기 위해 모든 메서드를 뒤지고 싶지 않았습니다. 그래서 저는 루비의 객체 할당 추적기(object allocation tracer)를 사용하는걸 좋아합니다. 루비의 할당 추적기는 루비 2.1버전부터 사용할 수 있습니다(확실한 것은 아닙니다). 제가 이 방법을 사용할 때는 가능한 빨리 <code class="language-text">require</code> 한 뒤에 활성화합니다. 그러면 제가 찾고자 하는 할당 위치를 찾을 수 있지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n\n<span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  p <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>프로그램을 실행하면 이런 결과를 얻습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby x.rb\n{&quot;x.rb&quot;=&gt;14}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p><code class="language-text">x</code> 객체가 해당 파일의 14번째 줄에 있다는 것을 알게 되었습니다. 그러면 해당 라인으로 가서 "wtf 트릭" 을 반복하거나 프로그램에 무슨 문제가 있는지 발견할 때 까지 이 방법을 반복합니다.</p>\n<p>저는 보통 객체 추적을 가능한 빠르게 시작합니다. 제 객체가 어디에 할당되었는지 모르니까요. 이런 추적은 프로그램의 속도를 떨어뜨리지만, 디버깅 중에는 신경쓸 필요가 없습니다.</p>\n<h2 id="나는-code-classlanguage-textrequirecode-를-진짜-진짜-빨리-하고-싶어"><a href="#%EB%82%98%EB%8A%94-code-classlanguage-textrequirecode-%EB%A5%BC-%EC%A7%84%EC%A7%9C-%EC%A7%84%EC%A7%9C-%EB%B9%A8%EB%A6%AC-%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나는 <code class="language-text">require</code> 를 진짜 진짜 빨리 하고 싶어</h2>\n<p>바로 위에 보여드린 기술은 오로지 객체가 <code class="language-text">trace_object_allocations_start</code> 메서드가 호출되고 난 뒤에 할당된 이후의 정보만 제공합니다. 파일이 <code class="language-text">require</code> 되는 순간에 객체가 할당되어서, 도대체 무슨 파일이고 <em>어디에 있는지</em> 모를 때가 있습니다. 그래서  프레임워크 안에 있는 어떤 파일이라도 로드되기 전에 코드를 좀 실행시킬 필요가 있습니다. 이럴 때 저는 <code class="language-text">-r</code> 플래그를 사용한 뒤 스크립트를 작성합니다.</p>\n<p>우리가 <code class="language-text">User::BLACKLISTED_CLASS_METHODS</code> 의 할당 위치를 찾는 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'active_record\'</span>\n\n<span class="token constant">AciveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>establish_connection adapter<span class="token punctuation">:</span> <span class="token string">\'sqlite3\'</span><span class="token punctuation">,</span> databse<span class="token punctuation">:</span> <span class="token string">\':memory:\'</span>\n\n<span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>instance_eval <span class="token keyword">do</span>\n  create_table <span class="token symbol">:users</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">;</span> <span class="token keyword">end</span>\np <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>그런데 우리는 이 어떤 파일이 이 상수를 할당했는지 모르고, 찾는 방법을 떠올리고 싶지도 않을 때가 있습니다(네, 이건 좀 억지로 꾸며낸 경우입니다). 이럴 때 <code class="language-text">y.rb</code> 라는 파일을 작성해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n</code></pre>\n      </div>\n<p>그리고 저는 루비의 커맨드 라인 인자를 넣어서 이 파일을 실행할 때 바로 <code class="language-text">require</code> 하도록 만들었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby -I. -ry x.rb\n{&quot;/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/activerecord-5.0.0.beta1/lib/active_record/attribute_methods.rb&quot;=&gt;35}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p>인자들을 찬찬히 살펴보면 <code class="language-text">-I.</code> 는 ". 를 불러오기 경로로 추가하고", <code class="language-text">-ry</code> 는 <code class="language-text">require &#39;y&#39;</code> 와 같으며, 이후에 <code class="language-text">x.rb</code> 를 실행하는 겁니다. 그러니 <code class="language-text">.</code> 가 불러오기 경로로 추가되었고, <code class="language-text">x.rb</code> 가 실행되기도 전에 <code class="language-text">y.rb</code> 파일이 <code class="language-text">require</code> 되었습니다. 그 결과로 <code class="language-text">BLACKLISTED_CLASS_METHODS</code> 가 <code class="language-text">attribute_methods.rb</code> 의 35번째 줄에 에 할당되어 있다는 사실을 알 수 있습니다. 만약 서브 프로세스 안에서 실행되는 코드에 이 기술을 적용하고자 한다면 <code class="language-text">RUBYOPT</code> 를 함께 쓰면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=&#39;-I. -ry&#39; rake test</code></pre>\n      </div>\n<h2 id="객체가-어딘가에서-수정되었는데mutated-그-위치를-모르겠다"><a href="#%EA%B0%9D%EC%B2%B4%EA%B0%80-%EC%96%B4%EB%94%98%EA%B0%80%EC%97%90%EC%84%9C-%EC%88%98%EC%A0%95%EB%90%98%EC%97%88%EB%8A%94%EB%8D%B0mutated-%EA%B7%B8-%EC%9C%84%EC%B9%98%EB%A5%BC-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체가 어딘가에서 수정되었는데(mutated), 그 위치를 모르겠다</h2>\n<p>객체를 살펴보다 보면 이게 수정되고 있다는건 알겠는데, 어디서 수정되고 있는 지 모를 때가 있습니다. 이 때는 객체에 <code class="language-text">freeze</code> 를 호출한 뒤에, 테스트를 실행해보고, 어디서 예외가 발생하는지 살펴보면 됩니다. 그 예로, 제가 <a href="https://github.com/rails/rails/blob/38b5af6595338cb2212980062d9aaf51241878cc/activesupport/lib/active_support/concurrency/share_lock.rb#L28">어디에서 특정 변수가 수정되는지 알고 싶을 때</a>가 있습니다. 코드를 살펴보니 이 변수가 수정된다는 것은 알고 있었지만, 어디서부터 수정이 일어나는지 알지 못했습니다. 그래서 코드를 이렇게 수정해봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> initialize\n  <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n  <span class="token variable">@cv</span> <span class="token operator">=</span> new_cond\n\n  <span class="token variable">@sharing</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n  <span class="token variable">@sharing</span><span class="token punctuation">.</span>freeze\n  <span class="token variable">@waiting</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n  <span class="token variable">@exclusive_thread</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n  <span class="token variable">@exclusive_depth</span> <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 나서 레일즈 서버를 실행하면 예외가 발생하며 추적 내역이 보여집니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">active_support/concurrency/share_lock.rb:151:in `delete&#39;: can&#39;t modify frozen Hash (RuntimeError)\n\tfrom active_support/concurrency/share_lock.rb:151:in `yield_shares&#39;\n\tfrom active_support/concurrency/share_lock.rb:79:in `block in stop_exclusive&#39;</code></pre>\n      </div>\n<p>이제 처음에 수정이 발생한 곳을 발견했습니다. 만약 이 부분이 여러분이 찾고자 하는 부분이 아니라면 작성해둔 <code class="language-text">freeze</code> 를 삭제한 뒤에 내역을 따라가서 수정된 부분 이후에 다시 덧붙이면 됩니다.</p>\n<h2 id="교착-상태deadlock에-빠졌는데-어디서-문제가-생겼는지-모르겠다"><a href="#%EA%B5%90%EC%B0%A9-%EC%83%81%ED%83%9Cdeadlock%EC%97%90-%EB%B9%A0%EC%A1%8C%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%94%94%EC%84%9C-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%83%9D%EA%B2%BC%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>교착 상태(deadlock)에 빠졌는데, 어디서 문제가 생겼는지 모르겠다</h2>\n<p>저에게 스레드와 관련된 이슈가 발생했고, 문제를 어디에서 해결해야할 지 몰랐을 때, 저는 살아있는 스레드를 검사해보기 위해 코드를 좀 추가했습니다. 예를 들어 저는 <a href="https://github.com/rails/rails/issues/23503">이 이슈를 디버깅하고 있었습니다</a>. 애플리케이션 서버가 막혀있는데, 대체 어디서 문제가 발생했는지 몰랐습니다. 그래서 어디서 스레드가 막혀있는지 찾기 위해 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token builtin">Thread</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    p t\n    puts t<span class="token punctuation">.</span>backtrace\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 이렇게 실행했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -I. -rx bin/rails s</code></pre>\n      </div>\n<p>이제 앱 서버가 막혔을 때, 컨트롤+T 키를 누르면(죄송하지만 OS X에서만 작동합니다, 리눅스에서는 <code class="language-text">kill</code> 을 사용해야 합니다), 모든 스레드의 추적 내역을 볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">##########################################################################################\n#&lt;Thread:0x007f90bc07cb38 run&gt;\nomglolwut/x.rb:7:in `backtrace&#39;\nomglolwut/x.rb:7:in `block (2 levels) in &lt;top (required)&gt;&#39;\nomglolwut/x.rb:4:in `each&#39;\nomglolwut/x.rb:4:in `block in &lt;top (required)&gt;&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `join&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `run&#39;\ngems/rack-2.0.0.alpha/lib/rack/server.rb:296:in `start&#39;\nrails/commands/server.rb:78:in `start&#39;\nrails/commands/commands_tasks.rb:90:in `block in server&#39;\nrails/commands/commands_tasks.rb:85:in `tap&#39;\nrails/commands/commands_tasks.rb:85:in `server&#39;\nrails/commands/commands_tasks.rb:49:in `run_command!&#39;\nrails/command.rb:20:in `run&#39;\nrails/commands.rb:19:in `&lt;top (required)&gt;&#39;\nbin/rails:4:in `require&#39;\nbin/rails:4:in `&lt;main&gt;&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b668@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/reactor.rb:136 sleep&gt;\nlib/puma/reactor.rb:29:in `select&#39;\nlib/puma/reactor.rb:29:in `run_internal&#39;\nlib/puma/reactor.rb:138:in `block in run_in_thread&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b500@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:216 sleep&gt;\nlib/puma/thread_pool.rb:219:in `sleep&#39;\nlib/puma/thread_pool.rb:219:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b3c0@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:187 sleep&gt;\nlib/puma/thread_pool.rb:190:in `sleep&#39;\nlib/puma/thread_pool.rb:190:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b258@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/server.rb:296 sleep&gt;\nlib/puma/server.rb:322:in `select&#39;\nlib/puma/server.rb:322:in `handle_servers&#39;\nlib/puma/server.rb:296:in `block in run&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90c1ef9a08@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:61 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:132:in `wait_until&#39;\naction_dispatch/http/response.rb:170:in `block in await_commit&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\naction_dispatch/http/response.rb:169:in `await_commit&#39;\naction_controller/metal/live.rb:270:in `process&#39;\naction_controller/metal.rb:193:in `dispatch&#39;\naction_controller/metal.rb:265:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:50:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:32:in `serve&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bd1d5f38@/Users/aaron/git/rails/actionpack/lib/action_controller/metal/live.rb:279 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:123:in `wait_while&#39;\nactive_support/concurrency/share_lock.rb:57:in `block (2 levels) in start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:154:in `yield_shares&#39;\nactive_support/concurrency/share_lock.rb:56:in `block in start_exclusive&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\nactive_support/concurrency/share_lock.rb:51:in `start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:113:in `exclusive&#39;\nactive_support/dependencies/interlock.rb:12:in `loading&#39;\nactive_support/dependencies.rb:37:in `load_interlock&#39;\nactive_support/dependencies.rb:369:in `require_or_load&#39;\nactive_support/dependencies.rb:529:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\nactive_support/dependencies.rb:561:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\napp/controllers/users_controller.rb:9:in `index&#39;\n##########################################################################################</code></pre>\n      </div>\n<p>가독성을 위해 결과물을 조금 잘라냈습니다만, 여러분은 이제 각각의 스레드가 무엇을 하는지 볼 수 있습니다. 그리고 어느 스레드 두 개가 교착 상태에 빠졌는지 쉽게 발견할 수 있습니다(정답은 마지막 두 개입니다).</p>\n<h2 id="특정한-시간에만-언제-메서드가-실행되는지-알고-싶다"><a href="#%ED%8A%B9%EC%A0%95%ED%95%9C-%EC%8B%9C%EA%B0%84%EC%97%90%EB%A7%8C-%EC%96%B8%EC%A0%9C-%EB%A9%94%EC%84%9C%EB%93%9C%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94%EC%A7%80-%EC%95%8C%EA%B3%A0-%EC%8B%B6%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정한 시간에만 언제 메서드가 실행되는지 알고 싶다</h2>\n<p>일정 시간 뒤에 메서드가 언제 실행되었는지 알고 싶을 때가 있습니다. 저는 애플리케이션이 <em>구동된 뒤에</em>  <code class="language-text">start_exclusive</code> 메서드가 언제 호출되는지 알고 싶었습니다. 이럴 때 위에 보여드린 <code class="language-text">trap</code> 트릭과 전역 변수를 조합하여 해결했습니다.</p>\n<p>먼저 <code class="language-text">start_exclusive</code> 를 이렇게 수정했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">start_exclusive</span><span class="token punctuation">(</span>purpose<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> compatible<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> no_wait<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token variable">$foo</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n  <span class="token comment"># ..</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  puts <span class="token string">"turning on debugging!"</span>\n  <span class="token variable">$foo</span> <span class="token operator">=</span> <span class="token keyword">true</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 구동하고 모든 요소가 준비되면 컨트롤+T를 눌러서 제 전역 변수를 <code class="language-text">true</code> 로 바꿉니다. 그리고 로그 메세지들을 살펴볼 수 있게 됩니다.</p>\n<h2 id="끝"><a href="#%EB%81%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>끝</h2>\n<p>이게 제가 지금 생각해 낼 수 있는 방법의 전부입니다. 그리고 <a href="http://www.schneems.com/2016/01/25/ruby-debugging-magic-cheat-sheet.html">Richard의 puts 디버깅에 관한 글도 읽어보세요</a>. 좋은 하루 되시길. 끝.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>간만에 엄청나게 긴 양의 글을 번역했습니다. 그래도 맘 잡고 하니 생각보다 오래 걸리지도 않고, 초벌번역의 퀄리티도 조금씩 올라가고 있다고 느끼고 있습니다.</p>\n<p>이번에 소개해 드린 글은 콘솔에 디버깅 하는 방법을 소개하는 글입니다. 보통은 디버깅 툴로 <code class="language-text">byebug</code>, <code class="language-text">pry-byebug</code> 등을 사용하실 겁니다. 저도 어지간한 디버깅을 그렇게 처리하고 있지만.. 본문의 내용처럼 좀 깊은 부분을 들여다볼 때는 일일히 깊숙하게 파고들기 힘들 때가 많습니다. 좀 더 자신이 사용하고 있는 코드의 깊은 부분을 들여보고자 할 때 아주 유용한 테크닉이 될 것이라 생각합니다.</p>\n<p>번역된 챕터 제목들의 말투가 조금 이상하다고 느끼실텐데, 들어가는 글에서 원 저자가 \'어차피 블로그 포스트니까 신경 안쓰고 말투를 편하게 한다\'는 식으로 쓰여있길래 그 느낌을 가능한 한 살려서 작성해보았습니다.</p>\n<p>글을 읽다 보면 레일즈같은 거대한 오픈 소스에 기여하는 분들은 \'어떻게 이 방대한 코드를 다 고려하면서 개발을 하는걸까?\' 하는 생각에 더욱 존경심이 들더군요. 레일즈 뿐 아니라 다른 오픈소스 프레임웍들도 마찬가지입니다. 언젠가는 오픈소스에 기여했다는 족적을 꼭 남겨 보고 싶습니다.</p>\n<p>현재 Hanami 기반으로 개발을 하고 있다보니 문서화가 덜 되어 \'소스를 까볼\' 일이 많은데 이런 기술을 더 유용하게 사용해볼 수 있겠습니다. 이 글을 보는 다른 분들은 어떻게 \'프로그램의 소스를 살펴 보시는지\' 궁금하기도 하고, 더 유용한 디버깅 팁이 있는지도 궁금해집니다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-03-19-I-am-a-puts-debuggerer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-03-19",path:"/posts/i-am-a-puts-debuggerer-kor",title:"[번역] 나는 'puts' 디버거다",tags:["Ruby","Debugging","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Piotr Solnica 의  글 을 번역한 것입니다 번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다 저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://twitter.com/_solnic_">Piotr Solnica</a>의 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">글</a>을 번역한 것입니다</strong></li>\n<li><strong>번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma)을 비판하는 내용이었습니다. 이 글을 작성하기까지 오랜 시간동안 머리속으로 생각만 하고 있었지만, 이 주제가 아마도.. 알려져 있다는 것을 알고 있었습니다. 그래서 글을 작성하기 전에 구글에 검색을 해 보기로 마음먹었지요. 구글에 "ruby dependency injection"을 입력하면 이런 결과를 얻었습니다:</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 580px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 69.13793103448276%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVQ4y3VTiZKiQAzl//dr9jdmBl3EW+5DkQZUoLnxbRodC8exq14lXZCXl3QiGXYIe7eB5TgIggCmacGyLDiuC9dxkWUZ8jwf8NNP0wxVkUHzU/z5e4K8iSHlvMT5nOKScZR5Nvx4uaSDFSjLElVVDajrergLNE0zoOtaXPIGslEiPFWQMDodC9EJAgpsmxZt2z4IBKEgKIpiwPV6HWLu5nEk8aEnCNvUQsUtsG2FgpoUdHh3rvc4ga4nHoL0/UGcvRthO3dhbn1oKw++zaiP1FfDg771sFu7CI8JeFWAF5xI+pck0ncGcSzLgDyRoagK1IWK5WoJzdhBXZG/XWK5EXcNtmuDxRE450LOk9InwjQtwViKJM4JHDFZnnfUCjxAb/BS9riZT4RihCaqieXag6wYUBY2pnT/t9DJ1yHPNlgbNFa+iQM7PPp7Hb3MD4VnRFGIJGGkNCAcSWWIYxggDA/Y773BT7N0mEXxeOPHeSFkUY7FmsGwEhr0E0z7BM2M4e85DX2NiDVw7AKWWVDykborficMKPuOHsEjJZq5g+la0G2dElCJB6FwjziJiUwMfor23tC3JV9OOY5+jDik0oMzjl6C0E9w8CL4TojAjwb/nGRIWAaeVqOSfyF0XR/qfIX5fInpdAZVIX+2hqIs8Pk1wcenjC95itV6A1N3kERnMTTve5jTLjNavyhiNxszlDTEFaEsaZh5PmxS33cU09OG9aMVvNn/HCEucTH4uRcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc1"\n        title=""\n        src="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png"\n        srcset="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-0ca6d.png 198w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-45e8e.png 395w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png 580w"\n        sizes="(max-width: 580px) 100vw, 580px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>역주: 이 글은 2013년 12월에 작성되었으며, 현재 같은 검색어로 검색하면 결과물의 순서 및 노출되는 글이 다릅니다.</em></p>\n<p>저는 <a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">DHH(David Heinmeier Hansson, Ruby on Rails의 창시자)의 블로그</a>로 들어가 글을 다시 읽어보았습니다. 그 글에 대해 희미한 기억만 남아있었기 때문입니다. 그리고 나서야 저는 세상이 루비의 의존성 주입에 대한 다른 글이 필요하다는 것을 깨달았습니다. 왜 그럴까요? 대개 저 글을 읽고 많은 루비스트들이 루비의 의존성 주입에 대해 잘못된 인식을 가질 우려가 있기 때문입니다. 또한 의존성 주입이 뭔지 배워보고자 하는 사람들은 DHH의 블로그 글을 발견할테고, 루비에서의 의존성 주입이 "필요 없다" 라는 크게 잘못된 생각을 가질 수 있습니다. 네, 정말로 걱정되는 부분입니다.</p>\n<p>제가 이 글의 제목을 "루비의 의존성 주입"이라고 작성한 이유는 <strong>"루비의"</strong> 라는 부분이 꽤 중요하기 때문입니다. 루비의 의존성 주입은 아주 직관적인 실체를 가지고 있으며 여러가지 장점을 가지고 있습니다.</p>\n<p>아, 간단히 정리하자면:</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 외부 라이브러리도 쓸 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 설정도 할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드의 단순함을 희생할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드를 더 작성해야 할 필요가 없습니다.</p>\n<h2 id="루비의-의존성-주입은-아주-쉽다"><a href="#%EB%A3%A8%EB%B9%84%EC%9D%98-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85%EC%9D%80-%EC%95%84%EC%A3%BC-%EC%89%BD%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루비의 의존성 주입은 아주 쉽다</h2>\n<p>별로 대단한 건 없어요. 정말로요. 하지만 당신의 코드에 큰 영향을 줍니다. 자신만의 의존성을 갖는 객체를 만드는 것 보다 객체에 의존성을 주입 할 때 유연성은 증가하고 결합도는 낮아집니다. 더 나은 디자인을 채용하게 된 덤으로 테스트 하기도 쉬워지지요. 자주 일어나는 일입니다.</p>\n<p>한번 살펴보시죠:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 일반적인 접근</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> initialize\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n\n<span class="token comment"># 그리고 의존성 주입의 경우</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 뭔가 멋진 의존성 주입 라이브러리를 사용했나요? 아니죠. 우리가 코드를 더 작성했나요? 글쎄요. 아니면 코드가 더 복잡해졌나요? 확실히 아닙니다.</p>\n<p>작은 변화에 불과했지만 여러분의 코드에 <strong>큰 영향을 미칩니다.</strong> <code class="language-text">Hacker</code> 클래스는 더 이상 키보드를 만드는 방법에 종속될 필요가 없습니다. 그저 주어진 인터페이스를 사용하게 될 뿐이며, 우리는 키보드 인터페이스를 구현하기만 하면 어떤 것이든 편하게 집어넣을 수 있게 되었습니다. 이게 유연성이 증가하고 결합도가 낮아진다는 것을 뜻합니다.</p>\n<p>다 좋은데 그렇다면 키보드의 의존성은 어디서 만들어야 할까요? 분명 어디선가 만들어져야 할 텐데요?</p>\n<p>제가 사용하는 패턴은 이렇습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>layout <span class="token operator">=</span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> layout<span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>잠깐만요, 제가 코드를 더 작성하지 않아도 된다고 했나요? 제가 거짓말을 했네요. <code class="language-text">build</code> 메서드를 쓰기 위해 코드를 두 줄 정도 더 써버렸습니다. 들켰네요.</p>\n<p>그래도 일단 좋은 면만 보도록 합시다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 우리는 hacker 인스턴스를 아주 작은 노력으로 만들 수 있습니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">\'us\'</span><span class="token punctuation">)</span>\n\n<span class="token comment"># 만약 우리가 이미 키보드 객체를 가지고 있다면 이 방식으로도 작동합니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard_we_already_had<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>우리가 의존성을 명시적으로 드러냈기 때문에 테스트하기도 쉬워졌습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token comment"># 여기서는 키보드 객체가 큰 의존성을 가지고 있어서 그냥 mock으로 만든다고 칩시다</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>의존성 주입이 없었다면 어떤 모양으로 보일 지 생각해봅시다. 제가 끔찍한 예를 하나 들어보겠습니다. 그리고 저는 여전히 사람들이 이런 코드를 작성하는 것을 보곤 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n\t<span class="token comment"># 우웩!</span>\n    <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token function">should_receive</span><span class="token punctuation">(</span><span class="token symbol">:new</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">with</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">and_return</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><em>역주: 윗부분에서 <code class="language-text">Hacker</code> 클래스를 의존성 주입 없이 사용하는 예를 살펴보시면 ,<code class="language-text">Hacker</code> 클래스의 인스턴스를 작성할 때 동시에 <code class="language-text">Keyboard</code> 클래스의 인스턴스를 만든다는 것을 볼 수 있습니다. 그래서 <code class="language-text">keyboard</code> 라는 객체가 의도대로 생성되는지를 테스트하기 위해 이런 복잡한 코드가 들어가게 되었다고 생각합니다.</em></p>\n<h2 id="더-나아가서"><a href="#%EB%8D%94-%EB%82%98%EC%95%84%EA%B0%80%EC%84%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>더 나아가서</h2>\n<p>루비의 의존성 주입을 연습할 때 저는 몇몇 작은 패턴과 규칙을 정해놓고 따르고 있습니다.</p>\n<ul>\n<li><code class="language-text">.new</code> 메서드를 깔끔하게 유지하고, 오버라이드 하지 말 것. 단순한 의존성만 인자로 받아들인다</li>\n<li>빌더 메서드를 분리하여 만들고 이 메서드가 "모양빠지는" 입력들을 받아서, 해당 클래스의 객체가 필요로 하는 모든 것을 만들 수 있게한다</li>\n<li>빌더 메서드가 너무 복잡해지게 되면 빌드 로직을 서로 다른 객체로 분리한다</li>\n<li>생성자에 옵션 해시를 전달하는 것을 피한다</li>\n</ul>\n<p>이 규칙들은 제가 작성하는 코드에 크게 긍정적인 영향을 주었습니다. 결합도를 낮추었고, 유연성을 높였으며, 리팩토링도 쉬워졌습니다.</p>\n<p>사실 제가 이 글을 통해 작성한 간단한 예제만으로 위의 규칙이 말이 된다고 설득하는 것은 어렵습니다. 그러므로 일단 루비의 의존성 주입을 사용해보라고 권하고 싶습니다. 의존성 주입을 사용하는게 단순히 테스트할 때 이득을 보기 위해서라고 여기지 말아주세요. 제발요 :)</p>\n<p>제가 말하고 싶은 것은 루비의 의존성 주입은 하나의 미덕이라는 점입니다. 루비는 복잡한 일들을 간단한 방법으로 구현할 수 있는 아름다운 언어입니다. 반면에 테스트 할 때 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 을 사용하는 것은 그렇게 영리한 방법은 아닙니다.<em>(역주: <code class="language-text">stub</code> 메서드는 Rspec에서 일종의 객체 목업을 생성해주는 메서드로 알고 있습니다. 굳이 글쓴이가 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 메서드를 사용한다는 이야기를 꺼낸 것은 이 예시가 DHH의 포스트에 언급되어 있기 때문입니다.)</em></p>\n<p>물론 여러분이 루비의 의존성 주입을 사용하지 않을 수도 있지만, 실제로 사용해 보시면 더 깔끔하고 명시적인 코드를 작성하실 수 있습니다. 여러분의 코드는 더 좋아질 겁니다.</p>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>저는 언제나 기본적인 컴퓨터 과학 및 좋은 프로그래밍 방법론에 대한 지식이 부족하다는 점을 통감하고 있습니다. 단순히 전공자가 아니기 때문인 것도 있지만, 지속적으로 개발을 제대로 하려면 이러한 지식이 반드시 필요하다고 생각하고 있기 때문입니다. 이런 점에서 최근에 좀 더 알아보고 싶던 주제가 \'의존성 주입\' 입니다.</p>\n<p>자바 스프링 프레임워크를 사용할 때 주로 \'의존성 주입\' 이라는 단어가 많이 나왔을겁니다. 그런데 제가 제대로 쓸 수 있는(정말일까?) 유일한 언어인 루비는 어떻게 의존성 주입을 사용하는지 궁금하여 찾아보다 이 글을 발견하게 되었습니다.</p>\n<p>번역 과정 자체는 무난했는데 후반부에 "Stub Time.now" 라는 말의 뜻을 이해하지 못하겠더군요. 알고보니 두 가지 문제가 있었습니다.</p>\n<ol>\n<li>RSpec을 제대로 써 보지 않았다</li>\n<li>DHH의 글을 먼저 읽어보지 않았다</li>\n</ol>\n<p>글 작성자에게 더 자세한 설명을 부탁했더니 이런 답변을 받았습니다. 참고하시기 바랍니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 94.36619718309859%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACa0lEQVQ4y3WUSY7bQAxFfaoE2TSycLctz7Ykz5ItWZ4yLAIEyKKBIAfIKifITRk+uijIcGdBsarE+kV+/qrWcj6Xn6+vslosZDoeSxrHskhTSdTHs5kkapPRSPpRJINe78FY538Sz2TY70sr225lk8Yym0wkzzJJk8SA3QgmMOp0pNft1t6N+WgwsP0c0GLx49OTdF9eZL1cylwBxwpCwHg4NEAHj6dTy5gx//nHGnOADZAPJ+C3m41cLxepylJOx6NZdSjloHPWL6dTbdfzWc4hhiRIrAZ0fsr9Xs4aXB0OBsqGi27MoWW1Mp7hnEoYQxcZdp6faz5rQIxNgJJpsdvJLs9lp7wuFKRZCQav7BkpLZTs87sMOXW7XkumgJ7RhrlmUuhBZMo4b87D4VPllLLvAPmZhw1k5pvxlMl/DtmHzKmGKvZUo/M7DkmZQBrAifCIZ+2oYzYBgIfnt9Tw0BQvGaAbh9ktG7IInv9lUVjJNAhg1hjXHLqR1efr1QIokSCMm+NzdIg3EE3gARAiETUTbgnNYMwaYsUYu/kcqTTXah2mo0j+/vmt/BTGB2Wb3oInA/hFHuNgyMfG4VqiRWINcBFP5NePb7aRLh6UH+xYVXJS40bQlE96UxA66zTHGwS3ANUZ9rqRtNttK3Ot5RKAsJGBd9bGKEAPQkbcIjj1cpsvUYsJfOAh18XqmgQMceMpy8HzoEOsCNlaU7g2XHx4gEO6yJvY9MQ4f/6kufbsLQzvpmWIpr5//XKTSLgF9oypVADE2ARHZODvoN9/SqY5xNkDy+KH9++MD7ijBE5vPqT/e62br7bH/QPWe/MwJaRjfAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc2"\n        title=""\n        src="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png"\n        srcset="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-d16f8.png 198w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-f21b1.png 395w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png 790w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ee9f1.png 994w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>루비의 의존성 주입에 대한 이야기는 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a> 책에도 조금 설명되어 있습니다. 루비로 프로그래밍을 하신다면 두번 이상은 읽어보시길 추천드립니다.</p>\n<p>참고 링크:</p>\n<ul>\n<li><a href="http://www.slideshare.net/hnki0104/ss-42101768">주니어 개발자도 이해할 수 있는 의존성 주입</a></li>\n<li><a href="https://medium.com/@Bakku1505/introduction-to-dependency-injection-in-ruby-dc238655a278#.ywoosbc3h">Introduction to dependency injection in Ruby</a></li>\n<li><a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">Dependency injection is not a virtue</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-02-04-the-world-needs-another-post-about-dependency-injection-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-04",path:"/posts/the-world-needs-another-post-about-dependency-injection-in-ruby-kor",title:"[번역] 세상은 루비의 의존성 주입에 대한 다른 글을 원한다",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Cezar Halmagean…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://twitter.com/chalmagean">Cezar Halmagean</a>의 <a href="https://mixandgo.com/blog/mastering-ruby-blocks-in-less-than-5-minutes">포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>블록은 루비에서 가장 강력한 기능이지만 대수롭지 않게 여겨지는 기능이기도 합니다. 고백컨데 저도 루비 블록이 어떻게 동작하는지, 그리고 실제로 어떻게 유용하게 사용될 수 있는지 알아내는데 시간이 좀 걸렸습니다.</p>\n<p>처음에 블록을 이해하는데 굉장히 어렵게 만드는 요소로 <code class="language-text">yield</code> 등의 개념이 있습니다. 저는 블록의 일부 개념에 대해 이야기하고 몇몇 예시를 들어서 글 마지막에는 여러분이 루비 블록을 명확하게 이해하도록 돕겠습니다.</p>\n<h2 id="무엇을-배울-것인가"><a href="#%EB%AC%B4%EC%97%87%EC%9D%84-%EB%B0%B0%EC%9A%B8-%EA%B2%83%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무엇을 배울 것인가</h2>\n<ol>\n<li>\n<p>기초: 루비 블록이란?</p>\n</li>\n<li>\n<p><code class="language-text">yield</code> 가 동작하는 방법</p>\n<ul>\n<li>블록을 메서드로 전달하기</li>\n<li><code class="language-text">yield</code> 도 매개변수를 받는다</li>\n</ul>\n</li>\n<li>\n<p><code class="language-text">&amp;block</code> 은 무엇을 의미하는가?</p>\n</li>\n<li>\n<p>값의 반환</p>\n</li>\n<li>\n<p><code class="language-text">.map(&amp;:something)</code> 은 어떻게 동작하는가?</p>\n</li>\n<li>\n<p>반복자, 그리고 여러분의 반복자를 직접 만들기</p>\n</li>\n<li>\n<p>블록을 이용하여 기본값으로 객체를 초기화하기</p>\n</li>\n<li>\n<p>루비 블록 예시</p>\n<p>​</p>\n</li>\n</ol>\n<h2 id="기초-루비-블록이란"><a href="#%EA%B8%B0%EC%B4%88-%EB%A3%A8%EB%B9%84-%EB%B8%94%EB%A1%9D%EC%9D%B4%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기초: 루비 블록이란?</h2>\n<p>블록은 기본적으로 <code class="language-text">do</code> 와 <code class="language-text">end</code> 사이에 들어가는 코드입니다. 그게 다에요. <em>"그럼 마법같은 일(Magic)은 어디서 일어나는거죠?"</em> 라고 질문하실 수 있겠습니다. 우리는 몇 분 이내에 그 부분을 파고들겠지만 차례대로 설명하겠습니다(but first things first).</p>\n<p>여러분은 블록을 두 가지 방법으로 작성할 수 있습니다. 1. 멀티-라인으로 작성할 때는 <code class="language-text">do</code> 와 <code class="language-text">end</code> 사이에 코드를 작성하고, 2. 인라인으로 작성할 땐 <code class="language-text">{</code> 와 <code class="language-text">}</code> 사이에 코드를 작성하면 됩니다.</p>\n<p>이 두 가지 작성 방법은 정확하게 똑같이 작동합니다. 그래서 어느 방법을 고를 지는 여러분의 선택에 달려 있습니다. 일반적인 스타일 가이드에 의하면 가독성을 위해 코드가 한줄 이상 넘어가면 <code class="language-text">do</code> ~ <code class="language-text">end</code> 를 이용하여 작성하는 것이 좋습니다.</p>\n<p>멀티 라인 블록의 기본적인 예시는 이렇습니다: <code class="language-text">[1, 2, 3].each do |n| puts &quot;Number #{n}&quot; end</code></p>\n<p>이 블록이 멀티 라인 블록이라 불리는 이유는 한 줄 이상으로 코드가 작성되어서가 아니고 인라인 블록이 아니기 때문입니다. 같은 예시를 인라인으로 작성할 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token punctuation">{</span> <span class="token operator">|</span>n<span class="token operator">|</span> puts <span class="token string">"Number <span class="token interpolation"><span class="token delimiter tag">#{</span>n<span class="token delimiter tag">}</span></span>"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>두 가지 버전 모두 1, 2, 3을 순서대로 출력할 겁니다. 파이프 사이에 있는 소문자 n(<code class="language-text">|n|</code>)은 <strong>블록 매개변수(block parameter)</strong> 라고 불리고, 이 예시에서는 배열 안에 있는 각각의 번호가 순서대로 나오게됩니다. 그래서 처음 반복 시에 <code class="language-text">n</code> 의 값은 1이 되고, 두번째 반복에서는 2가 되고 그 다음엔 3이 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nNumber 1\nNumber 2\nNumber 3\n =&gt; [1, 2, 3]</code></pre>\n      </div>\n<h2 id="yield가-동작하는-방법"><a href="#yield%EA%B0%80-%EB%8F%99%EC%9E%91%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yield가 동작하는 방법</h2>\n<p>이제 위험한 녀석이 왔습니다(Here\'s bad wolf). 이 녀석이 루비 블록의 마법스러움과 혼란스러움을 가져다주는 주범이지요. 제 생각엔 대부분 <code class="language-text">yield</code> 가 블록을 호출하는 방법과 어떻게 매개변수를 전달하는지가 어렵게 보일 것이라 생각합니다. 우리는 이 섹션에서 두 가지 시나리오를 모두 살펴볼겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> my_method\n  puts <span class="token string">"reached the top"</span>\n  <span class="token keyword">yield</span>\n  puts <span class="token string">"reached the bottom"</span>\n<span class="token keyword">end</span>\n\nmy_method <span class="token keyword">do</span>\n  puts <span class="token string">"reached yield"</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nreached the top\nreached yield\nreached the bottom\n =&gt; nil</code></pre>\n      </div>\n<p>기본적으로 <code class="language-text">my_method</code> 메서드가 실행되고 <code class="language-text">yield</code> 를 호출하는 줄에 도달하면, 블록 안에 있는 코드가 실행됩니다. 그리고 블록 안의 코드가 끝나면 <code class="language-text">my_method</code> 메서드가 계속 실행됩니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 492px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 42.07317073170732%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVQoz32R2U7DMBRE8///hQRCFYtQS6GlNdlIGy9xFsd2msHXooiH0iuNLCfO8egkQZjT6YRBDbC6hWsVnKjhGonJOXhnMY4mxpghnv1v5nlGct6UrARbr5AWb3jfPWGfvWKvCmTNF5wfMZ8mWGvQdV2Aj9Bao23bGHo2TVPkJN778IHFITuAPWY4hGZFX6PqBEp9jFFDE88QkHMOKSUYY0jTFEVRIM9zVFUV2yfWWkzh9mKXY7f+QKZKbGoGJnPsf7LhnzBugLNjaKTR9/0vWCkVQ3tiJS54orpGGvjRk4lw0wQfGpE/Z2l1cSWP5OnaRCBVlUpACI48S8GrI8bWxEYUG5zRD6GcXRH4UiJQSIHl8gWLxT1unu9wu3rAtkixFSE8eGrIjw8NB5Dzq0B6SVCeCui6gZ0ttG3RGA3VN5C9Qme6qICAfxtemm+oSGlJM6/67gAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 01 26 sc1"\n        title=""\n        src="/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-806d2.png"\n        srcset="/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-e0e3b.png 198w,\n/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-4f7b9.png 395w,\n/static/2017-01-26-sc1-0b41e997207a170368c666aab1b250d5-806d2.png 492w"\n        sizes="(max-width: 492px) 100vw, 492px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="블록을-메서드로-전달하기"><a href="#%EB%B8%94%EB%A1%9D%EC%9D%84-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A1%9C-%EC%A0%84%EB%8B%AC%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블록을 메서드로 전달하기</h3>\n<p>블록을 매개변수로 받기 위해 메서드에 특별히 무언가를 정의할 필요는 없습니다. 그냥 블록을 함수(메서드)로 전달할 수 있습니다. 하지만 그 함수가 <code class="language-text">yield</code> 를 호출하지 않으면 블록은 실행되지 않을겁니다.</p>\n<p>반면에 메서드에 <code class="language-text">yield</code> 를 호출하도록 해놓으면 블록을 인자로 전달하는 것이 강제됩니다. 이 메서드가 블록을 매개변수로 받지 않는다면 에러가 발생하게 됩니다.</p>\n<p>만약 블록을 매개변수로 받는 것을 가변적으로 처리하고 싶다면 <code class="language-text">block_given?</code> 메서드를 사용할 수 있습니다. 이 메서드는 블록이 메서드로 전달되었는지를 따져 true나 false를 리턴합니다.</p>\n<h3 id="code-classlanguage-textyieldcode-도-매개변수를-받는다"><a href="#code-classlanguage-textyield%1Ccode-%EB%8F%84-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%EB%A5%BC-%EB%B0%9B%EB%8A%94%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">yield</code> 도 매개변수를 받는다</h3>\n<p>어떠한 매개변수든지  <code class="language-text">yield</code> 로 전달되면 블록의 매개변수처럼 동작할 것입니다. 그래서 블록이 실행될 때 원래 메서드로(yield를 호출하는 메서드)부터 전달되는 매개변수를 사용할 수 있습니다. 즉 매개변수는 <code class="language-text">yield</code> 가 자리잡고 있는 메서드의 지역 변수가 될 수도 있다는 뜻입니다.</p>\n<p>전달되는 매개변수의 순서는 중요합니다. 왜냐면 여러분이 전달하는 매개변수의 순서가 블록이 매개변수를 전달받는 순서와 일치하기 때문입니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 475px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 43.15789473684211%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACF0lEQVQoz2NYPnGm+LKZEfzLpyUKbuqLEl0+LUtw2uJ2vnmz+wXmzO3jnzu3TwCI+WfP7hPs7W3lZQCCBQumMuAERxsPO12s6XO6UNdtd7mqzvN8Q6f53iVbxbfv6+ffsX2W4I4dMwRAeOfOOcKVlXkSID3////HbeCp2ite5xpvmJ1tvap7puWO4dmeiypnZhySPP2qi+PYoXk8R47M5Dl1ag732bNLeWtqCkQZCIENXetUWvZEc3dsTeHt3B7HM2V1Jf/CtT0CSxdNFd6wYZ7gli2LBJYvnyq4cuVMkbKyfBGCLgSB5c5PGC9N+s9Q4nOAkYEBrIcFiJmAWBiIQd5kB2KgHAOruLgoSJyhoqKCob29naGtrQ2MYWyG5fMW8s/o6+LtyS3hW9U8hffo1M28XpaOCjNLWvjbsssF61PyhVpzCvjbi0oFU9MSeQh6WUVb3EhVT8lSylbJISIx2Wpp1zaLhc0b7aZ1rjBf1bLLsWvGTNWYjelihasqpObOmSheWdnM3N7RxgF0DR/QVSCaB4h5gWwQzcKQ75Pr4hLmoGy+MFbTdFq4js2saHWbmTEaelNDjKymR2tbzIjUMp8Rqek2J0F17pR+mfqmZqDmNnGgZlkgFgZiGSCWA/GBhnIxHOg5qrZ300q+gwvm8x1ctJBv18K5fLuB+BCQvWPhbL49C+fx7V04n2/zvFmCU6Z28xLyMQBX/95WW5u5bgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 01 26 sc2"\n        title=""\n        src="/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-7203d.png"\n        srcset="/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-93713.png 198w,\n/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-ae0be.png 395w,\n/static/2017-01-26-sc2-bb2e2064049183892cdc8f6790ab92a8-7203d.png 475w"\n        sizes="(max-width: 475px) 100vw, 475px"\n      />\n    </span>\n  </span>\n  </p>\n<p>한가지 유의하셔야 할 점은 블록 안의 매개변수는 블록에만 한정된 지역 변수가 된다는 겁니다. (메서드에 있던 지역 변수를 블록으로 전달할 때와는 다릅니다)</p>\n<h2 id="block은-무엇을-의미하는가-ampersand-parameter"><a href="#block%EC%9D%80-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%9D%98%EB%AF%B8%ED%95%98%EB%8A%94%EA%B0%80-ampersand-parameter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>&#x26;block은 무엇을 의미하는가? (ampersand parameter)</h2>\n<p>여러분은 아마 다른 루비 코드 여기저기에 <code class="language-text">&amp;block</code> 이 사용된 것을 보셨을 겁니다. 이 것은 지역 변수 대신에 블록에 대한 참조(reference) 자체를 메서드로 전달하는 방식입니다. 사실 <strong>루비는 블록처럼 작동하는 어떠한 객체라도 메서드에 전달되는걸 허용합니다.</strong> 메서드가 전달받은 객체가 블록이라면 이 블록을 사용하려 할 것이지만, <em>만약 블록이 아니라면 그 객체에 <code class="language-text">to_proc</code> 메서드를 호출하여</em> 블록으로 변환하려고 시도할 것입니다.</p>\n<p>또 참고하셔야 할 점은 <code class="language-text">block</code> 이라는 이름은(ampersend(&#x26;) 기호 이외의 부분) 단지 참조를 위한 이름일 뿐입니다. 여러분이 좋아하는 어떠한 이름이라도 사용하실 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">my_method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>block<span class="token punctuation">)</span>\n  puts block\n  block<span class="token punctuation">.</span>call\n<span class="token keyword">end</span>\n\nmy_method <span class="token punctuation">{</span> puts <span class="token string">"Hello!"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n#&lt;Proc:0x0000010124e5a8@tmp/example.rb:6&gt;\nHello!</code></pre>\n      </div>\n<p>위의 예를 보시다시피, <code class="language-text">my_method</code> 안에 있는 <code class="language-text">block</code> 변수는 블록의 참조이고, 이 블록은 <code class="language-text">call</code> 메서드를 통해 실행될 수 있습니다. 블록에 <code class="language-text">call</code> 을 하는 것은 <code class="language-text">yield</code> 와 똑같은 겁니다. 일부 사람들은 가독성을 위해 <code class="language-text">yield</code> 대신에 <code class="language-text">block.call</code> 을 사용합니다.</p>\n<h2 id="값의-반환"><a href="#%EA%B0%92%EC%9D%98-%EB%B0%98%ED%99%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>값의 반환</h2>\n<p><code class="language-text">yield</code> 는 블록 안에서 마지막으로 평가된 값(last evaluated expression)이 반환됩니다. 달리 말하면 <code class="language-text">yield</code> 가 리턴하는 값은 블록이 리턴하는 값이라는 겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> my_method\n  value <span class="token operator">=</span> <span class="token keyword">yield</span>\n  puts <span class="token string">"value is: <span class="token interpolation"><span class="token delimiter tag">#{</span>value<span class="token delimiter tag">}</span></span>"</span>\n<span class="token keyword">end</span>\n\nmy_method <span class="token keyword">do</span>\n  <span class="token number">2</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nvalue is 2\n=&gt; nil</code></pre>\n      </div>\n<h2 id="mapsomething은-어떻게-동작하는가"><a href="#mapsomething%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%8A%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.map(&#x26;:something)은 어떻게 동작하는가?</h2>\n<p>여러분은 아마 <code class="language-text">.map(&amp;:capitalize)</code> 같은 단축 표현을 많이 쓰셨을 겁니다. 특히 레일즈로 코딩을 좀 해보셨다면 말이죠.  <code class="language-text">.map { |title| title.capitalize }</code> 에 비하면 아주 깔끔한 단축 표현입니다.</p>\n<p><strong>그런데 이게 어떻게 작동하는걸까요?</strong></p>\n<p>실제로는 <a href="http://ruby-doc.org/core-2.2.0/Symbol.html#method-i-to_proc">심볼 클래스가</a> <code class="language-text">to_proc</code> 을 메서드를 구현하고 있기 때문에, 단축 표현을 풀어서 실제의 긴 표현식으로 변환해주는 겁니다. 멋지죠?</p>\n<h2 id="반복자-그리고-여러분의-반복자를-직접-만들기"><a href="#%EB%B0%98%EB%B3%B5%EC%9E%90-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%97%AC%EB%9F%AC%EB%B6%84%EC%9D%98-%EB%B0%98%EB%B3%B5%EC%9E%90%EB%A5%BC-%EC%A7%81%EC%A0%91-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>반복자, 그리고 여러분의 반복자를 직접 만들기</h2>\n<p>여러분은 메서드 안에 있는 <code class="language-text">yield</code> 를 원하시는 대로 몇번이든 부를 수 있습니다. 그게 기본적으로 반복자(iterator)가 동작하는 원리입니다. <code class="language-text">yield</code> 를 배열 안에 있는 각 요소마다 호출하면 루비에서 기본적으로 제공하는 반복자를 흉내낼 수 있습니다.</p>\n<p>루비의 <code class="language-text">map</code> 메서드와 비슷한 메서드를 작성하는 방법을 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">my_map</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span>\n  new_array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n  <span class="token keyword">for</span> element <span class="token keyword">in</span> array\n    new_array<span class="token punctuation">.</span>push <span class="token keyword">yield</span> element\n  <span class="token keyword">end</span>\n\n  new_array\n<span class="token keyword">end</span>\n\n<span class="token function">my_map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>number<span class="token operator">|</span>\n  number <span class="token operator">*</span> <span class="token number">2</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n[2, 4, 6]</code></pre>\n      </div>\n<h2 id="블록을-이용하여-객체를-기본값과-함께-초기화하기"><a href="#%EB%B8%94%EB%A1%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EA%B8%B0%EB%B3%B8%EA%B0%92%EA%B3%BC-%ED%95%A8%EA%BB%98-%EC%B4%88%EA%B8%B0%ED%99%94%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>블록을 이용하여 객체를 기본값과 함께 초기화하기</h2>\n<p>루비 블록을 사용할 수 있는 멋진 패턴 중 하나는 객체를 기본값과 함께 초기화하는 것입니다. 한번이라도 아무 루비 젬에서나 <code class="language-text">.gemspec</code> 파일을 살펴보았을 때 이 패턴을 보셨을겁니다.</p>\n<p>작동하는 원리는 이렇습니다. <code class="language-text">initialize</code> 메서드 안에 <code class="language-text">yield(self)</code> 를 호출하는 초기화 도구(initializer)를 넣어두는 겁니다. 여기서 <code class="language-text">self</code> 는 초기화되는 객체 자신입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Car</span>\n  attr_accessor <span class="token symbol">:color</span><span class="token punctuation">,</span> <span class="token symbol">:doors</span>\n\n  <span class="token keyword">def</span> initialize\n    <span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\ncar <span class="token operator">=</span> <span class="token constant">Car</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">do</span> <span class="token operator">|</span>c<span class="token operator">|</span>\n  c<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span>\n  c<span class="token punctuation">.</span>doors <span class="token operator">=</span> <span class="token number">4</span>\n<span class="token keyword">end</span>\n\nputs <span class="token string">"My car\'s color is <span class="token interpolation"><span class="token delimiter tag">#{</span>car<span class="token punctuation">.</span>color<span class="token delimiter tag">}</span></span> and it\'s got <span class="token interpolation"><span class="token delimiter tag">#{</span>car<span class="token punctuation">.</span>doors<span class="token delimiter tag">}</span></span> doors."</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nMy car&#39;s color is Red and it&#39;s got 4 doors.</code></pre>\n      </div>\n<h2 id="루비-블록-예시"><a href="#%EB%A3%A8%EB%B9%84-%EB%B8%94%EB%A1%9D-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루비 블록 예시</h2>\n<p>요즘은 예시로 보여주는게 대세(all the rage these days)인만큼 실제 세계에서(혹은 실제 세계와 최대한 가까운) 블록을 사용하는 몇가지 흥미로운 시나리오를 보여드리겠습니다.</p>\n<h3 id="텍스트를-html-태그로-감싸기"><a href="#%ED%85%8D%EC%8A%A4%ED%8A%B8%EB%A5%BC-html-%ED%83%9C%EA%B7%B8%EB%A1%9C-%EA%B0%90%EC%8B%B8%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>텍스트를 HTML 태그로 감싸기</h3>\n<p>여러분이 다양한 코드 덩어리를 약간의 고정된 코드로 감싸고자 할 때 블록은 최고의 도구입니다. 예를 들자면 여러분이 어떤 텍스트를 감싸고 있는 HTML 태그를 만들고자 한다면, 텍스트는 가변적이고(왜냐면 아직 당신은 무엇을 태그로 감쌀지 전혀 모르니까요) 태그는 고정적인 부분입니다. 이 형태는 변하지 않습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> wrap_in_h1\n  <span class="token string">"&lt;h1><span class="token interpolation"><span class="token delimiter tag">#{</span><span class="token keyword">yield</span><span class="token delimiter tag">}</span></span>&lt;/h1>"</span>\n<span class="token keyword">end</span>\n\nwrap_in_h1 <span class="token punctuation">{</span> <span class="token string">"Here\'s my heading"</span> <span class="token punctuation">}</span>\n\n<span class="token comment"># => "&lt;h1>Here\'s my heading&lt;/h1>"</span>\n\nwrap_in_h1 <span class="token punctuation">{</span> <span class="token string">"Ha"</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token punctuation">}</span>\n\n<span class="token comment"># => "&lt;h1>HaHaHa&lt;/h1>"</span>\n</code></pre>\n      </div>\n<p>메서드에 블록을 넘기는 방법은 여러분이 특정 행동을 재사용하고 싶지만 살짝 다르게 쓰고 싶을 때 유용하다는 점을 알아두시기 바랍니다. 이번엔 우리가 HTML 태그로 감싸고 싶은 문자열이 있고, 이걸 조금 다른 용도로 사용하는 경우를 봅시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">wrap_in_tags</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> text<span class="token punctuation">)</span>\n  html <span class="token operator">=</span> <span class="token string">"&lt;<span class="token interpolation"><span class="token delimiter tag">#{</span>tag<span class="token delimiter tag">}</span></span>><span class="token interpolation"><span class="token delimiter tag">#{</span>text<span class="token delimiter tag">}</span></span>&lt;/<span class="token interpolation"><span class="token delimiter tag">#{</span>tag<span class="token delimiter tag">}</span></span>>"</span>\n  <span class="token keyword">yield</span> html\n<span class="token keyword">end</span>\n\n<span class="token function">wrap_in_tags</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>html<span class="token operator">|</span> <span class="token constant">Mailer</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token function">wrap_in_tags</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>html<span class="token operator">|</span> <span class="token constant">Page</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token symbol">:body</span> <span class="token operator">=</span><span class="token operator">></span> html<span class="token punctuation">)</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>첫 번째 경우에는 <code class="language-text">&lt;title&gt;Hello&lt;/title&gt;</code> 이라는 문자열을 이메일로 보냈고, 두 번째 경우에는 <code class="language-text">Page</code>  레코드를 만듭니다. 두 경우 모두 같은 메서드를 사용했지만 다른 일을 했습니다.</p>\n<h3 id="노트-작성하기"><a href="#%EB%85%B8%ED%8A%B8-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>노트 작성하기</h3>\n<p>우리가 생각(아이디어)을 데이터베이스 테이블로 저장하는 방법을 빠르게 개발한다고 생각해보겠습니다. 이 도구가 바르게 작동하려면 우리는 노트의 내용을 전달하고 메서드가 데이터베이스 연결을 다루도록 해야 합니다. 이상적으로 우리는 <code class="language-text">Note.create { &quot;Nice day today&quot; }</code> 라고 호출하고 나면 데이터베이스 연결을 열고 닫는데 일일이 신경 쓰고 싶지 않을 것입니다. 그럼 한번 보시죠.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Note</span>\n  attr_accessor <span class="token symbol">:note</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>note<span class="token operator">=</span><span class="token keyword">nil</span><span class="token punctuation">)</span>\n    <span class="token variable">@note</span> <span class="token operator">=</span> note\n    puts <span class="token string">"@note is <span class="token interpolation"><span class="token delimiter tag">#{</span>@note<span class="token delimiter tag">}</span></span>"</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>create\n    <span class="token keyword">self</span><span class="token punctuation">.</span>connect\n    note <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token keyword">yield</span><span class="token punctuation">)</span>\n    note<span class="token punctuation">.</span>write\n    <span class="token keyword">self</span><span class="token punctuation">.</span>disconnect\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> write\n    puts <span class="token string">"Writing \\"<span class="token interpolation"><span class="token delimiter tag">#{</span>@note<span class="token delimiter tag">}</span></span>\\" to the database."</span>\n  <span class="token keyword">end</span>\n\n<span class="token keyword">private</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>connect\n    puts <span class="token string">"Connecting to the database..."</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>disconnect\n    puts <span class="token string">"Disconnecting from the database..."</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token constant">Note</span><span class="token punctuation">.</span>create <span class="token punctuation">{</span> <span class="token string">"Foo"</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\nConnecting to the database...\n@note is Foo\nWriting &quot;Foo&quot; to the database.\nDisconnecting from the database...</code></pre>\n      </div>\n<p>데이터베이스 연결, 노트 작성, 그리고 연결을 종료하는 기능의 구체적인 구현은 이 글에서 다루는 범위를 넘어가는 것이라 설명하지 않겠습니다.</p>\n<h3 id="배열에서-나눌-수-있는divisible-요소를-찾기"><a href="#%EB%B0%B0%EC%97%B4%EC%97%90%EC%84%9C-%EB%82%98%EB%88%8C-%EC%88%98-%EC%9E%88%EB%8A%94divisible-%EC%9A%94%EC%86%8C%EB%A5%BC-%EC%B0%BE%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>배열에서 나눌 수 있는(divisible) 요소를 찾기</h3>\n<p>제가 점점 "실제 시나리오" 와 멀어진 설명을 하고 있는 것 같습니다만, 마지막 예시를 보여드리도록 하겠습니다. 만약 배열 안에 있는 모든 요소 중에서 3으로 나뉘는 요소를 가져온다고 할 때(어떤 숫자를 생각하셔도 상관없습니다), 루비 블록을 어떻게 활용할 수 있을까요?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Fixnum</span>\n  <span class="token keyword">def</span> to_proc\n    <span class="token builtin">Proc</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">do</span> <span class="token operator">|</span>obj<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token operator">|</span>\n      obj <span class="token operator">%</span> <span class="token keyword">self</span> <span class="token operator">==</span> <span class="token number">0</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">)</span>\nputs numbers\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 결과\n3\n6\n9</code></pre>\n      </div>\n<p>역주: 위의 코드를 간략하게 설명하자면, 글 위에 <code class="language-text">&amp;block</code> 을 설명한 부분에서 <code class="language-text">&amp;</code> 기호 뒤에 붙어있는 객체가 블록이 아니라면 <code class="language-text">to_proc</code> 으로 블록으로 변환하는 것을 시도한다는 내용이 있습니다. 그래서 <a href="https://en.wikipedia.org/wiki/Monkey_patch">몽키 패칭</a>으로 <code class="language-text">Fixnum</code> 클래스에 <code class="language-text">to_proc</code> 메서드를 정의해 두는 겁니다. 3이라는 숫자는 <code class="language-text">Fixnum</code> 클래스의 객체이기 때문입니다. (루비 2.4.0부터는 Integer 클래스에 속합니다.) 실제로 변환된 블록은 다음의 형태를 가지고 있을 겁니다. <code class="language-text">*args</code> 는 옵션입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>select <span class="token keyword">do</span> <span class="token operator">|</span>n<span class="token operator">|</span>\n  n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>블록은 단순히 <strong>코드 덩어리</strong>라고 볼 수 있고, <code class="language-text">yield</code> 는 메서드 어딘가에 그 코드를 <em>주입</em>할 수 있도록 만들어줍니다. 말인 즉슨 여러분은 한 가지 메서드를 다양한 방법으로 조작할 수 있다는 뜻입니다. 그래서 여러 메서드를 작성할 필요가 없어지게 됩니다. (한 메서드를 재사용하여 여러 가지를 할 수 있다는 겁니다.)</p>\n<p>수고하셨습니다! 이 포스트를 통해 여러분은 루비 블록을 더 유용하게 활용하는 방법을 익히셨을 겁니다. 만약 여전히 혼란스러운 부분이 있거나 이 글에서 뭔가 놓친 부분이 있다면 <a href="https://mixandgo.com/blog/mastering-ruby-blocks-in-less-than-5-minutes">댓글을 남겨주세요</a>.</p>\n<p>또는 루비 블록에 대해 새로 배운게 있다면 이 글을 공유해주세요.</p>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>회사에서 개발을 하면서 필요한 기능에 맞추어 메서드를 만들다가 무언가 반복되는 부분이 발견되었습니다. 처음엔 메서드를 쪼개서 한 메서드를 여러 메서드가 공유하는 방식으로 사용했었는데, 생각해보니 그렇게까지 할 것도 없더군요. 분명 머리속엔 <code class="language-text">yield</code> 라는 게 있다고 기억은 하고 있었는데.. 자세한 용도를 다시 살펴보고자 검색을 하니 이 포스팅을 발견하였고, 내용이 너무 좋아서 바로 번역을 해도 되겠냐고 저자에게 물었습니다. 하지만 실제 번역된 결과물을 내기까지 생각보다 시간이 걸렸습니다.</p>\n<p>포스팅에 작성 된 예제 말고도 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%ED%83%80_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D">메타프로그래밍</a> 등 블록이 사용될 수 있는 부분은 무궁무진하게 많습니다. 이 글을 시작으로 간단하게 블록을 사용하여 이미 작성한 메서드를 개량하는 것부터 시작해보시는게 어떨까요?</p>\n<p>여담이지만 아직까지는 번역을 하면서 존대어를 쓰는 번역도 있고 경어를 쓰는 번역도 있습니다. 제 자신도 실력이 부족하고, 표현에 대해서 큰 고민을 하지 않고 의미 전달에만 초점을 두다 보니 이런 뒤죽박죽인 결과가 나왔네요. 번역 퀄리티가 점점 더 발전할 수 있도록 노력하겠습니다. 물론 좋은 글들을 흡수하여 제 자신이 더 좋은 코드를 작성하는 것도 신경 써야겠지요 :)</p>',
id:"/home/circleci/repo/src/pages/posts/2017-01-26-mastering-ruby-blocks-in-less-than-5minutes-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-01-26",path:"/posts/mastering-ruby-blocks-in-less-than-5minutes-kor",title:"[번역] 루비 블록을 5분 이내에 마스터하기",tags:["Ruby","Translation"],category:"Translation"}},{excerpt:"이 번역글은  Justin Weiss의 포스팅 을 번역한 글입니다 오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요 당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development…",html:'<ul>\n<li><strong>이 번역글은 <a href="http://www.justinweiss.com/articles/how-do-you-take-an-app-from-test-less-to-tdd/">Justin Weiss의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오류 지적 및 피드백은 언제나 환영합니다. 댓글이나 메일로 알려주세요</strong></li>\n</ul>\n<hr>\n<p>당신은 자신이 만든 앱을 보고 매우 흥분한 상태이다. 한가지 문제가 있다는 점만 빼고 - 테스트를 전혀 작성하지 않았다는 점 말이다. 당신은 TDD(Test-Driven Development) 방법론을 적용하여 코드를 쓰고 싶었지만, 어디부터 시작해야 할지 전혀 몰라서 막혀버렸다. 어디부터 시작해야 할 것인가? <strong>어떻게 하면 테스트가 없는 앱을 가지고 TDD를 이용한 앱을 작성할 수 있을까?</strong></p>\n<h2 id="이미-작성한-코드를-테스트하라"><a href="#%EC%9D%B4%EB%AF%B8-%EC%9E%91%EC%84%B1%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EB%9D%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이미 작성한 코드를 테스트하라</h2>\n<p>당신은 테스트가 없는 코드 뭉치를 가지고 있다. 그렇다고 <em>당장</em> 기존의 코드를 가지고 테스트를 작성할 수 없다는 뜻은 아니다. 이미 가지고 있는 코드를 테스트하는 것 부터 시작해보라. 기대하던대로 코드가 작동하는지 확인해보는 것이다.</p>\n<p>이건 TDD가 아니다. <strong>그러나 이미 존재하는 코드를 테스팅하는 것은 TDD를 배우는데 도움을 줄 것이다.</strong></p>\n<ul>\n<li>\n<p><strong>예외적인 경우나 에러가 발생하는 조건에 대해 생각하는 연습을 하게 된다</strong></p>\n<p>모든 가능한 입력을 테스트하느라 수 년을 허비하지 않고 테스트를 작성하기 위해서, 당신은 보통 코드의 어느 부분에서 문제가 발생하는지 생각해야 한다. 만약 문자열을 받는 메서드를 테스트한다고 할 때, 대신 심볼을 넣으면 어떤 일이 생길 것인가?  <code class="language-text">nil</code> 을 넣는다면? 혹은 숫자를 나누는 함수를 테스트한다면, 0을 입력하는 경우에 대한 테스트를 하는 것이 좋다. 하지만 아마 1과 2를 테스트 할 필요는 없을 것이다.</p>\n<p>당신은 충분한 테스트를 작성한 뒤에 메서드의 어느 부분에서 문제가 발생할지 예측하기 시작할 것이다. 그리고 한번 TDD를 시작하면 이 기술을 이용하여 탄탄한 테스트를 작성할 수 있을 것이다. 이 테스트들은 예외 사항들을 더욱 잘 처리하도록 코드를 강제하는 역할을 한다. </p>\n</li>\n<li>\n<p><strong>짜임새있는 테스트를 작성하는 연습을 하게 된다</strong></p>\n<p>이미 작성한 코드에 대한 테스트를 작성한다면, 이 테스트들을 <a href="https://www.justinweiss.com/articles/writing-better-tests-with-the-three-phase-pattern//">구조화하는 다른 패턴들</a>을 시도해볼 수도 있다. 테스트하고자 하는 코드는 이미 있다. 그러니 당신은 테스트 자체, 그리고 이 테스트가 어떤 식으로 작성되어야 하는지에 대해 집중할 수 있다. 그리고 한번 몇몇 좋은 패턴들을 익히고 나면 당신이 기댈 코드가 <em>없을</em> 때에도 더 좋은 테스트를 작성할 것이다.</p>\n</li>\n<li>\n<p><strong>코드를 테스트하기 힘들게 하는 요소들을 발견하게 된다</strong></p>\n<p>테스트들을 작성할 수록 점점 시스템 어느 부분이 테스트하기 제일 어려운지 느끼게 될 것이다. 그런 부분들을 알아차리게 되면 그 부분을 리팩터링이 필요한 부분이라고 표시해둘 수 있다. 더 나아가 처음부터 더욱 테스트하기 좋은 코드를 작성하기 시작할 것이다.</p>\n<p>테스트하기 좋은 코드가 어떤 식으로 생겼는지 알기 시작하면, 그 지식을 기반으로 TDD하기 쉬운 API를 개발할 수 있으며 더욱 빨리 앱을 개발할 수 있을 것이다.</p>\n</li>\n</ul>\n<h2 id="tdd에-익숙해지기ease-into-tdd"><a href="#tdd%EC%97%90-%EC%9D%B5%EC%88%99%ED%95%B4%EC%A7%80%EA%B8%B0ease-into-tdd" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TDD에 익숙해지기(Ease into TDD)</h2>\n<p>\'테스트를 나중에\' 기법을 TDD를 배우는데 도움이 되는 기술로 사용할 수 있다. 하지만 여전히 당신 앱의 일부에 TDD를 적용하고 싶을 것이다.<em>(역주: 테스트를 먼저 작성하고 기능을 개발하는 것을 의미하는 것이라 추정합니다)</em> <strong>그리고 기존의 코드를 가지고 TDD에 익숙해지는 간단한 방법이 있다: <a href="https://ko.wikipedia.org/wiki/%ED%9A%8C%EA%B7%80_%ED%85%8C%EC%8A%A4%ED%8A%B8">회귀 테스트를 작성하는 것이다</a></strong></p>\n<p>회귀 테스트는 이미 확정한 코드를 부수는 것을 억누른다. 아이디어 자체는 아주 간단하다. 당신이 버그를 발견할 때마다, 그 버그를 다시 만들어보기 위해 브라우저에서 여기저기 클릭해보는 대신에:</p>\n<ul>\n<li>버그를 재생성하기 위해 <strong>실패하는 테스트를 작성하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 그 테스트가 확실히 실패하는지 확인하라 (왜냐면 버그는 아직 존재하니까).</li>\n<li>가능한한 가장 간단한 방법으로 <strong>버그를 수정하라.</strong></li>\n<li><strong>테스트를 실행하라,</strong> 그리고 테스트가 통과하는지 확인하라.</li>\n<li>만약 필요하다면 당신이 수정한 방법을 <strong>리팩터링하라.</strong></li>\n</ul>\n<p>이 방법은 새 시스템을 밑바닥부터 TDD로 개발하는 것 보단 훨씬 쉽다. 왜냐면 이미 작성된 코드를 단지 테스트 주도적으로 바꾸기만 하는 것이기 때문이다. 그리고 "Red, Green, Refactor" 라는 TDD의 핵심적인 루프를 습관화하게 된다. <strong>그리고 이쯤부터 당신의 TDD는 테스트가 없는 상태에서 바로 TDD로 개발하는 것에 가까워지게 된다.(And from here, TDD is a shorter step away than trying to go straight to TDD from no tests.)</strong></p>\n<h2 id="테스트가-없는-상태에서-tdd로"><a href="#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%97%86%EB%8A%94-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C-tdd%EB%A1%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테스트가 없는 상태에서 TDD로</h2>\n<p>테스트가 없는 앱은 그렇게 나쁜 출발점은 아니다. 이미 작성된 코드를 테스트할 때, 당신은 좋은 TDD 테스트를 작성하기 위해 무엇이 필요한지 많이 배우게 될 것이다. \'테스트를 나중에\' 하는 것은 시작부터 TDD로 개발하는 것 보다 쉽다. 왜냐면 아직 어떻게 디자인해야할지 모르는 API들을 상상할 필요가 없기 때문이다. 그리고 자신의 앱에 한번 TDD를 도입하기로 결정했다면 회귀 테스트를 통해 익숙해질 수 있다.</p>\n<p>그러니 만약 당신이 상상하고 있는 시스템에 TDD를 어떻게 도입해야 할 지 모르겠다면, 계속 테스트를 작성하라. 비록 코드를 먼저 써야 하더라도 말이다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>2017년 첫 번역은 TDD에 관한 글입니다. TDD 혹은 BDD(Behavior Driven Development)가 개발 방법론에 있어서 절대적인 진리는 아닐 겁니다. 다만 많이 권장되는데는 이유가 있겠지요. 저는 간단하게 TDD가 확장성, 유지보수성에 큰 도움이 된다고 인지하고 있습니다.</p>\n<p>제 자신도 아직 실력이 미천하여 코드 없이 테스트를 작성한다는 것에 큰 두려움을 느끼면서 지내왔습니다. 최근에야 일부 기능에 대해 예측되는 결과를 먼저 테스트로 작성하고, 이후에 실제 기능을 작성하여 잘 작동하는지 확인하는 수준에 불과합니다.</p>\n<p>그러다가 마침 기존에 작성한 코드를 이용하여 TDD를 배워나가는 과정에 대해 간단한 포스팅이 있어 이렇게 소개를 하게 되었습니다. 음.. 당장은 기존의 코드를 이용하여 테스트를 작성하는게 꽤 부끄럽지만 (왜냐면 테스트를 작성할 것도 없이 손대야 할 부분들이 수두룩하게 보이니까요) 이런 방식으로 약간 우회하여 TDD를 습득하는 방법도 있겠지요. </p>\n<p>그럼 모두 2017년 한해에도 좋은 테스트 + 테스트를 통과하는 좋은 코드 작성이 잘 되시길 바랍니다 :)</p>\n<p>(추가) 피드백에 의해 \'You\' 라는 단어의 직역이 너무 많이 들어간 것 같아 조금 수정하였습니다. 확실히 번역할 때 \'당신\' 이라는 단어가 일일이 들어갈 필요는 없겠네요. 좋은 피드백을 주신 <a href="https://twitter.com/initnirvana">@initNirvana</a> 님께 감사드립니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-01-16-how-do-you-take-an-app-from-no-tests-to-tdd-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-01-16",path:"/posts/how-do-you-take-an-app-from-no-tests-to-tdd-kor",title:"[번역] 테스트가 없는 앱을 이용하여 TDD를 배우는 방법",tags:["Ruby","Testing","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Luca Guidi의 포스팅 을 번역한 글입니다 오역이나 잘못된 표현 지적은 언제나 환영합니다 객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기 역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 '루비 3'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다. 오늘은 주식회사 활빈당(Spectacular Foo Ltd…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://lucaguidi.com/2016/06/07/the-penguin-that-cannot-fly.html">Luca Guidi의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오역이나 잘못된 표현 지적은 언제나 환영합니다</strong></li>\n</ul>\n<hr>\n<h2 id="객체-지향-프로그래밍-인터페이스-동적-타입에-대한-짧은-이야기"><a href="#%EA%B0%9D%EC%B2%B4-%EC%A7%80%ED%96%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EB%8F%99%EC%A0%81-%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%A7%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기</h2>\n<p><em>역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 \'루비 3\'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다.</em></p>\n<p>오늘은 주식회사 활빈당(Spectacular Foo Ltd. <em>역주: 보통 임의의 사람 이름을 홍길동이라고 하다 보니 임의의 회사 이름은 무엇으로 할까 하다가...</em>)의 본사에서 일어나는 일을 이야기해보고자 한다. 이 회사는 인디 게임계에서 떠오르고 있는 회사이고, 다음 블록버스터 타이틀인 <em>흔해빠진 새들(Banal Birds)</em> 의 발매를 앞두고 있다.</p>\n<p>올해는 2019년이고, 루비 3는 세배나 빠르고, 놀랍게도 모든 문제를 해결할 수 있는 동적 타입을 가지고 있다! 조금 향수에 젖은 결정이긴 하지만 당신은 리드 개발자로서 루비를 이 프로젝트에 사용하기로 결정했다.</p>\n<p>당신은 관리자인 제인에게 최종 코드 리뷰를 부탁했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Bird</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>아이디어는 간단하지만 혁명적이었다: 플레이어는 <strong>어떤</strong> 종류의 새라도 고를 수 있고 그 새가 날아가는 것을 볼 수 있다. 이건 엄청날거야!(This is gonna be kickass!)</p>\n<p>당신은 유명한 루비 젬 <code class="language-text">acts_as_a_bird</code>(새처럼 행동하라)를 재사용했다. 이 젬은 <code class="language-text">Bird</code> 를 완벽하게 구현하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Bird</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>많은 새들 가운데서 우리는 올빼미나 벌새도 구현했다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Owl</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying owl"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Hummingbird</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying hummingbird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>소프트웨어 공학의 참으로 놀라운 부분 아닌가? 글쎄, 이 게임에 엄청난 투자를 했음에도 불구하고 문제가 하나 남아있었다: 제인이 \'그러면 펭귄은요?\' 라고 물었다. 그렇다, 펭귄은 새지만 날 수 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Penguin</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token comment"># LOL I\'m a penguin (ㅋㅋㅋ 난 펭귄인데?)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>오늘은 게임 발매 당일이고 당신은 버그를 수정하기 위한 여력이 없다. 그래도 발매는 되어야 한다(The show must go on). 그래서 당신은 게임을 발매하고 사용자들이 펭귄을 고르지 않기를 기도할 수 밖에 없다.</p>\n<p>당신은 기분이 별로다. 그리고 자기 자신에게 묻기 시작한다: <em>왜 내가 루비를 골랐지? 왜 동적 타입을 쓴걸까?</em></p>\n<p>제인은 "당신이 정말 사용해야 했던 것은 타입이 아니라 인터페이스에요." 라고 말했다. 당신은 그 말을 듣자마자 "맙소사, 자바 말인가요!?(OMG, Java!)"  라고 말했지만, 그녀는 찬찬히 시간을 들여 그 개념은 <a href="http://golangtutorials.blogspot.kr/2011/06/interfaces-in-go.html">Go(GoLang)</a>에서 빌려온 것이라고 설명하였다.</p>\n<blockquote>\n<p>"루비같이 동적 타입을 가지고 있는 언어에서, 당신이 정말 신경써야 하는 것은 <strong>행동(behavior)</strong>이에요. 당신은 객체에 <em>메세지를 보낼 수 있도록</em> 해야합니다. 그게 객체 지향 프로그래밍의 핵심이에요."</p>\n</blockquote>\n<p>그녀는 계속 설명했다: "타입을 사용하는 것은, 당신이 수행하고자 하는 일보다 과하게 많은 일을 수행하려는 객체를 받아들인다는 것과 같아요. 그리고 그건 <a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4_%EB%B6%84%EB%A6%AC_%EC%9B%90%EC%B9%99">인터페이스 분리 원칙</a>을 무너뜨립니다."</p>\n<blockquote>\n<p>"차이점은 미묘해요: 당신은 <code class="language-text">Bird</code> 클래스가 <code class="language-text">fly</code> 메서드에 반응할 것이라(respond to) 추측했지요. 하지만 언제나 그렇진 않아요. 대신 프로그래밍 언어 측에서<em>(역주: 문맥 상 프로그래머가 작성한 코드를 말하는 것으로 보입니다)</em> 주어진 객체가 특정 메서드(혹은 메서드의 모음)를 구현하고 있는 지 확인하는 도구를 제공해야 합니다."</p>\n</blockquote>\n<p>이 시점에서 당신은 충격을 받았다. 당신은 루비가 행동의 모음을 정의할 수 있는 특별한 모듈을 제공했으면 정말 좋겠다고 생각했다<em>(역주: wished라는 동사를 사용했지만 문맥상 희망하다라고 쓰기엔 딱딱해 보입니다)</em>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">interface <span class="token class-name">Flying</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying <span class="token interpolation"><span class="token delimiter tag">#{</span> name <span class="token delimiter tag">}</span></span>"</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"bird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Falcon</span>\n  include <span class="token constant">Flying</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"falcon"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Flying</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>또한 가상머신(VM)이 \'펭귄은 날 수 없다\' 같은 당황스러운 에러를 내뿜기 전에 당신을 막아주었으면 좋겠다고 생각했다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>예전에 RORLAB 슬랙의 질문 채널에서 이런 내용의 대화를 주고받은 적이 있습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 544px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 87.86764705882352%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACtklEQVQ4y31UuY7UQBScH+Ij+Af4BH6BjJSIhBghIkICMqKVWBEgEaAVYnfYGd/3+BqP7Tk9Ll4949kDFkvtvuu96qruyYezK9hB8QXAy647vjvIt9vtcTweezzw9X3/z8Jv8uLVW3y/tH4lcfgxiuLPURR1tu0giuO+KEssFimSJNE6jCL4QYCqqh4MNIHkstlsUNcNynIJ23Hgul7v+z4cx0UYhrAsG6ZpIRbgLMt0nEEkAakXiOMEXdcNGfIngEcB6GTjsW3bXuhCmPf7vVIH68Oh0zY/9rfbLdcoEOsTZf7quobneQiEjlDWiEJZs2EWy+VS5kKdZ+ZFUSjtOI41U5buTzAFbNu1bhqjjWXss95ud9jtdtpnpvfXnjJ8/uwJvn09h2HaAtxitVqdFg1UB8ABYKg3QpfgYwDWJ8D3b17jx8UFLNtWQQzDUBEM08RsNlMxqLptD8KMQqVpqiKRWZ7nN6J4riWTiZ5RluUyWehiZspzymQxN1XVSl1AFv/z5+Tp40c4P/uE65khXlugLEoFK8WDFOuwEWpCcQygtRQKlsh6CtI0zQ2gbVyrWqZQdEVpUmV7Op2KH114lgNPaHJsPjcGXwp90myaVoPQx7eMrT7U86jLCnmaIRdbcAOz4DhtRAOPlqJ9eAxj1hTvDiDpmZbcBHrN9TXT+XyumSR+KOPRSbDLyyvNnAKxP7riDiDPiuoxGwJ7nq8bCOxSVQHlmO8HcATMkjXMkna5LcjJ2Ov1Gp7roc5KNLEoneYKVhVCK19qoOGWBPpIsLDPILw1fwPKwxDNHSycANOfVwpuGKYWX9oEvxZP0lqOUB/ABgHZ5nmPtBWQaukZ8pkSD6YiDAvVT2kPCiZBmQUNPD4SY1b3ni/oy5GomrFeftY0MSmxzcI2fUdxwjDSPQzC63gb/DfqqlBeKJlTYwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="slack_conversation"\n        title=""\n        src="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png"\n        srcset="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-5510e.png 198w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-f5670.png 395w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png 544w"\n        sizes="(max-width: 544px) 100vw, 544px"\n      />\n    </span>\n  </span>\n  </p>\n<p>마침 이 글을 읽은 직후라 비유를 <code class="language-text">fly</code> 로 사용했었던 것이 기억나네요. 보통 동적 타입을 사용하는 언어들의 단점으로 여러가지가 거론되지만 \'실행하기 전에는 무슨 일이 일어날 지 바로 알 수 없다\' 라는 단점을 본 적이 있습니다.</p>\n<p>하지만 본문에서 설명한 개념으로 그런 단점을 최소화하는게 가능하겠지요. 핵심은 프로그래머가 자신의 프로그램이 어떻게 동작할지를 면밀하게 설계할 필요가 있다는 것입니다.</p>\n<p>위 개념을 조금 더 적극적으로 활용하고자 하시는 루비 프로그래머분들은 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a>의 5, 6, 7장을 찬찬히 살펴보시면 많은 도움이 될 것입니다.</p>\n<p>2016년의 마지막 날, 이 글을 읽는 분들에게 조그마한 새해 선물이 되었이 되었으면 좋곘고 새해에도 많은 분들과 더 좋은 내용의 글을 주고받을 수 있도록 개발자로서의 역량을 갈고 닦고 싶습니다 :)</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-31-the-penguin-that-cannot-fly-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-31",path:"/posts/the-penguin-that-cannot-fly-kor",title:"[번역] 펭귄은 날 수 없다(The Penguin That Can't Fly)",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Luca Guidi의 포스팅을  번역한 글입니다 문제를 설명하는데 나온 하나미(Hanami…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://lucaguidi.com/2016/12/27/isolate-global-state.html">Luca Guidi의 포스팅을</a> 번역한 글입니다</strong></li>\n<li><strong>문제를 설명하는데 나온 하나미(Hanami)에 대해서는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction">이 포스팅</a>을 참조해주세요</strong></li>\n<li><strong>전문 번역이 아니기에 부족한 표현이나 오역은 언제든지 지적해주세요</strong></li>\n</ul>\n<hr>\n<p>소프트웨어 프로그램에서 전역 상태를 사용하는건 개발하기엔 쉽지만 유지보수 할 때는 악몽이 된다. 예상치 못한 상황에서 발생하여 추적하기도 어려운 버그가 되기 쉽상이다.</p>\n<p>왜 그렇게 되는지, 그리고 어떻게 그 문제를 완화할 수 있을지 살펴보자.</p>\n<p><em>역주: 이 글에서 전역 상태는 전역 변수와 거의 동일한 의미로 사용되는 것으로 추정됩니다.</em></p>\n<h2 id="문제의-예시"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 예시</h2>\n<p>예를 들자면 하나미의 코드 베이스 안에서 우리는 환경 변수에 따라 어떻게 프레임워크가 설정되는지 테스트 할 필요가 있다.</p>\n<p>우리<em>(역주: 하나미 개발팀으로 보입니다)</em>는 보통 테스트를 이런 식으로 작성한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  before <span class="token keyword">do</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'RACK_ENV\'</span><span class="token punctuation">]</span>    <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_HOST\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_PORT\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    before <span class="token keyword">do</span>\n      <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'production\'</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span>\n    <span class="token class-name">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리는 보통 각각의 테스트를 실행하기 전에 모든 환경 변수를 초기화해왔다. 그리고 우리가 필요로 하는 특별한 상황(the edge case)에서만 하나씩 설정했다.</p>\n<p>이러한 접근 방식을 사용할 때의 <strong>문제는</strong> 이 방법이 루비 프로세스의 전역 상태를 <strong>더럽힌다는</strong> 것이다. 우리가 테스트 파일을 단독으로 실행할 때는  <code class="language-text">before</code> 블록이 환경 변수를 리셋하기 때문에 잘 작동한다.</p>\n<p>그러나 모든 테스트를 한번에 실행할 때, 테스트는 꼬이게 될 것이다. 환경 변수 초기화가 언제나 작동하진 않기 때문이다.</p>\n<p>만약 한 테스트가 <code class="language-text">ENV</code> 속성을 변환하고 나서 뒷정리를 하지 않으면, 그 다음 테스트는 기존의 <code class="language-text">ENV</code> 값의 변화를 <strong>물려받아서</strong> 우리가 기대하던대로 작동하지 않을 수 있다.</p>\n<p>때때로 위의 예시 처럼 눈에 띄는 부분에서 변화를 준 경우에는 우리가 <code class="language-text">after</code> 블록을 설정하여 뒷정리를 할 수 있다. 그러나 다른 때엔 변환한 것(the mutation)이 우리 눈에 보이지 않는 부분에서 부작용을 초래할 수 있다.</p>\n<p>이건 소스의 버그다. 그리고 이 버그는 엉킨 실타래처럼 되어 디버그하기 힘들다.</p>\n<p><strong>오랜 시간동안, 여러 가지 전역 상태의 조합하는 것은 하나미를 지속적 통합 개발(<a href="https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9">CI builds</a>)이 힘들도록 만들고 여러 버그를 일으켰다.</strong></p>\n<p>개발자로서의 내 경험으로 미루어보아(<em>역주: Luca Guidi는 숙련된 웹 개발자입니다</em>) 이런 형태의 문제를 완화할 수 있는 유일한 방법은 <strong>전역 상태를 격리하거나, 전역 상태를 사용하는 것을 아예 피하는 것이다.</strong> 우리는 <strong>가능한한 전역 상태를 사용하는 것을 줄이도록</strong> 하나미의 내부 구현을 바꾸고 있다.</p>\n<h2 id="문제의-해법"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%ED%95%B4%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 해법</h2>\n<p>앞서 이야기한 특별한 경우를 위해 우리는 환경 변수를 격리할 수 있는 새로운 객체를 선보였다. 이는 <code class="language-text">Hanami::Env</code> 라고 불린다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Env</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> env\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>구현 자체는 별 것 아니다: <code class="language-text">ENV</code> 에 접근하는 것을 캡슐화하는 것이다.</p>\n<p>우리는 환경 변수를 관리하기 위해 자체 인터페이스를 정의했다. 우리는 명시적인 구현(concrete implementation)을 사용하기보다(<code class="language-text">ENV</code>) 추상화(<code class="language-text">Hanami::Env</code>)에 의존하고 있다(<a href="https://ko.wikipedia.org/wiki/%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84_%EC%97%AD%EC%A0%84_%EC%9B%90%EC%B9%99">의존관계 역전 원칙 참고</a>). </p>\n<p><code class="language-text">Hanami::Environment</code> 는 프로젝트의 환경 변수를 설정하는 책임을 가지고 있는데, 우리는 이런 방식으로 사용한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Environment</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>\n      opts <span class="token operator">=</span> options<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>dup\n      <span class="token variable">@env</span> <span class="token operator">=</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Env</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> opts<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n\n      <span class="token comment"># ...</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 하나미 프로젝트를 사용할 때, <code class="language-text">:env</code> 옵션은 설정되지 않은 상태이다. 이로 인해 <code class="language-text">@env</code> 는 <code class="language-text">ENV</code> 를 참조하여 루비 프로세스의 진짜 환경 변수를 읽거나 쓰게 된다.</p>\n<p>이렇게 우리는 <code class="language-text">Hanami::Environment</code> 의 테스트 중에 많은 양의 코드를 단순화하고, <strong>공유되고 변화 가능한 상태(shared mutable state, 즉 <code class="language-text">ENV</code> 말이다)의 사용을 피할 수 있었다.</strong> 아래 코드에서 우리는 <code class="language-text">ENV</code> 와 유사하게 동작하는 <code class="language-text">:env</code> 를 객체의 옵션으로 전달하지만, 이 것은 실제로 <code class="language-text">ENV</code>가 아니다: 그냥 <code class="language-text">Hash</code> 이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token builtin">Hash</span><span class="token punctuation">[</span><span class="token string">"HANAMI_ENV"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"production"</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n\n    it <span class="token string">"tests something interesting"</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> env<span class="token punctuation">)</span>  \n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p><a href="https://ko.wikipedia.org/wiki/%EC%BA%A1%EC%8A%90%ED%99%94">캡슐화</a>와 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">의존성 주입</a>을 적절하게 사용하여, 각각의 테스트에서 발생할 수 있는 변화는 나머지 테스트에서는 보이지 않게 되었다. 결과적으로 안정적인 테스트 수행을 할 수 있게 되었고, 하나미 내부를 <a href="https://ko.wikipedia.org/wiki/SOLID">SOLID 디자인</a>에 맞게 구성할 수 있었다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>보통 루비 프로젝트에서 <code class="language-text">dotenv</code> 같은 젬으로 환경 변수를 관리합니다. 사실 이 환경 변수라는 개념도 저에게 아직 모호한 개념이지만, 객체지향 프로그래밍의 핵심적인 주제인 캡슐화와 의존성 주입을 어떤 식으로 활용하는지 좋은 예를 보여준 것 같아 한번 번역해보게 되었습니다.</p>\n<p>특히 제가 요즘에야 테스트를 작성해보기 시작했는데, 테스트를 개별로 실행할 때는 몰라도 전체 테스트를 실행할 때 원인을 알 수 없는 오류가 생길 때가 종종 있었습니다. 이 글을 통해 약간의 힌트를 얻었다는 생각도 듭니다. </p>',
id:"/home/circleci/repo/src/pages/posts/2016-12-30-isolate-global-state-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-30",path:"/posts/isolate-global-state-kor",title:"[번역] 전역 상태를 격리하라",tags:["Ruby","Hanami","Testing","Translation"],category:"Translation"}},{excerpt:"본 포스팅은  루비 대림절 달력 을 위해 제작하였습니다 기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다 작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다 들어가며 아직 갓…",html:'<ul>\n<li><strong>본 포스팅은 <a href="http://ruby-korea.github.io/advent-calendar/">루비 대림절 달력</a>을 위해 제작하였습니다</strong></li>\n<li><strong>기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다</strong></li>\n<li><strong>작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다</strong></li>\n</ul>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>아직 갓 6개월 된 초보 개발자로서 이제 루비 온 레일즈(이하 레일즈)에 조금씩 익숙해지던 차에, 상사로부터 \'하나미라는 프레임워크가 있으니 한번 리서치를 해 보세요\' 라는 권유를 받았다. 그는 루비로 백엔드 서버들을 구축했지만 레일즈는 자신의 취향에 맞지 않다고 했고, 구조적으로도 하나미가 더 나아보인다고 이야기하였다.</p>\n<p>그리고 하나미 공식 가이드를 쭉 읽어본 나에게는 혼돈과 절망만 남았다. 루비 뿐 아니라 웹 개발의 기초 지식이 부족해서 그런지 도저히 이게 어떻게 돌아가는건지도 모르겠고, 레일즈에 대입해서 이해할 수 있는 것도 아니라는 생각이 들었다.</p>\n<p>다시 6개월을 다른 레일즈 프로젝트 제작, 리서치 작업을 하며 보내고 나니 회사에서는 본격적으로 레일즈 사용을 하지 않고 하나미를 사용하는 방향으로 가닥을 잡았다. 어쩌다가 레일즈라는 걸출한 웹 프레임워크를 두고 생소한 하나미라는 프레임워크를 사용하게 되었는지, 이번 기회를 통해 독자 분들의 관심을 이끄는 계기를 만들어보고자 한다.</p>\n<h2 id="변화가-일고-있는-레일즈-커뮤니티"><a href="#%EB%B3%80%ED%99%94%EA%B0%80-%EC%9D%BC%EA%B3%A0-%EC%9E%88%EB%8A%94-%EB%A0%88%EC%9D%BC%EC%A6%88-%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변화가 일고 있는 레일즈 커뮤니티</h2>\n<p>레일즈는 2005년에 처음 소개 된 이후 빠르고 쉬운 웹 애플리케이션 개발을 위한 도구로써 많은 개발자들의 사랑을 받아왔다.</p>\n<p>\'프로그래머의 단짝 친구\' 라고 소개할 정도로 쉽고 재미있는 언어인 루비를 기반으로 삼은 프레임워크이기도 하고, 꼭 루비 문법을 모두 꿰고 있어야 할 정도로 많은 지식을 알고 있지 않아도 금방 어지간한 웹 애플리케이션을 제작할 수 있다는 점이 주요 셀링 포인트라고 여겨진다.</p>\n<p>소위 \'Rails Magic\' 덕분에 form에 변수를 할당하는 것으로 경로 설정이 알아서 되거나 스캐폴딩만 해도 신기하게 돌아가는 애플리케이션을 보며 감탄했던 적이 한두 번이 아니었다.</p>\n<p>2016년 현재 레일즈는 버전 5까지 발매되었고, 더 많은 기능이 구현되어 있으며 커뮤니티는 많이 거대해졌다. 거대해진 레일즈 세계와 함께 그 음영을 느끼는 개발자들도 조금씩 늘어나게 되었다.</p>\n<p>예를 들어 보통 레일즈 애플리케이션을 오래 개발해온 사람들은 애플리케이션의 규모가 커질수록 유지보수하는게 힘들어진다는 점을 지적하고 있는데, 이를 해결하기 위해 <strong>Fat model, Skinny controller</strong> 등의 방법론이 제시되고 있지만 \'뭔가 문제가 있다\'는 의견들은 끊임없이 제시되고 있다.</p>\n<p>또한 DHH(David Heinemeier Hansson, 레일즈의 창시자)가 제시하고 있는 <a href="http://solnic.eu/2016/05/22/my-time-with-rails-is-up.html">\'Rails way\'에 반감을 가진 사람들이 점차 늘어나고</a> 루비로 웹 개발을 하는 것에 대해 <a href="http://rwdtow.stdout.in/">더 나은 방법을 찾는</a> 사람들이 점차 늘어나고 있다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 599px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 131.3856427378965%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABe2AlTSxFMuUv/8QAGRABAAIDAAAAAAAAAAAAAAAAAQACEBEw/9oACAEBAAEFAqmqxODj/8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQMBAT8BY//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Ain/xAAaEAADAQADAAAAAAAAAAAAAAAAAREQITFR/9oACAEBAAE/IYTxFLPKU5GXOpWf/9oADAMBAAIAAwAAABBv7vz/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EHDbIc//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxAp/8QAHhABAAICAQUAAAAAAAAAAAAAAQARITFBUWGBkaH/2gAIAQEAAT8QKn0nwj0BmUTlxMVEarzE8Q3EKIQbZTiXibZ3H3P/2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="현재 레일즈 커뮤니티"\n        title=""\n        src="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg"\n        srcset="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-28fc4.jpg 198w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-44f6c.jpg 395w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg 599w"\n        sizes="(max-width: 599px) 100vw, 599px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>현재 레일즈 커뮤니티의 묘사 - 출처: <a href="http://railshurts.com/current_state">http://railshurts.com/current_state</a></em></p>\n<p>이러한 분위기 속에서 \'Ruby way, not Rails\' 를 표방하는 루비 기반 웹 프레임워크가 등장하였으니, 바로 이번에 소개할 <a href="hanamirb.org">Hanami(하나미)</a>이다.</p>\n<h2 id="하나미가-뭐죠"><a href="#%ED%95%98%EB%82%98%EB%AF%B8%EA%B0%80-%EB%AD%90%EC%A3%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미가 뭐죠?</h2>\n<p>하나미는 이탈리아의 개발자 <a href="https://lucaguidi.com">Luca Guidi</a> 가 개발한 루비 MVC 웹 프레임워크이다. 2014년에 Lotus라는 이름으로 처음 등장하였으나, IBM의 Louts 상표권과 엮이는 문제가 있어 지금의 이름으로 변경하게 되었다.</p>\n<p>새로운 이름으로 <strong>하나미</strong>라는 이름을 쓰게 된 이유는 \'꽃구경\' 이라는 일본어 본래의 뜻에 걸맞게 함께 하는 커뮤니티의 중요성을 일깨운다는 점을 강조하기 위해서라고 한다. 루비의 창시자 Matz와(일본인이다) 루비 그 자체에 대한 찬사의 의미도 가지고 있다.</p>\n<p>하나미의 특징을 몇 가지 소개하자면 먼저 최대한 루비라는 언어를 직접적으로 사용하는 방식으로 구현되어 있다는 점이다. 다만 이 때문에 레일즈를 습득하는데 루비 지식이 크게 필요하지 않은 것과 다르게 일정 수준의 루비 언어의 이해를 요구한다.</p>\n<p>또한 Magic을 최대한 배제하고(하나미 Gitter 채팅방에서 혹은 몇몇 포스트에서 "I\'m now sick of rails magic!" 이라고 주장하는 사람들이 많이 보인다) 개발자가 최대한 자신이 무엇을 하고 있는지 인지하면서 앱을 제작하도록 유도한다.</p>\n<p>그리고 보통 Rails best practice 로 제시되는 요소들을 기본적으로 구현하고 있다.</p>\n<ul>\n<li>컨트롤러는 HTTP 콜만 다룬다 -> 액션에서 비지니스 로직을 분리하여 처리하기 위해 <code class="language-text">Interactor</code> 라는 모듈이 있다</li>\n<li>퍼시스턴스 로직과 도메인 로직을 분리한다 -> 하나미 모델은 기본적으로 도메인과 퍼시스턴스 레이어가 분리되어 있다</li>\n<li>루비 객체를 만들어서 제대로 OOP를 한다 -> 하나미는 OOP 개념을 잘 지키기 위해 노력한다. 또한 모듈화도 굉장히 쉽다</li>\n</ul>\n<p>하나미 가이드 페이지 첫머리에서 제시하는 <a href="http://hanamirb.org/guides/#why-choose-hanami-">\'하나미를 선택하는 이유\'</a> 를 가볍게 살펴보면 이렇게 말하고 있다.</p>\n<ul>\n<li>하나미는 가볍다 -> 상대적으로 짧은 코드, 웹 애플리케이션 개발에 필요한 필수적인 부분에 초점을 맞춤</li>\n<li>하나미는 구조적으로 건전하다 -> 컨트롤러 액션은 각각의 클래스로 분리되어 있으며 테스트하기 용이하다</li>\n<li>하나미는 스레드에 안전하다 -> (아직 이런 문제를 겪을만한 규모의 앱을 작성해본 적이 없어서 설명하기 어렵다)</li>\n</ul>\n<p>또한 하나미는 컨테이너 형태의 앱 구조를 기본적으로 제공한다. 덕분에 한 개의 프로젝트를 생성하여 API 서버와 웹 서버를 동시에 운용하는게 가능하다. 물론 레일즈로도 비슷한 구성을 할 수야 있겠지만 충돌 없는 구현을 위해 앱의 구조가 훨씬 복잡해질 가능성이 높다.</p>\n<h2 id="만들어-볼까요"><a href="#%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%BC%EA%B9%8C%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>만들어 볼까요</h2>\n<p>글을 길게 써 보았지만, 개발자들에겐 장황한 글보다 코드 몇 줄을 보는 것이 훨씬 이해가 빠를 것이다. 하나미의 공식 가이드를 따라가면서 눈여겨 볼 점들을 소개하겠다.</p>\n<h3 id="bookshelf-프로젝트-생성"><a href="#bookshelf-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bookshelf 프로젝트 생성</h3>\n<p>이번에 만들어볼 애플리케이션(이하 앱)은 <code class="language-text">Bookshelf</code> 라는 앱이다. 책의 제목과, 작가가 있고 이 책들의 리스트를 살펴보고 책을 추가할 수 있는 기능을 가지고 있다. 가이드에서 수정과 삭제는 다루고 있지 않아 조금 아쉬운 느낌이 들지만 기본적인 웹 개발(레일즈) 지식이 있다면 구현하는 것이 그렇게 어렵지는 않다.</p>\n<p>기본적으로 루비 버전은 2.3+ 을 권장한다. 또한 데이터베이스는 sqlite3를 사용할 예정이다.</p>\n<p>먼저 하나미로 프로젝트를 생성하기 위해서는 <code class="language-text">gem install hanami</code> 로 하나미가 설치되어 있어야 한다. 그 다음에는 새 프로젝트를 생성해본다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ hanami new bookshelf</code></pre>\n      </div>\n<p>생성된 프로젝트의 폴더 구조를 살펴보면 다음과 같다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ tree -L 2\n.\n├── Gemfile\n├── Rakefile\n├── apps\n│   └── web\n├── config\n│   ├── environment.rb\n│   └── initializers\n├── config.ru\n├── db\n│   ├── migrations\n│   └── schema.sql\n├── lib\n│   ├── bookshelf\n│   └── bookshelf.rb\n├── public\n└── spec\n    ├── bookshelf\n    ├── features_helper.rb\n    ├── spec_helper.rb\n    ├── support\n    └── web</code></pre>\n      </div>\n<p>여기서 특이한 점은 <code class="language-text">apps</code> 라는 폴더가 있다는 점인데 기본 컨테이너는 <code class="language-text">web</code> 이지만 사용자가 웹 브라우저로 보는 애플리케이션 이외에 같은 데이터베이스를 공유하는 api 서버 등을 따로 만들고자 하면 제네레이터로 따로 컨테이너를 생성할 수 있다. 그러면 같은 데이터베이스 사용하는 별개의 앱을 따로 구축할 수 있다는 장점이 있다. (물론 라우팅은 다르겠지만.. 이 부분은 <code class="language-text">mount</code> 옵션으로 처리할 수 있다) <a href="http://hanamirb.org/guides/getting-started/#hanami-architecture">- 참고</a></p>\n<p>각 앱들에는 별개의 설정 파일, 컨트롤러, 뷰, 라우트, 템플릿 파일 및 폴더가 있다.</p>\n<p>테스트는 사용자가 원하는 어떤 형태로도 이용할 수 있다.(minitest or rspec) 하나미에서는 minitest를 기본으로 사용하며 capybara 젬도 사용한다. 이번 포스팅에서는 테스트를 구현하는 부분은 넘어가고자 한다. 테스팅이 궁금한 분들은 공식 가이드를 참조하시라.</p>\n<h3 id="루트-페이지-만들기"><a href="#%EB%A3%A8%ED%8A%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루트 페이지 만들기</h3>\n<p>라우팅은 각 앱의 <code class="language-text">config/routes.rb</code> 파일에서 설정한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\n</code></pre>\n      </div>\n<p>그러면 home 컨트롤러의 index 액션을 실행해주기 위해 제네레이터로 액션을 생성해본다. 아직 하나미는 레일즈처럼 다양하고 세분화된 옵션의 CLI를 제공하진 않는다. 번거롭긴 하지만 개발에 큰 지장은 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web home#index\n    create  spec/web/controllers/home/index_spec.rb\n    create  apps/web/controllers/home/index.rb\n    create  apps/web/views/home/index.rb\n    create  apps/web/templates/home/index.html.erb\n    create  spec/web/views/home/index_spec.rb\n    insert  apps/web/config/routes.rb</code></pre>\n      </div>\n<p><code class="language-text">action</code> 뒤에 있는 <code class="language-text">web</code> 은 액션을 생성하고자 하는 컨테이너의 이름이다. 그 다음에 컨트롤러와 액션 이름을 적어주면 된다. 앱 구조가 단독 컨테이너 구조일 경우(<code class="language-text">hanami new</code> 커맨드로 앱 생성시 <code class="language-text">--arch=app</code> 옵션을 주어 단독 컨테이너 앱 생성도 가능하다)에는 바로 액션 이름만 작성해주어도 된다.</p>\n<p>아쉬운 점은 매 액션마다 저 명령어를 작성해주어야 한다는 점이다. <code class="language-text">hanami-scaffold</code> 라는 젬이 있지만 그닥 유지보수는 되지 않고 있어서 사용하는 것을 추천하지 않는다.</p>\n<p>컨트롤러는 폴더에 불과하며 그 폴더에 속한 각각의 액션 파일에 컨트롤러가 정의되어 있는 형태이다. 또한 뷰는 템플릿 파일(레일즈의 views 폴더 안에 있는 템플릿들)과 뷰 파일(레일즈에 비유하자면 뷰 헬퍼와 비슷)로 구성되어있다. 지금은 템플릿 파일에 간단하게 제목을 추가해보도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/home/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Bookshelf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><em>(주의) 템플릿 파일이 변경될 때에는 서버를 재실행할 필요가 없지만, 컨트롤러 등의 루비 파일이 변경될 때에는 서버를 재실행해야 한다.</em></p>\n<p>그리고 서버를 실행한 뒤 <code class="language-text">localhost:2300</code> 으로 접속해보면 심플하지만 Bookshelf라는 글씨가 보이는 페이지를 마주할 수 있다.\n(본 포스트에서는 빠른 진행을 위해 <code class="language-text">application.html.erb</code> 파일을 미리 수정해두었다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami server</code></pre>\n      </div>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 358px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 74.58100558659218%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQ4y81R32tSYRg+/8tyumBjEkxd5TKZRRlHnU70HM/x1/RibmArF5UXDRbtz/CmwfyVJ4i6qP6CdhEEbRmIO4pCA9F25Y+n93xk0MVawS468PB+7/c97/M833c446QeNuMlzC1chsGkw8WpafCORVgXbLhy1Yo5kxkms+UX5jTQ3njfbJmHTj+FC5MGTOj04Cwk6DLPw87fhOHaBBxWGyrZDFKrq0gmE3A6neB5Hi6XCy6qbrf7N4iiSMJmTM/MkLAB3G0i3aAh+3U77tziEQgEEBRExGIxhmQigXg8DkmSEA6HIQgC44wRDAbh9/vJkAw8HnAyEaVQCB6PG4IoQJZkJpDJZLC5mcEDQjqdprRJrKXWEIlEWCpZlplJiGa1tWYejUbBabG1RiIhLQEjiSEskUE0FodIabWhYCCI5WUfVihxJBKFz+dFIpEk8xUK44Fxdhb2RQe4fD6PcrmMUqkMRVGolqh/gVKxiEpFQZGqdlYsFNhZ5SenQL2ivGTr/N4ecrkcnu/ugsM5f5x6VMeH/X30ej2cnHzHwcEhvh0fo/rlEEeqik6ng/fv3qJa/coG+v0+BoPBqeDevH6FJa8Xz3Z28PjRQ6TvbiCbzWLryRY27t3H9vZTrKdS+PjpMxMcDIcYjUangut2u2g0GgQV9XodzWYTtVoNqtpAq9WiqqLdblOyARPUhv545X95n7PEmKBGGtI1zsJY7FwT/tVf/u8FfwCkJLVg24iPyAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf Title"\n        title=""\n        src="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png"\n        srcset="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-dc079.png 198w,\n/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png 358w"\n        sizes="(max-width: 358px) 100vw, 358px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="모델-구축하기"><a href="#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 구축하기</h3>\n<p>본격적으로 책들을 저장하고 출력하기 위해 데이터베이스 마이그레이션을 진행해 보도록 한다. 먼저 마이그레이션 파일을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate migration create_books</code></pre>\n      </div>\n<p>생성된 마이그레이션 파일은 이렇게 작성해 보았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/20161203083239_create_books.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:books</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:title</span><span class="token punctuation">,</span>  <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:author</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">primary_key</code> 가 반드시 <code class="language-text">id</code> 일 필요는 없다. 또한 <code class="language-text">String</code>, <code class="language-text">DateTime</code> 은 루비 타입이다(루비 클래스). 반드시 루비 타입을 사용할 필요는 없고 <code class="language-text">&quot;varchar(255)&quot;</code> 같이 데이터베이스 타입을 문자열로 직접 작성해주어도 된다.</p>\n<p>마이그레이션 파일 작성이 완료되면 테이블을 생성해주는 명령어를 입력한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami db prepare\n$ bundle exec hanami db migrate</code></pre>\n      </div>\n<p>그리고 <code class="language-text">Book</code> 모델을 생성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate model book\n      create  lib/bookshelf/entities/book.rb\n      create  lib/bookshelf/repositories/book_repository.rb\n      create  spec/bookshelf/entities/book_spec.rb\n      create  spec/bookshelf/repositories/book_repository_spec.rb</code></pre>\n      </div>\n<p>생성된 파일을 보면 조금 특이한 점을 볼 수 있는데 <code class="language-text">entities</code> 폴더와 <code class="language-text">repositories</code> 폴더가 따로 나뉘어져 있다는 점이다. <code class="language-text">Entity</code> 는 도메인 객체로, 실제 데이터베이스 쿼리 등으로 추출된 자료 객체를 일컫는다. <code class="language-text">Repository</code> 는 퍼시스턴스 계층과 <code class="language-text">Entity</code> 를 이어주는 역할을 한다. 여기서 <code class="language-text">Entity</code> 는 데이터베이스의 존재를 전혀 모르는 단순 루비 객체이며 테스트가 용이하고 가벼운 앱을 만드는데 도움이 된다.</p>\n<p>실제 콘솔에서 레코드를 다루어보면 이런 방식으로 동작한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami console\n&gt;&gt; repo = BookRepository.new\n=&gt; #&lt;BookRepository:... &gt;\n&gt;&gt; repo.all\n=&gt; []\n&gt;&gt; book = repo.create(title: &#39;TDD&#39;, author: &#39;Kent Beck&#39;)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;\n&gt;&gt; repo.find(book.id)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;</code></pre>\n      </div>\n<p><code class="language-text">Repository</code> (이하 리퍼지토리)에서 제공되는 메서드로 데이터베이스에 <code class="language-text">Entity</code> (이하 엔티티)를 조작할 수 있고, 엔티티에는 따로 속성 혹은 동작을 지정할 수 있다. 그래서 레일즈에서 사용하는 <code class="language-text">scope</code> 나 커스텀 쿼리가 작성된 메서드 등은 리퍼지토리 클래스에 분리해 둘 수 있다.</p>\n<h3 id="데이터를-표현하기"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%ED%91%9C%ED%98%84%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터를 표현하기</h3>\n<p>임의로 몇 개의 <code class="language-text">Book</code> 레코드를 생성해주고 리스트를 표현해보기 위해 새 컨트롤러 액션을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web books#index</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>All books<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;% if books.any? %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    &lt;% books.each do |book| %>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>book<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&lt;%= book.title %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;%= book.author %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    &lt;% end %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n&lt;% else %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>placeholder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>There are no books yet.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n&lt;% end %>\n</code></pre>\n      </div>\n<p>여기서 <code class="language-text">books</code> 는 어디서 온 것일까? 실제로 액션 부분은 이렇게 작성되어 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:books</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@books</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>all\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">expose</code> 메서드의 사용은 하나미의 규칙으로, <code class="language-text">expose</code> 로 지정한 변수만 템플릿으로 노출되며 그 변수는 <code class="language-text">call</code> 메서드 안에 인스턴스 변수로 존재해야 한다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 385px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 128.05194805194807%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAAC+0lEQVRIx61U/UtTURi+f0vq0n7oA0Q2P5L8ojLEocxtd03nvpztw2V/QBqmmRpYRjgrrIku06kUBEFQ6IhyZaap6Nb6oURJ3Jyi4rane44oaubHtQsP59z3nPc5z3PP+14mXnAc6fFCJKQJEXUmCqkJIkguZeNcRiYys7KQlp4BUWLSrkhMSkbM8ThEC2JxLFpAwYji4pCdeBYpF1MRkyCAuUCKxnIL9KVGWMwm6PU65IpzIRaLtyEvLw8KBQuhUISTp05DEHuCkjN5Egmyc3JwPusCLrNKyFg5dHo9R6SHwWBAaWkpnWs0GmjUGjoWFxdDJpNBLpeDVSjoSCCVysAolUoUKguRn59PTyQbCYHFYoHVaoXJaFwn42AoKYFWq4VarYZKpQLJZVkWEk4Uy+WqVAowZKGszAqj0QSz2QzjFSN0Wh10Oi2NEcuGEgOKioroISYuRubl5ddgMlug4AiTk1MglxbgqsUAxuPxYHJykmJqaoqCxDbiXq8XPp+Pvm9d2zone9ZjHjD4zw/T2+NEVdVNdHY50dXpwN2m++h29qCmuhp9vb2or2vAg2Yb3by2toZwOLwnGLd7EHa7HTbbQzja29DheIb2Dgfa7E/R43Si83k3Bt2fKCFJiEQieys8qBVCdiDLq6ur+D03h5mZGSwvL2NlZQWBQICOhCQUCm2SEXX7KnQN9KO27g4e2ZrRbGtBa+sTNDTUo+/Fy79s7ke2qXBhYQGLi0HMz89z8NPR7/cfWNU2QnJzxNZuz2GINgnHvo2iueUxrlfewPjEBA2SA7baPJTCVe7j//w1jbHxcc724jZlvBTuTNp6o7w6xcv1oGvAhaGhL3j7rh8jI6OI8LC6rbA3EkOh8JHsUsIgVzLT09OY44qbYHZ2FgEuxvsbvne5cKumBvW3a9F0rxGVFRV49frNodpt114mpbL+Nwlt1iUvhUtLS7RTSP/6/QFq90iEP3zf4Xa7MfR5CMPDX/Hh4yCCwSB/wn8t8L7ljXrbCb6kfwBgoxYXcTdGKQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf list"\n        title=""\n        src="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png"\n        srcset="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-54c53.png 198w,\n/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png 385w"\n        sizes="(max-width: 385px) 100vw, 385px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="새로운-책을-등록하기"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%B1%85%EC%9D%84-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 책을 등록하기</h3>\n<p>웹 페이지에서 새로운 책을 등록하기 위해서는 <code class="language-text">new</code>, <code class="language-text">create</code> 액션과 패러매터를 전달해 줄 <code class="language-text">Form</code> 이 필요할 것이다. 먼저 <code class="language-text">books#new</code>, <code class="language-text">books#create</code> 액션을 생성해 준 뒤에 라우팅을 조금 깔끔하게 다듬어주도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\nresources <span class="token symbol">:books</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:new</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>하나미는 REST를 기본적으로 지원한다. 2번째 줄에서 사용 된 <code class="language-text">resources</code> 는 보통 레일즈 라우트 파일에서 자주 보았던 그 <code class="language-text">resources</code> 메서드처럼 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami routes\n        Name Method     Path           Action\n\n        root GET, HEAD  /              Web::Controllers::Home::Index\n       books GET, HEAD  /books         Web::Controllers::Books::Index\n    new_book GET, HEAD  /books/new     Web::Controllers::Books::New\n       books POST       /books         Web::Controllers::Books::Create</code></pre>\n      </div>\n<p>다음은 <code class="language-text">new</code> 템플릿에 폼 헬퍼(Form helper) 를 이용하여 간단한 폼을 작성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/new.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Add book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;%=\n  form_for :book, routes.books_path do\n    div class: \'input\' do\n      label      :title\n      text_field :title\n    end\n\n    div class: \'input\' do\n      label      :author\n      text_field :author\n    end\n\n    div class: \'controls\' do\n      submit \'Create Book\'\n    end\n  end\n%>\n</code></pre>\n      </div>\n<p>폼 헬퍼의 구조가 레일즈의 <code class="language-text">form_for</code> 헬퍼와는 사뭇 다르다. 간단하게 차이점을 이야기하자면 하나미의 <code class="language-text">form_for</code> 는 레일즈의 <code class="language-text">form_tag</code> 헬퍼에 가깝다고 생각하면 된다. <a href="http://hanamirb.org/guides/helpers/forms/#technical-notes">하나미 가이드에 따르면</a> <code class="language-text">form_for do |f|</code> 형식으로 작성하는 것은 올바른 ERB 템플릿이 아니며, 하나미의 폼 헬퍼는 템플릿 엔진에 의존하지 않고 사용할 수 있도록(어느 템플릿 엔진을 사용하던 같은 루비 코드를 사용하도록) 구성되어 있다.</p>\n<p><code class="language-text">routes.books_path</code> 는 라우팅 헬퍼이며 상기 라우팅 구조에 있는 이름을 사용하여 <code class="language-text">routes</code> 뒤에 메서드 형식으로 붙여주면 자동으로 경로를 연결해준다.</p>\n<p>책을 생성하기 위한 <code class="language-text">create</code> 액션은 다음과 같이 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n      redirect_to routes<span class="token punctuation">.</span>books_path\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후 생성된 폼에 새로운 책을 등록해보니 문제없이 책이 생성되었다.</p>\n<h3 id="유효성-검사"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사</h3>\n<p>하나미는 유효성 검사를 모델이 아닌 컨트롤러 액션에서 처리한다. 물론 엔티티 클래스에 유효성 검사를 정의할 수 있지만, 유효성 검사는 입력 이후 가장 가까운 단계에서 이루어질 것을 권장하고 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:book</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:author</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">if</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n        <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n        redirect_to routes<span class="token punctuation">.</span>books_path\n      <span class="token keyword">else</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">422</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">params</code> 로 시작하는 유효성 검사는 엔티티를 정의해놓은 것 같은 역할을 할 수 있겠다. 자세한 내용은 <a href="http://hanamirb.org/guides/actions/parameters/">가이드</a>를 참고하면 손쉽게 작성할 수 있다.</p>\n<p>만약 패러매터가 유효하지 않다면 HTTP 상태 코드 422(Unprocessable Entity)를 리턴하고, 그에 알맞는 뷰를 다시 표현해 주어야 한다. 현재 <code class="language-text">create</code> 액션에는 아무런 템플릿도 작성되어있지 않고, 실제로는 <code class="language-text">new</code> 템플릿을 그대로 사용하면 되기 때문에 뷰 파일에 알맞는 템플릿을 정의해주면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/views/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Views</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">View</span>\n    template <span class="token string">\'books/new\'</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>지금까지 하나미를 통해 간단한 웹 애플리케이션을 개발하는 과정을 살펴보았다. 아주 기초적인 부분만 설명하였지만, 가이드를 살펴보고 하나미의 기능에 조금 더 익숙해진 뒤에는 github에 올라와 있는 몇몇 프로젝트 소스를 살펴보면서 하나미를 파악해보는 것을 추천한다.</p>\n<p>개인적으로 <a href="https://github.com/bruz/bookshelf-delivery-example">이 Github 저장소</a>를 방문해 보는 것을 추천한다. 하나미의 컨테이너 구조 및 컨트롤러 액션과 비지니스 로직을 구분하는 예를 잘 보여준 코드로 구성되어있다.(<code class="language-text">lib</code> 폴더 안에 있는 <code class="language-text">interactors</code> 폴더에 주목하라)</p>\n<p>본 포스팅에 사용된 코드는 <a href="https://github.com/emaren84/hanami-introduction">여기서</a> 확인해 볼 수 있다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>루비는 일반적 용도의 언어로써 충분히 완성도가 있는 언어이지만 상대적으로 다양한 분야에서 사용되는 파이썬에 비해 어느샌가 웹 개발에만 쓰이는 언어라는 선입견이 심어지게 되었다. 그리고 이러한 선입견의 중심엔 레일즈가 있다.</p>\n<p>레일즈가 등장하고 루비라는 언어가 크게 알려지는 데 기여한 것은 사실이다. 하지만 이 세상에 특정 문제 해결을 위한 단 하나의 정답은 거의 없다. 루비라는 언어 자체도 하나의 문제를 해결 하는데 다양한 방법을 제시하는 언어이기도 하다.</p>\n<p>하나미의 등장도 이런 맥락에서 바라볼 수 있다. 단순히 레일즈만이 루비로 웹 애플리케이션을 만드는 최고의 방법이 아니며, 하나미를 잘 활용하면 레일즈에 비해 유지보수가 쉽고, 더 성능이 좋은 웹 애플리케이션을 작성할 수도 있을 것이다.</p>\n<p>물론 하나미는 나온지 얼마 되지 않은 프레임워크이고, 기능 구현이 레일즈에 비해 상대적으로 부족한 점도 있다. <strong>특히 문서화가 되어있지 않아 소스 코드를 이리저리 살펴보아야 하는 부분들이 아직 많이 있다는 점이 아쉽다.</strong> 하지만 충분한 발전 가능성을 지니고 있고, 진정 루비라는 언어로 프로그래밍을 하는 재미를 주는 것이 매력적이기 때문에 루비 언어 자체를 좋아하는 사람들이라면 한번 사용해 볼 것을 추천한다.</p>\n<p>하나미의 정보를 더 얻고자 하는 분들에게는 다음의 링크를 살펴보면 된다.</p>\n<ul>\n<li><a href="http://hanamirb.org/guides/">하나미 공식 가이드</a> + <a href="https://github.com/hanami/hanami">소스 코드</a></li>\n<li><a href="https://gitter.im/hanami/chat">하나미 Gitter 채팅방</a></li>\n<li><a href="https://github.com/davydovanton/awesome-hanami">유용한 젬 및 링크 공유</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2016-12-03-hanami-introduction/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-03",path:"/posts/hanami-introduction",title:"레일즈(Ruby on Rails)와는 또 다른 루비 웹 프레임워크, Hanami(하나미)",tags:["Ruby","Rails","Hanami"],category:"Hanami"}},{excerpt:"Beginning of the Heonchek-hunter…",html:'<h2 id="beginning-of-the-heonchek-hunter"><a href="#beginning-of-the-heonchek-hunter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Beginning of the Heonchek-hunter</h2>\n<p>예전에 레일즈로 <strong>헌책 헌터</strong> 라는 이름의 웹앱을 한번 만들어 본 적이 있다.</p>\n<p>알라딘 중고서점에 원하는 책의 재고가 있는지 알아보고 해당 매장으로 가고 싶은데 일일이 매장을 하나하나 잡아서 검색해야하는게 너무 불편했었기 때문이다.</p>\n<p>잉여력이 넘치던 시절에는 서울 어지간한 지역에는 마음만 먹으면 방문할 수 있었기 때문에 꽤 유용한 아이디어라고 생각했는데, 지금은 딱히 그러기가 힘들다. 그래도 여러 개 매장의 중고책 재고를 검색하는데는 꽤 요긴하다는 생각이 든다.</p>\n<p>구현 원리는 생각보다 단순했지만 귀찮은 과정이었다. 알라딘 중고서점 검색 url은 하나만 제공되는데, 어떤 매장의 책을 검색하는지 구분하는 방법은 클라이언트가 가지고 있는 쿠키(cookie) 정보이다. 먼저 신촌점 페이지를 방문한 뒤에 검색을 하면 신촌점의 검색 결과가 나오고, 종로점 페이지를 방문한 뒤에 검색을 하면 종로점 검색 결과가 나오는 형식이다.</p>\n<p>다만 이 문제로 단순히 요청을 하고 결과를 받아오는 형식의 웹 크롤링을 해 주는 <code class="language-text">nokogiri</code> 젬은 쓸 수가 없었다. 이런저런 조사를 해 본 결과 <a href="https://github.com/sparklemotion/mechanize"><code class="language-text">mechanize</code></a> 젬이 웹사이트에 대한 자동 상호작용(automatic interaction)을 지원한다는 것을 발견하여 임의의 <code class="language-text">Mechanize</code> 객체가 가상으로 각 매장을 방문한 뒤에 책을 검색하고, 결과를 파싱해와서 html 페이지에 출력하는 방식의 구현에 성공했었다.</p>\n<h2 id="why-not-rails"><a href="#why-not-rails" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why not Rails?</h2>\n<p>여러가지 자잘한 문제가 있었지만, 일단 돌아가는 애플리케이션을 만들어서 쓰다 보니 조금 아쉽게 생각되는 점들이 있었다. 처음에야 가장 익숙한 웹 애플리케이션을 제작할 수 있는 도구인 레일즈로 제작을 하였지만, 여러 가지 이유에서 이 프로젝트를 제작하는데는 레일즈를 쓸 필요가 없었다.</p>\n<ol>\n<li><code class="language-text">rails new myapp</code> 를 입력하고 엔터를 치는 순간 나는 굳이 쓸 필요가 없는 파일들이 무더기로 생성된다. 미관상 마음에 들지 않는다.</li>\n<li>(지금 수준의 애플리케이션에는 차이가 크게 느껴지지 않겠지만) 레일즈는 다른 가벼운 웹 프레임워크에 비해 무겁다.</li>\n<li>DB가 필요없는 애플리케이션임에 불구하고 앱을 실행하기 위해서는 반드시 DB를 준비해야 한다. (Sqlite 등)</li>\n</ol>\n<p>제일 크게 느껴지는 문제는 1번 이었는데, 각종 컨트롤러 파일, 헬퍼 파일 등 나는 굳이 쓸 필요가 없는 파일들이 기본적으로 저장소에 자리잡고 있는게 마음에 들지 않았다.</p>\n<p>그리고 서울 지역 알라딘 중고매장 페이지를 모두 방문하고 정보를 긁어와야 하는 앱 구조상 동작이 꽤 느린데, 혹시나 더 가볍게 앱을 제작하면 속도가 더 빨라지지 않을까 하는 막연한 기대가 있었다.</p>\n<p>그래서 처음에는 요즘 야금야금 공부하고 있는 Node.js(노드) 로 크롤링 앱을 작성해볼까 했는데, 쿠키를 들고 리퀘스트를 보내는 등의 여러가지 시도를 하였음에도 불구하고 자꾸 결과가 나오지 않아 포기 상태이다. 루비에 비하면 월등히 빠른 처리 속도를 가지고 있는 노드를 활용해보려 했지만(싱글 스레드라는 단점이 있어도) 자꾸 500에러를 내뿜으니.. 나중에 다시 시도해보고자 한다.</p>\n<p>그래서 기존에 레일즈용으로 작성했던 로직을 가져와 또 다른 루비 웹 프레임워크인 시나트라로 다시 한번 더 나은 버전의 헌책 헌터를 구현해보기로 하였다.</p>\n<h2 id="what-is-sinatra"><a href="#what-is-sinatra" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Sinatra?</h2>\n<blockquote>\n<p>Sinatra is a <a href="https://en.wikipedia.org/wiki/Domain-specific_language">DSL</a> for quickly creating web applications in Ruby with minimal effort</p>\n</blockquote>\n<p>시나트라는 최소한의 노력으로 루비 기반 웹 애플리케이션을 신속하게 작성하기 위한 DSL이다.</p>\n<p>특히 Node.js 의 웹 프레임워크로 유명한 Express 에 영감을 준 것으로 잘 알려져 있다. 파이썬의 Flask와도 비슷하다는데 파이썬을 제대로 써 보지 않아서 모르겠다.</p>\n<p>Rack(루비 기반 웹 애플리케이션 개발을 위한 인터페이스 제공, Rack자체로도 웹 애플리케이션 개발은 가능하다) 기반으로 작성되어 있으며 흔히 생각하는 MVC 패턴을 구현한 웹 프레임워크는 아니다.</p>\n<p>RESTful 라우팅과 다양한 템플릿을 지원하고, 유저가 어느정도 직접 구현하면 레일즈로 만든 애플리케이션 부럽지 않은 웹 애플리케이션 제작이 가능하다. 보통 레일즈가 더 유명하고 편해서 그렇지.. 그렇지만 순수한 루비를 이용하는 느낌이 더 강해서 이쪽이 더 마음에 든다.</p>\n<p>데이터베이스와 연결하고자 하면 보통 ActiveRecord(그 레일즈의 ActiveRecord 맞다) 를 불러와 쓰거나, DataMapper 라는 젬을 이용한다고 한다.</p>\n<p>시나트라로 간단하게 Hello World를 출력하는 앱을 만든다면 한개의 파일, 약 4줄짜리 코드면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># myapp.rb</span>\n<span class="token keyword">require</span> <span class="token string">\'sinatra\'</span>\n\nget <span class="token string">\'/\'</span> <span class="token keyword">do</span>\n  <span class="token string">\'Hello world!\'</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>당연 그 전에 시나트라 젬은 설치되어 있어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># Install sinatra gem\n$ gem install sinatra\n\n# Launch the application\n$ ruby myapp.rb  # View at http://localhost:4567</code></pre>\n      </div>\n<h2 id="how-to-improve"><a href="#how-to-improve" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to improve?</h2>\n<p>그럼 이 시나트라를 이용하여 어떻게 기존에 작성한 애플리케이션을 재구성할 수 있을까? 기존에 작성한 소스는 그냥 정적 페이지로만 구성하였다. <code class="language-text">index</code> 액션에서 검색어를 입력받고 <code class="language-text">search</code> 같은 액션에 패러미터를 보내어 검색 후 결과가 나오면 <code class="language-text">result</code> 페이지에서 출력해주는 방식이다.</p>\n<p>어차피 검색하고 결과를 출력하기만 하면 되는데 페이지 여러개를 만들 필요는 딱히 없겠다는 생각이 들었다. 그래서 이번에는</p>\n<ul>\n<li>컨트롤러와 검색 로직의 분리</li>\n<li>AJAX 통신으로 초기 페이지에서 결과 부분만 따로 랜더링</li>\n</ul>\n<p>이 두 가지 포인트를 우선적으로 구현하는 것을 목표로 애플리케이션을 제작해 보았다. Single Page Application이라고 AngularJS 등의 거창한 자바스크립트 프레임워크를 쓸 수준은 아니기에 단순히 jQuery AJAX로 구현할 예정이다.</p>\n<h2 id="work-with-sinatra"><a href="#work-with-sinatra" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Work with Sinatra</h2>\n<p>시나트라는 <code class="language-text">rails new</code> 같이 편리한 CLI(Command Line Interface) 가 없다. 정말 위에 적은대로 루비파일 하나만으로도 만들 수 있을 정도이다. 조금 검색을 해 보니 따로 정립된 프로젝트의 형태는 없지만, 배포를 염두에 둔다면 시나트라 애플리케이션 구동 설정을 하는데 <code class="language-text">config.ru</code> 파일을 작성하길 권장하고 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># config.ru</span>\n<span class="token keyword">require</span> <span class="token string">\'./app\'</span>\nrun <span class="token constant">Sinatra</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Application</span>\n</code></pre>\n      </div>\n<p>그리고 <code class="language-text">rackup</code> 커맨드로 애플리케이션을 실행시킨다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ rackup -p 4000</code></pre>\n      </div>\n<p>기본으로 설정된 애셋 파일은 <code class="language-text">/public</code> 폴더에, 뷰 파일을 <code class="language-text">/views</code> 파일에 랜더링된다고 적혀있으니 컨트롤러인 <code class="language-text">app.rb</code> 파일은 루트에 두고 필요한 폴더를 작성하고 자바스크립트와 CSS 파일은 <code class="language-text">public</code> 폴더에, ERB파일은 <code class="language-text">views</code> 폴더에 작성하였다.</p>\n<h3 id="controller"><a href="#controller" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller</h3>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'sinatra\'</span>\nrequire_relative <span class="token string">\'./lib/book_search\'</span>\n\nget <span class="token string">\'/\'</span> <span class="token keyword">do</span>\n  erb <span class="token symbol">:index</span>\n<span class="token keyword">end</span>\n\nget <span class="token string">\'/search\'</span> <span class="token keyword">do</span>\n  book_title <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:title</span><span class="token punctuation">]</span>\n\n  <span class="token variable">@results</span> <span class="token operator">=</span> <span class="token constant">BookSearch</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span><span class="token punctuation">.</span>search\n  erb <span class="token symbol">:result</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span> results<span class="token punctuation">:</span> <span class="token variable">@results</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>검색을 위한 클래스를 따로 작성하여 <code class="language-text">/lib</code> 폴더에 저장해두었다. 지금은 기존에 레일즈용으로 작성했던 로직을 거의 그대로 사용한 클래스인데, 여러가지 면에서 개선할 점들이 많다.</p>\n<p><code class="language-text">erb</code> 로 템플릿을 지정하고 심볼로 파일 이름을 지정하면 해당 이름의 템플릿을 찾아서 html 파일로 랜더링한다. 굳이 <code class="language-text">index.html.erb</code> 같은 이름이 아닌 <code class="language-text">index.erb</code> 로 작성하여도 잘 작동하는게 신기했다. 또한 이 부분은 나중에 <code class="language-text">result.erb</code> 파일에도 중요한 포인트로 작용한다.</p>\n<p><code class="language-text">locals</code> 옵션은 레일즈의 <code class="language-text">render partial</code> 이후 지역변수를 삽입해주는 것과 비슷하게 작용한 것 처럼 보여서 사용해보았다. 사실 굳이 쓰지 않고 그냥 <code class="language-text">@results</code> 를 그대로 사용해도 별 문제 없어 보인다.</p>\n<h3 id="searching-books"><a href="#searching-books" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Searching Books</h3>\n<p>맨 처음 레일즈용으로 앱을 작성할 당시에는 컨트롤러에 프라이빗 메서드 하나 작성해 두고 거기다 모든 과정을 다 처리했었다. 처음엔 \'나중에 리팩터링 하면 되지\' 하고 생각했지만 이렇게 아예 새로 만드는 방향까지 와 버렸다.</p>\n<p><code class="language-text">BookSearch</code> 라는 클래스를 하나 정의하여 거기에 매장 리스트, 매장 방문 URI, 검색 URI 등을 상수로 지정해 두고 시작하는 형태이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span>\n  <span class="token variable">@book_title</span> <span class="token operator">=</span> book_title<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">\'euc-kr\'</span><span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\n  <span class="token variable">@agent</span> <span class="token operator">=</span> <span class="token constant">Mechanize</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n  <span class="token variable">@result</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>인자로 받는 <code class="language-text">book_title</code> 은 인코딩을 반드시 바꾸어 주어야 한다. 알라딘 홈페이지는 EUC-KR 인코딩을 사용하기 때문이다. 국내 사이트는 정말 어쩔수가 없는건지.. <code class="language-text">@agent</code> 는 알라딘 서버와 연결 상호작용을 수행할 <code class="language-text">mechanize</code> 젬의 객체이다. 기존에는 매 검색마다 객체를 생성하도록 코드를 작성했었는데 전혀 그럴 필요가 없다는걸 뒤늦게 깨달았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># ...</span>\n<span class="token keyword">def</span> search\n  <span class="token constant">STORE_LISTS</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>store_code<span class="token punctuation">,</span> store_name<span class="token operator">|</span>\n    <span class="token comment"># 개별 매장 검색 시작</span>\n    search_results <span class="token operator">=</span> <span class="token function">get_books</span><span class="token punctuation">(</span>store_code<span class="token punctuation">)</span>\n    <span class="token variable">@result</span><span class="token punctuation">[</span>store_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">serialize_info</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token variable">@result</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">private</span>\n\n<span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span>\n  store_index <span class="token operator">=</span> <span class="token variable">@agent</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span>\n  store_form <span class="token operator">=</span> store_index<span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">\'QuickSearch\'</span><span class="token punctuation">)</span>\n  store_form<span class="token punctuation">[</span><span class="token string">\'SearchWord\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">@book_title</span>\n\n  query_result <span class="token operator">=</span> <span class="token variable">@agent</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>store_form<span class="token punctuation">)</span>\n  query_result<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">\'EUC-KR\'</span>\n\n  query_result\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">get_books</span><span class="token punctuation">(</span>store_code<span class="token punctuation">)</span>\n  store_url <span class="token operator">=</span> <span class="token constant">URI</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">STORE_URI</span> <span class="token operator">+</span> store_code<span class="token punctuation">)</span>\n  <span class="token function">query</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'div.ss_book_box\'</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">serialize_info</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>\n  <span class="token comment"># 검색 결과가 있다면 검색 시작, 아니면 빈 배열 입력</span>\n  <span class="token keyword">return</span> search_results <span class="token keyword">if</span> search_results<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n\n  <span class="token comment"># 매장별 결과는 배열로 리턴 (각 배열의 요소는 해쉬)</span>\n  search_results<span class="token punctuation">.</span>map <span class="token keyword">do</span> <span class="token operator">|</span>book<span class="token operator">|</span>\n    book_info<span class="token punctuation">,</span> price_info <span class="token operator">=</span> book<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'div.ss_book_list\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0.</span><span class="token number">.1</span><span class="token punctuation">]</span> <span class="token comment"># Pattern matching</span>\n\n    title <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'a.bo_l b\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n    sub_title <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_f_g2\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n\n    author_list <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'ul > li\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' | \'</span><span class="token punctuation">)</span>\n\n    author<span class="token punctuation">,</span> publisher<span class="token punctuation">,</span> pub_date <span class="token operator">=</span> author_list<span class="token punctuation">[</span><span class="token number">0.</span><span class="token number">.2</span><span class="token punctuation">]</span>\n\n    price <span class="token operator">=</span> price_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_p2 b\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text\n    stock <span class="token operator">=</span> price_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_p4 b\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n\n    <span class="token punctuation">{</span>\n      title<span class="token punctuation">:</span> title<span class="token punctuation">,</span>\n      sub_title<span class="token punctuation">:</span> sub_title<span class="token punctuation">,</span>\n      author<span class="token punctuation">:</span> author<span class="token punctuation">,</span>\n      publisher<span class="token punctuation">:</span> publisher<span class="token punctuation">,</span>\n      pub_date<span class="token punctuation">:</span> pub_date<span class="token punctuation">,</span>\n      price<span class="token punctuation">:</span> price<span class="token punctuation">,</span>\n      stock<span class="token punctuation">:</span> stock\n    <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">query</code> 메서드는 생성한 에이전트로 중고매장 각 지점을 임의로 방문한 뒤에 생성된 쿠키를 들고 책을 검색하는 역할을 수행한다. 초반부에 서술했듯이 검색을 할 때 매장이름을 패러미터로 받는 것이 아니라 요청한 클라이언트가 들고있는 쿠키로 어느 매장의 책을 찾고자 하는지 조회하기 때문이다.</p>\n<p>중요한 점은 여기서도 출력된 결과물을 EUC-KR 인코딩으로 바꾸어주어야 한다는 것이다.</p>\n<p><code class="language-text">get_books</code> 는 각 매장 코드와 매장명을 가지고 있는 해시로 반복문을 돌 때 <code class="language-text">query</code> 메서드를 매번 다른 매장명으로 실행시키고 그 결과를 출력하는 부분을 담당한다. <code class="language-text">css</code> 는 <code class="language-text">nokogiri</code> 젬에서 지원하는 메서드로 파싱한 결과를 말 그대로 css 선택자처럼 사용하여 결과를 가져올 수 있도록 만든다. 선택자로 선택된 DOM들은 <code class="language-text">nokogiri</code>의 객체가 담긴 배열로 리턴된다. (nokogiri 젬은 웹 크롤링에 사용되는 대표적인 루비 젬이며 <code class="language-text">mechanize</code> 젬과 의존관계를 형성하고 있다.)</p>\n<p>그리고 이를 이용하여 <code class="language-text">serialize_info</code> 메서드를 실행하여 원하는 결과를 출력하는 방식이다. 각각 어떤 결과를 가져와야 하는지는 알라딘 검색을 직접 해 보고 크롬의 개발자 도구로 html 코드를 뒤져 찾아내었다.</p>\n<p>변수 할당에 패턴 매칭이 들어간 점도 눈여겨 볼 수 있다. 배열의 요소 하나하나를 변수에 할당한다고 한줄씩 코드를 작성하는 것 보다 배열의 범위와 그에 맞는 개수의 변수를 할당해주어 여러 줄로 작성할 코드를 손쉽게 한 줄로 줄일 수 있었다.</p>\n<h3 id="views"><a href="#views" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Views</h3>\n<p>뷰 파일들은 레일즈로 작성할 때 <code class="language-text">html.erb</code> 템플릿과 크게 차이는 없었다. 단순히 <code class="language-text">erb</code>  확장자만 넣어도 그대로 작동한다는 것만 빼면 컨트롤러 부분에서 보다시피 어떤 인자를 가져올 것인지 주입할 수도 있고, 템플릿을 바꾼다던지 할 수도 있다. 다만 내가 여지껏 깨닫지 못했던 흥미로운 요소가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// public/script/app.js</span>\n<span class="token comment">// ...</span>\n  $<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'/search\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> bookTitle <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    $dimmer<span class="token punctuation">.</span><span class="token function">dimmer</span><span class="token punctuation">(</span><span class="token string">\'hide\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>indexPage <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'.ui.main.text.container\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>$result_partial<span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">\'result_container\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      $result_partial<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">\'result_container\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    $result_partial<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    $result_partial<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">\'slide down in\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>다음은 내가 책 검색을 비동기로 처리하기 위해 작성했던 AJAX 호출이다. 함수 자체야 별거 없는데 성공 후의 콜백에서 <code class="language-text">$result_partial.html(data);</code> 부분이 핵심이다. 저 <code class="language-text">data</code> 인자는 컨트롤러에서 어떤 방식으로 전달되었을까?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># app.rb</span>\n<span class="token comment"># ...</span>\nget <span class="token string">\'/search\'</span> <span class="token keyword">do</span>\n  book_title <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:title</span><span class="token punctuation">]</span>\n\n  <span class="token variable">@results</span> <span class="token operator">=</span> <span class="token constant">BookSearch</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span><span class="token punctuation">.</span>search\n  erb <span class="token symbol">:result</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span> results<span class="token punctuation">:</span> <span class="token variable">@results</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>액션 실행 후 리턴은 erb로 한다고 작성되어 있다. 말인 즉슨 랜더링 처리가 다 된 erb 파일을 콜백 함수의 <code class="language-text">data</code> 인자로 전달한다는 것이다. 보통 레일즈에서 작성했다면 <code class="language-text">respond_to</code> 메서드로 어떤 포맷에 반응하여 출력할지를 지정해주어야 했을 텐데, 오히려 그런 면에서 신경 쓸 필요가 전혀 없었다. 랜더링된 <code class="language-text">result.erb</code> 는 그냥 html 코드 덩어리나 다름없겠다는 생각에 jQuery의 <code class="language-text">html()</code> 함수에 넣어보았다. 아주 잘 작동하였다.</p>\n<p>여지껏 \'Rails way\' 로 작성한 AJAX 호출에 익숙해져 있다 보니 이런 방식으로 결과를 출력할 수 있다는게 새삼 새롭게 느껴졌다.</p>\n<h2 id="conclusion"><a href="#conclusion" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>\n<p>이번에는 아주 간단한 기능 위주로 작성해본 것지만, <a href="http://hanamirb.org">하나미</a> 를 시작으로 점점 레일즈를 벗어나 루비로 웹 애플리케이션을 작성하는데 익숙해지고, 더 재미를 느끼고 있다.</p>\n<p>앱 특성상 레일즈와 비교하여 검색 결과를 출력하는 속도가 압도적으로 빠르다고 느끼진 못했다. 아마 일반적인 형태의 홈페이지로 비교한다면 조금 다른 결과가 나올지도 모르겠다.</p>\n<p>특히 지금처럼 모든 웹 애플리케이션이 데이터베이스(혹은 모델)을 필요로 하는 것은 아니다. 이런 경우에는 레일즈보단 시나트라로 작성하는게 더 나아 보인다.</p>\n<p>앞으로도 더 복잡한 애플리케이션을 쉽게 잘 작성해보고 싶다. 공부해야할 것들이 너무나 많지만, 지금은 자바스크립트 위주의 공부부터 차근차근 도전중이다.</p>\n<p><strong>Source Code</strong>: <a href="https://github.com/emaren84/heoncheck-hunter-sinatra">https://github.com/emaren84/heoncheck-hunter-sinatra</a></p>',id:"/home/circleci/repo/src/pages/posts/2016-11-21-simple-spa-application-sinatra/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-11-21",path:"/posts/simple-spa-application-with-sinatra",title:"시나트라(Sinatra)로 간단한 Single Page Application(SPA) 제작해 보기",tags:["Ruby","Sinatra"],category:"Ruby"}}],OOP:[{excerpt:"이 글의 원문은  Michał Konarski…",html:'<ul>\n<li>이 글의 원문은 <a href="http://mjk.space/how-to-avoid-inheritance-in-ruby/">Michał Konarski</a>가 작성하였습니다.</li>\n<li>번역 실수 및 용어 사용의 지적 등은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>상속이 왜 문제가 될까요? 예를 하나 들어드리겠습니다.</p>\n<p>여러분의 고객이 \'교통 상황 시뮬레이터\'를 만들어달라고 요청했다고 해보죠. 고객은 몇몇 자동차가 움직이는 모습을 실험해보고 싶어합니다. 만약 루비같은 객체지향 언어를 사용한다면 먼저 모든 로직과 속성을 담고 있는 모델 클래스를 떠올리게 됩니다. 이렇게요.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 136px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50.73529411764706%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABlUlEQVQoz62SyU4CQRRF8bNc+AGu/BDWim4YNiQaV67QsDFqHIgyis2ktHHCCIgM3dD0wKAoIsqgkFRSz6oGGhJXJnRy0q9e7r016qJCYEY3pS/IuQZZ7tTebIhzm0Ocx0BY+Q9h3mMIcm6LI26f05KvpaipAXUQW0VQupKKTOmIE0yMhxoK9VBvmPeuaoE3MmuQ2kXIvmb6BJSppRFXz6HCR16Db3Ao3+CR0Cwg7p1TNVRLPVJbhEj+1DwOlNhlpSvDMAzn6lnM3J3hQ+YAn0SOsevCiYP3AczEGLV3X4zh3FsWUy31KN8yCfRZJleoBaZfnjBZBfiuvGBZN4NxzQj2IztYN6ywuW8D/aIeyCRANVRLPaU/gRK7JLYEIDP26VZG2yEGFFce1DpZTqh1ohRHqeojGh0N+ffEtgAR3mfSAm/lS9MnNMkhK1D5KQ/oUSrw3K+qdbU/qClV0h9plI4CX8R7nvePL8WfccyT97jDCkEbYWtEtBBQYYWAVo97ms4WLTC7zuT2ghrWRmha71pX6zR0v7xe4phLYWhMAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle Class"\n        title=""\n        src="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png"\n        srcset="/static/2017-07-16-sc1-2e83a320a96db4a01c9b4553157907f6-9805c.png 136w"\n        sizes="(max-width: 136px) 100vw, 136px"\n      />\n    </span>\n  </span>\n  </p>\n<p>완성된 결과물을 고객에게 보여주었습니다. 다 괜찮았는데 이제 고객이 자동차가 \'승용차\' 혹은 \'트럭\' 으로 나뉘었으면 좋겠다고 합니다. 이런 경우 두 차종은 최소한 일부 행동을 공유하고 있있는데다, 코드를 반복해서 작성하는 것도 별로 내키지 않습니다. 문제 없어요! 상속을 활용하면 되죠! 지금 마주친 경우는 아주 적절한 \'-이다(is-a)\' 관계입니다. 안 될 것 있나요?</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 424px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.443396226415096%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB30lEQVQoz2NgQAMn7h9mBNFH7+23OvPoRMvll+drrr29XHvpxfmaUw+PNR25u1cOLH93PyMDMeDEnaMsIPr0w+PNP/9//3/h8fn/J24d+3/j9fX/X/9//n/83iFXkPzhG/uZsRpw7P4Bhr1XtjP8//8fzAfSTCD6zJPjcWcfnrp7+PrBS8dvHTl79Mbhy2cenrx19tlxA2R1IH3bz25kOPnoMMP2K2tQzAZ5AWQrSCGLlp0sM7cQu7CilqwQSFJaWVyYW4hNSF5XHCwPVYfpygXnOtgqp2dxWLkbi1r7GAmYu+sLCEsIcAOluICYDU05B0hcTl2Kx9LTQMA52FrQKcBa5NjvNazdm8vYJu2tZmK48PTs7TMPTp44cfvomcsvLp688OzsidNPD+tAvcPYPq2F4cqbCwxrD6wE88Hh+/ho4OXnF64Cg+T4MWBwnHt05vTFp+fOHri1I4jh7/8//2++ufn/7P0z/18B4bPfT/8fu3vAAaRx68kNcC8xMjIyHLx0EMw/9eBY0c//P/7ffnfr/8lbJ/7f/3z//1sgPHxnbyFQ8uiU04+OtwNxJzBmO08+ONKx7+Y2eZBGoI3wpLHp4lIGoBow/9Cd3RbAJDTx7OMTYH1ANgh37b6+yRwAIIsHylqv15gAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with inheritance"\n        title=""\n        src="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png"\n        srcset="/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-20168.png 198w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-b3d3b.png 395w,\n/static/2017-07-16-sc2-fa7f9df8054d6743399cc2574b2c80e3-11014.png 424w"\n        sizes="(max-width: 424px) 100vw, 424px"\n      />\n    </span>\n  </span>\n  </p>\n<p>고객은 결과물에 또 만족했지만, 또 다른 추가사항을 요구했습니다. 이 자동차들이 다른 종류의 엔진을 탑재했으면 한다고 합니다. 예를 들어 석유 엔진과 전기 엔진으로요. 다시 한번 상속을 사용해서 문제를 해결해보겠습니다!</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 562px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACUUlEQVQoz6VSS2sTURSeJhXbjVECYrXQ1C5cZNOdIiio1F1EEFy70aJVpOBGhFr9AW7agiBBMAYj2DTapHnPjJn3TCaZmbwzySSTZJz0IYIiZlG9zqRuWrLzwOXc+z0O595zIWhAvPywNGTmcM5vFzT+DSUT74zlEzq8O5xbPWZyS74XQ4O8EF6H+5lsIhCtEFYddCwAAKuJ0Ro6nvsiAapCArpKAUkTeqyOnjQ5U6ODtoWu41ZKRf7VSu4vejCmzztH55/POaP5jxNhcc3xcPGu88z01MggLVZL7t8g5chRvsNcTYpRF15BXakKfHnm+qXhg8b7T2YPYVXkClpIurAS4jI8M3A5fMTkUrUEBLEqYTEPRA29oO9qoLRdBO1eC0h6tgfLoX43SDFmwWXEsmeK2SRd2FW+10FhMw9avSYg6+hZk2OauMXssP+4ua/pE2mVebROBJ4mstEFscvfTm9hwyueZYjtYBCtpvo6uo0eljYzd+KZ6ELg8+oi32LnpR3u+N5tE4MH9V8Rq/ptsBwc9ybdkykl4oiVAjasGbMbQ5jywu6J/E967D3pHvHzntHiL27ME3/liEhrp5FayE5pSRu/jTvcwZVJWodPoWrQBglaxlfaKoIoE/nd+KEAqZt9zKucR+yIIMHHgfytAkQ9czPT5m6Vd0p9rNDNg2yHf80o5DNJEwEiwH/EtgAYhfJC6Rb9gGvQ60QFe2vkCNcir3EqdY+WiRBZxb2sQm1wLeocq5IXDcOGiTF1MmT4ZukGdoOS8bDx6U3sE9Mg5v4CEGx46+zImFIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Vehicle with even more inheritance"\n        title=""\n        src="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png"\n        srcset="/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-8c8bd.png 198w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-e07aa.png 395w,\n/static/2017-07-16-sc3-ea0481feb5f8dca30a8d25a48403b0b1-7f0b2.png 562w"\n        sizes="(max-width: 562px) 100vw, 562px"\n      />\n    </span>\n  </span>\n  </p>\n<p>여러분의 고객은 \'지금은\' 아주 행복합니다. 하지만 또 세분화를 요구한다면 어떻게 될까요? 전용차라던가, 경찰차라던가, 소방트럭이나 앰뷸런스 등 이보다 더 많은 세분화를 요구한다면? 우리의 상속 트리는 점점 커지고 복잡해지게 됩니다. 반복되는 코드를 줄이는 대신에 결국 같은 로직을 여러군데 복사-붙여넣기 하게 될 것입니다. 심지어 <a href="https://en.wikipedia.org/wiki/Combinatorial_explosion">위키피디아에도</a> 이 현상이 기재되어 있습니다.</p>\n<p>위에서 말씀드린 사례는 제가 가볍게 지어낸 경우가 아닙니다. 저는 전문 개발자로 일하면서 오래된 코드에 새로운 기능이나 행동을 추가하려 할 때마다 이런 상황을 여러 번 접했습니다. 특히 여러분이 레일즈를 사용하면서 더 자주 접하실\n수 있습니다. <code class="language-text">ApplicationRecord</code> 나 <code class="language-text">ApplicationController</code> 를 상속하도록 강제하는 경우가 많기 때문입니다.</p>\n<p>상속이 발생하는 코드를 예로 보여드리겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Truck</span> <span class="token operator">&lt;</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span> <span class="token operator">&lt;</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span> <span class="token operator">&lt;</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다 (반복되는 코드!)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 코드를 더 낫게 만들 수 있을까요? 가능합니다.</p>\n<h2 id="아마도-믹스인mixin을-쓰면"><a href="#%EC%95%84%EB%A7%88%EB%8F%84-%EB%AF%B9%EC%8A%A4%EC%9D%B8mixin%EC%9D%84-%EC%93%B0%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>아마도 믹스인(Mixin)을 쓰면?</h2>\n<p>수 많은 루비 프로그래머들이 상속이 문제를 해결할 수 없다고 깨닫는 순간, 가장 먼저 떠오르는 해결책은 믹스인일 겁니다. 믹스인이 뭘까요? 기본적으로 메서드들이 정의된 모듈을 클래스에 포함하여 그 클래스의 일부로 사용하는 기법입니다. 우리는 간단히 공통된 로직을 추출하여 코드의 재사용을 피할 수 있습니다. </p>\n<p>믹스인을 사용하면 코드가 어떻게 바뀔까요? 먼저 <code class="language-text">include</code> 하게 될 모듈을 만들겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Vehicle</span>\n  <span class="token keyword">def</span> run\n    refill\n    load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Truck</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">Car</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">module</span> <span class="token constant">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 믹스인할 대상이 되는 클래스를 만듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">PetrolCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Car</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">PetrolEngine</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">ElectricTruck</span>\n  include <span class="token constant">Vehicle</span>\n  include <span class="token constant">Truck</span>\n  include <span class="token constant">ElectricEngine</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>좀 보기 좋습니다. 코드가 반복되지도 않았고, 새로운 종류의 특성을 넣어서 어떤 종류의 차량이라도 만들어낼 수 있게 되었습니다. 게다가 차량이 어떤 기능을 가지고 있는지도 눈에 잘 들어옵니다.</p>\n<p>하지만 여전히 문제가 남아있습니다. 클래스를 살펴보면 포함된 행동들이 어떻게 사용되는지 명확하지 않습니다. 믹스인으로 새로운 메서드들이 추가되었지만 이 메서드들이 무엇을 하는지, 클래스가 어떻게 메서드와 영향을 주고받는지, 실행되는 과정은 어떻게 되는지 바로 파악할 수 없습니다. 만에 하나 같은 이름을 가지고 있는 두 모듈을 가져와 사용한다면 문제가 발생하게 됩니다. 한 모듈이 다른 모듈에 있는 메서드를 \'조용히\' 가져와서 사용하게 되겠지요. 상속 할 클래스가 늘어나면서 생기는 문제와 비슷한 방식으로 코드가 엉망이 되기 시작합니다.</p>\n<p>믹스인은 확실히 좋은 사용처가 있기 때문에 그렇게 나쁜 방법은 아닙니다. 제 의견으로는 로깅, 인증, 유효성 검사 등 클래스의\n메타행위(meta behavior)를 정의할 때는 아주 잘 동작한다고 생각합니다. 믹스인은 코드를 깔끔하고 작은 규모로 유지할 수 있다는 명확한 장점이 있습니다. 여러분이 모듈에 정의되어 있는 구현을 믿고 있고, 서로 다른 로직을 무너뜨리지 않는 지점을 파악하고 있는 한 괜찮습니다. 기억하셔야 할 점은 이는 단지 <strong>루비가 은연중에 다중 상속을 구현하는 방법</strong>에 불과하다는 점입니다.</p>\n<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">In OOP there’s this thing to prefer composition over inheritance. And in Ruby people constantly forget that modules == multiple inheritance</p>&mdash; Piotr Solnica (@_solnic_) <a href="https://twitter.com/_solnic_/status/623224611212251136">July 20, 2015</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>\n<p>이 문제를 개선할 수 있을까요? Yes, we can!</p>\n<h2 id="조합"><a href="#%EC%A1%B0%ED%95%A9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조합</h2>\n<p>조합은 저도 오래전에 알고 있었지만 최근에야 사용하기 시작한 용어입니다. 단지 조합을 충분히 편하게 사용할만큼 좋다는 <em>느낌을 받지 못했습니다.</em> 그러던 어느 날 Sandi Metz의 <a href="https://www.youtube.com/watch?v=OMPfEXIlTVE">\'Nothing is Something\'</a> 이라는 아주 환상적인 발표를 보게 되었습니다. 다른 것 보다 그녀는 조합에 대해 이야기하면서 제가 예를 들었던 문제(교통 상황 시뮬레이터)를 풀어냈습니다.</p>\n<p>조합은 어떤 방식으로 동작할까요? 클래스 사이에 <strong>같은</strong> 행위를 공유하려 하기보다, 어떤 요소가 <strong>다른</strong>지 알아낸 뒤에 이름을 붙이고, 개별 클래스로 추출해낸 뒤에 마지막에 하나의 객체로 합치는 방식으로  동작하게 됩니다.</p>\n<p>상속이 \'-이다(is-a)\' 관계를 나타낸다면 조합은 \'-를 가지고 있다(has-a)\' 관계를 나타냅니다. 그러므로 조합을 활용하기 위해서 문제의 구조를 바꾸어야 합니다. 우리의 차량은 더 이상 전기자동차가 아니라, 전기 엔진을 가진 자동차 입니다(Our vehicle <strong>is not</strong> an electric vehicle anymore but rather it <strong>has</strong> an electric engine). 트럭은 그냥 트럭이 아니고 자동차가 트럭의 몸체를 가진 것입니다(It <strong>is not</strong> a truck but it <strong>has</strong> a truck body). 이렇게 우리는 두 가지 개념을 잡아냈습니다. 바로 <strong>엔진</strong> 과 <strong>몸체</strong> 입니다.</p>\n<p>우리의 애플리케이션은 이제 아래와 같은 모습이 되었습니다. 엔진과 몸체 컨셉을 구현한 뒤에 <code class="language-text">Vehicle</code> 클래스 안에 엔진과 몸체가 들어갈 자리를 마련했습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 373px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 76.67560321715818%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADhElEQVQ4y5WU34sbVRTHJ10CEfwPBNEHX8UX8UVsUV9EQQVXiw9aLOiT0LqwYhfUsrD1qSLaBREfLNqyKD5I3UXbJrv5NZlkJpP5sROT+T2ZH8nm90w26e4kc7x3dIW+CL1w+N5zBj5z7nfOXIJ4gAUAsVaUybLchdVmFy7IPbiI9hfq3uLjDN9/mrhOfrV0o3ztoZ+oa6kt5tsUHdxJ1e7tpu5av6R+JL9J3Sxvpm6UN9Hz75ZOwFUt4OrOEdCNXhyVv7rQngGU5ck6UdJz51ibtmtOla/ZjFTWShKlkhJtliVUwyGiul7QMq+dAGv69FdK6oxytVYry1puuqK2qvLQLzWCDwnaolY7URsavQbIgyak2TTskNuQFbKgjVVo9hvgHNlAGYXzGHZ+42wiX/c/EF24iuKK6MEXUgc2uNbiy+2yd4aoWORHxqEOYps/Er3aXPBqC8HFwS5wjurHyrCJgPl3T3wsiO09UnQgX7PCXVpb7FX1Y8EIgJKDVdzhijnVQbBb4b4ziCRvAPX2CCR3AKI9iHjbmKu+jDs8h4HLCEhKPYpVx1DgHaDqXcjQGoitGRTr4zWCaVErxqGKAKOw4UJ0m5Th910RcqwDygFEgt2Zq2PcYTEGfr+9eaqszp5SR/C8MoDTzT6cQfvTch9e+JM5eDTu0DhEb7DbYd2dRqzWBVpuA2+iTlEu2DbqEAML8ZH3O/zS/84WbZVWrKkBgseHvMtFSCEOlwecix4/18bKfx6KHXbp4eeuLD22/EPyxbVK8qXLXPKJt28mU89uJB9/ffNUDIw9dNQQdRPtew40ugeAFfkaCY58n4fEI0SC1afXRWumsJrPs6ovCuaUk5xjPS8N3yMY6x8PRbsfotNGBd6NbmX4iFX8SI09bN/nIV6SG0rDBUBRcCBbNdBwdwGvUsO/jD/KReyRaPdmcgdCTvfDHBoHrDgXbO9ec1DHwHcw7OXPzibKcrAuWEe/ccZsC+nPNWO6xZmzW7tC/1WiYpJrIxiAOjZAnzhgTT00yF0wkeqBA1pgQg8OAP1R72PgK2tvJaim/zWt+EVGDe6WG6MMrQR3kA1Umuu9SeTV9DMIus60yE/oVvESbRUuVcx8rAzOcd0qfZ6Vbz95cuS6O5ecCQDT7OHhRmECSoHRZp8SD3bbmIl/b5urvDXbY1R/h9UmfzDKeIczDnNZcfjG37JmJTRNQVyIAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Composition in action"\n        title=""\n        src="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png"\n        srcset="/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-c12ac.png 198w,\n/static/2017-07-16-sc4-b6caad80a0028f7518410ecd07b25a64-a1aef.png 373w"\n        sizes="(max-width: 373px) 100vw, 373px"\n      />\n    </span>\n  </span>\n  </p>\n<p>실제 코드는 어떻게 될까요? 핵심 클래스부터 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span><span class="token punctuation">)</span>\n    <span class="token variable">@engine</span> <span class="token operator">=</span> engine\n    <span class="token variable">@body</span> <span class="token operator">=</span> body\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> run\n    <span class="token variable">@engine</span><span class="token punctuation">.</span>refill\n    <span class="token variable">@body</span><span class="token punctuation">.</span>load\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이제 우리는 컨셉에 맞는 구현을 한 뒤에 <code class="language-text">Vehicle</code> 객체에 주입하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">ElectricEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 전지를 충전한다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">PetrolEngine</span>\n  <span class="token keyword">def</span> refill\n    <span class="token comment"># 연료를 채운다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TruckBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 화물을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">CarBody</span>\n  <span class="token keyword">def</span> load\n    <span class="token comment"># 승객을 싣는다</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>마지막으로 모두 한 곳에 넣으면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">petrol_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_car <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">CarBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\npetrol_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">PetrolEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\nelectric_truck <span class="token operator">=</span> <span class="token constant">Vehicle</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token constant">ElectricEngine</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token constant">TruckBody</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>이 접근방식은 많은 이점이 있습니다. <code class="language-text">Vehicle</code> 클래스가 외부 로직을 사용하는 방식은 첫 눈에 명확하게 들어옵니다. 이름이 꼬이는 문제도 없습니다. 각각의 클래스는 정확히 한 가지 일을 하고 있습니다(<a href="https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9D%BC_%EC%B1%85%EC%9E%84_%EC%9B%90%EC%B9%99">단일 책임 원칙</a>을 만족합니다). 그래서 이 클래스들이 자신에게 주어진 일을 얼마나 제대로 하는지 확인하는 테스트를 쉽게 할 수 있습니다.</p>\n<p>우리는 높은 응집력(관련있는 로직을 같이 두는 것)을 달성하면서 동시에 결합도(클래스의 의존성을 낮게 만드는 것)는 낮추었습니다. 이제 인터페이스 전체를 바꾸지 않는 한, 고객의 요구에 걱정하지 않고 코드에 사용되는 엔진이나 몸체를 바꿀 수 있습니다.</p>\n<p>조합 기법에도 문제점이 있을까요? 물론 있습니다. 이 방식은 코드를 더 길게 쓰도록 합니다. 특히 모든 의존성들을 최종 객체에 주입하게 될 때 눈에 띄게 길어집니다. 여러분은 추가적인 보일러플레이트(여기서는 코드를 생산해내는 템플릿 함수)를 만들어서 참조 위치를 저장하고, 어디에 위임을 할지 설정하며 정확한 실행 흐름을 제어할 수 있도록 만들어야 합니다. 문제의 처방전으로 여러분은 여러 가지 <a href="https://en.wikipedia.org/wiki/Creational_pattern">제작 패턴</a>을 활용할 수 있습니다. 팩토리(Factory)나 빌더(Builder) 처럼요.</p>\n<p>제가 조합을 활용하려고 할 때 제일 어려웠던 점은 제 사고 방식을 조합을 응용하기에 알맞는 방식으로 고치는 것이었습니다. 예상밖으로 <strong>Go</strong> 언어를 가지고 놀 때 많은 도움을 받았습니다. 이 프로그래밍 언어는 상속을 받지 않도록 설계되어 있지만 객체지향 방식으로 코드를 작성할 수 있게 되어있습니다. 또한 프로그래머들에게 조합을 사용하도록 권장하는 기능들이 담겨있습니다. (역주: <a href="http://hackthology.com/object-oriented-inheritance-in-go.html">이 글</a>이 Go 언어에서 조합을 사용하는 예를 보여주는 좋은 글로 보입니다) 제가 Go를 조금 가지고 놀다가 갑자기 조합을 사용하는데 훨씬 익숙해졌다는 사실을 깨달았습니다. 다음 포스팅에 이 이야기를 자세히 쓰고자 합니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>저는 여러분께 코드를 구축하는 세 가지 다른 접근 방식을 보여드렸습니다. 상속, 믹스인, 조합 말씀입니다. <strong>상속</strong>은 많은 프로그래머들의 첫 번째 선택지이지만, 저에게는 심하게 과용되고 코드를 복잡하게 만드는데다 유지보수도 힘들게 만들었습니다. <strong>믹스인</strong>은 더 똑똑하고 강력한 대체제로 보이지만 사실은 다중 상속의 한 방법에 불과하고 코드의 복잡도를 늘릴 수도 있습니다. <strong>조합</strong>은 코드 양은 제일 길어지겠지만 클래스 사이에 의존성을 관리하는데 가장 직관적이며 깔끔한 접근방식을 가지고 있습니다. 조합은 코드를 작고 분리된 조각으로 유지하며 테스트하기도 쉽습니다. 그래서 제가 가장 선호하는 방법입니다.</p>\n<p>객체 지향 프로그래밍은 일부 프로그래머들이 다른 프로그래머들이 처한 문제를 조금 더 쉽게 해결하도록 돕고자 만든 하나의 협약에 지나지 않는다는 점을 잊으시면 안됩니다. 규약에 얽매이지 마세요. 여러분이 처한 상황에 가장 잘 맞는 해결책을 선택하세요.</p>\n<p>그리고 마지막으로, 이 말을 새겨두시기 바랍니다.</p>\n<blockquote>\n<p>객체 지향 소프트웨어를 설계하는 일은 어렵다. 그리고 재사용 가능한 객체 지향 소프트웨어를 설계하는 일은 훨씬 더 어렵다. - Gang of Four</p>\n</blockquote>\n<p>이 말을 경험을 통해 알게 되실 겁니다.</p>\n<h2 id="원문의-참고-자료"><a href="#%EC%9B%90%EB%AC%B8%EC%9D%98-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>원문의 참고 자료</h2>\n<ul>\n<li>RailsConf 2015 - Nothing is Something</li>\n<li><a href="https://learnrubythehardway.org/book/ex44.html">https://learnrubythehardway.org/book/ex44.html</a></li>\n<li><a href="https://robots.thoughtbot.com/reusable-oo-inheritance">https://robots.thoughtbot.com/reusable-oo-inheritance</a></li>\n<li><a href="https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose">https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose</a></li>\n</ul>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>어느정도 일상과 공부와 번역 등의 밸런스가 틀이 잡혀가면서 한달에 한 개 정도 포스팅하는 방향으로 굳어지고 있나봅니다. 적어도 한달에 두어개는 작성하고 싶은데.. 좋은 글은 매일 탐독하고 있지만 제대로 써먹지 못하면서 알려봤자 뭐가 좋나? 라는 생각이 들 때도 있습니다.</p>\n<p>이전에 의존성 주입에 관한 글을 번역했을 때도 그렇지만 조합 패턴은 루비를 사용하면서, 혹은 자바스크립트를 사용하면서도 아주 중요한 패턴 중 하나라고 생각합니다. 반드시 자유자재로 다루고 싶은 패턴이긴 한데 \'평범하게\' 레일즈를 사용하게 되면 아마 쉽게 익숙해지긴 힘든 패턴이라 생각합니다. 그래서 개인적으로 루비로 API 백엔드를 구축하는 토이 프로젝트를 하시게 된다면 하나미(hanamirb)를 이용해서 만들어보시는걸 강력하게 권장하고 싶습니다. 레일즈는 구조 특성상 이런 형태의 조합을 사용하기 쉽지 않다고 생각하기 때문입니다. (<code class="language-text">ActiveSupport::Concern</code>, <code class="language-text">Single Inheritance Table</code> 등)</p>\n<p>자바스크립트에서 조합을 사용하는 것을 권장하는 글도 최근에 읽고 큰 감명을 받았는데, 한번 살펴보시길 권하면서 링크를 남깁니다.</p>\n<ul>\n<li><a href="https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0">https://developers.caffeina.com/object-composition-patterns-in-javascript-4853898bb9d0</a></li>\n<li><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3">https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-07-16-how-to-avoid-inheritance-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-07-16",path:"/posts/how-to-avoid-inheritance-in-ruby-kor",title:"[번역] 루비에서 상속을 피하는 방법",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Piotr Solnica 의  글 을 번역한 것입니다 번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다 저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://twitter.com/_solnic_">Piotr Solnica</a>의 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">글</a>을 번역한 것입니다</strong></li>\n<li><strong>번역 내용에 대한 조언 및 의견은 언제나 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>저는 우리 루비스트들이 의존성 주입(Dependency Injection)에 대해 요즘은 어떻게 생각하는지 궁금해졌습니다. 제가 기억하는 한 의존성 주입에 대한 몇몇 토론은 대부분 자바로 인해 굳혀진 개념(post-java-trauma)을 비판하는 내용이었습니다. 이 글을 작성하기까지 오랜 시간동안 머리속으로 생각만 하고 있었지만, 이 주제가 아마도.. 알려져 있다는 것을 알고 있었습니다. 그래서 글을 작성하기 전에 구글에 검색을 해 보기로 마음먹었지요. 구글에 "ruby dependency injection"을 입력하면 이런 결과를 얻었습니다:</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 580px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 69.13793103448276%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVQ4y3VTiZKiQAzl//dr9jdmBl3EW+5DkQZUoLnxbRodC8exq14lXZCXl3QiGXYIe7eB5TgIggCmacGyLDiuC9dxkWUZ8jwf8NNP0wxVkUHzU/z5e4K8iSHlvMT5nOKScZR5Nvx4uaSDFSjLElVVDajrergLNE0zoOtaXPIGslEiPFWQMDodC9EJAgpsmxZt2z4IBKEgKIpiwPV6HWLu5nEk8aEnCNvUQsUtsG2FgpoUdHh3rvc4ga4nHoL0/UGcvRthO3dhbn1oKw++zaiP1FfDg771sFu7CI8JeFWAF5xI+pck0ncGcSzLgDyRoagK1IWK5WoJzdhBXZG/XWK5EXcNtmuDxRE450LOk9InwjQtwViKJM4JHDFZnnfUCjxAb/BS9riZT4RihCaqieXag6wYUBY2pnT/t9DJ1yHPNlgbNFa+iQM7PPp7Hb3MD4VnRFGIJGGkNCAcSWWIYxggDA/Y773BT7N0mEXxeOPHeSFkUY7FmsGwEhr0E0z7BM2M4e85DX2NiDVw7AKWWVDykborficMKPuOHsEjJZq5g+la0G2dElCJB6FwjziJiUwMfor23tC3JV9OOY5+jDik0oMzjl6C0E9w8CL4TojAjwb/nGRIWAaeVqOSfyF0XR/qfIX5fInpdAZVIX+2hqIs8Pk1wcenjC95itV6A1N3kERnMTTve5jTLjNavyhiNxszlDTEFaEsaZh5PmxS33cU09OG9aMVvNn/HCEucTH4uRcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc1"\n        title=""\n        src="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png"\n        srcset="/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-0ca6d.png 198w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-45e8e.png 395w,\n/static/2017-02-04-sc1-9dcb9be1a8d06e20a0c943b7fe6c9637-9c10f.png 580w"\n        sizes="(max-width: 580px) 100vw, 580px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>역주: 이 글은 2013년 12월에 작성되었으며, 현재 같은 검색어로 검색하면 결과물의 순서 및 노출되는 글이 다릅니다.</em></p>\n<p>저는 <a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">DHH(David Heinmeier Hansson, Ruby on Rails의 창시자)의 블로그</a>로 들어가 글을 다시 읽어보았습니다. 그 글에 대해 희미한 기억만 남아있었기 때문입니다. 그리고 나서야 저는 세상이 루비의 의존성 주입에 대한 다른 글이 필요하다는 것을 깨달았습니다. 왜 그럴까요? 대개 저 글을 읽고 많은 루비스트들이 루비의 의존성 주입에 대해 잘못된 인식을 가질 우려가 있기 때문입니다. 또한 의존성 주입이 뭔지 배워보고자 하는 사람들은 DHH의 블로그 글을 발견할테고, 루비에서의 의존성 주입이 "필요 없다" 라는 크게 잘못된 생각을 가질 수 있습니다. 네, 정말로 걱정되는 부분입니다.</p>\n<p>제가 이 글의 제목을 "루비의 의존성 주입"이라고 작성한 이유는 <strong>"루비의"</strong> 라는 부분이 꽤 중요하기 때문입니다. 루비의 의존성 주입은 아주 직관적인 실체를 가지고 있으며 여러가지 장점을 가지고 있습니다.</p>\n<p>아, 간단히 정리하자면:</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 외부 라이브러리도 쓸 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 어떠한 설정도 할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드의 단순함을 희생할 필요가 없습니다.</p>\n<p>여러분은 루비의 의존성 주입을 사용하기 위해 코드를 더 작성해야 할 필요가 없습니다.</p>\n<h2 id="루비의-의존성-주입은-아주-쉽다"><a href="#%EB%A3%A8%EB%B9%84%EC%9D%98-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85%EC%9D%80-%EC%95%84%EC%A3%BC-%EC%89%BD%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루비의 의존성 주입은 아주 쉽다</h2>\n<p>별로 대단한 건 없어요. 정말로요. 하지만 당신의 코드에 큰 영향을 줍니다. 자신만의 의존성을 갖는 객체를 만드는 것 보다 객체에 의존성을 주입 할 때 유연성은 증가하고 결합도는 낮아집니다. 더 나은 디자인을 채용하게 된 덤으로 테스트 하기도 쉬워지지요. 자주 일어나는 일입니다.</p>\n<p>한번 살펴보시죠:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 일반적인 접근</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> initialize\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n\n<span class="token comment"># 그리고 의존성 주입의 경우</span>\n<span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 뭔가 멋진 의존성 주입 라이브러리를 사용했나요? 아니죠. 우리가 코드를 더 작성했나요? 글쎄요. 아니면 코드가 더 복잡해졌나요? 확실히 아닙니다.</p>\n<p>작은 변화에 불과했지만 여러분의 코드에 <strong>큰 영향을 미칩니다.</strong> <code class="language-text">Hacker</code> 클래스는 더 이상 키보드를 만드는 방법에 종속될 필요가 없습니다. 그저 주어진 인터페이스를 사용하게 될 뿐이며, 우리는 키보드 인터페이스를 구현하기만 하면 어떤 것이든 편하게 집어넣을 수 있게 되었습니다. 이게 유연성이 증가하고 결합도가 낮아진다는 것을 뜻합니다.</p>\n<p>다 좋은데 그렇다면 키보드의 의존성은 어디서 만들어야 할까요? 분명 어디선가 만들어져야 할 텐데요?</p>\n<p>제가 사용하는 패턴은 이렇습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Hacker</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>layout <span class="token operator">=</span> <span class="token string">\'us\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> layout<span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n    <span class="token variable">@keyboard</span> <span class="token operator">=</span> keyboard\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># stuff</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>잠깐만요, 제가 코드를 더 작성하지 않아도 된다고 했나요? 제가 거짓말을 했네요. <code class="language-text">build</code> 메서드를 쓰기 위해 코드를 두 줄 정도 더 써버렸습니다. 들켰네요.</p>\n<p>그래도 일단 좋은 면만 보도록 합시다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 우리는 hacker 인스턴스를 아주 작은 노력으로 만들 수 있습니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">\'us\'</span><span class="token punctuation">)</span>\n\n<span class="token comment"># 만약 우리가 이미 키보드 객체를 가지고 있다면 이 방식으로도 작동합니다</span>\n<span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard_we_already_had<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>우리가 의존성을 명시적으로 드러냈기 때문에 테스트하기도 쉬워졌습니다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token comment"># 여기서는 키보드 객체가 큰 의존성을 가지고 있어서 그냥 mock으로 만든다고 칩시다</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>의존성 주입이 없었다면 어떤 모양으로 보일 지 생각해봅시다. 제가 끔찍한 예를 하나 들어보겠습니다. 그리고 저는 여전히 사람들이 이런 코드를 작성하는 것을 보곤 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">describe <span class="token constant">Hacker</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:keyboard</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">\'keyboard\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n  it <span class="token string">\'writes awesome ruby code\'</span> <span class="token keyword">do</span>\n\t<span class="token comment"># 우웩!</span>\n    <span class="token constant">Keyboard</span><span class="token punctuation">.</span><span class="token function">should_receive</span><span class="token punctuation">(</span><span class="token symbol">:new</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">with</span><span class="token punctuation">(</span><span class="token symbol">:layout</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">\'us\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n      <span class="token function">and_return</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>\n\n    hacker <span class="token operator">=</span> <span class="token constant">Hacker</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n\n    <span class="token comment"># some expectations</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><em>역주: 윗부분에서 <code class="language-text">Hacker</code> 클래스를 의존성 주입 없이 사용하는 예를 살펴보시면 ,<code class="language-text">Hacker</code> 클래스의 인스턴스를 작성할 때 동시에 <code class="language-text">Keyboard</code> 클래스의 인스턴스를 만든다는 것을 볼 수 있습니다. 그래서 <code class="language-text">keyboard</code> 라는 객체가 의도대로 생성되는지를 테스트하기 위해 이런 복잡한 코드가 들어가게 되었다고 생각합니다.</em></p>\n<h2 id="더-나아가서"><a href="#%EB%8D%94-%EB%82%98%EC%95%84%EA%B0%80%EC%84%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>더 나아가서</h2>\n<p>루비의 의존성 주입을 연습할 때 저는 몇몇 작은 패턴과 규칙을 정해놓고 따르고 있습니다.</p>\n<ul>\n<li><code class="language-text">.new</code> 메서드를 깔끔하게 유지하고, 오버라이드 하지 말 것. 단순한 의존성만 인자로 받아들인다</li>\n<li>빌더 메서드를 분리하여 만들고 이 메서드가 "모양빠지는" 입력들을 받아서, 해당 클래스의 객체가 필요로 하는 모든 것을 만들 수 있게한다</li>\n<li>빌더 메서드가 너무 복잡해지게 되면 빌드 로직을 서로 다른 객체로 분리한다</li>\n<li>생성자에 옵션 해시를 전달하는 것을 피한다</li>\n</ul>\n<p>이 규칙들은 제가 작성하는 코드에 크게 긍정적인 영향을 주었습니다. 결합도를 낮추었고, 유연성을 높였으며, 리팩토링도 쉬워졌습니다.</p>\n<p>사실 제가 이 글을 통해 작성한 간단한 예제만으로 위의 규칙이 말이 된다고 설득하는 것은 어렵습니다. 그러므로 일단 루비의 의존성 주입을 사용해보라고 권하고 싶습니다. 의존성 주입을 사용하는게 단순히 테스트할 때 이득을 보기 위해서라고 여기지 말아주세요. 제발요 :)</p>\n<p>제가 말하고 싶은 것은 루비의 의존성 주입은 하나의 미덕이라는 점입니다. 루비는 복잡한 일들을 간단한 방법으로 구현할 수 있는 아름다운 언어입니다. 반면에 테스트 할 때 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 을 사용하는 것은 그렇게 영리한 방법은 아닙니다.<em>(역주: <code class="language-text">stub</code> 메서드는 Rspec에서 일종의 객체 목업을 생성해주는 메서드로 알고 있습니다. 굳이 글쓴이가 <code class="language-text">Time.now</code> 에 <code class="language-text">stub</code> 메서드를 사용한다는 이야기를 꺼낸 것은 이 예시가 DHH의 포스트에 언급되어 있기 때문입니다.)</em></p>\n<p>물론 여러분이 루비의 의존성 주입을 사용하지 않을 수도 있지만, 실제로 사용해 보시면 더 깔끔하고 명시적인 코드를 작성하실 수 있습니다. 여러분의 코드는 더 좋아질 겁니다.</p>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>저는 언제나 기본적인 컴퓨터 과학 및 좋은 프로그래밍 방법론에 대한 지식이 부족하다는 점을 통감하고 있습니다. 단순히 전공자가 아니기 때문인 것도 있지만, 지속적으로 개발을 제대로 하려면 이러한 지식이 반드시 필요하다고 생각하고 있기 때문입니다. 이런 점에서 최근에 좀 더 알아보고 싶던 주제가 \'의존성 주입\' 입니다.</p>\n<p>자바 스프링 프레임워크를 사용할 때 주로 \'의존성 주입\' 이라는 단어가 많이 나왔을겁니다. 그런데 제가 제대로 쓸 수 있는(정말일까?) 유일한 언어인 루비는 어떻게 의존성 주입을 사용하는지 궁금하여 찾아보다 이 글을 발견하게 되었습니다.</p>\n<p>번역 과정 자체는 무난했는데 후반부에 "Stub Time.now" 라는 말의 뜻을 이해하지 못하겠더군요. 알고보니 두 가지 문제가 있었습니다.</p>\n<ol>\n<li>RSpec을 제대로 써 보지 않았다</li>\n<li>DHH의 글을 먼저 읽어보지 않았다</li>\n</ol>\n<p>글 작성자에게 더 자세한 설명을 부탁했더니 이런 답변을 받았습니다. 참고하시기 바랍니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 94.36619718309859%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACa0lEQVQ4y3WUSY7bQAxFfaoE2TSycLctz7Ykz5ItWZ4yLAIEyKKBIAfIKifITRk+uijIcGdBsarE+kV+/qrWcj6Xn6+vslosZDoeSxrHskhTSdTHs5kkapPRSPpRJINe78FY538Sz2TY70sr225lk8Yym0wkzzJJk8SA3QgmMOp0pNft1t6N+WgwsP0c0GLx49OTdF9eZL1cylwBxwpCwHg4NEAHj6dTy5gx//nHGnOADZAPJ+C3m41cLxepylJOx6NZdSjloHPWL6dTbdfzWc4hhiRIrAZ0fsr9Xs4aXB0OBsqGi27MoWW1Mp7hnEoYQxcZdp6faz5rQIxNgJJpsdvJLs9lp7wuFKRZCQav7BkpLZTs87sMOXW7XkumgJ7RhrlmUuhBZMo4b87D4VPllLLvAPmZhw1k5pvxlMl/DtmHzKmGKvZUo/M7DkmZQBrAifCIZ+2oYzYBgIfnt9Tw0BQvGaAbh9ktG7IInv9lUVjJNAhg1hjXHLqR1efr1QIokSCMm+NzdIg3EE3gARAiETUTbgnNYMwaYsUYu/kcqTTXah2mo0j+/vmt/BTGB2Wb3oInA/hFHuNgyMfG4VqiRWINcBFP5NePb7aRLh6UH+xYVXJS40bQlE96UxA66zTHGwS3ANUZ9rqRtNttK3Ot5RKAsJGBd9bGKEAPQkbcIjj1cpsvUYsJfOAh18XqmgQMceMpy8HzoEOsCNlaU7g2XHx4gEO6yJvY9MQ4f/6kufbsLQzvpmWIpr5//XKTSLgF9oypVADE2ARHZODvoN9/SqY5xNkDy+KH9++MD7ijBE5vPqT/e62br7bH/QPWe/MwJaRjfAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 02 04 sc2"\n        title=""\n        src="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png"\n        srcset="/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-d16f8.png 198w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-f21b1.png 395w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ffc88.png 790w,\n/static/2017-02-04-sc2-0f2ed11f15088cd9b3c54a8078fb8ed1-ee9f1.png 994w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>루비의 의존성 주입에 대한 이야기는 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a> 책에도 조금 설명되어 있습니다. 루비로 프로그래밍을 하신다면 두번 이상은 읽어보시길 추천드립니다.</p>\n<p>참고 링크:</p>\n<ul>\n<li><a href="http://www.slideshare.net/hnki0104/ss-42101768">주니어 개발자도 이해할 수 있는 의존성 주입</a></li>\n<li><a href="https://medium.com/@Bakku1505/introduction-to-dependency-injection-in-ruby-dc238655a278#.ywoosbc3h">Introduction to dependency injection in Ruby</a></li>\n<li><a href="http://david.heinemeierhansson.com/2012/dependency-injection-is-not-a-virtue.html">Dependency injection is not a virtue</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-02-04-the-world-needs-another-post-about-dependency-injection-in-ruby-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-04",path:"/posts/the-world-needs-another-post-about-dependency-injection-in-ruby-kor",title:"[번역] 세상은 루비의 의존성 주입에 대한 다른 글을 원한다",tags:["Ruby","OOP","Translation"],category:"Translation"}},{excerpt:"이 포스팅은  Luca Guidi의 포스팅 을 번역한 글입니다 오역이나 잘못된 표현 지적은 언제나 환영합니다 객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기 역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 '루비 3'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다. 오늘은 주식회사 활빈당(Spectacular Foo Ltd…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://lucaguidi.com/2016/06/07/the-penguin-that-cannot-fly.html">Luca Guidi의 포스팅</a>을 번역한 글입니다</strong></li>\n<li><strong>오역이나 잘못된 표현 지적은 언제나 환영합니다</strong></li>\n</ul>\n<hr>\n<h2 id="객체-지향-프로그래밍-인터페이스-동적-타입에-대한-짧은-이야기"><a href="#%EA%B0%9D%EC%B2%B4-%EC%A7%80%ED%96%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EB%8F%99%EC%A0%81-%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%A7%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체 지향 프로그래밍, 인터페이스, 동적 타입에 대한 짧은 이야기</h2>\n<p><em>역주: 이 글은 가상의 이야기를 기반으로 객체 지향의 개념을 일부 짚어주는 글입니다 \'루비 3\'는 아직 개발 중이며, 어떤 형태로 나오게 될 지 모릅니다.</em></p>\n<p>오늘은 주식회사 활빈당(Spectacular Foo Ltd. <em>역주: 보통 임의의 사람 이름을 홍길동이라고 하다 보니 임의의 회사 이름은 무엇으로 할까 하다가...</em>)의 본사에서 일어나는 일을 이야기해보고자 한다. 이 회사는 인디 게임계에서 떠오르고 있는 회사이고, 다음 블록버스터 타이틀인 <em>흔해빠진 새들(Banal Birds)</em> 의 발매를 앞두고 있다.</p>\n<p>올해는 2019년이고, 루비 3는 세배나 빠르고, 놀랍게도 모든 문제를 해결할 수 있는 동적 타입을 가지고 있다! 조금 향수에 젖은 결정이긴 하지만 당신은 리드 개발자로서 루비를 이 프로젝트에 사용하기로 결정했다.</p>\n<p>당신은 관리자인 제인에게 최종 코드 리뷰를 부탁했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Bird</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>아이디어는 간단하지만 혁명적이었다: 플레이어는 <strong>어떤</strong> 종류의 새라도 고를 수 있고 그 새가 날아가는 것을 볼 수 있다. 이건 엄청날거야!(This is gonna be kickass!)</p>\n<p>당신은 유명한 루비 젬 <code class="language-text">acts_as_a_bird</code>(새처럼 행동하라)를 재사용했다. 이 젬은 <code class="language-text">Bird</code> 를 완벽하게 구현하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Bird</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>많은 새들 가운데서 우리는 올빼미나 벌새도 구현했다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Owl</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying owl"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Hummingbird</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying hummingbird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>소프트웨어 공학의 참으로 놀라운 부분 아닌가? 글쎄, 이 게임에 엄청난 투자를 했음에도 불구하고 문제가 하나 남아있었다: 제인이 \'그러면 펭귄은요?\' 라고 물었다. 그렇다, 펭귄은 새지만 날 수 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Penguin</span> <span class="token operator">&lt;</span> <span class="token constant">Bird</span>\n  <span class="token comment"># LOL I\'m a penguin (ㅋㅋㅋ 난 펭귄인데?)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>오늘은 게임 발매 당일이고 당신은 버그를 수정하기 위한 여력이 없다. 그래도 발매는 되어야 한다(The show must go on). 그래서 당신은 게임을 발매하고 사용자들이 펭귄을 고르지 않기를 기도할 수 밖에 없다.</p>\n<p>당신은 기분이 별로다. 그리고 자기 자신에게 묻기 시작한다: <em>왜 내가 루비를 골랐지? 왜 동적 타입을 쓴걸까?</em></p>\n<p>제인은 "당신이 정말 사용해야 했던 것은 타입이 아니라 인터페이스에요." 라고 말했다. 당신은 그 말을 듣자마자 "맙소사, 자바 말인가요!?(OMG, Java!)"  라고 말했지만, 그녀는 찬찬히 시간을 들여 그 개념은 <a href="http://golangtutorials.blogspot.kr/2011/06/interfaces-in-go.html">Go(GoLang)</a>에서 빌려온 것이라고 설명하였다.</p>\n<blockquote>\n<p>"루비같이 동적 타입을 가지고 있는 언어에서, 당신이 정말 신경써야 하는 것은 <strong>행동(behavior)</strong>이에요. 당신은 객체에 <em>메세지를 보낼 수 있도록</em> 해야합니다. 그게 객체 지향 프로그래밍의 핵심이에요."</p>\n</blockquote>\n<p>그녀는 계속 설명했다: "타입을 사용하는 것은, 당신이 수행하고자 하는 일보다 과하게 많은 일을 수행하려는 객체를 받아들인다는 것과 같아요. 그리고 그건 <a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4_%EB%B6%84%EB%A6%AC_%EC%9B%90%EC%B9%99">인터페이스 분리 원칙</a>을 무너뜨립니다."</p>\n<blockquote>\n<p>"차이점은 미묘해요: 당신은 <code class="language-text">Bird</code> 클래스가 <code class="language-text">fly</code> 메서드에 반응할 것이라(respond to) 추측했지요. 하지만 언제나 그렇진 않아요. 대신 프로그래밍 언어 측에서<em>(역주: 문맥 상 프로그래머가 작성한 코드를 말하는 것으로 보입니다)</em> 주어진 객체가 특정 메서드(혹은 메서드의 모음)를 구현하고 있는 지 확인하는 도구를 제공해야 합니다."</p>\n</blockquote>\n<p>이 시점에서 당신은 충격을 받았다. 당신은 루비가 행동의 모음을 정의할 수 있는 특별한 모듈을 제공했으면 정말 좋겠다고 생각했다<em>(역주: wished라는 동사를 사용했지만 문맥상 희망하다라고 쓰기엔 딱딱해 보입니다)</em>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">interface <span class="token class-name">Flying</span>\n  <span class="token keyword">def</span> fly\n    puts <span class="token string">"I\'m a flying <span class="token interpolation"><span class="token delimiter tag">#{</span> name <span class="token delimiter tag">}</span></span>"</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"bird"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Falcon</span>\n  include <span class="token constant">Flying</span>\n\n  <span class="token keyword">def</span> name\n    <span class="token string">"falcon"</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Game</span>\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> <span class="token constant">Flying</span><span class="token punctuation">)</span>\n    <span class="token variable">@bird</span> <span class="token operator">=</span> bird\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> play\n    <span class="token variable">@bird</span><span class="token punctuation">.</span>fly\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>또한 가상머신(VM)이 \'펭귄은 날 수 없다\' 같은 당황스러운 에러를 내뿜기 전에 당신을 막아주었으면 좋겠다고 생각했다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>예전에 RORLAB 슬랙의 질문 채널에서 이런 내용의 대화를 주고받은 적이 있습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 544px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 87.86764705882352%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACtklEQVQ4y31UuY7UQBScH+Ij+Af4BH6BjJSIhBghIkICMqKVWBEgEaAVYnfYGd/3+BqP7Tk9Ll4949kDFkvtvuu96qruyYezK9hB8QXAy647vjvIt9vtcTweezzw9X3/z8Jv8uLVW3y/tH4lcfgxiuLPURR1tu0giuO+KEssFimSJNE6jCL4QYCqqh4MNIHkstlsUNcNynIJ23Hgul7v+z4cx0UYhrAsG6ZpIRbgLMt0nEEkAakXiOMEXdcNGfIngEcB6GTjsW3bXuhCmPf7vVIH68Oh0zY/9rfbLdcoEOsTZf7quobneQiEjlDWiEJZs2EWy+VS5kKdZ+ZFUSjtOI41U5buTzAFbNu1bhqjjWXss95ud9jtdtpnpvfXnjJ8/uwJvn09h2HaAtxitVqdFg1UB8ABYKg3QpfgYwDWJ8D3b17jx8UFLNtWQQzDUBEM08RsNlMxqLptD8KMQqVpqiKRWZ7nN6J4riWTiZ5RluUyWehiZspzymQxN1XVSl1AFv/z5+Tp40c4P/uE65khXlugLEoFK8WDFOuwEWpCcQygtRQKlsh6CtI0zQ2gbVyrWqZQdEVpUmV7Op2KH114lgNPaHJsPjcGXwp90myaVoPQx7eMrT7U86jLCnmaIRdbcAOz4DhtRAOPlqJ9eAxj1hTvDiDpmZbcBHrN9TXT+XyumSR+KOPRSbDLyyvNnAKxP7riDiDPiuoxGwJ7nq8bCOxSVQHlmO8HcATMkjXMkna5LcjJ2Ov1Gp7roc5KNLEoneYKVhVCK19qoOGWBPpIsLDPILw1fwPKwxDNHSycANOfVwpuGKYWX9oEvxZP0lqOUB/ABgHZ5nmPtBWQaukZ8pkSD6YiDAvVT2kPCiZBmQUNPD4SY1b3ni/oy5GomrFeftY0MSmxzcI2fUdxwjDSPQzC63gb/DfqqlBeKJlTYwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="slack_conversation"\n        title=""\n        src="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png"\n        srcset="/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-5510e.png 198w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-f5670.png 395w,\n/static/2016-12-31-sc1-a13427f93ee2f60a5107ed26df13cfdc-959a9.png 544w"\n        sizes="(max-width: 544px) 100vw, 544px"\n      />\n    </span>\n  </span>\n  </p>\n<p>마침 이 글을 읽은 직후라 비유를 <code class="language-text">fly</code> 로 사용했었던 것이 기억나네요. 보통 동적 타입을 사용하는 언어들의 단점으로 여러가지가 거론되지만 \'실행하기 전에는 무슨 일이 일어날 지 바로 알 수 없다\' 라는 단점을 본 적이 있습니다.</p>\n<p>하지만 본문에서 설명한 개념으로 그런 단점을 최소화하는게 가능하겠지요. 핵심은 프로그래머가 자신의 프로그램이 어떻게 동작할지를 면밀하게 설계할 필요가 있다는 것입니다.</p>\n<p>위 개념을 조금 더 적극적으로 활용하고자 하시는 루비 프로그래머분들은 <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=49317754">루비로 배우는 객체지향 디자인</a>의 5, 6, 7장을 찬찬히 살펴보시면 많은 도움이 될 것입니다.</p>\n<p>2016년의 마지막 날, 이 글을 읽는 분들에게 조그마한 새해 선물이 되었이 되었으면 좋곘고 새해에도 많은 분들과 더 좋은 내용의 글을 주고받을 수 있도록 개발자로서의 역량을 갈고 닦고 싶습니다 :)</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-31-the-penguin-that-cannot-fly-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-31",path:"/posts/the-penguin-that-cannot-fly-kor",title:"[번역] 펭귄은 날 수 없다(The Penguin That Can't Fly)",tags:["Ruby","OOP","Translation"],category:"Translation"}}],Python:[{excerpt:"자바를 맛만 보고, 실질적으로 루비를 첫 프로그래밍 언어로 접하여 지금까지 사용해오고 있습니다. 어느 덧 2년이 다 되어가네요. 루비는 비교적 간단하면서도 강력한 언어이지만, 현재는 루비 온 레일즈(이하 레일즈) 라는 걸출한 웹 프레임워크의 기반이 되는 언어라는 인식 이외에는 그다지 유명세를 얻지 못하고 있습니다. 반면 비슷하게 간단하면서 강력한데다 전 세계적인 인지도를 가지고 있는 프로그래밍 언어가 있습니다. 파이썬(Python…",html:"<p>자바를 맛만 보고, 실질적으로 루비를 첫 프로그래밍 언어로 접하여 지금까지 사용해오고 있습니다. 어느 덧 2년이 다 되어가네요.<br>\n루비는 비교적 간단하면서도 강력한 언어이지만, 현재는 루비 온 레일즈(이하 레일즈) 라는 걸출한 웹 프레임워크의 기반이 되는 언어라는 인식 이외에는 그다지 유명세를 얻지 못하고 있습니다.</p>\n<p>반면 비슷하게 간단하면서 강력한데다 전 세계적인 인지도를 가지고 있는 프로그래밍 언어가 있습니다. 파이썬(Python) 입니다.<br>\n사실 언제라도 필요에 따라 마음만 먹으면 파이썬을 금방 사용할 수 있으리라 생각해 왔는데 좀처럼 그럴 기회가 없었습니다.<br>\n그래서 이번에 길벗 출판사에서 진행하는 이벤트를 통해 가볍게 파이썬을 접해보는 계기를 만들고자 '파이썬 코딩의 기술(Effective Python) 책을 리뷰하기로 했습니다.</p>\n<p>이 책을 한 마디로 표현한다면 파이썬의 <strong>'요람부터 무덤까지'</strong> 를 알려주는 책이라고 할 수 있습니다.<br>\n저자는 파이썬다운 생각을 하는 방법부터 시작하여 함수, 클래스, 병렬성, 내장 모듈, 협력, 제품화까지 파이썬으로 프로그래밍을 하는데 있어 필요한 모든 요소를 관통하며 묵직한 조언을 던져줍니다. </p>\n<p>파이썬이라는 언어는 그 자유로움 때문에 프로그래머가 각자 편한 방식으로 코딩을 하다가 성능이나 가독성, 원인을 알 수 없는 버그 등 많은 문제에 직면하기 쉽습니다. 그렇기 때문에 저는 프로그래밍 언어를 익힐 때 해당 언어의 사고방식을 체득하려는 노력을 합니다.<br>\n이 책은 그 사고방식을 익히는데 최적화되어 있으며, 평소에 잊고 있다가도 필요한 부분에 바로 적용할 수 있도록 예제 코드가 단계별로 잘 제공되어 있습니다. 특히 바로 잘 정돈된 코드만 나열하는 게 아니라 좋지 않은 예를 어떤 과정과 사고방식을 통해 개선해가는지 보여주는 점이 가장 마음에 들었습니다.</p>\n<p><strong>다만 이 책을 제대로 활용하기 위해서는 기초적인 파이썬 문법을 알고 있어야 합니다.</strong><br>\n초보자 혹은 다른 언어 기반지식을 가지고 파이썬을 가볍게 익히신 분들이라면 <strong>바로 읽어보셔야 할 책이라고 생각하며</strong>, '어떻게 하면 더 효율적인 코드를 작성할 수 있을까?' 라는 고민을 안고 있는 중급 파이썬 개발자들에게도 조심스레 추천드리고 싶습니다.</p>",id:"/home/circleci/repo/src/pages/posts/2017-06-28-effective-python-review/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-06-28",path:"/posts/effective-python-review",title:"파이썬 코딩의 기술(Effective Python) 리뷰",tags:["Reading","Python"],category:"Review"}}],Programming:[{excerpt:"이 글의 원문은  Yegor Bugayenko가 작성하였습니다. 오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다. 코드 평가 (다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development…",html:'<ul>\n<li>이 글의 원문은 <a href="http://www.yegor256.com/2015/02/09/serious-code-reviewer.html">Yegor Bugayenko가 작성하였습니다.</a></li>\n<li>오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p><a href="http://en.wikipedia.org/wiki/Code_review">코드 평가</a>(다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development 브랜치에 우연찮은 실수가 <a href="http://www.yegor256.com/2014/07/21/read-only-master-branch.html">덮어씌워지지 않도록</a> 하고, 어떤 팀은 머지가 된 후에 버그나 어긋나는 점을 발견하기 위해 코드의 작성자와 <a href="http://www.yegor256.com/2014/12/18/independent-technical-reviews.html">일반적인 평가</a>를 합니다. 어떤 팀은 둘 다 하기도 합니다. 코드 평가는 평가자가 소프트웨어 전체 소스의 접근 권한을 가지고 결점을 찾아내는 <a href="https://ko.wikipedia.org/wiki/%ED%99%94%EC%9D%B4%ED%8A%B8%EB%B0%95%EC%8A%A4_%EA%B2%80%EC%82%AC">화이트박스 평가</a> 기술과 아주 유사합니다. 어느 경우든 코드 평가는 퀄리티 향상 및 팀의 동기 부여를 위한 좋은 도구가 됩니다.</p>\n<p>하지만 코드 평가를 제대로 하기는 어렵습니다. 오히려 잘못 하기가 훨씬 쉽다고 말씀드리고 싶습니다. 제가 여태까지 본 바로는 대부분의 코드 평가와 평가자는 비슷한 실수를 반복해왔습니다. 그래서 제가 알고 있는 좋은 코드 평가자들이 가지고 있는 네 가지 기본 원칙을 정리하는 글을 작성하게 되었습니다. 이 글이 도움이 되길 바랍니다.</p>\n<h2 id="두려움을-가지지-않기no-fear"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EC%A7%80-%EC%95%8A%EA%B8%B0no-fear" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지지 않기(No Fear)</h2>\n<p>진짜배기 코드 평가자라면 갖지 말아야 할 몇 가지 두려움이 있습니다. 첫 번째이자 가장 유명한 두려움은 코드의 작성자를 공격하는 일입니다. <em>"오늘은 그냥 눈을 감고 저 버그를 못 본척 하면 내일 작성자는 내 실수(버그를 못 봄)를 알아차리지 못할거야."</em> - 이런 태도가 만들어내는 두려움입니다. 말할 필요도 없겠지만 이는 비생산적이고 코드 퀄리티와 팀의 사기를 낮추는 일입니다. 조언을 드리자면 직설적이고, 솔직하고, 간결하게 이야기하세요. 당신이 이 코드가 맘에 들지 않는다면 말 그대로 맘에 들지 않는겁니다. 당신의 의견이 코드의 작성자에게 어떻게 받아들여질지 신경쓸 필요가 없습니다.</p>\n<p>만약 당신이 동료를 향해 신경쓰이는 기분이 든다면 회사 혹은 팀의 경영 측면에서 문제가 있는 겁니다. 되려 못하는 사람에게 "팀 플레이어가 아니다" 라는 낙인찍힐까봐 두려워하고 있는 겁니다. 평가를 해야 하는 사람은 프로젝트 스폰서입니다. 스폰서는 당신이 제품의 질을 신경쓰지 않는 다른사람을 불쾌하게 한다고 얼마나 개선이 될 지 신경쓰지 않습니다. 그저 제품을 생산하여 사용자들로부터 돈을 벌어오길 원합니다. 스폰서는 당신이 <a href="http://www.yegor256.com/2015/10/06/how-to-be-good-office-slave.html">회사에서</a> 친구를 사귀라고 급여를 주는 게 아닙니다.</p>\n<p>다른 종류의 두려움은 이런 식으로 나타납니다. <em>"내가 이 코드를 거부하면 제품 발매(release)가 늦어질거야."</em> - 다시 한 번, 이런 태도는 프로젝트 전체에 커다란 해가 된다는 말씀을 드리고 싶습니다. 당신은 코드에서 마음에 들지 않는 부분을 눈 감고 외면한 뒤에 승인을 합니다. 코드는 다음 배포판에 포함될 예정이고 더 빨리 출시할 수 있게 되었습니다. 발매를 늦추는 병목현상도 없었으며 아무도 당신에게 \'저 지멋대로인 코드 평가자 때문에 발매가 늦춰지고 돈을 덜 벌게 되었다\' 는 말을 하지 않습니다. 당신은 좋은 팀 플레이어입니다. 그럴까요? 그럴리가요!</p>\n<p>지난 번 <a href="http://www.yegor256.com/2015/01/15/how-to-cut-corners.html">제가 언급했듯이</a>, 전문적인 팀 플레이어는 자신의 역할이 다른 사람 뒤를 봐주는 일이 아니라는 것을 알고 있습니다. <a href="http://www.yegor256.com/2015/11/24/imprisonment-for-irresponsible-coding.html">나쁜 코드</a>를 거부하여 발매가 늦어진다면, 이는 코드 작성자의 잘못입니다. 전문가로서 당신의 책임은 이런 결점을 찾아내는 것입니다. 이렇게 팀의 학습과 발전을 위해 도움을 주어야 합니다.</p>\n<p>저는 팀의 학습과 성장을 위해서 가장 먼저 해야할 일이 나쁜 프로그래머를 없애고 좋은 프로그래머를 끌어올리는 것이라 생각합니다. 솔직하고 두려움 없는 코드 평가자들은 팀의 학습과 성장을 돕습니다.</p>\n<p>또 이런 두려움도 있습니다. <em>"내가 잘못 본거라면 다른 사람들에게 놀림받을 거야"</em> - 더 심하면 다른 사람들이 당신이 부족한 지식을 가지고 있다고 지적할 수도 있고, 당신이 \'내가 대체 뭘 하고 있는지 모르겠다\' 는 표정을 짓고 있는 모습을 볼 수도 있습니다. 그렇다면 그냥 조용히 앉아서 버그를 못본 척 할 수도 있습니다. 최소한 멍청한 코멘트를 달았다고 당황하진 않을 테니까요. 당신은 더 똑똑해 보이기 위해 입을 다무는게 낫겠지요. 그렇겠지요? 틀렸다니까요!</p>\n<p>프로젝트(스폰서)는 괜찮은 모습을 보이라고 급여를 주는 게 아닙니다. 당신은 팀원에게 사랑받기 때문에 급여를 받는 게 아니라 매일 제품을 만들기 위해 급여를 받는 겁니다. 전문가로서 당신의 책임은 프로젝트를 위해 최선을 다하고, 그러기 위해 모두의 의견을 무시할 수도 있어야 합니다. 상급자의 의견도 포함해서요. <a href="http://www.yegor256.com/2015/01/26/happy-boss-false-objective.html">"행복한 상급자(대표) 만들기는 잘못된 목표다"</a> 라는 글의 내용과 비슷하게, \'팀에서 존경받는 사람 되기\'는 잘못된 목표라는 말씀을 드리고 싶습니다. 존경을 구걸하는 대신 깔끔한 코드를 짜면 자연스레 존경받게 됩니다.</p>\n<p>다시 한번 말씀드리자면 다른 사람의 코드에 잘못되거나 멍청한 코멘트를 달았다고 당황하게 되는 일을 두려워하지 마십시오. 다른 사람이 당신에게 가지고 있는 기대를 위하지 말고 프로젝트를 위해 최선을 다하십시오. 팀원들은 당신이 똑똑하고 총명하게 보이길 바랄 수 있겠지만, 프로젝트는 당신이 이 코드를 어떻게 생각하는지 말해주길 바랍니다. 그러니까 그런 사람들의 의견은 무시하세요. 당신이 올바르다고 생각하는 일을 하세요.</p>\n<h2 id="타협하지-않기no-compomise"><a href="#%ED%83%80%ED%98%91%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-compomise" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>타협하지 않기(No Compomise)</h2>\n<p>자, 당신은 두려움 없이 특정 코드에 대한 생각을 말하고 거부하였습니다. 당신이 평가하고 있던 브랜치는 좋지 않았고 그 이유도 설명했습니다. 그리고 작성자에게 이 부분은 고치고(Refactor) 저 부분은 다시 쓰라고 지시하였습니다. 그 다음은요?</p>\n<p>그/그녀는 당신과 거래를 하려고 할 겁니다. 이는 자연스러운 현상이고 저희 팀에서 제가 살펴보는 대부분의 브랜치에서 일어납니다. 코드의 작성자도 마찬가지로 전문 개발자이며 마찬가지로 두려움이 없습니다. 그래서 자신의 구현 방법이 옳았고 당신의 생각이 틀렸다고 주정합니다. 전문적인 코드 평가자라면 이 경우에 어떻게 해야할까요?</p>\n<p>가장 최악의 갈등 해결 방법은 \'\'타협하기\'\' 입니다. 나쁜 코드를 작성하는 것 보다 더 빠르게 제품의 질을 망치는 길입니다. 타협은 갈등 해결을 위해 양측이 원하는 것을 갖지 않기로(혹은 하지 않기로) 합의하는 방식의 갈등 조절 기술입니다. 다른 말로 표현하자면 <em>"우리 그만 싸우고 평화롭게 지내자"</em> 인데, 문제 해결 측면에서 최악의 방식입니다.</p>\n<p>좋지도 않은 타협을 하기보다, 전문가로서 코드 자체를 위해 실천할 수 있는 세 가지 방법이 있습니다.</p>\n<ul>\n<li><em>"당신 말이 맞아요, 제 생각을 철회합니다."</em>: 보통 이런 일이 자주 일어납니다. 당신은 자신의 실수를 인정할 준비가 되어있어야 합니다. 코드가 맘에 들지 않았지만 코드의 작성자가 이 코드를 적용할 때 생기는 이익을 설명하였고 당신은 그 로직을 받아들인 겁니다. 절대로 \'싸우기 싫어서\' 가 아니라 진정 로직을 이해하고 받아들이는 겁니다. 기꺼이 \'내가 틀렸습니다.\' 라고 말하는 것은 성숙하고 진지한 개발자의 첫 번째 덕목입니다.</li>\n<li><em>"난 절대 영원히 인정할 수 없어!"</em>: 어떤 코드는 이럴 수도 있는데, 이렇게 갈등을 해결하는 방법이 잘못된 것은 아닙니다. 상대방은 이 상황을 받아들이고 전부 다시 작성하게 되겠지요. 그리고 새로운 것도 배울 수 있을겁니다.</li>\n<li><em>"설계자가 뭐라고 하는지 들어보자!"</em>: 모든 프로젝트에는 최종적인 결정을 내리는 <a href="http://www.yegor256.com/2014/10/12/who-is-software-architect.html">소프트웨어 설계자</a>가 있습니다. 이 사람에게 말하고 최종적인 결정을 내려달라고 부탁해 보세요. 토론이 벌어지고 있는 상황에서 설계자를 대려온 다음 한쪽 편을 들어달라고 이야기하는 겁니다. 그 사람이 당신이 잘못되었다고 이야기한다면 그 결정을 받아들이고, 이번 경험에서 새로이 무언가를 배우도록 노력해보세요.</li>\n</ul>\n<p>이와 같이 당신의 의견을 고수하며 싸우거나 잘못되었음을 인정하세요. 한 쪽을 고르되 절대 타협하지 마십시오!</p>\n<p>제 말을 잘못 받아들이지 마시길 바랍니다. 고집불통이 되라거나 나쁜 패를 죽어도 놓지 않는(holding your cards no matter how bad they are) 사람이 되라는 이야기가 아닙니다. 유연하게 생각하고 배울 점은 배우세요. 당신의 입장은 협의를 하면서 얼마든지 변할 수 있습니다만, 맘에 들지 않는 어떤 것이라도 받아들이면 안됩니다. 당신은 상대가 옳았음을 완전히 받아들이거나 (아니면 그 반대), 설계자가 \'이렇게 해라\' 라고 말했을 때만 갈등에서 빠져나올 수 있습니다. 중간 지점은 없습니다.</p>\n<h2 id="개소리하지-않기no-bullshit"><a href="#%EA%B0%9C%EC%86%8C%EB%A6%AC%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-bullshit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>개소리하지 않기(No Bullshit)</h2>\n<p>이제 당신은 특정 메서드가 다르게 디자인 되어야한다고 고민없이 지적했습니다. 코드의 작성자는 그렇게 생각하지 않는다고 답변했지요. 그 코드를 다시 살펴보고 나서 자신의 주장을 굽히지 말아야겠다고 생각했다 칩시다. 당신은 여전히 자신이 옳다고 생각하고 타협할 생각도 없습니다. 이제 어떡할까요? 설계자를 부르기에 너무 이르기 때문에 상대방을 설득해보기로 했습니다.</p>\n<p>대부분의 경우 설득하는 일은 가르치는 일입니다. 당신은 상대방이 모르는 것을 알고 있기 때문에 그 메서드가 맘에 안든다고 생각했을 겁니다. 그 사람은 추가적인 교육이 필요한 상태이구요. 이제 동료를 가르칠 수 있는 기회가 왔습니다. 효과적인 가르침을 위해선 증거가 필요합니다. 당신은 자신의 논리를 단단히 하여 상대방이 이해하고 받아들일 수 있도록 해야합니다.</p>\n<p>링크나 기사, 책, 보고서, 예시 등을 준비하세요. <em>"나는 자바를 15년이나 써 왔으니 이걸 알고 있다"</em> 같은 소리는 도움이 되지 않습니다. 게다가 이런 방식의 논쟁은 당신의 설득력을 떨어뜨릴 뿐입니다.</p>\n<p>만약 설득하기 위한 증거가 충분하지 않다면 다시 생각해보세요. 당신이 틀렸을 수도 있습니다.</p>\n<p>그리고 당신이 하는 일은 평가하고 있는 코드가 잘못되었음을 증명하는 겁니다. 코드의 작성자는 아무것도 증명할 필요가 없습니다. 그/그녀의 코드는 기본적으로 훌륭하겠지요. 평가자는 어떻게, 왜 이 코드가 잘못된 경우인지 보여주어야 합니다. 다르게 말하자면 당신은 고소인이고 상대방은 피고소인이 되겠지요. 그 반대는 성립하지 않습니다(Not the other way around).</p>\n<h2 id="모욕하지-않기no-offense"><a href="#%EB%AA%A8%EC%9A%95%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-offense" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모욕하지 않기(No Offense)</h2>\n<p>제일 마지막이자 제일 어려운 원칙을 알려드리겠습니다. 아무리 코드가 형편 없고 코드의 작성자가 고집불통이라도 전문가의 태도를 유지하세요. 솔직히 말씀드리자면 때로는 저도 이렇게 하기 아주 어렵다고 생각합니다. <a href="http://www.teamed.io/">teamd.io는</a> 광범위한 팀으로 작업을 하고 있고 매주 몇 명의 새로운 사람들을 고용합니다. 그들 중 일부는 <a href="http://www.yegor256.com/2014/10/29/how-much-do-you-cost.html">우리의 심사 기준</a>에도 불구하고 다소 어리석게 대처하는 것 처럼 보입니다.</p>\n<p>약 1년 전에, 새로 온 개발자가 이미 있는 자바 라이브러리에 작지만 새로운 기능(약 20~30줄 짜리 코드)을 추가해야 했습니다. 저는 그 때 웃긴 일을 겪었습니다. 그는 수백줄 짜리 코드를 작성한 뒤에 저에게 풀 리퀘스트를 보냈습니다(제가 코드 평가자였습니다). 그 코드는 완전 쓰레기였으며 심지어 그 사람이 작성한 것도 아니었습니다. 저는 보자마자 이 사람이 어딘가에서 찾아낸 코드를 복사했다는 사실을 간파했습니다. 그런데 제가 어떻게 했을까요? 어떻게 \'당신의 태도는 전문적인 개발자로서 용납될 수 없다\' 며 길길이 날뛰지 않고 이 코드를 거부할 수 있었을까요? 저는 시간을 좀 내서 객관적으로 그의 코드를 비판했습니다. 스타일, 디자인 등 수많은 진지한 코멘트를 달아서 그에게 전부 고치라고 말했고, 그 사람은 쓰레기를 전부 지운 뒤에 바닥부터 다시 코드를 작성했습니다. 그 작업 이후에 그 사람을 다시 보는 일은 없었습니다.</p>\n<p>제가 말씀드리고 싶은 것은 전문가를 다룰 때는 전문가다운 생각을 하기 쉽지만 <em>(역주: 제대로된 코드를 보면 사람답게 대화할 수 있다는 뜻으로 보입니다)</em>, 언제나 다른 경우를 접할 수도 있습니다. 하지만 아무리 당신이 보고 있는 코드가 형편없더라도 참을성을 가지고 설득력 있게 대하십시오.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>정말 오랜만에 새 번역을 하게 되었습니다. 진작에 한번 읽어놓고 \'다음에 번역할 글은 너로 정했다!\' 라고 생각해놓고 모셔두었지만 어느새 시간이.. 바쁘다는 핑계는 댈 것도 없으며 제 자신의 게으름을 탓하게 됩니다.</p>\n<p>코드 리뷰(코드 평가)를 할 때 다른 분들은 어떻게 하는지 모르겠지만 여러 가지 이야기가 오가게 될 겁니다. 그 와중에 타협을 하는 경우도 적지 않게 많이 있을 테고, 아예 코드 리뷰 자체를 안하는 팀이 있을지도 모르겠네요. 타협과 관한 부분에서 특히 느낀 점이 많았습니다.</p>\n<p>아무쪼록 팀 단위로 작업을 하실 때 더 좋은 결과물을 만드는데 도움이 될 수 있기를 바랍니다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-05-27-four-nos-of-serious-code-reviewer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-05-27",path:"/posts/four-nos-of-serious-code-reviewer-kor",title:"[번역] 진짜배기 코드 평가자라면 하지 말아야 할 네 가지",tags:["Programming","Code Review","Translation"],category:"Translation"}},{excerpt:"이 포스트는  Alex Kotliarskyi 의  글 을 번역한 것입니다. 오역 지적 및 피드백은 언제나 환영합니다. 저는 드디어  Cheng Lou 가 ReactConf'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요. 요약:  언어가 있으면  메타언어 (고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE…",html:'<ul>\n<li><strong>이 포스트는 <a href="http://frantic.im/">Alex Kotliarskyi</a>의 <a href="http://frantic.im/meta-language">글</a>을 번역한 것입니다.</strong></li>\n<li><strong>오역 지적 및 피드백은 언제나 환영합니다.</strong></li>\n</ul>\n<hr>\n<p>저는 드디어 <a href="https://twitter.com/_chenglou">Cheng Lou</a>가 ReactConf\'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요.</p>\n<iframe width="560" height="315" src="https://www.youtube.com/embed/_0T5OSSzxms" frameborder="0" allowfullscreen></iframe>\n<p><strong>요약:</strong> 언어가 있으면 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%ED%83%80_%EC%96%B8%EC%96%B4">메타언어</a>(고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE 기능, 문서, 예제, 튜토리얼, 블로그 글, 책, 비디오, 컨퍼런스 등의 기술 발표 등)을 뜻한다. 우리는 언어를 배우기 위해 메타언어를 사용한다. 우리가 메타언어의 개념을 언어 자체로 끌어내리면, 우리가 다루는 개념은 더욱 유연해지고 점차 새로운 메타언어를 만들어나갈 수 있게 된다. 새로운 메타언어는 같은 에너지를 쏟아도 기존 메타언어에 비해 더 고차원적이고 풍부한 형태를 가질 수 있게 된다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 49.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQoz4WS226DMAyG+/7vtk2atHU3k3qBOLQhQCFRIHb+OZmg6WFdJCsG2Z9/O97hjxNCSDcRgewE6hQWrTCfTuB5vorJ/d3qxPuRERNsPeL0UsEWGjwO4GW5y1m/d7eV8orxNwuwqRy+9xPOZ4KjAE7xF8g80wWY05n5TiFLy9Vo8aE6vNUtDnpaWQkaWIDuAdAYg+PxKCrOKMsSRVHAOQe/eCin8Dl8JRsWLXM1opI3yOL+UZgeQixIEnnG5Gqo4R2t2OhKmFkJ8ALxMz+f4TboGCwt+b6GPbyC+gbwtHb723IUkAMfPX1+fFQ6jkDTgMoK3PeJtXUmBRdD1wpzWJxbL0ld18F7n8xYi0FmG/IOcp/Dc2DbtlBKFln2LdooCrXW2xhu9y/P/wHyLxHJM3AJqAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="The Flow"\n        title=""\n        src="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png"\n        srcset="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-d16f8.png 198w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-f21b1.png 395w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png 790w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-81e7e.png 1185w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-c6d11.png 1200w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>이 그림의 이해를 돕기 위해 다양한 예제를 준비해왔습니다.</p>\n<h2 id="어셈블리-명령어-→-변수명"><a href="#%EC%96%B4%EC%85%88%EB%B8%94%EB%A6%AC-%EB%AA%85%EB%A0%B9%EC%96%B4-%E2%86%92-%EB%B3%80%EC%88%98%EB%AA%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어셈블리 명령어 → 변수명</h2>\n<p>우주 산업 분야에서 행성으로부터의 <a href="https://ko.wikipedia.org/wiki/%ED%83%88%EC%B6%9C_%EC%86%8D%EB%8F%84">탈출 속도(escape velocity)</a>를 구하기 위해 사용되는 코드 일부를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-assembly"><code class="language-assembly">.SUB_0_21:\n    ; Computes escape velocity\n    ; register xmm0 - planet mass\n    ; retister xmm1 - planet radius\n    mulsd   xmm0, qword ptr [rip + .LCPI0_0]\n    divsd   xmm0, xmm1\n    xorps   xmm1, xmm1\n    sqrtsd  xmm1, xmm0\n    ucomisd xmm1, xmm1\n    jp      .LBB0_2\n    movapd  xmm0, xmm1\n    ret\n.LBB0_2:\n    jmp     sqrt                    ; TAILCALL\n.LCPI0_0:\n    .quad   4459223850755291651     ; double 1.334816E-10</code></pre>\n      </div>\n<p>코드의 상당수가 메타언어에 기대고 있습니다. 이 코드에 대한 주석이나 문서(여기엔 보이지 않지만) 말입니다. 위 코드와 비교해서 C로 작성된 예를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> GRAVITY_CONSTANT 6.67408e-11</span>\n<span class="token keyword">double</span> <span class="token function">escape_velocity</span><span class="token punctuation">(</span><span class="token keyword">double</span> mass<span class="token punctuation">,</span> <span class="token keyword">double</span> radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> GRAVITY_CONSTANT <span class="token operator">*</span> mass <span class="token operator">/</span> radius<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그저 변수에 이름을 지정해주었을 뿐인데 메타언어에 기대고 있던 정보를 언어 자체로 끌어내릴 수 있게 됐습니다.</p>\n<h2 id="변수명-→-심화-타입advanced-types"><a href="#%EB%B3%80%EC%88%98%EB%AA%85-%E2%86%92-%EC%8B%AC%ED%99%94-%ED%83%80%EC%9E%85advanced-types" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변수명 → 심화 타입(Advanced Types)</h2>\n<p>C 버전의 코드는 어셈블리로 작성된 코드보다 훨씬 많은 정보를 가지고 있고, 메타언어도 더 높은 수준으로 이루어져 있습니다. 이제 우리는 반복 작성을 하거나 코드 안의 내용이 무엇인지 문서화할 필요가 없어졌습니다. 이 함수가 2개의 인자를 받아야 하며 첫 번째 인자는 질량, 두 번째 인자는 반경이라는 내용 말입니다.</p>\n<p>하지만 아직 문맥상 코드에 부족한 부분이 있습니다. 이 함수가 어느 단위 위에서 동작하는지 알 수가 없다는 겁니다. 당장은 라이브러리의 문서(메타언어)에 기댈 수 밖에 없습니다.</p>\n<p>우리는 인자 이름을 <code class="language-text">mass_kilograms</code>, <code class="language-text">radius_meters</code> 같은 이름으로 바꾸는 간단한 트릭을 써 볼수 있지만, 언어 자체에서 \'이 함수는 반드시 킬로그램과 미터를 입력해야한다\'고 보장해주는 장치가 없습니다.</p>\n<p>이제 더 복잡한 타입을 지원하는 언어의 예를 살펴보겠습니다. 저는 OCaml을 사용하겠지만 대부분의 ML-계열 언어들(하스켈, 스위프트 등)은 이런 기능을 지원합니다. (<a href="https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/units-of-measure">그리고 F#은 아예 단위에 대해 가장 높은 우선 순위로 지원을 하고 있습니다.</a>)</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">=</span> <span class="token number">6.67408e-11</span>\n\n<span class="token keyword">type</span> mass <span class="token operator">=</span> Kilograms <span class="token keyword">of</span> float\n<span class="token keyword">type</span> length <span class="token operator">=</span> Meters <span class="token keyword">of</span> float\n<span class="token keyword">type</span> velocity <span class="token operator">=</span> MetersPerSecond <span class="token keyword">of</span> float\n\n<span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token punctuation">(</span>Kilograms mass<span class="token punctuation">)</span> <span class="token punctuation">(</span>Meters radius<span class="token punctuation">)</span> <span class="token operator">=</span>\n    MetersPerSecond <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*.</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">*.</span> mass <span class="token operator">/.</span> radius <span class="token operator">|></span> sqrt<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p><em>실은 지구로부터의 탈출 속도를 계산할 때 제 구현체에서 버그를 발견했습니다. 질량을 엉뚱한 단위로 입력하고 있었어요.</em></p>\n<p>위의 코드에서 <code class="language-text">length</code> 와 <code class="language-text">mass</code> 는 단순한 숫자가 아니라 1급 객체(first class citizen)입니다. 덕분에 더욱 안전하고 유지보수가 용이하며 코드를 발전시키기 쉬워졌지요. 예를 들어 우리가 야드파운드법을 지원하고자 한다면(왜 그래야하는지는 모르겠지만), <code class="language-text">mass</code> 타입을 이렇게 바꾸면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">type</span> mass <span class="token operator">=</span>\n  <span class="token operator">|</span> Kilograms <span class="token keyword">of</span> float\n  <span class="token operator">|</span> Pounds <span class="token keyword">of</span> float\n</code></pre>\n      </div>\n<p>이러면 타입 체커가 기존 코드에서 새 단위를 적용하기 위해 수정해야 할 부분을 낱낱이 지적해줄 겁니다.</p>\n<h2 id="사용되지-않을-경우deprecation와-다른-메타정보들"><a href="#%EC%82%AC%EC%9A%A9%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%84-%EA%B2%BD%EC%9A%B0deprecation%EC%99%80-%EB%8B%A4%EB%A5%B8-%EB%A9%94%ED%83%80%EC%A0%95%EB%B3%B4%EB%93%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용되지 않을 경우(Deprecation)와 다른 메타정보들</h2>\n<p>우리가 기존의 탈출 속도보다 훨씬 정확한 값을 구할 수 있는 새로운 공식을 발견했다고 칩시다. 그렇다면 기존의 함수가 더 이상 사용되지 않는다고 표시하려면 어떻게 해야할까요?</p>\n<p>이럴 때 보통 주석이나 문서를 추가하거나 Medium에 글을 쓰는 등 메타언어를 구축할 것입니다. 하지만 메타언어로 구성된 정보들을 코드 자체로 끌어내리는게 훨씬 더 생산적인 방법입니다.</p>\n<p>전에 썼던 트릭처럼 C 함수의 이름을 바꾸어 <code class="language-text">escape_velocity</code> 를 <code class="language-text">escape_velocity_DEPRECATED</code> 나 <a href="https://github.com/facebook/react/blob/80bff5397bf854750dbe7c286f61654ea58938c5/src/umd/ReactUMDEntry.js#L21">이렇게 괴상한 이름으로 바꿀 수도 있습니다</a>. 하지만 이는 우리의 API가 변경되면서 클라이언트의 코드가 동작하지 않게 되고, 표준적인 방법도 아닙니다(누구나 자신만의 접미사를 붙일 수 있으니까요). 그리고 새로이 사용해야 할 메서드를 제대로 추천하지 않고 있습니다.</p>\n<p>만약 언어 자체가 이 메타정보를 알아서 알려주는 기능을 지원한다면 어떨까요?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">[</span><span class="token operator">@</span>ocaml<span class="token punctuation">.</span>deprecated <span class="token string">"Please use `quantum_escape` instead"</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<h2 id="추가-예시"><a href="#%EC%B6%94%EA%B0%80-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>추가 예시</h2>\n<p>지금까지 메타적 공간에 있던 많은 정보를 언어 자체에 심어주는 하나의 방법을 보여드렸습니다. 다른 예들을 보여드리겠습니다.</p>\n<p><strong><a href="https://ko.wikipedia.org/wiki/%EB%B9%84%EC%A7%80%ED%84%B0_%ED%8C%A8%ED%84%B4">방문자 패턴(Visitor Pattern)</a>과 <code class="language-text">for</code> 루프 → map/filter/reduce:</strong> 제가 대학에 다닐 땐 방문자 패턴을 배웠지만, 이젠 이 패턴이 많은 언어에서 기본 라이브러리로 손쉽게 제공되고 있습니다.</p>\n<p><strong>상태(state) 불러오기:</strong> 저는 종종 사람들이 리액트 컴포넌트를 만들면서 상태를 이렇게 설정해두는 것을 보게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript">state <span class="token operator">=</span> <span class="token punctuation">{</span>\n  data<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  error<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이 경우 <code class="language-text">loading</code> 이 <code class="language-text">false</code> 라면 <code class="language-text">data</code> 나 <code class="language-text">error</code> 중에 하나가 <code class="language-text">null</code> 이 되어서는 안된다는 안내를 하려면 메타언어를 사용할 수 밖에 없습니다. 그 대신 우리는 Flow나 타입스크립트(Typescript)를 사용하여 언어 단위에서 제약을 걸 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> State <span class="token operator">=</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'loading\'</span> <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'done\'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> Object <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'error\'</span><span class="token punctuation">,</span> error<span class="token punctuation">:</span> Error <span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>리덕스(Redux)와 불변성(Immutability):</strong> 현재는 문서, 블로그 포스트, 비디오, 컨퍼런스 발표 등에서 리덕스를 사용할 때 변수나 객체에 직접적으로 변화를 주지 않을 것을(lack of direct mutation) 전제하고 있습니다. 만약 자바스크립트가 기본적으로 불변 데이터 타입과 타입 선언(type annotations)을 제공한다면 위에서 말하는 전제를 코드에서 바로 표현할 수 있지 않을까요?</p>\n<p><strong>프로미스(Promises)와 옵저버블(Observables):</strong> 자바스크립트에서 프로미스 패턴은 라이브러리에서 제공하는 기능이었지만 이제 코어 기능으로 자리잡았습니다. <a href="https://github.com/tc39/proposal-observable">옵저버블</a>에도 같은 과정이 진행중입니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>아무리 메타언어를 언어로 끌어내린다 하더라도 사람 사이에 의사소통하는 부분을 해결할 수는 없다는 것을 새겨두시는게 좋습니다. 하지만 언어의 진화와 함께 우리는 더 효과적인 의사소통의 기회를 열어가고 있습니다.</p>\n<p>반드시 어딘가엔 복잡한 부분이 존재합니다. 만약 언어가 아주 단순하다면, 복잡한 부분은 메타언어에 머무르게 됩니다.</p>\n<p>참고로  <a href="https://www.youtube.com/watch?v=4anAwXYqLG8">Sebastian Markbåge의 최소한의 API 표현 범위(minimal API surface area)에 관한 발표와</a>, <a href="https://www.youtube.com/watch?v=V1po0BT7kac">Jared Forsyth의 타입 시스템에 대한 발표</a>를 살펴보세요. 아 그리고 영화 <a href="http://movie.daum.net/moviedb/main?movieId=105570">컨택트(Arrival, 2016)</a>도 꼭 보세요. 강추합니다!</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>처음 이 글을 접하게 된 계기는 이 코드 때문이었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// explicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n\n<span class="token comment">// implicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>보고 계시는 자바스크립트 코드에서 위쪽에 제시된 코드가 평균적으로 최대 15%까지 처리 속도가 빠르다고 합니다. <a href="https://twitter.com/dhh/status/846627223176167424">DHH는 트위터에서</a> \'어차피 15%라고 해봤자 실제로는 몇 밀리초 이하일텐데 왜 기계에게 맞추려고 하느냐\' 같은 내용의 비판을 쏟아내었지요. 코드를 어떻게 작성하실건지는 여러분의 취향에 맡기겠습니다.</p>\n<p>하지만 오늘 제가 드리고픈 말씀은 아래 트윗에 다 있기 때문에 후기를 짧게 줄이고자 합니다.</p>\n<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/dhh">@dhh</a> Code is not a conversation between a dev and a machine.&#13;&#13;Code is a conversation between a developer AND THE NEXT DEVELOPER.</p>&mdash; Don Schenck (@DonSchenck) <a href="https://twitter.com/DonSchenck/status/846675893909180416">March 28, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>',id:"/home/circleci/repo/src/pages/posts/2017-04-04-understanding-taming-the-meta-language-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-04",path:"/posts/understanding-taming-the-meta-language-kor",title:"[번역] 메타언어 길들이기",tags:["Programming","Learning","Translation"],category:"Translation"}}],"Code Review":[{excerpt:"이 글의 원문은  Yegor Bugayenko가 작성하였습니다. 오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다. 코드 평가 (다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development…",html:'<ul>\n<li>이 글의 원문은 <a href="http://www.yegor256.com/2015/02/09/serious-code-reviewer.html">Yegor Bugayenko가 작성하였습니다.</a></li>\n<li>오역 지적 및 더 나은 번역을 위한 제안은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p><a href="http://en.wikipedia.org/wiki/Code_review">코드 평가</a>(다른 말로 동료 평가)는 모든 소프트웨어 개발 팀의 필수 원칙이 되어야합니다. 제 말에 이견이 없기를 바랍니다. 어떤 팀은 머지가 되기 전에 코드 평가를 하여 master/development 브랜치에 우연찮은 실수가 <a href="http://www.yegor256.com/2014/07/21/read-only-master-branch.html">덮어씌워지지 않도록</a> 하고, 어떤 팀은 머지가 된 후에 버그나 어긋나는 점을 발견하기 위해 코드의 작성자와 <a href="http://www.yegor256.com/2014/12/18/independent-technical-reviews.html">일반적인 평가</a>를 합니다. 어떤 팀은 둘 다 하기도 합니다. 코드 평가는 평가자가 소프트웨어 전체 소스의 접근 권한을 가지고 결점을 찾아내는 <a href="https://ko.wikipedia.org/wiki/%ED%99%94%EC%9D%B4%ED%8A%B8%EB%B0%95%EC%8A%A4_%EA%B2%80%EC%82%AC">화이트박스 평가</a> 기술과 아주 유사합니다. 어느 경우든 코드 평가는 퀄리티 향상 및 팀의 동기 부여를 위한 좋은 도구가 됩니다.</p>\n<p>하지만 코드 평가를 제대로 하기는 어렵습니다. 오히려 잘못 하기가 훨씬 쉽다고 말씀드리고 싶습니다. 제가 여태까지 본 바로는 대부분의 코드 평가와 평가자는 비슷한 실수를 반복해왔습니다. 그래서 제가 알고 있는 좋은 코드 평가자들이 가지고 있는 네 가지 기본 원칙을 정리하는 글을 작성하게 되었습니다. 이 글이 도움이 되길 바랍니다.</p>\n<h2 id="두려움을-가지지-않기no-fear"><a href="#%EB%91%90%EB%A0%A4%EC%9B%80%EC%9D%84-%EA%B0%80%EC%A7%80%EC%A7%80-%EC%95%8A%EA%B8%B0no-fear" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>두려움을 가지지 않기(No Fear)</h2>\n<p>진짜배기 코드 평가자라면 갖지 말아야 할 몇 가지 두려움이 있습니다. 첫 번째이자 가장 유명한 두려움은 코드의 작성자를 공격하는 일입니다. <em>"오늘은 그냥 눈을 감고 저 버그를 못 본척 하면 내일 작성자는 내 실수(버그를 못 봄)를 알아차리지 못할거야."</em> - 이런 태도가 만들어내는 두려움입니다. 말할 필요도 없겠지만 이는 비생산적이고 코드 퀄리티와 팀의 사기를 낮추는 일입니다. 조언을 드리자면 직설적이고, 솔직하고, 간결하게 이야기하세요. 당신이 이 코드가 맘에 들지 않는다면 말 그대로 맘에 들지 않는겁니다. 당신의 의견이 코드의 작성자에게 어떻게 받아들여질지 신경쓸 필요가 없습니다.</p>\n<p>만약 당신이 동료를 향해 신경쓰이는 기분이 든다면 회사 혹은 팀의 경영 측면에서 문제가 있는 겁니다. 되려 못하는 사람에게 "팀 플레이어가 아니다" 라는 낙인찍힐까봐 두려워하고 있는 겁니다. 평가를 해야 하는 사람은 프로젝트 스폰서입니다. 스폰서는 당신이 제품의 질을 신경쓰지 않는 다른사람을 불쾌하게 한다고 얼마나 개선이 될 지 신경쓰지 않습니다. 그저 제품을 생산하여 사용자들로부터 돈을 벌어오길 원합니다. 스폰서는 당신이 <a href="http://www.yegor256.com/2015/10/06/how-to-be-good-office-slave.html">회사에서</a> 친구를 사귀라고 급여를 주는 게 아닙니다.</p>\n<p>다른 종류의 두려움은 이런 식으로 나타납니다. <em>"내가 이 코드를 거부하면 제품 발매(release)가 늦어질거야."</em> - 다시 한 번, 이런 태도는 프로젝트 전체에 커다란 해가 된다는 말씀을 드리고 싶습니다. 당신은 코드에서 마음에 들지 않는 부분을 눈 감고 외면한 뒤에 승인을 합니다. 코드는 다음 배포판에 포함될 예정이고 더 빨리 출시할 수 있게 되었습니다. 발매를 늦추는 병목현상도 없었으며 아무도 당신에게 \'저 지멋대로인 코드 평가자 때문에 발매가 늦춰지고 돈을 덜 벌게 되었다\' 는 말을 하지 않습니다. 당신은 좋은 팀 플레이어입니다. 그럴까요? 그럴리가요!</p>\n<p>지난 번 <a href="http://www.yegor256.com/2015/01/15/how-to-cut-corners.html">제가 언급했듯이</a>, 전문적인 팀 플레이어는 자신의 역할이 다른 사람 뒤를 봐주는 일이 아니라는 것을 알고 있습니다. <a href="http://www.yegor256.com/2015/11/24/imprisonment-for-irresponsible-coding.html">나쁜 코드</a>를 거부하여 발매가 늦어진다면, 이는 코드 작성자의 잘못입니다. 전문가로서 당신의 책임은 이런 결점을 찾아내는 것입니다. 이렇게 팀의 학습과 발전을 위해 도움을 주어야 합니다.</p>\n<p>저는 팀의 학습과 성장을 위해서 가장 먼저 해야할 일이 나쁜 프로그래머를 없애고 좋은 프로그래머를 끌어올리는 것이라 생각합니다. 솔직하고 두려움 없는 코드 평가자들은 팀의 학습과 성장을 돕습니다.</p>\n<p>또 이런 두려움도 있습니다. <em>"내가 잘못 본거라면 다른 사람들에게 놀림받을 거야"</em> - 더 심하면 다른 사람들이 당신이 부족한 지식을 가지고 있다고 지적할 수도 있고, 당신이 \'내가 대체 뭘 하고 있는지 모르겠다\' 는 표정을 짓고 있는 모습을 볼 수도 있습니다. 그렇다면 그냥 조용히 앉아서 버그를 못본 척 할 수도 있습니다. 최소한 멍청한 코멘트를 달았다고 당황하진 않을 테니까요. 당신은 더 똑똑해 보이기 위해 입을 다무는게 낫겠지요. 그렇겠지요? 틀렸다니까요!</p>\n<p>프로젝트(스폰서)는 괜찮은 모습을 보이라고 급여를 주는 게 아닙니다. 당신은 팀원에게 사랑받기 때문에 급여를 받는 게 아니라 매일 제품을 만들기 위해 급여를 받는 겁니다. 전문가로서 당신의 책임은 프로젝트를 위해 최선을 다하고, 그러기 위해 모두의 의견을 무시할 수도 있어야 합니다. 상급자의 의견도 포함해서요. <a href="http://www.yegor256.com/2015/01/26/happy-boss-false-objective.html">"행복한 상급자(대표) 만들기는 잘못된 목표다"</a> 라는 글의 내용과 비슷하게, \'팀에서 존경받는 사람 되기\'는 잘못된 목표라는 말씀을 드리고 싶습니다. 존경을 구걸하는 대신 깔끔한 코드를 짜면 자연스레 존경받게 됩니다.</p>\n<p>다시 한번 말씀드리자면 다른 사람의 코드에 잘못되거나 멍청한 코멘트를 달았다고 당황하게 되는 일을 두려워하지 마십시오. 다른 사람이 당신에게 가지고 있는 기대를 위하지 말고 프로젝트를 위해 최선을 다하십시오. 팀원들은 당신이 똑똑하고 총명하게 보이길 바랄 수 있겠지만, 프로젝트는 당신이 이 코드를 어떻게 생각하는지 말해주길 바랍니다. 그러니까 그런 사람들의 의견은 무시하세요. 당신이 올바르다고 생각하는 일을 하세요.</p>\n<h2 id="타협하지-않기no-compomise"><a href="#%ED%83%80%ED%98%91%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-compomise" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>타협하지 않기(No Compomise)</h2>\n<p>자, 당신은 두려움 없이 특정 코드에 대한 생각을 말하고 거부하였습니다. 당신이 평가하고 있던 브랜치는 좋지 않았고 그 이유도 설명했습니다. 그리고 작성자에게 이 부분은 고치고(Refactor) 저 부분은 다시 쓰라고 지시하였습니다. 그 다음은요?</p>\n<p>그/그녀는 당신과 거래를 하려고 할 겁니다. 이는 자연스러운 현상이고 저희 팀에서 제가 살펴보는 대부분의 브랜치에서 일어납니다. 코드의 작성자도 마찬가지로 전문 개발자이며 마찬가지로 두려움이 없습니다. 그래서 자신의 구현 방법이 옳았고 당신의 생각이 틀렸다고 주정합니다. 전문적인 코드 평가자라면 이 경우에 어떻게 해야할까요?</p>\n<p>가장 최악의 갈등 해결 방법은 \'\'타협하기\'\' 입니다. 나쁜 코드를 작성하는 것 보다 더 빠르게 제품의 질을 망치는 길입니다. 타협은 갈등 해결을 위해 양측이 원하는 것을 갖지 않기로(혹은 하지 않기로) 합의하는 방식의 갈등 조절 기술입니다. 다른 말로 표현하자면 <em>"우리 그만 싸우고 평화롭게 지내자"</em> 인데, 문제 해결 측면에서 최악의 방식입니다.</p>\n<p>좋지도 않은 타협을 하기보다, 전문가로서 코드 자체를 위해 실천할 수 있는 세 가지 방법이 있습니다.</p>\n<ul>\n<li><em>"당신 말이 맞아요, 제 생각을 철회합니다."</em>: 보통 이런 일이 자주 일어납니다. 당신은 자신의 실수를 인정할 준비가 되어있어야 합니다. 코드가 맘에 들지 않았지만 코드의 작성자가 이 코드를 적용할 때 생기는 이익을 설명하였고 당신은 그 로직을 받아들인 겁니다. 절대로 \'싸우기 싫어서\' 가 아니라 진정 로직을 이해하고 받아들이는 겁니다. 기꺼이 \'내가 틀렸습니다.\' 라고 말하는 것은 성숙하고 진지한 개발자의 첫 번째 덕목입니다.</li>\n<li><em>"난 절대 영원히 인정할 수 없어!"</em>: 어떤 코드는 이럴 수도 있는데, 이렇게 갈등을 해결하는 방법이 잘못된 것은 아닙니다. 상대방은 이 상황을 받아들이고 전부 다시 작성하게 되겠지요. 그리고 새로운 것도 배울 수 있을겁니다.</li>\n<li><em>"설계자가 뭐라고 하는지 들어보자!"</em>: 모든 프로젝트에는 최종적인 결정을 내리는 <a href="http://www.yegor256.com/2014/10/12/who-is-software-architect.html">소프트웨어 설계자</a>가 있습니다. 이 사람에게 말하고 최종적인 결정을 내려달라고 부탁해 보세요. 토론이 벌어지고 있는 상황에서 설계자를 대려온 다음 한쪽 편을 들어달라고 이야기하는 겁니다. 그 사람이 당신이 잘못되었다고 이야기한다면 그 결정을 받아들이고, 이번 경험에서 새로이 무언가를 배우도록 노력해보세요.</li>\n</ul>\n<p>이와 같이 당신의 의견을 고수하며 싸우거나 잘못되었음을 인정하세요. 한 쪽을 고르되 절대 타협하지 마십시오!</p>\n<p>제 말을 잘못 받아들이지 마시길 바랍니다. 고집불통이 되라거나 나쁜 패를 죽어도 놓지 않는(holding your cards no matter how bad they are) 사람이 되라는 이야기가 아닙니다. 유연하게 생각하고 배울 점은 배우세요. 당신의 입장은 협의를 하면서 얼마든지 변할 수 있습니다만, 맘에 들지 않는 어떤 것이라도 받아들이면 안됩니다. 당신은 상대가 옳았음을 완전히 받아들이거나 (아니면 그 반대), 설계자가 \'이렇게 해라\' 라고 말했을 때만 갈등에서 빠져나올 수 있습니다. 중간 지점은 없습니다.</p>\n<h2 id="개소리하지-않기no-bullshit"><a href="#%EA%B0%9C%EC%86%8C%EB%A6%AC%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-bullshit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>개소리하지 않기(No Bullshit)</h2>\n<p>이제 당신은 특정 메서드가 다르게 디자인 되어야한다고 고민없이 지적했습니다. 코드의 작성자는 그렇게 생각하지 않는다고 답변했지요. 그 코드를 다시 살펴보고 나서 자신의 주장을 굽히지 말아야겠다고 생각했다 칩시다. 당신은 여전히 자신이 옳다고 생각하고 타협할 생각도 없습니다. 이제 어떡할까요? 설계자를 부르기에 너무 이르기 때문에 상대방을 설득해보기로 했습니다.</p>\n<p>대부분의 경우 설득하는 일은 가르치는 일입니다. 당신은 상대방이 모르는 것을 알고 있기 때문에 그 메서드가 맘에 안든다고 생각했을 겁니다. 그 사람은 추가적인 교육이 필요한 상태이구요. 이제 동료를 가르칠 수 있는 기회가 왔습니다. 효과적인 가르침을 위해선 증거가 필요합니다. 당신은 자신의 논리를 단단히 하여 상대방이 이해하고 받아들일 수 있도록 해야합니다.</p>\n<p>링크나 기사, 책, 보고서, 예시 등을 준비하세요. <em>"나는 자바를 15년이나 써 왔으니 이걸 알고 있다"</em> 같은 소리는 도움이 되지 않습니다. 게다가 이런 방식의 논쟁은 당신의 설득력을 떨어뜨릴 뿐입니다.</p>\n<p>만약 설득하기 위한 증거가 충분하지 않다면 다시 생각해보세요. 당신이 틀렸을 수도 있습니다.</p>\n<p>그리고 당신이 하는 일은 평가하고 있는 코드가 잘못되었음을 증명하는 겁니다. 코드의 작성자는 아무것도 증명할 필요가 없습니다. 그/그녀의 코드는 기본적으로 훌륭하겠지요. 평가자는 어떻게, 왜 이 코드가 잘못된 경우인지 보여주어야 합니다. 다르게 말하자면 당신은 고소인이고 상대방은 피고소인이 되겠지요. 그 반대는 성립하지 않습니다(Not the other way around).</p>\n<h2 id="모욕하지-않기no-offense"><a href="#%EB%AA%A8%EC%9A%95%ED%95%98%EC%A7%80-%EC%95%8A%EA%B8%B0no-offense" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모욕하지 않기(No Offense)</h2>\n<p>제일 마지막이자 제일 어려운 원칙을 알려드리겠습니다. 아무리 코드가 형편 없고 코드의 작성자가 고집불통이라도 전문가의 태도를 유지하세요. 솔직히 말씀드리자면 때로는 저도 이렇게 하기 아주 어렵다고 생각합니다. <a href="http://www.teamed.io/">teamd.io는</a> 광범위한 팀으로 작업을 하고 있고 매주 몇 명의 새로운 사람들을 고용합니다. 그들 중 일부는 <a href="http://www.yegor256.com/2014/10/29/how-much-do-you-cost.html">우리의 심사 기준</a>에도 불구하고 다소 어리석게 대처하는 것 처럼 보입니다.</p>\n<p>약 1년 전에, 새로 온 개발자가 이미 있는 자바 라이브러리에 작지만 새로운 기능(약 20~30줄 짜리 코드)을 추가해야 했습니다. 저는 그 때 웃긴 일을 겪었습니다. 그는 수백줄 짜리 코드를 작성한 뒤에 저에게 풀 리퀘스트를 보냈습니다(제가 코드 평가자였습니다). 그 코드는 완전 쓰레기였으며 심지어 그 사람이 작성한 것도 아니었습니다. 저는 보자마자 이 사람이 어딘가에서 찾아낸 코드를 복사했다는 사실을 간파했습니다. 그런데 제가 어떻게 했을까요? 어떻게 \'당신의 태도는 전문적인 개발자로서 용납될 수 없다\' 며 길길이 날뛰지 않고 이 코드를 거부할 수 있었을까요? 저는 시간을 좀 내서 객관적으로 그의 코드를 비판했습니다. 스타일, 디자인 등 수많은 진지한 코멘트를 달아서 그에게 전부 고치라고 말했고, 그 사람은 쓰레기를 전부 지운 뒤에 바닥부터 다시 코드를 작성했습니다. 그 작업 이후에 그 사람을 다시 보는 일은 없었습니다.</p>\n<p>제가 말씀드리고 싶은 것은 전문가를 다룰 때는 전문가다운 생각을 하기 쉽지만 <em>(역주: 제대로된 코드를 보면 사람답게 대화할 수 있다는 뜻으로 보입니다)</em>, 언제나 다른 경우를 접할 수도 있습니다. 하지만 아무리 당신이 보고 있는 코드가 형편없더라도 참을성을 가지고 설득력 있게 대하십시오.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>정말 오랜만에 새 번역을 하게 되었습니다. 진작에 한번 읽어놓고 \'다음에 번역할 글은 너로 정했다!\' 라고 생각해놓고 모셔두었지만 어느새 시간이.. 바쁘다는 핑계는 댈 것도 없으며 제 자신의 게으름을 탓하게 됩니다.</p>\n<p>코드 리뷰(코드 평가)를 할 때 다른 분들은 어떻게 하는지 모르겠지만 여러 가지 이야기가 오가게 될 겁니다. 그 와중에 타협을 하는 경우도 적지 않게 많이 있을 테고, 아예 코드 리뷰 자체를 안하는 팀이 있을지도 모르겠네요. 타협과 관한 부분에서 특히 느낀 점이 많았습니다.</p>\n<p>아무쪼록 팀 단위로 작업을 하실 때 더 좋은 결과물을 만드는데 도움이 될 수 있기를 바랍니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-05-27-four-nos-of-serious-code-reviewer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-05-27",path:"/posts/four-nos-of-serious-code-reviewer-kor",title:"[번역] 진짜배기 코드 평가자라면 하지 말아야 할 네 가지",tags:["Programming","Code Review","Translation"],category:"Translation"}}],"Vue.js":[{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 로그인 페이지를 만드는데도 꽤 많은 노력이 들었지만, 기존에 사용하시던 방법으로 같은 페이지를 작성한다고 했을 때 얼마나 시간과 노력이 드는지 한번 생각해보시면 Vue.js…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p>로그인 페이지를 만드는데도 꽤 많은 노력이 들었지만, 기존에 사용하시던 방법으로 같은 페이지를 작성한다고 했을 때 얼마나 시간과 노력이 드는지 한번 생각해보시면 Vue.js로 구현하는 쪽이 약간 쉽지 않으셨는지요?</p>\n<p>가계부 페이지 구현은 로그인 페이지보다 내용이 약간 길어지겠지만 여전히 그렇게 어려운 난이도는 아닙니다. 비슷한 페이지를 예전에 React로 만들어 본 적이 있었는데 지금 생각해보면 코드를 따라 쳐 봤을 뿐이지 실질적인 내용은 거의 이해가 되지 않았네요. <strong>참고로 이 글의 내용이 이해가 잘 되지 않으시면 언제든지 질문 및 지적 부탁드립니다.</strong></p>\n<p>처음에 API서버를 만들 때 구상해 두었던 요소들보다 조금 축소되긴 했지만 다음의 기능을 구현해볼 예정입니다. 혹시나 아쉽다고 느끼시는 분들은 직접 구현에 도전해보시는 것도 좋은 배움의 기회가 될 수 있겠네요.</p>\n<ul>\n<li>Amount, Description 을 입력하여 기록</li>\n<li>최신 시간 순서대로 내용을 표로 출력</li>\n<li>\n<p>Edit, Delete 버튼을 눌러서 자료의 수정 및 삭제</p>\n<ul>\n<li>Edit 버튼을 누르면 해당 레코드의 내용이 자동으로 수정 Form으로 변화</li>\n</ul>\n</li>\n<li>모든 수익, 지출과 그 합계를 모아 상단에 대시보드 형식으로 표시</li>\n</ul>\n<p>기존 방식대로 레일즈나 하나미로 웹 애플리케이션을 만들었을 때는 모든 값을 서버에서 미리 계산해두고, 랜더링된 값을 클라이언트로 전달해주면 클라이언트는 받은 페이지를 불러오는 정도의 역할을 수행했었습니다. 하지만 자바스크립트를 적극적으로 활용하면 서버에서는 레코드만 던져주고, 브라우저에서 랜더링에 필요한 값을 계산하여 출력해 줄 수 있게 됩니다.</p>\n<h2 id="페이지-틀-만들기"><a href="#%ED%8E%98%EC%9D%B4%EC%A7%80-%ED%8B%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>페이지 틀 만들기</h2>\n<p>먼저 Vue 인스턴스와 연결할 HTML 페이지를 만들겠습니다. 파일 이름은 <code class="language-text">content.html</code> 이며, 이전에 만들었던 페이지와 같은 폴더에 위치해야 합니다. 불러와야 하는 자바스크립트 라이브러리가 하나 변경된 수준입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.0/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p><code class="language-text">moment</code> 라이브러리는 자바스크립트에서 시간을 다루는 데 필요한 최고의 라이브러리입니다. 현재 서버에 자료를 저장할 때 각 레코드의 <code class="language-text">created_at</code>, <code class="language-text">updated_at</code> 이 UTC 기준으로 저장되어 있는데, 서버에서 이 시간을 변경해서 보내주기보다 클라이언트에서 직접 시간대를 변경하여 알맞은 형식으로 표현하는 것 까지 처리할 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">\n<span class="token selector">html, body</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #E6E6E6<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">#app</span> <span class="token punctuation">{</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">margin</span><span class="token punctuation">:</span> 1.5rem 0<span class="token punctuation">;</span>\n  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.title</span> <span class="token punctuation">{</span>\n  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.message:not(:last-child)</span> <span class="token punctuation">{</span>\n  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.message-body</span> <span class="token punctuation">{</span>\n  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.button</span> <span class="token punctuation">{</span>\n  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.income</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.outcome</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-10 is-offset-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--title--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title is-2 is-spaced<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Your Records<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--input form--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field has-addons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>amount<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Amount<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control is-expanded<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Description<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Save<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--dashboard--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Income<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Outcome<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Total<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--contents--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Record Time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Amount<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Description<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Delete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Edit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>단순히 입력 태그가 맨 윗쪽에 있고, 대시보드, 테이블 순으로 자료가 표시되는 구조입니다. 이 안에 어떻게 내용을 채워나가게 될 지 기대해주세요.</p>\n<h2 id="인증-및-자료-가져오기"><a href="#%EC%9D%B8%EC%A6%9D-%EB%B0%8F-%EC%9E%90%EB%A3%8C-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>인증 및 자료 가져오기</h2>\n<p>지난번 로그인 페이지를 만들 때 로그인이 성공하면 JWT 토큰을 저장하고, 이 <code class="language-text">content.html</code> 페이지로 이동하도록 만들어 두었습니다. 그러면 당연하게도 <code class="language-text">content.html</code> 페이지를 이용할 수 있는 사람은 유효한 토큰을 가지고 있는 사람이어야 합니다.</p>\n<p>페이지가 처음 랜더링 될 때 무언가 행동을 지시하려면 Vue 인스턴스에 <code class="language-text">created</code> 를 지정하면 됩니다. Vue 인스턴스의 라이프사이클을 더 자세히 보시려면 <a href="https://kr.vuejs.org/v2/guide/instance.html#%EB%9D%BC%EC%9D%B4%ED%94%84%EC%82%AC%EC%9D%B4%ED%81%B4-%EB%8B%A4%EC%9D%B4%EC%96%B4%EA%B7%B8%EB%9E%A8">다음 가이드</a>를 참고해주세요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    records<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./login.html\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>인스턴스가 만들어질 때 토큰을 가져오고, 만약 해당 토큰이 없다고 하면 로그인 페이지로 되돌립니다. <code class="language-text">fetchData</code> 는 바로 아래에 구현할 메서드인데, 여기서도 만약 유효하지 않은 토큰이라고 판명되면 로그인 페이지로 되돌립니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'get\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token string">\'http://localhost:2300/api/records\'</span><span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>records <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>records<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>ersponse<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./login.html\'</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token comment">// handle error</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>토큰이 있다면 <code class="language-text">fetchData</code> 메서드로 토큰을 실어 서버에 요청을 보내게 됩니다. 이미 API 서버를 만들 때 유효하지 않은 토큰이라면 401에러를 리턴하도록 만들어두었기 때문에, 그냥 로그인 페이지로 돌려버리면 됩니다. 만에 하나 다른 에러가 출력된다면 여러분들이 편한 방법대로 에러를 다루면 될 것입니다.</p>\n<p>잘 작동하는지 테스트하실 때는 하나미 API 서버를 미리 켜두시는 것을 잊지 마시기 바랍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami server</code></pre>\n      </div>\n<p>당장은 저장된 자료가 없기 때문에 POSTMAN으로 일일이 요청을 보내어 자료를 생성할 수 밖에 없을겁니다. 그냥 하나미 콘솔에서 임의의 자료를 몇 개 생성해두록 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami console\n-------------------------\n[2] pry(main)&gt; 15.times do\n[2] pry(main)*   RecordRepository.new.create(\n[2] pry(main)*     user_id: 5, // Your favorite user id\n[2] pry(main)*     amount: [-1000, -5000, 5000, 1000, 10000].sample,\n[2] pry(main)*     description: %w(FUS RO DAH).sample\n[2] pry(main)*   )\n[2] pry(main)* end</code></pre>\n      </div>\n<p>이제 랜더링 된 후에 브라우저 콘솔에서 <code class="language-text">app.records</code> 명령어를 입력해보시면 가져온 자료들이 배열로 표시됩니다.</p>\n<h2 id="대시보드-표시하기"><a href="#%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%ED%91%9C%EC%8B%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>대시보드 표시하기</h2>\n<p>대시보드에 쓰일 자료를 자바스크립트로 계산하여 표시해주는 작업은 <code class="language-text">computed</code> 속성에 정의해두면 됩니다. <code class="language-text">data</code> 들을 다루어 계산된 결과를 리턴해주고, 만약 값의 변화가 있다면 바로 반영됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">sumOfIncome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>amount <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> income<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> income<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n    <span class="token function">sumOfOutcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>amount <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> outcome<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> outcome<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n    <span class="token function">totalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> record<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> sum <span class="token operator">+</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>수입과 지출을 표시해주는 함수는 <code class="language-text">records</code> 배열에서 각각 0보다 크거나 작은 수를 추린 뒤에 모든 수를 합치고, 전체 합계를 표시해주는 함수는 그냥 더해주기만 하면 됩니다. <code class="language-text">filter</code>, <code class="language-text">map</code> 등에 바로 이어 <code class="language-text">reduce</code> 를 활용해주는 방법은 여러모로 유용하게 사용할 수 있습니다.</p>\n<p>이 계산된 값을 바로 HTML 태그 안에 <code class="language-text">{{ }}</code> 로 감싸주어 입력해주시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--dashboard--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Income<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ sumOfIncome }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Outcome<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ sumOfOutcome }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message is-info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Total<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        {{ totalAmount }}\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<h2 id="전체-자료-표로-표시하기"><a href="#%EC%A0%84%EC%B2%B4-%EC%9E%90%EB%A3%8C-%ED%91%9C%EB%A1%9C-%ED%91%9C%EC%8B%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전체 자료 표로 표시하기</h2>\n<p>API 서버에 요청하여 가져온 자료를 바로 쓰는데는 몇 가지 문제가 있습니다.</p>\n<ol>\n<li>오래된 자료가 먼저 나옵니다. 보통은 최신 순서로 정렬을 하게 되지요.</li>\n<li>시간 표시가 UTC인데다가, 바로 표시하기 어려운 형식으로 나옵니다.</li>\n</ol>\n<p>그러면 우리는 자료 표시 순서를 뒤집어주고, 시간 표시를 더 깔끔하게 해 주면 되겠네요. 여기서도 <code class="language-text">computed</code> 를 활용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\ncomputed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">allRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> createdAt <span class="token operator">=</span> record<span class="token punctuation">.</span>created_at<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\sUTC$/</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">let</span> localCreatedAt <span class="token operator">=</span> moment<span class="token punctuation">.</span><span class="token function">utc</span><span class="token punctuation">(</span>createdAt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">\'YYYY-MM-DD HH:mm:ss\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        id<span class="token punctuation">:</span> record<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n        amount<span class="token punctuation">:</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>\n        description<span class="token punctuation">:</span> record<span class="token punctuation">.</span>description<span class="token punctuation">,</span>\n        created_at<span class="token punctuation">:</span> localCreatedAt\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">records</code> 배열의 순서를 뒤집어주고, 시간대를 다시 지정한 뒤에 원하는 포맷으로 출력하도록 만들었습니다. 이렇게 변환된 배열을 <code class="language-text">v-for</code> 로 반복 출력해주면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--contents--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Record Time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Amount<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Description<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ record.created_at }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{\n          income: record.amount > 0,\n          outcome: record.amount &lt; 0\n        }<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          {{ record.amount }}\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ record.description }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Delete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Edit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>파이썬의 <code class="language-text">for..in</code> 문법과 비슷하게 생각하시면 됩니다<em>(이 사람은 파이썬을 써 본적이 없다)</em>. <code class="language-text">allRecords</code> 배열에 있는 각각의 <code class="language-text">record</code> 를 사용하여 템플릿을 랜더링하게 됩니다.</p>\n<p>한 가지 살펴보실 점은 수입과 지출을 구분하기 위해 사용한 <code class="language-text">:class</code> 입니다. <code class="language-text">v-bind:class</code> 와 같은 의미인데, 해당 HTML 속성을 Vue 인스턴스와 묶어둔다는 의미입니다. 자세한 내용은 <a href="https://kr.vuejs.org/v2/guide/class-and-style.html">가이드</a>를 참고하시기 바랍니다.</p>\n<p>보통은 <code class="language-text">data</code>, <code class="language-text">computed</code> 에 객체를 정의해두고 <code class="language-text">:class</code> 로 불러와서 해당 객체의 값이 true이면 표시하고, false이면 표시하지 않는 형태로 되어있는데, 반복문에서는 어떻게 활용해야할지 잘 몰라서 저렇게 직접 입력했습니다. 레코드의 값이 0 이상이면 income 클래스가 활성화되고, 0 이하이면 outcome 클래스가 활성화됩니다.</p>\n<p>여기까지 하셨다면 절반은 오신겁니다. 나머지는 자료의 입력, 수정 및 삭제를 구현하면 됩니다.</p>\n<p><img src="/2017-05-02-sc1-b6b1e472327780813fa5b39517e5a316.gif"></p>\n<h2 id="지출-및-수입-기록하기"><a href="#%EC%A7%80%EC%B6%9C-%EB%B0%8F-%EC%88%98%EC%9E%85-%EA%B8%B0%EB%A1%9D%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>지출 및 수입 기록하기</h2>\n<p>지난번 로그인 Form과 같은 형태로 Form이라는 클래스를 따로 만들겠습니다. 클래스 내부는 이전에 로그인 페이지 만들었던 때와 거의 동일합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> data<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> record<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'post\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token string">\'http://localhost:2300/api/records\'</span><span class="token punctuation">,</span>\n      data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token comment">// handle errors</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span><span class="token punctuation">{</span>\n    records<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    insertForm<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      amount<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">create</code> 메서드가 호출될 때 저장되어있던 토큰을 가져와서 요청할 때 헤더에 실어보내게 됩니다. 요청이 성공했을 때 돌아온 데이터는 우리가 레코드 저장용으로 지정해두었던 <code class="language-text">records</code> 배열에다 추가해주면 됩니다. (혹시나 해서 말씀드리지만 <code class="language-text">app.records</code> 는 아래부분에 만들어놓은 Vue 인스턴스의 <code class="language-text">this.records</code> 와 같은 의미입니다.) 그 다음에 배열에 변화를 감지한 뷰 인스턴스는 <code class="language-text">computed</code> 에 지정해두었던 <code class="language-text">allRecords</code> 의 계산을 다시 하게 됩니다. 변경을 감지하는 배열 메서드 및 그 활용법은 <a href="https://kr.vuejs.org/v2/guide/list.html#%EB%B0%B0%EC%97%B4-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80">가이드</a>를 참고하시기 바랍니다.</p>\n<p>나머지는 저장 버튼을 누를 때 <code class="language-text">Form#create</code> 함수가 실행되도록 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--input form--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field has-addons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertForm.amount<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Amount<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control is-expanded<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertForm.description<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Description<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertRecord<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Save<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">insertRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>insertForm<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="기록-변경하기"><a href="#%EA%B8%B0%EB%A1%9D-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기록 변경하기</h2>\n<p>너무나 당연하겠지만 우리가 작성한 기록은 수정할 수 있어야합니다. Edit 버튼을 누르면 기존의 자료가 표시되던 테이블 행이 Input 폼으로 변하게 만들 예정입니다.</p>\n<p><img src="/2017-05-02-sc2-94166b4983ac54195b522a7b106b82ad.gif"></p>\n<p>여기까지 튜토리얼을 진행해보셨다면 Amount, Description 표시 부분에 <code class="language-text">v-if</code>, <code class="language-text">v-else</code> 를 이용하면 되지 않을까? 하고 생각하실 수 있을겁니다. 지금처럼 작은 규모의 프로젝트에는 매 <code class="language-text">td</code> 태그마다 조건에 따라 레이아웃이 변하게 만드는 일이 그렇게 어렵지 않지요. 그런데 너무 줄이 길어져서 가독성도 떨어지고, 아예 <code class="language-text">tr</code> 태그의 레이아웃이 통채로 달라지게 만들 예정이라면? 그럴 땐 컴포넌트를 도입하면 됩니다.</p>\n<h3 id="컴포넌트-추출하기"><a href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%B6%94%EC%B6%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컴포넌트 추출하기</h3>\n<p>리액트를 조금이라도 해 보셨던 분이라면 아시겠지만, 리액트는 JSX로 DOM을 생성하고, 계층화된 컴포넌트의 조합으로 하나의 앱을 만드는게 가능합니다. Vue.js도 컴포넌트를 지원합니다. 보통은 노드 프로젝트로 Vue 프로젝트를 만들 때 많이 쓰게 되는데, 일반적인 자바스크립트에도 충분히 컴포넌트를 만들 수 있습니다.</p>\n<p>HTML 부분에 너무 코드가 많아지면 가독성이 떨어진다고 생각하고, 앞으로 한 부분에서 두 개의 컴포넌트가 나오도록 만들 예정이기 때문에 지금 사용자 레코드를 보여주는 부분을 컴포넌트로 분리해보겠습니다. 우리가 <code class="language-text">v-for</code> 문 바로 아래에 만들었던 <code class="language-text">tr</code> 태그 부분을 통채로 복사하시면 됩니다.</p>\n<p><code class="language-text">Form</code> 클래스 바로 아래에 새로운 변수를 선언합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n    &lt;tr>\n      &lt;td>{{ record.created_at }}&lt;/td>\n      &lt;td :class="{\n        income: record.amount > 0,\n        outcome: record.amount &lt; 0\n      }">\n        {{ record.amount }}\n      &lt;/td>\n      &lt;td>{{ record.description }}&lt;/td>\n      &lt;td>\n        &lt;button class="button is-danger">Delete&lt;/button>\n        &lt;button class="button is-light">Edit&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">template</code> 속성은 이 컴포넌트가 어떤 형태의 HTML 태그를 가지고 있는지 나타냅니다. 그리고 <code class="language-text">props</code> 는 부모 컴포넌트에서 자식 컴포넌트로 내려보내는 속성입니다. 여기서는 기존에 쓰던대로 <code class="language-text">record</code> 를 속성으로 가져왔고, 이 속성을 그대로 활용하고 있습니다.</p>\n<p>컴포넌트를 만들었으면 사용할 수 있도록 장착하고, HTML 파일에 선언해주어야 합니다. 먼저 Vue 인스턴스에 <code class="language-text">components</code> 속성을 정의합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">\'record-row\'</span><span class="token punctuation">:</span> RecordRow\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제 우리는 HTML 파일에 <code class="language-text">record-row</code> 라는 이름으로 태그를 선언하여 컴포넌트를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">:record</code> 는 <code class="language-text">v-bind:record</code> 의 약어입니다. 해당 속성을 이렇게 컴포넌트에 지정해주면 컴포넌트에서 <code class="language-text">record</code> 라는 이름의 속성을 사용할 수 있는겁니다. 다른 이름을 사용하고자 하면 <code class="language-text">:somethingElse</code> 같이 다른 이름을 넣고, 컴포넌트의 <code class="language-text">props</code> 속성에도 다른 이름을 넣어주고 사용하시면 됩니다. 아직까지 이 컴포넌트는 기존에 HTML에 작성해둔 코드와 똑같은 일을 수행합니다.</p>\n<h3 id="edit-버튼으로-토글하기"><a href="#edit-%EB%B2%84%ED%8A%BC%EC%9C%BC%EB%A1%9C-%ED%86%A0%EA%B8%80%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Edit 버튼으로 토글하기</h3>\n<p>일단 Edit 버튼을 누르면 테이블 행 자체가 바뀌도록 만드는 기능부터 구현해보겠습니다. 토글 버튼을 누르면서 일어나는 과정을 순서대로 나열해보자면 다음과 같습니다.</p>\n<ol>\n<li>토글 버튼 클릭</li>\n<li>해당 행의 자료가 \'수정 가능한 상태(isEditMode or isEditable)\' 로 변경</li>\n<li>변경된 자료를 배열에 반영</li>\n<li>배열이 수정되면서 변경된 부분만 Vue.js 가 알아서 새로 랜더링</li>\n</ol>\n<p>우리가 처음에 <code class="language-text">records</code> 배열을 만들 당시에는 수정 가능한 상태를 표시하는 속성이 없었으니 이 속성을 먼저 추가하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Vue instance</span>\ncomputed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">allRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n      id<span class="token punctuation">:</span> record<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n      amount<span class="token punctuation">:</span> record<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> record<span class="token punctuation">.</span>description<span class="token punctuation">,</span>\n      created_at<span class="token punctuation">:</span> localCreatedAt<span class="token punctuation">,</span>\n      isEditMode<span class="token punctuation">:</span> record<span class="token punctuation">.</span>isEditMode\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token comment">// ...</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token function">fetchData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>records <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assgin</span><span class="token punctuation">(</span>record<span class="token punctuation">,</span> <span class="token punctuation">{</span> isEditMode<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>처음에 <code class="language-text">fetchData</code> 메서드로 레코드를 가져올 때 각 레코드마다 <code class="language-text">isEditMode</code> 속성을 추가하면서 초기값으로 <code class="language-text">false</code> 를 넣어주었습니다. 그리고 <code class="language-text">allRecords</code> 는 <code class="language-text">records</code> 배열에 따라 값을 가져오니까 그대로 값을 가져오면 됩니다. 나중에 <code class="language-text">isEditMode</code> 속성이 <code class="language-text">true</code> 로 변하게 되면 <code class="language-text">allRecords</code> 는 자동으로 새로운 배열을 만들어낼겁니다.</p>\n<p>기본적으로 상위 컴포넌트와 하위 컴포넌트는 Props를 통한 단방향 데이터 흐름을 형성합니다. 물론 다양한 방법으로 양방향으로 데이터 변경을 가하는 방법은 있습니다. 하지만 이 경우에는 신중을 기하여 설계하셔야 합니다. 자칫 앱의 규모가 커지면서 상태 관리가 겉잡을 수 없이 복잡해질 수 있으니까요.</p>\n<p>그럼 우리는 어떻게 하위 컴포넌트에 있는 Edit 버튼을 클릭하여 상태를 변경할 수 있을까요? 이 때는 <a href="https://kr.vuejs.org/v2/guide/components.html#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8">사용자 지정 이벤트</a>를 활용하여 하위 컴포넌트에 특정 이벤트가 일어났다고 상위 컴포넌트에 알리고, 그에 따라 상위 컴포넌트가 연산을 수행하도록 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n\t// ...\n      &lt;td>\n        &lt;button class="button is-danger">Delete&lt;/button>\n        &lt;button class="button is-light" @click="toggleEdit">Edit&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">toggle-edit</code> 은 상위 컴포넌트에서 <code class="language-text">record-row</code> 컴포넌트를 선언할 때 이벤트로 지정해두면 됩니다. <strong>이벤트 이름이 일치하지 않는다고 오류가 따로 나지 않기 때문에 오탈자에 유의하셔야 합니다.</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(record, index) in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!record.isEditMode<span class="token punctuation">"</span></span> <span class="token attr-name">@toggle-edit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleEditModeOf(index)<span class="token punctuation">"</span></span> <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>Hello! Edit Mode Toggled!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">v-for</code> 는 이렇게 각 배열의 요소 뿐 아니라 인덱스도 가져올 수 있습니다. Vue 인스턴스에서 <code class="language-text">toggle-edit</code> 이벤트가 일어났다고 감지하면 <code class="language-text">toggleEditModeOf</code> 메서드를 실행하게 만들면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Vue instance</span>\nmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">toggleEditModeOf</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> target_record <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>\n\t\tObject<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target_record<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      \t\tisEditMode<span class="token punctuation">:</span> <span class="token operator">!</span>target_record<span class="token punctuation">.</span>isEditMode\n\t    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">Array#splice</code> 메서드로 해당 인덱스에 있는 자료의 상태를 변경해줍니다. Vue.js는 이 변화를 감지하여 <code class="language-text">allRecords</code> 의 변경된 부분만 새로 만듭니다.</p>\n<h3 id="수정용-컴포넌트-만들기"><a href="#%EC%88%98%EC%A0%95%EC%9A%A9-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>수정용 컴포넌트 만들기</h3>\n<p>이제 토글 버튼을 눌러서 원하는 줄의 내용이 바뀌는걸 확인하셨다면  <code class="language-text">v-else</code> 위치에 새로운 컴포넌트가 들어가게 만들면 됩니다. 수정용 컴포넌트는 조금 더 복잡합니다. 왜냐면 Edit 버튼을 눌렀을 때 원래 적혀있던 값이 input 태그로 바뀌면서 그대로 유지되어야 하며, 변경된 값을 서버에 전송하기 전에 처리해두어야 하기 때문입니다.</p>\n<ol>\n<li>updateForm이라는 새로운 Form 객체를 생성</li>\n<li>Edit 버튼이 토글 될 때 updateForm은 기존 레코드의 자료를 복사해서 저장</li>\n<li>수정용 컴포넌트에서 변경값이 입력될 때 updateForm의 속성도 같이 변화</li>\n<li>Update 버튼을 누르면 입력된 정보를 서버로 전송</li>\n</ol>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> UpdateRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'record\'</span><span class="token punctuation">,</span> <span class="token string">\'form\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n    &lt;tr>\n      &lt;td>{{ record.created_at }}&lt;/td>\n      &lt;td>\n        &lt;input class="input" type="number" :value="record.amount"\n               @input="updateFormValue(\'amount\', $event.target.value)" />\n      &lt;/td>\n      &lt;td>\n        &lt;input class="input" type="text" :value="record.description"\n               @input="updateFormValue(\'description\', $event.target.value)" />\n      &lt;/td>\n      &lt;td>\n        &lt;button class="button is-danger" @click="toggleEdit">Cancel&lt;/button>\n        &lt;button class="button is-light" @click="updateRecord">Update&lt;/button>\n      &lt;/td>\n    &lt;/tr>\n  `</span></span><span class="token punctuation">,</span>\n  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">editForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> form <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">;</span>\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>record<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        form<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>record<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token keyword">return</span> form<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">updateFormValue</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>editForm<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'form-update\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>editForm<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'update-record\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ..</span>\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    updateForm<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      id<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      amount<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      description<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>updateForm<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">\'record-row\'</span><span class="token punctuation">:</span> RecordRow<span class="token punctuation">,</span>\n    <span class="token string">\'update-row\'</span><span class="token punctuation">:</span> UpdateRow\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>코드 아래 쪽을 먼저 봐주시면 <code class="language-text">updateForm</code> 객체를 만들어두긴 했지만 아직 빈 값밖에 없는 상태입니다. 그래서 <code class="language-text">editForm</code> 을 이용하여 컴포넌트에서 <code class="language-text">record</code> 의 값을 updateForm(여기서는 form) 으로 복사해주는 작업을 합니다. 다음에는 input 이벤트가 일어날 때마다 해당 값을 반영한 뒤에 변경된 <code class="language-text">form</code> 을 부모 컴포넌트로 올려보냅니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(record, index) in allRecords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record-row</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!record.isEditMode<span class="token punctuation">"</span></span>\n    <span class="token attr-name">@toggle-edit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleEditModeOf(index)<span class="token punctuation">"</span></span>\n    <span class="token attr-name">:record</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n  &lt;update-row v-else\n    @toggle-edit="toggleEditModeOf(index)"\n    :record="record" :form="updateForm"\n    @form-update="form => { updateForm = form }"\n              // 여기서 form은 아까 컴포넌트에 있던 this.editForm 입니다\n    @update-record="updateRecord"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update-row</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">form-update</code> 이벤트 리스너는 자식 컴포넌트가 올려준 <code class="language-text">form</code> 을 기존에 만들어두었던 <code class="language-text">updateForm</code> 과 바꿔치기하게 되지요. 분명 더 좋은 방법은 있습니다만, 저와 이 글을 보시는 여러분 모두 차근차근 보면서 더 나은 방법으로 구현할 수 있게 되었으면 좋겠습니다.</p>\n<h3 id="서버에-전송하기"><a href="#%EC%84%9C%EB%B2%84%EC%97%90-%EC%A0%84%EC%86%A1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서버에 전송하기</h3>\n<p>Update 버튼을 누르면 <code class="language-text">updateRecord</code> 가 실행되게 만드는 것 까지 하셨다면 Form 클래스에 <code class="language-text">update</code> 메서드를 구현하면 됩니다. 기존에 하던 방법처럼 axios로 요청을 보내고 그 응답을 처리하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> record_id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> record<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      method<span class="token punctuation">:</span> <span class="token string">\'patch\'</span><span class="token punctuation">,</span>\n      url<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`http://localhost:2300/api/records/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>\n      data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>\n      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> index <span class="token operator">=</span> app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>record <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> record<span class="token punctuation">.</span>id <span class="token operator">===</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      app<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token comment">// handle error</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="레코드-삭제하기"><a href="#%EB%A0%88%EC%BD%94%EB%93%9C-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>레코드 삭제하기</h2>\n<p>마지막 기능인 레코드 삭제를 구현하겠습니다. 여지껏 구현해왔던 기능에 비하면 훨씬 쉽게 구현할 수 있습니다. 삭제 버튼을 클릭하면 \'이 기록을 삭제할것이다\' 라는 이벤트를 전송하고, 그러면 우리는 레코드 삭제용 메서드에 해당 레코드의 인덱스를 넘겨주면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">&lt;record-row v-if="!record.isEditMode"\n  @toggle-edit="toggleEditModeOf(index)"\n  @delete-record="deleteRecord(index)" // delete-record 추가\n  :record="record"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record-row</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> RecordRow <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`\n\t// ...\n    &lt;td>\n      &lt;button class="button is-danger" @click="deleteRecord">Delete&lt;/button>\n      &lt;button class="button is-light" @click="toggleEdit">Edit&lt;/button>\n    &lt;/td>\n  `</span></span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'toggle-edit\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">deleteRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">\'delete-record\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// ...</span>\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n    <span class="token function">deleteRecord</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">let</span> record_id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>\n      <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        method<span class="token punctuation">:</span> <span class="token string">\'delete\'</span><span class="token punctuation">,</span>\n        url<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`http://localhost:2300/api/records/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>\n        headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">\'Authorization\'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>여담이지만 서버와 통신하는 메서드는 어느정도 일관된 틀을 가지고 있다는 점을 보실 수 있습니다. 토큰을 가져와야 하고, 비슷한 URL로 요청을 보내며, 응답에 따라 <code class="language-text">response</code> / <code class="language-text">error</code> 를 받아옵니다. 이 기본 기능을 이해하시면 서버 통신하는 기능을 재사용 가능한 함수로 만들어서 불필요한 코드가 반복되는 일을 줄일 수 있을겁니다.</p>\n<hr>\n<p>이렇게 간단한 가계부 앱을 HTML 페이지 두 장으로 만들어보았습니다. 강좌에서 제공한 코드 곳곳에 개선해야 할 점들은 많습니다. 바로 위에 말씀드렸다시피 중복되는 기능을 재사용 가능하게 만든다던가, 자료를 처리하는 방법을 조금 더 효율적으로 만들거나, 에러를 처리를 위한 고민도 필요합니다.</p>\n<p>코드를 찬찬히 살펴보시면서 \'이렇게 하면 더 나을거같은데..\' 라고 생각하는 부분을 직접 구현해보시면서 점차 Vue.js의 사용법을 익혀나갈 수 있으리라 생각합니다. <a href="https://kr.vuejs.org/v2/guide/">공식 가이드만 참고하셔도</a> 충분히 괜찮은 퀄리티의 앱을 만드실 수 있을겁니다.</p>\n<ul>\n<li>Source Code: <a href="https://github.com/emaren84/moneybook_client">Github</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-05-02-hanami-vuejs-moneybook-frontend-2/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-05-02",path:"/posts/hanami-vuejs-moneybook-frontend-2",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (프론트엔드 편 - 2)",tags:["Javascript","Vue.js"],category:"Vue.js"}},{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 지난 시간에 하나미로 JSON API 서버를 만들었습니다. 이제 가계부 클라이언트를 Vue.js로 구현해보겠습니다.\n처음에는 vue-cli나 Nuxt…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p>지난 시간에 하나미로 JSON API 서버를 만들었습니다. 이제 가계부 클라이언트를 Vue.js로 구현해보겠습니다.\n처음에는 vue-cli나 Nuxt같은 다양한 도구를 이용해서 프로젝트를 만들어야 하나 고민을 했는데, 굳이 그렇게 할 필요도 없이 쉽게 구현 가능하다는 사실을 깨달았습니다.</p>\n<p>이번 프로젝트에서 우리가 필요한건 로그인 페이지와 가계부 페이지 html 두 장 뿐입니다. CSS와 자바스크립트는 같은 파일안에 작성하려는데, 가독성이 떨어지거나 번거롭게 느껴지신다면 따로 분리하여 작업하셔도 됩니다.</p>\n<p><strong>이번에 만드는 프로젝트는 ES6(ECMAscript 2016) 문법을 적극적으로 활용하여 작성할 예정입니다. 크롬 최신버전 (현재 58) 기준으로 만들 예정이며, 더 낮은 버전의 브라우저는 제대로 작동하지 않을 확률이 큽니다(특히 IE).</strong></p>\n<h2 id="vuejs란"><a href="#vuejs%EB%9E%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue.js란?</h2>\n<p>여태까지 AngularJS, ReactJS가 프론트엔드 JS 프레임워크의 양대 산맥을 이루고 있었지만, Vue.js가 혜성처럼 등장하여 3대장과 같은 위치를 차지하게 되었습니다. 두 프레임워크의 장점을 적절히 가져오고 쉽게 익힐 수 있도록 설계되어 있는데다가, 복잡한 프로젝트 세팅 없이 바로 CDN에서 파일을 가져오기만 해도 충분히 쓸만할 만큼 가볍고 사용성이 좋습니다.</p>\n<p>Vue.js에 관한 더 자세한 소개와 간단한 튜토리얼은 아래 링크를 참고하시기 바랍니다</p>\n<p><a href="https://velopert.com/3007">Vue.js 2.0 소개 및 시작하기 - velopert</a></p>\n<h2 id="회원-가입--로그인-페이지-만들기"><a href="#%ED%9A%8C%EC%9B%90-%EA%B0%80%EC%9E%85--%EB%A1%9C%EA%B7%B8%EC%9D%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>회원 가입 &#x26; 로그인 페이지 만들기</h2>\n<p>지난 시간에 가계부 앱에 필요한 기능들을 말씀드렸을 때, 회원 가입을 하고 로그인을 하면 토큰을 받고 브라우저의 LocalStorage에 저장한다고 말씀드렸습니다. 두 기능 모두 거의 같은 로그인 Form을 공유하기 때문에 한 페이지로 만들고 <code class="language-text">v-if</code> 같은 분기문을 사용해서 상태에 따라 조금씩 다른 모습이 나타나도록 만들면 되겠습니다.</p>\n<h3 id="기본-설정"><a href="#%EA%B8%B0%EB%B3%B8-%EC%84%A4%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 설정</h3>\n<p>하나미 프로젝트와 다른 곳 혹은 같은 곳에 폴더를 생성하고 <code class="language-text">login.html</code> 파일을 만든 뒤에 필요한 파일들을 등록해두겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.0/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>서버와 AJAX 통신을 위해 axios, 좀더 깔끔한 페이지 뷰를 위해 CSS 프레임워크인 Bulma를 사용하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">\n  <span class="token selector">html, body</span> <span class="token punctuation">{</span>\n    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n\n  <span class="token selector">#app</span> <span class="token punctuation">{</span>\n    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token property">background-color</span><span class="token punctuation">:</span> #E6E6E6<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#app .column</span> <span class="token punctuation">{</span>\n    <span class="token property">margin-top</span><span class="token punctuation">:</span> 10%<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#app .column > p</span> <span class="token punctuation">{</span>\n    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token selector">#sign-up-button</span> <span class="token punctuation">{</span>\n    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!--main container--></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns is-mobile<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token comment">&lt;!--centered column--></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column is-half is-offset-one-quarter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title is-2 is-spaced<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MoneyBook<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n\n      <span class="token comment">&lt;!--login form--></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-envelope<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                Login\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n                Sign up\n              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token comment">&lt;!--end of form--></span>\n\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token comment">&lt;!--end of column--></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!--end of container--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위의 코드를 넣어주시면 다음과 같은 화면을 보실 수 있습니다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 56.46437994722956%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPElEQVQoz41TS07DQAzN+TgCl2HBjhNwinIAVl20Cyp2qBISSCj/+QTapGnTJDMPe/pRaJPSkZ7s8djO8ydeHMc4RRRF6LNf8+4NOfH9gO79vw94XQPLMAyd9H0fs9kMk8nEyfF47PT5fI4kSY5+3dgzhuyotUaWZU5KKSGEQJqm7o11tvEbQynVz/BgZOe6aZCvCmzrLfhYa3E4rDOa1qA1FpuqupxQSAEYiqRc1XpDyWsYDm7bP9g5AU1dURzH9yTknnyrDK/lB570FGmuYSmZsQSzg93Ll88Nnt/WCFUJkQ4w9MMAK7XEgx7hxr/HVyMdC07YLd1QqXejH9w+akzfCyLBZKLhtcn1AmudQysaipKu8acoFhrlkoan5dkqna1NQKUHxJZbMATnE4RHZt318a79O4YR7Qezwy9tojFePAHLOwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2017 04 30 sc1"\n        title=""\n        src="/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-ffc88.png"\n        srcset="/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-d16f8.png 198w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-f21b1.png 395w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-ffc88.png 790w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-81e7e.png 1185w,\n/static/2017-04-30-sc1-9100a80c23929f21d4e5ca6a8de99a9e-53295.png 1516w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="회원-가입--로그인-페이지-전환"><a href="#%ED%9A%8C%EC%9B%90-%EA%B0%80%EC%9E%85--%EB%A1%9C%EA%B7%B8%EC%9D%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%A0%84%ED%99%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>회원 가입 &#x26; 로그인 페이지 전환</h3>\n<p>형태를 잡았으니 본격적인 Vue 도입을 시작하겠습니다. 가장 먼저 <code class="language-text">Vue</code> 인스턴스를 생성한 뒤, 필요한 데이터 필드를 설정하고, 회원 가입 버튼을 누를 때 다른 페이지가 나올 수 있도록 설정할 예정입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignUp<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><code class="language-text">body</code> 태그 맨 아래에 <code class="language-text">script</code> 태그를 삽입하고 위의 코드를 넣어줍니다. 먼저 어느 엘리먼트에서 Vue 앱이 구동될지 지정해주고, 앱 안에서 사용하고자 하는 데이터를 설정해준 뒤, 데이터를 조작할 수 있는 메서드를 지정해 주었습니다.</p>\n<p>한 페이지 안에서 로그인 페이지와 회원가입 페이지를 버튼에 따라 다르게 나타나게 하려면 <code class="language-text">v-if</code>, <code class="language-text">v-else</code> 를 사용하면 됩니다. 자세한 내용은 <a href="https://kr.vuejs.org/v2/guide/conditional.html">공식 가이드를 참고해주세요.</a></p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--password confirmation--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password Confirmation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--buttons--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Login\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Sign up\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Submit\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Back\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><code class="language-text">template</code> 태그는 Vue에서 사용하는 래퍼 태그입니다. <code class="language-text">v-if</code> 나  <code class="language-text">v-else</code> 는 기본적으로 하나의 태그에만 작동하고, 그 하위 태그들에는 동작하지 않기 때문에 이렇게 단위로 묶어줄 필요가 있습니다.</p>\n<p><code class="language-text">@click.prevent</code> 는 <code class="language-text">v-on:click.prevent</code> 와 같은 의미입니다. 이 버튼을 클릭하면 아까 지정해둔 <code class="language-text">toggleSignIn</code> 메서드를 실행하게 되고, 이 메서드가 <code class="language-text">isSignIn</code> 값을 변경하여 모든 템플릿에 영향을 줍니다.</p>\n<h3 id="form의-자료를-저장할-객체-생성"><a href="#form%EC%9D%98-%EC%9E%90%EB%A3%8C%EB%A5%BC-%EC%A0%80%EC%9E%A5%ED%95%A0-%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Form의 자료를 저장할 객체 생성</h3>\n<p>우리가 만들어놓은 Form에는 세 가지 필드가 있습니다. 이메일 주소, 비밀번호, 비밀번호 확인 필드입니다. 기존에 jQuery를 사용해 오셨다면, 필드의 변화를 바로바로 잡아내기 보다 폼을 제출할 때 이벤트 핸들러가 이런저런 일을 처리하도록 만드셨을 겁니다. Vue도 그렇게 하는게 가능은 하지만 그닥 추천하고 싶은 방법은 아닙니다.</p>\n<p>이번에는 <code class="language-text">v-model</code> 속성을 이용하여 데이터를 묶어두는(binding) 방법을 적용해 보겠습니다. 가장 기초적인 방법으로 Vue 인스턴스에 data를 다음과 같이 지정해둘 수 있을겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignIn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    email<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n    password<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n    password_confirmation<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Vue 인스턴스의 <code class="language-text">data</code> 속성은 해당 인스턴스의 스키마 역할을 하기도 하고, 이렇게 지정해두지 않은 데이터는 동적으로 제어하는게 불가능합니다. (API 문서를 보시면 이후에 추가하는 메서드가 있긴 하지만 그닥 추천드리고 싶지 않습니다) 지금은 필드가 단지 3개밖에 없으니까 이렇게 바로 데이터를 지정해둘 수 있을겁니다.</p>\n<p>미리 서버에 요청을 보내는 과정을 알려드리면 <strong>Form의 데이터를 객체로 모으기 -> axios로 post 요청 보내기 -> 서버의 응답 리턴</strong> 일텐데, 첫 번째 과정을 눈여겨보셔야 합니다. 만약 우리가 회원 가입을 할 때 전화번호나 주소같이 추가적인 정보를 더 많이 받게 된다면, 이 모든 속성을 <code class="language-text">data</code> 에 지정하는 일은 비효율적입니다. 아예 Form 데이터를 모아주고, 요청도 전송해주고, 특정 버튼을 눌렀을 때 input 값을 초기화해주는 등의 역할을 해 주는 객체를 새로 만들면 어떨까요?</p>\n<p>먼저 해당 역할을 해 주는 Form 클래스를 만들고, <code class="language-text">data</code> 속성에 지정해두겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  el<span class="token punctuation">:</span> <span class="token string">\'#app\'</span><span class="token punctuation">,</span>\n\n  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    isSignIn<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    form<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Form</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      email<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      password<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      password_confirmation<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>참고로 자바스크립트 인터프리터는 코드를 위에서 아래 순서대로 읽기 때문에 Form 클래스의 정의를 Vue 인스턴스 아랫부분에 하게 되면 에러가 납니다.</p>\n<p>Form의 <code class="language-text">originalData</code> 속성은 단순히 필드 저장용으로 사용하게 됩니다. 지금은 <code class="language-text">email</code>, <code class="language-text">password</code>, <code class="language-text">password_confirmation</code> 필드가 있지요. 그리고 for..in으로  Form 클래스의 속성에 필드를 추가합니다.</p>\n<p>이제 input 태그에 데이터를 연결해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--email input--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Email<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-envelope<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--password input--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n<span class="token comment">&lt;!--password confirmation--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control has-icons-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Password Confirmation<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form.password_confirmation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon is-small is-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-lock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>각 input 태그에 <code class="language-text">v-model</code> 속성과 함께, 어느 속성이 연결되어야 할 지 지정되어있는 모습을 보실 수 있습니다. 이제 각 필드의 값에 변화가 일어날 때 마다 Form 객체의 속성이 변하게 됩니다.</p>\n<p><img src="/2017-04-30-sc2-f20f52ea53e7fae81e0d032d4e69d830.gif"></p>\n<p>이제 작동 원리가 눈에 들어오셨다면 Form 클래스에 몇 가지 메서드를 추가해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>originalData <span class="token operator">=</span> data<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/^password/</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`moneybook:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        data<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">return</span> data<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> field <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originalData<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">reset</code> 메서드는 말 그대로 각 필드를 비우는 메서드이고, <code class="language-text">data</code> 필드는 새로운 객체에 각 필드에 입력된 값을 모아주는 역할을 합니다. 서버에 패스워드를 전송할 때는 반드시 암호화되어야 하기 때문에 <a href="https://github.com/emn178/js-sha256">SHA-256 라이브러리</a>를 적용했습니다. 단순히 작동되는 모습을 보기만 하시려면 굳이 적용하지 않으셔도 됩니다.</p>\n<p><code class="language-text">reset</code> 메서드는 <code class="language-text">toggleSignIn</code> 메서드가 실행될 때 같이 실행되도록 하여 회원가입&#x3C;->로그인 전환 시 필드 값을 초기화하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\n\tmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isSignUp<span class="token punctuation">;</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<h3 id="서버와-통신하기"><a href="#%EC%84%9C%EB%B2%84%EC%99%80-%ED%86%B5%EC%8B%A0%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서버와 통신하기</h3>\n<p>사실 Form 을 다루는 이야기를 더 하자면 내용이 꽤 길어집니다. 유효성 검사라던가, 서버로부터 들어온 에러를 다루는 방법이라던가.. 이 부분은 나중에 소스코드에는 구현 할 예정이니 업로드 된 소스코드를 직접 살펴보시길 바랍니다.</p>\n<p>지금은 서버에 데이터를 전송한 뒤에 리턴된 토큰을 저장하는 방법을 살펴보겠습니다. 같은 Form 안에서 조건에 따라 다른 요청을 하도록 구성되어 있기 때문에 Login, Submit 버튼에 다른 메서드를 연결하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!--buttons--></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!isSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitLogin<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Login\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-info<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Sign up\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-success<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log-in-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Submit\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button is-light<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sign-up-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleSignUp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        Back\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ...</span>\n\tmethods<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">// ...</span>\n        <span class="token function">submitLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token string">\'http://localhost:2300/api/auth/sign_in\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n        <span class="token function">submitSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token string">\'http://localhost:2300/api/auth/sign_up\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token comment">// ...</span>\n    <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>요청 주소는 하나미 기본 서버 주소 및 포트를 기준으로 했습니다. 별도로 하나미쪽에 CORS를 신경 써 주어야 하는데 미처 신경 쓰지 못했네요, 추후에 업데이트 하겠습니다.</p>\n<p><code class="language-text">submit</code> 메서드는 지정한 url을 받아서 서버에 POST요청을 하고, 응답에 따라 토큰을 저장하거나, 메세지를 띄우면서 Login 페이지로 돌아오는 역할을 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Form</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n      <span class="token function">submit</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> user<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">\'auth_token\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">\'auth_token\'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">\'auth_token\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n              location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">\'./content.html\'</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n              app<span class="token punctuation">.</span><span class="token function">renderNotification</span><span class="token punctuation">(</span><span class="token string">\'Successfully Singed Up\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n              app<span class="token punctuation">.</span><span class="token function">toggleSignUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token punctuation">{</span>\n            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>axios 라이브러리를 이용하여 요청을 하고, 성공하거나 실패한 요청을 각각 <code class="language-text">then</code>, <code class="language-text">catch</code> 로 다룰 수 있습니다. API 서버 구현 파트에서 보셨다시피 사용자가 가입을 할 때는 해당 사용자의 정보를 리턴하고, 가입된 계정으로 로그인을 할 때만 <code class="language-text">auth_token</code> 을 반환합니다. 그리고 받은 토큰을 브라우저의 <code class="language-text">localStorage</code> 에 저장합니다. 그 뒤에 자연스럽게 가계부  앱 페이지로 이동하게 만들면 됩니다.</p>\n<p>회원 가입이 정상적으로 처리 된 뒤에는 다시 로그인 페이지로 돌아도록 만들었습니다. <code class="language-text">renderNotification</code> 메서드는 오른쪽 구석에 알림을 띄우도록 만든 메서드인데, 이를 활용하여 에러 메세지도 손쉽게 표현하실 수 있을겁니다.</p>\n<p>다음 포스팅에서 로그인 이후에 실제 가계부 앱을 Vue.js로 구현해보겠습니다.</p>\n<hr>\n<p>Source Code: <a href="https://github.com/emaren84/moneybook_client">Github</a></p>',
id:"/home/circleci/repo/src/pages/posts/2017-04-30-hanami-vuejs-moneybook-frontend-1/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-30",path:"/posts/hanami-vuejs-moneybook-frontend-1",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (프론트엔드 편 - 1)",tags:["Javascript","Vue.js"],category:"Vue.js"}},{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 업데이트 BCrypt 관련 설명 수정 (2017-05-02) 들어가며 하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p><strong>업데이트</strong></p>\n<ul>\n<li>BCrypt 관련 설명 수정 (2017-05-02)</li>\n</ul>\n<hr>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.0 버전이 발매되었고, 아직도 쓰고있다보니 감개무량합니다.</p>\n<p>요즘 프론트엔드 JS 프레임워크에 많은 관심을 가지고 ReactJS, Vue.js를 공부하고 있는데, 간단히 배운 내용을 적용해볼 겸 간단 가계부를 구현해보도록 하겠습니다. 백엔드 JSON API 서버는 하나미로 구현하고, 프론트엔드는 Vue.js로 구현하는 과정을 보여드리겠습니다.</p>\n<p>최대한 간단히 설명해드리려 노력하겠지만, 기존에 루비로 웹 개발을 해보신분이 이해하시기 쉬울 겁니다. 사실 JSON API 서버는 어떤 언어나 프레임워크로 제공해도 되니까요 :) 구현방법에 약간씩 차이가 있을 뿐이지 제가 보여드리는 정도의 앱은 그렇게 어렵지 않게 작성하실 수 있으리라 봅니다.</p>\n<h2 id="애플리케이션의-기본-구성"><a href="#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>애플리케이션의 기본 구성</h2>\n<p>처음에는 더욱 간단한 To-Do List(할일 관리) 를 구현하려고 했는데, 그러면 하나미를 다루는 부분이 너무 영양가가 없어질 것 같아서 가계부 형식의 앱으로 만들고, 다음의 기능을 구상해 보았습니다.</p>\n<ul>\n<li>\n<p>회원 등록 및 인증</p>\n<ul>\n<li>이메일과 비밀번호로 회원 가입</li>\n<li>JWT로 인증 (토큰은 LocalStorage에 저장)</li>\n</ul>\n</li>\n<li>\n<p>사용금액, 내용 입력</p>\n<ul>\n<li>수입은 녹색, 지출은 빨강색으로 표시</li>\n<li>각 아이템을 클릭하면 바로 수정 가능, 삭제 버튼을 누르면 삭제</li>\n</ul>\n</li>\n<li>수입, 지출을 필터링하여 보기</li>\n<li>가장 최신 레코드 30개를 처음에 불러온 뒤, 화면에 보이는 마지막 내역까지 스크롤 하게 되면 추가로 자료 가져오기</li>\n</ul>\n<p>이 정도의 기능을 구현해볼 예정입니다. 막상 하려니 쉽진 않겠지만 차근차근 진행해보겠습니다.</p>\n<h2 id="하나미-프로젝트-생성"><a href="#%ED%95%98%EB%82%98%EB%AF%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미 프로젝트 생성</h2>\n<p>너무나 당연하지만 하나미를 사용하기 위해서는 개발 환경에 루비가 세팅되어 있어야 합니다. 아직 루비가 설치되어있지 않은 경우에는 <a href="https://gorails.com/setup/">GoRails의 설치 가이드</a>를 따라하시면 되겠습니다. 그 다음에 하나미 젬을 설치하시면 됩니다. 이번 강좌에서는 <strong>루비 2.4.1</strong>, <strong>하나미 1.0.0</strong> 버전을 기준으로 프로젝트를 생성하겠습니다.</p>\n<p>먼저 하나미 젬을 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">gem install hanami</code></pre>\n      </div>\n<p>설치 된 이후에 프로젝트는 원하시는 이름으로 설치하시면 됩니다. 하나미는 SQLite, MySQL, PostgreSQL 등을 지원하지만, 기본적으로 PostgreSQL을 권장합니다. 또한 테스팅 프레임워크도 처음 프로젝트를 설정할 때 Minitest, RSpec 중에서 고르실 수 있습니다. 제가 아직 RSpec은 커녕 TDD를 잘 못하기 때문에 Minitest로 진행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">hanami new moneybook-api --database=postgres --test=minitest</code></pre>\n      </div>\n<p>생성된 프로젝트에서 젬파일을 살펴보시면 꽤 간단합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\nsource <span class="token string">\'https://rubygems.org\'</span>\n\ngem <span class="token string">\'rake\'</span>\ngem <span class="token string">\'hanami\'</span><span class="token punctuation">,</span>       <span class="token string">\'~> 1.0\'</span>\ngem <span class="token string">\'hanami-model\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 1.0\'</span>\n\ngem <span class="token string">\'pg\'</span>\n\ngroup <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  <span class="token comment"># Code reloading</span>\n  <span class="token comment"># See: http://hanamirb.org/guides/projects/code-reloading</span>\n  gem <span class="token string">\'shotgun\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span><span class="token punctuation">,</span> <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'dotenv\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 2.0\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'minitest\'</span>\n  gem <span class="token string">\'capybara\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:production</span> <span class="token keyword">do</span>\n  <span class="token comment"># gem \'puma\'</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 중에서 <code class="language-text">capybara</code> 젬은 뷰 테스트 용이기 떄문에 이번 프로젝트에선 굳이 없어도 됩니다. 앞으로 젬이 더 추가될테지만 필요에 따라 추가하기로 하고, <code class="language-text">bundle install</code> 커맨드로 필요한 젬을 설치해두겠습니다.</p>\n<p>참고로 PostgreSQL을 이용하시려면 <code class="language-text">.env</code> 파일에서 계정 설정을 해주셔야 합니다. SQLite를 이용하신다면 파일로 관리되기 때문에 계정 설정을 해 주실 필요는 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\nDATABASE_URL=&quot;postgresql://username:password@localhost/moneybook_api_development&quot;</code></pre>\n      </div>\n<h2 id="사용자-인증-구현"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 인증 구현</h2>\n<p>기존의 웹 페이지는 서버에서 인증 관련 정보를 들고, 세션을 이용하여 인증 상태를 유지하고 요청을 하는 경우가 많았습니다. 하지만 모바일 애플리케이션이나, 많은 인스턴스를 올려서 인증을 관리하는 경우 세션 기반 인증은 유연한 대응이 어렵습니다. JWT라는 개념을 이용하면 세션 기반 인증의 단점을 극복하고 사용자 인증을 적용할 수 있습니다.</p>\n<p>JWT 인증이 무엇인지 궁금하시다면 다음의 링크를 읽어보시길 바랍니다.</p>\n<ul>\n<li><a href="https://velopert.com/2389">JSON Web Token 소개 및 구조 - velopert</a></li>\n<li><a href="http://bcho.tistory.com/999">REST JWT 소개 - 조대협</a></li>\n<li><a href="https://jwt.io/introduction/">Introduction to JSON Web Tokens</a></li>\n</ul>\n<p>인증에 필요한 젬을 추가한 뒤, 사용자 정보를 기록하는 모델을 생성하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\n<span class="token comment"># ...</span>\ngem <span class="token string">\'bcrypt\'</span>\ngem <span class="token string">\'jwt\'</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">bcrypt</code> 젬은 비밀번호 생성에 특화된 단방향 해시 함수를 지원합니다.<br>\n간단한 사용법을 알려드리면 <code class="language-text">BCrypt::Password.create(&#39;password&#39;)</code> 로 해시 다이제스트를 생성하고, <code class="language-text">BCrypt::Password.new(digest)</code> 로 해시 다이제스트가 본래 비밀번호와 일치하는지 검사합니다.</p>\n<p>너무나 당연하면서 중요한 이야기지만 웹 개발자로서 복잡한 보안 알고리즘을 직접 구현하면 관리 및 취약점을 파악하기가 어렵기 때문에 차라리 <code class="language-text">bcrypt</code> 처럼 검증된 라이브러리를 사용하시길 추천합니다. 비슷한 예로 Rails에서 사용자 인증과 관련한 부분은 되도록이면 Devise 젬을 사용하길 권장하는 것 처럼요.</p>\n<p>패스워드 저장 매커니즘에 대해 <a href="http://d2.naver.com/helloworld/318732">이 글</a>을 읽어보시길 추천합니다.</p>\n<h3 id="사용자-모델-생성"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 모델 생성</h3>\n<p>먼저 사용자 정보를 저장하기 위한 모델을 생성하겠습니다. 간단히 이메일과 패스워드를 저장하는 테이블을 만들면 되겠네요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model user</code></pre>\n      </div>\n<p>앞으로 모든 하나미 커맨드 앞에는 <code class="language-text">bundle exec</code>  이 붙을 예정입니다. 앞으로 하나미를 자주 쓰게 되면 <code class="language-text">bashrc</code> 나  <code class="language-text">zshrc</code> 에 alias 지정을 해 두는걸 추천합니다.</p>\n<p>그리고 레일즈와 비슷하게 <code class="language-text">db/migrations</code> 폴더에 마이그레이션 파일이 있습니다. 어떤 컬럼에 어떤 정보가 들어가게 될 지 작성해주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migration/2017***_create_users.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:users</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:password_digest</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>방법에 따라서는 이메일 컬럼만 있어도 충분히 JWT 인증을 구현할 수 있다는데 아직 잘 모르겠습니다. 이제 테이블 생성을 위해 마이그레이션을 실행하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami db create # 먼저 데이터베이스 생성부터\nbundle exec hanami db migrate</code></pre>\n      </div>\n<h3 id="사용자-등록-액션"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%93%B1%EB%A1%9D-%EC%95%A1%EC%85%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 등록 액션</h3>\n<p>이제 사용자를 등록하는 액션을 생성하겠습니다. 이후에 JWT 인증하는 과정을 덧붙일 예정입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api auth#sign_in --skip-view\nbundle exec hanami generate action api auth#sign_up --skip-view</code></pre>\n      </div>\n<p>action 뒤에 <code class="language-text">api</code> 는 제가 사용할 앱 이름입니다. 기본값은 web으로 되어 있지만, <a href="http://hanamirb.org/guides/command-line/generators/">하나미 가이드의 Command Line 부분을 참고하시면</a> 다른 앱을 생성하거나 삭제하는 등 액션을 실행할 수 있습니다.</p>\n<p><code class="language-text">--skip-view</code> 는 뷰와 관련된 템플릿 파일이나 뷰 클래스 및 테스트를 생성하지 않는 커맨드입니다. 우리는 하나미를 순순히 API 서버로 사용할 것이기 때문에 미리 입력해주어야 불필요한 파일을 만들지 않게 됩니다.</p>\n<p>라우팅 파일의 내용도 변경해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\npost <span class="token string">\'/auth/sign_in\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_in\'</span>\npost <span class="token string">\'/auth/sign_up\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_up\'</span>\n</code></pre>\n      </div>\n<p>사용자를 등록하는 과정은 JWT랑은 관련이 없습니다. 단순히 이메일, 비밀번호, 비밀번호 확인을 하는 패러매터를 전달 받은 뒤, 유효성 검사에 성공하면 비밀번호를 암호화하여 데이터베이스에 저장하면 됩니다.</p>\n<p>우리는 JSON API 서버를 만들고 있기 때문에 애플리케이션의 <code class="language-text">body_parsers</code> 나 <code class="language-text">default_request_format</code> 등의 설정을 바꾸어 주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># From Line 90</span>\n      <span class="token comment"># Default format for the requests that don\'t specify an HTTP_ACCEPT header</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_request_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># Default format for responses that don\'t consider the request format</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_response_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># HTTP Body parsers</span>\n      <span class="token comment"># Parse non GET responses body for a specific mime type</span>\n      <span class="token comment"># Argument: Symbol, which represent the format of the mime type</span>\n      <span class="token comment">#             (only `:json` is supported)</span>\n      <span class="token comment">#           Object, the parser</span>\n      <span class="token comment">#</span>\n      body_parsers <span class="token symbol">:json</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>이제 안정적으로 기능을 구현하기 위해 테스트를 작성하겠습니다. 테스트 파일은 <code class="language-text">spec/</code> 폴더에 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># spec/api/controllers/auth/sign_up_spec.rb</span>\n<span class="token keyword">require</span> <span class="token string">\'spec_helper\'</span>\nrequire_relative <span class="token string">\'../../../../apps/api/controllers/auth/sign_up\'</span>\n\ndescribe <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">}</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n      user<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> <span class="token string">"foo@bar.com"</span><span class="token punctuation">,</span>\n        password<span class="token punctuation">:</span> <span class="token string">"secret"</span><span class="token punctuation">,</span>\n        password_confirmation<span class="token punctuation">:</span> <span class="token string">"secret"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  describe <span class="token string">\'with valid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'is successful\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">201</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n\n  describe <span class="token string">\'with invalid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'returns 422\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">422</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>먼저 유효성 검사부터 만들겠습니다. 하나미의 유효성 검사는 모델에서 수행하는 게 아니라 각 액션에서 수행합니다. (공통된 유효성 검사를 모듈화할 수도 있습니다)</p>\n<p><strong>작성되는 코드는 모두 테스트를 먼저 작성하고 진행하지만, 글에서 모두 보여드리지 않겠습니다. 자세한 내용은 <a href="https://github.com/emaren84/moneybook_api">Github에 올라와 있는 소스코드</a>를 살펴봐 주세요.</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">halt</code> 메서드는 인자로 받은 스테이터스 번호와 메세지를 리턴합니다. 메세지는 생략 가능합니다. 이제 올바른 패러매터가 들어왔으면  사용자를 등록하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># same file</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>interactor<span class="token punctuation">:</span> <span class="token constant">UserSignUp</span><span class="token punctuation">)</span>\n      <span class="token variable">@interactor</span> <span class="token operator">=</span> interactor\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      result <span class="token operator">=</span> <span class="token variable">@interactor</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>call\n      status <span class="token number">201</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>user<span class="token punctuation">.</span>show_info<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>뭔가 이상한 녀석이 나왔습니다. interactor라뇨? 인터렉터(Interactor)는 하나미에서 제공하는 모듈인데, 보통 다양한 비지니스 처리 로직을 분리하는 용도 혹은 재사용 가능한 비지니스 로직을 API, Web 같이 서로 다른 앱에서도 공유할 수 있도록 만들어졌습니다. <code class="language-text">lib/interactor</code> 에 해당 클래스명으로 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/interactor/user_sign_up.rb</span>\n<span class="token keyword">require</span> <span class="token string">"hanami/interactor"</span>\n<span class="token keyword">require</span> <span class="token string">"bcrypt"</span>\n\n<span class="token keyword">class</span> <span class="token class-name">UserSignUp</span>\n  include <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Interactor</span>\n  include <span class="token constant">BCrypt</span>\n\n  expose <span class="token symbol">:user</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">,</span> encryptor<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> repo<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">)</span>\n    <span class="token variable">@user_attr</span> <span class="token operator">=</span> user_attr\n    <span class="token variable">@encryptor</span> <span class="token operator">=</span> encryptor <span class="token operator">||</span> <span class="token constant">BCrypt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Password</span>\n    <span class="token variable">@repo</span> <span class="token operator">=</span> repo <span class="token operator">||</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n  <span class="token class-name">end</span>\n\n  <span class="token keyword">def</span> call\n    safe_user <span class="token operator">=</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">)</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token variable">@repo</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>safe_user<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">private</span>\n\n  attr_reader <span class="token symbol">:user_attr</span>\n\n  <span class="token keyword">def</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>attributes<span class="token punctuation">)</span>\n    password <span class="token operator">=</span> <span class="token variable">@encryptor</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>attributes<span class="token punctuation">[</span><span class="token symbol">:password</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n    <span class="token punctuation">{</span> email<span class="token punctuation">:</span> user_attr<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">,</span> password_digest<span class="token punctuation">:</span> password <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>눈여겨 보실점은 <code class="language-text">expose</code> 밖에 없고 나머지는 일반적인 사용자 등록 로직으로 구성되어 있습니다. 인터렉터는 해당 클래스의 객체를 생성하고 <code class="language-text">call</code> 메서드로 연산을 수행하는데, 그 결과값을 <code class="language-text">expose</code> 로 내보내야 합니다. 참고로 <code class="language-text">expose</code> 로 내보내려는 값은 인스턴스 변수여야 합니다. 여기서는 <code class="language-text">@user</code> 가 되겠네요. 내보낸 결과물은 메서드처럼 <code class="language-text">.user</code> 로 가져올 수 있습니다.</p>\n<p>그런데 액션 부분에 <code class="language-text">result.user.show_info.to_json</code>  이라고 되어있는 부분이 있습니다. <code class="language-text">to_json</code> 은 리턴값이 JSON이어야 되니까 그렇다 치고, <code class="language-text">show_info</code> 는 어디에 있는 녀석일까요? 방금까지 우리는 사용자를 생성했습니다. 그리고 생성된 결과값이 User Entity(엔티티)인데, 엔티티에 메서드를 정의하여 원하는 정보를 가공하여 보여줄 수 있도록 만든 것입니다. 콘솔에서 한번 확인해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami console</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[2] pry(main)&gt; UserRepository.new.create(email: &#39;foo@baz.com&#39;, password_digest: &#39;some secret&#39;)\n[moneybook_api] [INFO] [2017-04-22 14:06:37 +0900] (0.003739s) INSERT INTO &quot;users&quot; (&quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (&#39;foo@baz.com&#39;, &#39;some secret&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;) RETURNING &quot;id&quot;, &quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;\n=&gt; #&lt;User:0x007fb6a6c49348\n @attributes=\n  {:id=&gt;3, :email=&gt;&quot;foo@baz.com&quot;, :password_digest=&gt;&quot;some secret&quot;, :created_at=&gt;2017-04-22 05:06:37 UTC, :updated_at=&gt;2017-04-22 05:06:37 UTC}&gt;</code></pre>\n      </div>\n<p>저렇게 임의의 사용자를 생성하니 User 엔티티가 리턴된 것을 볼 수 있습니다. Repository가 뭐고, Entity가 무엇인지는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0">제가 전에 작성한 하나미 소개 포스트를 참고해주세요.</a></p>\n<p>엔티티 클래스 파일의 위치는 <code class="language-text">lib/moneybook_api/entities</code> 입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/entities/user.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Entity</span>\n  <span class="token keyword">def</span> show_info\n    <span class="token keyword">self</span><span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>tap <span class="token punctuation">{</span> <span class="token operator">|</span>attributes<span class="token operator">|</span> attributes<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:password_digest</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이렇게 하여 사용자 생성 후 리턴 값에는 패스워드를 뺸 나머지 정보만 보이게 됩니다.</p>\n<h3 id="토큰-생성하기"><a href="#%ED%86%A0%ED%81%B0-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 생성하기</h3>\n<p>이제부터가 본격적인 JWT 인증을 구현하는 부분입니다. 생성한 사용자가 로그인을 시도하고 요청한 이메일과 비밀번호가 맞다면 우리는 인증 토큰을 생성하여 돌려주게 되고, 사용자는 매번 로그인 할 필요 없이 그 토큰을 가지고 (유효기간이 만료할 때 까지) 자유로이 앱을 사용할 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/controllers/auth/sign_in.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignIn</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      email <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">)</span>\n      password <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:password</span><span class="token punctuation">)</span>\n\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n\n      <span class="token keyword">if</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>valid_password<span class="token operator">?</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>\n        token <span class="token operator">=</span> <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n\n        status <span class="token number">201</span><span class="token punctuation">,</span> token<span class="token punctuation">.</span>to_json\n      <span class="token keyword">else</span>\n        halt <span class="token number">401</span><span class="token punctuation">,</span> <span class="token string">\'Authentication Failed\'</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 하는 부분은 회원 등록 하는 액션에서도 적어놓았기 때문에 쉽게 알아보실 수 있을겁니다. 바로 아래에 <code class="language-text">params.get</code> 이라는 메서드는 <code class="language-text">Hash#dig</code> 메서드와 비슷한 용도를 가지고 있는데 <code class="language-text">params[:user][:email]</code> 같이 값을 검색하려다가 <code class="language-text">params[:user]</code> 가 <code class="language-text">nil</code> 인 경우 <code class="language-text">NoMethodError</code> 에러가 발생하는 일을 방지해줍니다. 대신 <code class="language-text">nil</code> 을 리턴합니다.</p>\n<p><code class="language-text">find_by_email</code> 같은 메서드는 레일즈를 하시는 분들이 보기엔 아주 친숙할겁니다. 하지만 우리는 이 메서드를 직접 구현해야 합니다. 레일즈로 개발하면서 느끼는 마법은 하나미에서는 일어나지 않습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/user_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">UserRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n    users<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> email<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token symbol">:entity</span><span class="token punctuation">)</span><span class="token punctuation">.</span>one\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><strong>모든 하나미의 쿼리 메서드는 private 입니다. 콘솔에서 바로 테스트 할 수 없습니다.</strong> 테스트를 작성하거나, 원하는 쿼리를 메서드로 정의한 뒤에 콘솔에서 돌려봐야 합니다.</p>\n<p><code class="language-text">users</code> 는 리퍼지토리와 연결되어있는 테이블명을 나타내는 규약입니다. 만약 <code class="language-text">BookRepository</code> 에서 <code class="language-text">books</code> 라는 테이블의 내용을 가져오게 된다면 우리는 <code class="language-text">books.</code> 로 시작하는 메서드를 작성하게 됩니다. 자세한 내용은 하나미 모델의 구현체인 <a href="http://rom-rb.org">ROM</a>의 문서를 참고하시는게 좋습니다.</p>\n<p>레일즈를 개발하는 분들은 보통 쿼리의 결과가 각 모델의 객체로 나오기 때문에 이후에 각 엔티티마다 메서드를 바로 사용할 수 있을겁니다. 하지만 하나미에서는 <code class="language-text">as(:entity)</code> 옵션을 적용해주지 않으면 결과물이 단순한 <code class="language-text">ROM::Struct</code> 객체를 리턴하거나. <code class="language-text">ROM::Relation</code> 객체를 리턴하는 경우가 많습니다.</p>\n<p><code class="language-text">Struct</code> 객체는 Hash처럼 되어있어서, 쿼리의 결과 레코드를 그대로 쓰는 건 가능하지만 엔티티에 정의해놓은 메서드를 사용할 수 없습니다. <code class="language-text">Relation</code> 객체는 쿼리를 아직 실행하기 전에 ROM에서 쿼리를 준비해 놓는 객체입니다. 이 객체에 <code class="language-text">to_a</code> 나 <code class="language-text">each</code> 같은 메서드를 사용해서 자료를 가공할 때 쿼리를 실행하고, 그 때 엔티티를 다룰 수 있습니다.</p>\n<p>지금은 간단한 쿼리라서 <code class="language-text">.as(:entity)</code> 부분을 빼도 결과값을 맨 앞 한개만 출력하라는 <code class="language-text">one</code> 메서드 때문에 바로 User 엔티티가 출력될겁니다. 이후에 더 복잡한 쿼리를 작성하게 되는 일이 있을 때 제가 말씀드린 내용이 도움이 되었으면 좋겠습니다.</p>\n<p><code class="language-text">user.valid_password?</code> 메서드는 <code class="language-text">BCrypt</code> 젬을 이용하여 암호화했던 비밀번호를 해독하고, 맞는지 확인하는 역할을 합니다.</p>\n<p><code class="language-text">JwtIssuer</code> 클래스는 라이브러리로 활용하기 위해 <code class="language-text">lib/moneybook_api/services</code> 폴더에 작성했습니다. 여기에 작성해 두면 다른 앱이나 액션에서 자유롭게 사용할 수 있기 때문입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/services</span>\n<span class="token keyword">class</span> <span class="token class-name">JwtIssuer</span>\n  <span class="token constant">DEFAULT_EXPIRE_TIME</span> <span class="token operator">=</span> <span class="token number">86400</span> <span class="token comment"># 24 hours</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> exp <span class="token operator">=</span> <span class="token builtin">Time</span><span class="token punctuation">.</span>now<span class="token punctuation">.</span>to_i <span class="token operator">+</span> <span class="token constant">DEFAULT_EXPIRE_TIME</span><span class="token punctuation">)</span>\n    payload <span class="token operator">=</span> <span class="token punctuation">{</span> user_id<span class="token punctuation">:</span> user_id<span class="token punctuation">,</span> iss<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_ISSUER\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> exp<span class="token punctuation">:</span> exp <span class="token punctuation">}</span>\n    token <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">\'HS256\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> auth_token<span class="token punctuation">:</span> token <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n    <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>코드의 내용은 <a href="https://github.com/jwt/ruby-jwt/blob/master/README.md#algorithms-and-usage">JWT 젬의 사용법을 따라</a> 우리가 필요한 부분을 캡슐화한 정도입니다. 토큰 생성 시점에서 24시간의 기한을 주었고, <code class="language-text">iss</code> 옵션은 발행자 옵션인데, 임의로 <code class="language-text">localhost</code> 로 지정해두었습니다. <code class="language-text">ENV[&#39;JWT_SECRET&#39;]</code> 같이 지정되어있는 환경변수를 가져오는 방법은 프로젝트 폴더에 <code class="language-text">.env.development</code> 같이 되어있는 파일에다 작성는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\n# ...\nJWT_SECRET=&quot;some secret&quot;\n# ...</code></pre>\n      </div>\n<p>비밀번호 토큰은 여러분이 원하는대로 만든 다음에, <code class="language-text">Base64</code> 나 <code class="language-text">Digest</code> 클래스를 활용하여 암호화하시길 추천합니다.</p>\n<p>인코딩에 성공하면 컨트롤러 액션은 201 스테이터스와 함께 토큰 JSON을 리턴하게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl -X POST -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/json&quot; -d &#39;{ &quot;user&quot;: { &quot;email&quot;: &quot;foo@bar.com&quot;, &quot;foo&quot;: &quot;cherryblossom&quot; } }&#39; &quot;http://localhost:2300/api/auth/sign_in&quot;\n=&gt;\n{\n  &quot;auth_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0LCJpc3MiOiJsb2NhbGhvc3QiLCJleHAiOjE0OTI5NjM2NTV9.38-CWKZkOuWD_idEOhv1gAret6_qG_ue7kk0iPftJ_M&quot;\n}</code></pre>\n      </div>\n<p>이제 사용자가 매 요청을 할 때마다 이 토큰이 유효한지 검사하는 부분을 만들어야 하는데, 가계부 기록 작성과 관련된 API를 구현한 뒤에 마저 만들어 보겠습니다.</p>\n<h2 id="가계부-api-만들기"><a href="#%EA%B0%80%EA%B3%84%EB%B6%80-api-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>가계부 API 만들기</h2>\n<p>가계부 API는 간단한 REST 형식으로 만들 예정입니다.</p>\n<table>\n<thead>\n<tr>\n<th align="center">정의</th>\n<th align="center">내용</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">/records (GET)</td>\n<td align="center">모든 레코드를 가져온다</td>\n</tr>\n<tr>\n<td align="center">/records (POST)</td>\n<td align="center">레코드를 생성한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id (PATCH)</td>\n<td align="center">해당 레코드를 수정한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id(DELETE)</td>\n<td align="center">해당 레코드를 삭제한다</td>\n</tr>\n</tbody>\n</table>\n<p>RESTful API 라면 보통 사용자가 가지고 있는 레코드를 표현해야 하니까 URL 어딘가에 <code class="language-text">user_id</code> 같은게 있어야 할 것 처럼 보입니다. 하지만 우리가 구현하고자 하는 서버에는 필요가 없습니다. JWT 토큰을 HTTP 헤더에 추가하여 요청을 하면, 서버가 토큰을 해석하여 <code class="language-text">user_id</code> 를 찾아내고 그 값을 기반으로 특정 사용자의 레코드를 검색하게 됩니다.</p>\n<h3 id="모델-생성--라우팅"><a href="#%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1--%EB%9D%BC%EC%9A%B0%ED%8C%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 생성 &#x26; 라우팅</h3>\n<p>일단 레코드 모델과 레코드를 생성하는 액션을 만들고 나서, 토큰 인증 과정을 덧붙이도록 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model record</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/2017**_create_records.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:records</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n      foreign_key <span class="token symbol">:user_id</span><span class="token punctuation">,</span> <span class="token symbol">:users</span><span class="token punctuation">,</span> on_delete<span class="token punctuation">:</span> <span class="token symbol">:cascade</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:amount</span><span class="token punctuation">,</span>      <span class="token builtin">Integer</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:description</span><span class="token punctuation">,</span> <span class="token builtin">String</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>외부 키는 컬럼 이름과, 연결해 줄 테이블 이름을 지정해줍니다. 나머지 뒤에 있는 요소들은 <a href="http://hanamirb.org/guides/migrations/create-table/">공식 문서에 자세한 설명이 있으니</a> 참조바랍니다. 그리고 마이그레이션을 실행하면 됩니다.</p>\n<p>그 다음에 액션을 생성하고 라우트를 지정하겠습니다. 다른 <code class="language-text">records</code> 관련 액션을 미리 생성해두셔도 상관 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api records#create --skip-view</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\n<span class="token comment"># ...</span>\nresources <span class="token symbol">:records</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>이 부분은 레일즈의 자동 라우팅과 아주 유사합니다. 라우팅이 어떻게 구성되었는지 확인하시려면 <code class="language-text">bundle exec hanami routes</code> 커맨드를 실행하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">    Name Method     Path                           Action\n\n         POST       /api/auth/sign_in    Api::Controllers::Auth::SignIn\n         POST       /api/auth/sign_up    Api::Controllers::Auth::SignUp\n records GET, HEAD  /api/records         Api::Controllers::Records::Index\n records POST       /api/records         Api::Controllers::Records::Create\n  record PATCH      /api/records/:id     Api::Controllers::Records::Update\n  record DELETE     /api/records/:id     Api::Controllers::Records::Destroy</code></pre>\n      </div>\n<h3 id="레코드-생성"><a href="#%EB%A0%88%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>레코드 생성</h3>\n<p>이제 세부 로직을 구현할 준비가 끝났으니 레코드 생성을 해 보겠습니다. 지금은 임의의 사용자를 지정하여 레코드를 생성하려 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>first\n      amount <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:amount</span><span class="token punctuation">)</span>\n      description <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:description</span><span class="token punctuation">)</span>\n\n      record <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>\n        user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n        amount<span class="token punctuation">:</span> amount<span class="token punctuation">,</span>\n        description<span class="token punctuation">:</span> description\n      <span class="token punctuation">)</span>\n\n      status <span class="token number">201</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>패러매터가 유효하면 레코드를 생성하고 그 정보를 JSON으로 리턴하는 간단한 내용의 코드입니다. 이제 패러매터의 유효성은 둘째치고 모든 액션에 앞서 토큰의 유효성을 검사하는 모듈이 필요합니다. 이 파일을 어디에 정의하고 어떻게 사용하는지 <a href="http://hanamirb.org/guides/actions/share-code/">가이드에 잘 설명이 되어있는데</a>, 가이드의 내용을 활용하여 만들어보겠습니다.</p>\n<h3 id="토큰-인증"><a href="#%ED%86%A0%ED%81%B0-%EC%9D%B8%EC%A6%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 인증</h3>\n<p>컨트롤러에 공통적으로 사용되는 모듈은 해당 앱의 <code class="language-text">/controllers</code> 폴더에다 바로 작성하면 됩니다. 그리고 모든 컨트롤러 액션에 공통적으로 사용하고자 하면 <code class="language-text">application.rb</code> 파일을 수정해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/authentication.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span>\n  <span class="token keyword">module</span> <span class="token constant">Authentication</span>\n    <span class="token keyword">module</span> <span class="token constant">Skip</span>\n      <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:authenticate!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      halt <span class="token number">401</span> <span class="token keyword">unless</span> authenticated<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> authenticated<span class="token operator">?</span>\n      <span class="token operator">!</span><span class="token operator">!</span>current_user\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> current_user\n      user_id <span class="token operator">=</span> validate_token <span class="token operator">?</span> validate_token<span class="token punctuation">[</span><span class="token string">\'user_id\'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">nil</span>\n      <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> validate_token\n      token_header <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">get_header</span><span class="token punctuation">(</span><span class="token string">\'HTTP_AUTHORIZATION\'</span><span class="token punctuation">)</span>\n      token <span class="token operator">=</span> token_header<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span><span class="token regex">/^Bearer\\s/</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span>\n\n      <span class="token keyword">begin</span>\n        <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n      <span class="token keyword">rescue</span>\n        <span class="token keyword">nil</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>몇 가지 이상한 녀석들이 나왔습니다. 일단 <code class="language-text">included</code> 메서드는 모듈이 특정 모듈이나 클래스에 <code class="language-text">include</code> 될 때 실행되는 훅(Hook)과 같은 메서드입니다. 인자 <code class="language-text">action</code> 은 이 모듈을 불러온 액션을 뜻합니다. 그리고 <code class="language-text">class_eval</code> 은 해당 클래스에 블락의 내용을 추가로 작성해주는 메서드라고 이해하시면 됩니다. 즉 이 모듈을 불러오는 클래스는 <code class="language-text">before :authenticate!</code> 라는 코드 라인이 추가되는겁니다. <code class="language-text">before</code> 는 레일즈의 <code class="language-text">before_action</code> 처럼 해당 액션을 실행하기 전에 먼저 실행되는 메서드를 정의합니다.</p>\n<p>마지막으로 <code class="language-text">request</code> 는 <code class="language-text">Rack::Request</code> 에 정의되어 있는 객체입니다 <a href="http://hanamirb.org/guides/actions/request-and-response/">가이드에 간단한 사용법이 있지만</a> 더 자세한 사용법을 보시려면 <a href="http://www.rubydoc.info/gems/rack/Rack/Request">직접 문서를 보셔야 합니다</a>.</p>\n<p>사용자는 발급받은 토큰을 매 HTTP 헤더에 실어서 보내야 합니다. 그 형식은 <code class="language-text">Authorization =&gt; Bearer {token}</code> 이 되도록 지정했습니다.</p>\n<p>이제 애플리케이션 설정 파일에서 이 모듈을 공통적으로 불러오게 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># ...</span>\nrequire_relative <span class="token string">\'./controllers/authentication\'</span>\n<span class="token comment"># ...</span>\n      controller<span class="token punctuation">.</span>prepare <span class="token keyword">do</span>\n        include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span> <span class="token comment"># included in all the actions</span>\n      <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>약 260번째 줄 부근에 해당 코드가 있습니다. 모든 컨트롤러 액션에 이 블록 안의 코드가 추가됩니다. 맨 윗줄에 <code class="language-text">require_relative</code> 로 파일을 불러오는 걸 잊어버리시면 안됩니다.</p>\n<p>그 다음 <code class="language-text">records#create</code> 액션의 코드를 수정해줍시다. 한 줄이면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token comment"># ...</span>\nuser <span class="token operator">=</span> current_user\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>테스트를 잘 작성해오셨다면 전혀 뜬금없이 회원 가입, 로그인 액션에서 오류가 납니다. 인증 토큰을 요구할 필요가 없는 액션에서도 토큰을 요구하고 있기 때문입니다. 하지만 위에 인증을 스킵할 수 있도록 오버라이드용 메서드를 정의해 두었으니 <code class="language-text">Api::Authentication::Skip</code> 모듈을 불러오기만 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Skip</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h3 id="나머지-액션들-작성"><a href="#%EB%82%98%EB%A8%B8%EC%A7%80-%EC%95%A1%EC%85%98%EB%93%A4-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나머지 액션들 작성</h3>\n<p>이제 레코드를 만들고, 인증하는 과정을 만들었으니 나머지 액션들은 비교적 간단합니다. 간단하게 작성한 코드를 참고해주세요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      status <span class="token number">200</span><span class="token punctuation">,</span> get_records<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span>\n\n    <span class="token keyword">def</span> get_records\n      records <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">by_user</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token operator">|</span>record<span class="token operator">|</span> record<span class="token punctuation">.</span>to_h <span class="token punctuation">}</span>\n\n      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>tap <span class="token keyword">do</span> <span class="token operator">|</span>hash<span class="token operator">|</span>\n        hash<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token symbol">:records</span><span class="token punctuation">,</span> records<span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">by_user</code> 메서드는 <code class="language-text">RecordRepository</code> 에 정의되어 있습니다. 사실 레일즈 사용자분들이라면 모델에 <code class="language-text">has_many</code> 같은 메서드를 사용하여 1:N 관계를 정의하는 경우가 보편적일텐데요. 하나미도 <a href="http://hanamirb.org/guides/models/associations/">최근에 그런 기능을 지원하기 시작헀지만</a> 아직 실험적인 기능이기 때문에 직접 구현했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/record_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">RecordRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">by_user</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n    records<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후의 결과물은 완성된 Hash나 Array가 아니라 <code class="language-text">Enumerator</code> 같은 객체라서 원하는 결과물을 반복 메서드를 사용하여 다양하게 다룰 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">require_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Update</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      <span class="token keyword">begin</span>\n        updated_record <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">,</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        status <span class="token number">200</span><span class="token punctuation">,</span> updated_record<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There was a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">SetRecord</code> 모듈도 <a href="http://hanamirb.org/guides/actions/share-code/">공식 가이드의 내용</a>을 참고하여 만들었습니다. Update와 Destroy 액션에서 공통적으로 레코드를 찾는 과정이 필요한데, 모듈에다 구현해두고 여러 액션에서 재활용할 수 있도록 만든겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/set_record.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">module</span> <span class="token constant">SetRecord</span>\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:set_record</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> set_record\n      <span class="token variable">@record</span> <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n      halt <span class="token number">404</span> <span class="token keyword">unless</span> <span class="token variable">@record</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/destroy.rb</span>\nrequire_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Destroy</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">begin</span>\n        repo<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n        status <span class="token number">204</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token string">\'Successfully Removed\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There is a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>축하합니다. 여러분은 하나미로 간단 API 서버를 가독성 높고 모듈화하기 용이한 루비 코드로 작성하였습니다.</p>\n<hr>\n<p>사실 더 개선할 부분들은 많습니다. 예를 들면 Interactor 를 활용한 로직 분리, 명확한 의존성 주입으로 테스트 효율 높이기 + 더 짜임새 있는 테스트 작성 등을 고려해야겠지요. 마침 <a href="https://github.com/nickgnd/hanami-jwt-example">비슷한 내용의 예제 코드가 아주아주 높은 퀄리티로 작성되어 있어서</a> 이번 튜토리얼을 구현해보면서 기본 개념을 익히신 다음에, 다른 예제를 참고하시면 큰 도움이 될 것이라 생각합니다.</p>\n<ul>\n<li>Source Code: <a href="https://github.com/emaren84/moneybook_api">Github</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-04-27-hanami-vuejs-moneybook-api-server/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-27",path:"/posts/hanami-vuejs-moneybook-api-server",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (API 서버 편)",tags:["Ruby","Hanami","Vue.js"],category:"Hanami"}}],Hanami:[{excerpt:"Hanamirb + Vue.js 시리즈 목차 API 서버 로그인 & 회원가입 페이지 가계부 페이지 업데이트 BCrypt 관련 설명 수정 (2017-05-02) 들어가며 하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.…",html:'<p><strong>Hanamirb + Vue.js 시리즈 목차</strong></p>\n<ol>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-api-server">API 서버</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-1">로그인 &#x26; 회원가입 페이지</a></p>\n</li>\n<li>\n<p><a href="/posts/hanami-vuejs-moneybook-frontend-2">가계부 페이지</a></p>\n</li>\n</ol>\n<hr>\n<p><strong>업데이트</strong></p>\n<ul>\n<li>BCrypt 관련 설명 수정 (2017-05-02)</li>\n</ul>\n<hr>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>하나미 정식 버전이 지난 4월 6일에 발표되었습니다. 기존에 레일즈에 여러모로 아쉬움을 느끼고 있던 해외의 루비 개발자들은 많은 관심을 가지고 있나봅니다. 제가 처음 하나미를 접했을 때 버전이 0.7.2였는데 어느새 1.0.0 버전이 발매되었고, 아직도 쓰고있다보니 감개무량합니다.</p>\n<p>요즘 프론트엔드 JS 프레임워크에 많은 관심을 가지고 ReactJS, Vue.js를 공부하고 있는데, 간단히 배운 내용을 적용해볼 겸 간단 가계부를 구현해보도록 하겠습니다. 백엔드 JSON API 서버는 하나미로 구현하고, 프론트엔드는 Vue.js로 구현하는 과정을 보여드리겠습니다.</p>\n<p>최대한 간단히 설명해드리려 노력하겠지만, 기존에 루비로 웹 개발을 해보신분이 이해하시기 쉬울 겁니다. 사실 JSON API 서버는 어떤 언어나 프레임워크로 제공해도 되니까요 :) 구현방법에 약간씩 차이가 있을 뿐이지 제가 보여드리는 정도의 앱은 그렇게 어렵지 않게 작성하실 수 있으리라 봅니다.</p>\n<h2 id="애플리케이션의-기본-구성"><a href="#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>애플리케이션의 기본 구성</h2>\n<p>처음에는 더욱 간단한 To-Do List(할일 관리) 를 구현하려고 했는데, 그러면 하나미를 다루는 부분이 너무 영양가가 없어질 것 같아서 가계부 형식의 앱으로 만들고, 다음의 기능을 구상해 보았습니다.</p>\n<ul>\n<li>\n<p>회원 등록 및 인증</p>\n<ul>\n<li>이메일과 비밀번호로 회원 가입</li>\n<li>JWT로 인증 (토큰은 LocalStorage에 저장)</li>\n</ul>\n</li>\n<li>\n<p>사용금액, 내용 입력</p>\n<ul>\n<li>수입은 녹색, 지출은 빨강색으로 표시</li>\n<li>각 아이템을 클릭하면 바로 수정 가능, 삭제 버튼을 누르면 삭제</li>\n</ul>\n</li>\n<li>수입, 지출을 필터링하여 보기</li>\n<li>가장 최신 레코드 30개를 처음에 불러온 뒤, 화면에 보이는 마지막 내역까지 스크롤 하게 되면 추가로 자료 가져오기</li>\n</ul>\n<p>이 정도의 기능을 구현해볼 예정입니다. 막상 하려니 쉽진 않겠지만 차근차근 진행해보겠습니다.</p>\n<h2 id="하나미-프로젝트-생성"><a href="#%ED%95%98%EB%82%98%EB%AF%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미 프로젝트 생성</h2>\n<p>너무나 당연하지만 하나미를 사용하기 위해서는 개발 환경에 루비가 세팅되어 있어야 합니다. 아직 루비가 설치되어있지 않은 경우에는 <a href="https://gorails.com/setup/">GoRails의 설치 가이드</a>를 따라하시면 되겠습니다. 그 다음에 하나미 젬을 설치하시면 됩니다. 이번 강좌에서는 <strong>루비 2.4.1</strong>, <strong>하나미 1.0.0</strong> 버전을 기준으로 프로젝트를 생성하겠습니다.</p>\n<p>먼저 하나미 젬을 설치합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">gem install hanami</code></pre>\n      </div>\n<p>설치 된 이후에 프로젝트는 원하시는 이름으로 설치하시면 됩니다. 하나미는 SQLite, MySQL, PostgreSQL 등을 지원하지만, 기본적으로 PostgreSQL을 권장합니다. 또한 테스팅 프레임워크도 처음 프로젝트를 설정할 때 Minitest, RSpec 중에서 고르실 수 있습니다. 제가 아직 RSpec은 커녕 TDD를 잘 못하기 때문에 Minitest로 진행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">hanami new moneybook-api --database=postgres --test=minitest</code></pre>\n      </div>\n<p>생성된 프로젝트에서 젬파일을 살펴보시면 꽤 간단합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\nsource <span class="token string">\'https://rubygems.org\'</span>\n\ngem <span class="token string">\'rake\'</span>\ngem <span class="token string">\'hanami\'</span><span class="token punctuation">,</span>       <span class="token string">\'~> 1.0\'</span>\ngem <span class="token string">\'hanami-model\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 1.0\'</span>\n\ngem <span class="token string">\'pg\'</span>\n\ngroup <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  <span class="token comment"># Code reloading</span>\n  <span class="token comment"># See: http://hanamirb.org/guides/projects/code-reloading</span>\n  gem <span class="token string">\'shotgun\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span><span class="token punctuation">,</span> <span class="token symbol">:development</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'dotenv\'</span><span class="token punctuation">,</span> <span class="token string">\'~> 2.0\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:test</span> <span class="token keyword">do</span>\n  gem <span class="token string">\'minitest\'</span>\n  gem <span class="token string">\'capybara\'</span>\n<span class="token keyword">end</span>\n\ngroup <span class="token symbol">:production</span> <span class="token keyword">do</span>\n  <span class="token comment"># gem \'puma\'</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이 중에서 <code class="language-text">capybara</code> 젬은 뷰 테스트 용이기 떄문에 이번 프로젝트에선 굳이 없어도 됩니다. 앞으로 젬이 더 추가될테지만 필요에 따라 추가하기로 하고, <code class="language-text">bundle install</code> 커맨드로 필요한 젬을 설치해두겠습니다.</p>\n<p>참고로 PostgreSQL을 이용하시려면 <code class="language-text">.env</code> 파일에서 계정 설정을 해주셔야 합니다. SQLite를 이용하신다면 파일로 관리되기 때문에 계정 설정을 해 주실 필요는 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\nDATABASE_URL=&quot;postgresql://username:password@localhost/moneybook_api_development&quot;</code></pre>\n      </div>\n<h2 id="사용자-인증-구현"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 인증 구현</h2>\n<p>기존의 웹 페이지는 서버에서 인증 관련 정보를 들고, 세션을 이용하여 인증 상태를 유지하고 요청을 하는 경우가 많았습니다. 하지만 모바일 애플리케이션이나, 많은 인스턴스를 올려서 인증을 관리하는 경우 세션 기반 인증은 유연한 대응이 어렵습니다. JWT라는 개념을 이용하면 세션 기반 인증의 단점을 극복하고 사용자 인증을 적용할 수 있습니다.</p>\n<p>JWT 인증이 무엇인지 궁금하시다면 다음의 링크를 읽어보시길 바랍니다.</p>\n<ul>\n<li><a href="https://velopert.com/2389">JSON Web Token 소개 및 구조 - velopert</a></li>\n<li><a href="http://bcho.tistory.com/999">REST JWT 소개 - 조대협</a></li>\n<li><a href="https://jwt.io/introduction/">Introduction to JSON Web Tokens</a></li>\n</ul>\n<p>인증에 필요한 젬을 추가한 뒤, 사용자 정보를 기록하는 모델을 생성하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>\n<span class="token comment"># ...</span>\ngem <span class="token string">\'bcrypt\'</span>\ngem <span class="token string">\'jwt\'</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">bcrypt</code> 젬은 비밀번호 생성에 특화된 단방향 해시 함수를 지원합니다.<br>\n간단한 사용법을 알려드리면 <code class="language-text">BCrypt::Password.create(&#39;password&#39;)</code> 로 해시 다이제스트를 생성하고, <code class="language-text">BCrypt::Password.new(digest)</code> 로 해시 다이제스트가 본래 비밀번호와 일치하는지 검사합니다.</p>\n<p>너무나 당연하면서 중요한 이야기지만 웹 개발자로서 복잡한 보안 알고리즘을 직접 구현하면 관리 및 취약점을 파악하기가 어렵기 때문에 차라리 <code class="language-text">bcrypt</code> 처럼 검증된 라이브러리를 사용하시길 추천합니다. 비슷한 예로 Rails에서 사용자 인증과 관련한 부분은 되도록이면 Devise 젬을 사용하길 권장하는 것 처럼요.</p>\n<p>패스워드 저장 매커니즘에 대해 <a href="http://d2.naver.com/helloworld/318732">이 글</a>을 읽어보시길 추천합니다.</p>\n<h3 id="사용자-모델-생성"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 모델 생성</h3>\n<p>먼저 사용자 정보를 저장하기 위한 모델을 생성하겠습니다. 간단히 이메일과 패스워드를 저장하는 테이블을 만들면 되겠네요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model user</code></pre>\n      </div>\n<p>앞으로 모든 하나미 커맨드 앞에는 <code class="language-text">bundle exec</code>  이 붙을 예정입니다. 앞으로 하나미를 자주 쓰게 되면 <code class="language-text">bashrc</code> 나  <code class="language-text">zshrc</code> 에 alias 지정을 해 두는걸 추천합니다.</p>\n<p>그리고 레일즈와 비슷하게 <code class="language-text">db/migrations</code> 폴더에 마이그레이션 파일이 있습니다. 어떤 컬럼에 어떤 정보가 들어가게 될 지 작성해주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migration/2017***_create_users.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:users</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:password_digest</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>방법에 따라서는 이메일 컬럼만 있어도 충분히 JWT 인증을 구현할 수 있다는데 아직 잘 모르겠습니다. 이제 테이블 생성을 위해 마이그레이션을 실행하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami db create # 먼저 데이터베이스 생성부터\nbundle exec hanami db migrate</code></pre>\n      </div>\n<h3 id="사용자-등록-액션"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%93%B1%EB%A1%9D-%EC%95%A1%EC%85%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 등록 액션</h3>\n<p>이제 사용자를 등록하는 액션을 생성하겠습니다. 이후에 JWT 인증하는 과정을 덧붙일 예정입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api auth#sign_in --skip-view\nbundle exec hanami generate action api auth#sign_up --skip-view</code></pre>\n      </div>\n<p>action 뒤에 <code class="language-text">api</code> 는 제가 사용할 앱 이름입니다. 기본값은 web으로 되어 있지만, <a href="http://hanamirb.org/guides/command-line/generators/">하나미 가이드의 Command Line 부분을 참고하시면</a> 다른 앱을 생성하거나 삭제하는 등 액션을 실행할 수 있습니다.</p>\n<p><code class="language-text">--skip-view</code> 는 뷰와 관련된 템플릿 파일이나 뷰 클래스 및 테스트를 생성하지 않는 커맨드입니다. 우리는 하나미를 순순히 API 서버로 사용할 것이기 때문에 미리 입력해주어야 불필요한 파일을 만들지 않게 됩니다.</p>\n<p>라우팅 파일의 내용도 변경해줍니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\npost <span class="token string">\'/auth/sign_in\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_in\'</span>\npost <span class="token string">\'/auth/sign_up\'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">\'auth#sign_up\'</span>\n</code></pre>\n      </div>\n<p>사용자를 등록하는 과정은 JWT랑은 관련이 없습니다. 단순히 이메일, 비밀번호, 비밀번호 확인을 하는 패러매터를 전달 받은 뒤, 유효성 검사에 성공하면 비밀번호를 암호화하여 데이터베이스에 저장하면 됩니다.</p>\n<p>우리는 JSON API 서버를 만들고 있기 때문에 애플리케이션의 <code class="language-text">body_parsers</code> 나 <code class="language-text">default_request_format</code> 등의 설정을 바꾸어 주어야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># From Line 90</span>\n      <span class="token comment"># Default format for the requests that don\'t specify an HTTP_ACCEPT header</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_request_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># Default format for responses that don\'t consider the request format</span>\n      <span class="token comment"># Argument: A symbol representation of a mime type, defaults to :html</span>\n      <span class="token comment">#</span>\n      default_response_format <span class="token symbol">:json</span>\n\n      <span class="token comment"># HTTP Body parsers</span>\n      <span class="token comment"># Parse non GET responses body for a specific mime type</span>\n      <span class="token comment"># Argument: Symbol, which represent the format of the mime type</span>\n      <span class="token comment">#             (only `:json` is supported)</span>\n      <span class="token comment">#           Object, the parser</span>\n      <span class="token comment">#</span>\n      body_parsers <span class="token symbol">:json</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>이제 안정적으로 기능을 구현하기 위해 테스트를 작성하겠습니다. 테스트 파일은 <code class="language-text">spec/</code> 폴더에 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># spec/api/controllers/auth/sign_up_spec.rb</span>\n<span class="token keyword">require</span> <span class="token string">\'spec_helper\'</span>\nrequire_relative <span class="token string">\'../../../../apps/api/controllers/auth/sign_up\'</span>\n\ndescribe <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span> <span class="token keyword">do</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">SignUp</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">}</span>\n  <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n      user<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> <span class="token string">"foo@bar.com"</span><span class="token punctuation">,</span>\n        password<span class="token punctuation">:</span> <span class="token string">"secret"</span><span class="token punctuation">,</span>\n        password_confirmation<span class="token punctuation">:</span> <span class="token string">"secret"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  describe <span class="token string">\'with valid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'is successful\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">201</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n\n  describe <span class="token string">\'with invalid params\'</span> <span class="token keyword">do</span>\n    it <span class="token string">\'returns 422\'</span> <span class="token keyword">do</span>\n      response <span class="token operator">=</span> action<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n      response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>must_equal <span class="token number">422</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>먼저 유효성 검사부터 만들겠습니다. 하나미의 유효성 검사는 모델에서 수행하는 게 아니라 각 액션에서 수행합니다. (공통된 유효성 검사를 모듈화할 수도 있습니다)</p>\n<p><strong>작성되는 코드는 모두 테스트를 먼저 작성하고 진행하지만, 글에서 모두 보여드리지 않겠습니다. 자세한 내용은 <a href="https://github.com/emaren84/moneybook_api">Github에 올라와 있는 소스코드</a>를 살펴봐 주세요.</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">halt</code> 메서드는 인자로 받은 스테이터스 번호와 메세지를 리턴합니다. 메세지는 생략 가능합니다. 이제 올바른 패러매터가 들어왔으면  사용자를 등록하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># same file</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span><span class="token punctuation">.</span>confirmation\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>interactor<span class="token punctuation">:</span> <span class="token constant">UserSignUp</span><span class="token punctuation">)</span>\n      <span class="token variable">@interactor</span> <span class="token operator">=</span> interactor\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      result <span class="token operator">=</span> <span class="token variable">@interactor</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>call\n      status <span class="token number">201</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>user<span class="token punctuation">.</span>show_info<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>뭔가 이상한 녀석이 나왔습니다. interactor라뇨? 인터렉터(Interactor)는 하나미에서 제공하는 모듈인데, 보통 다양한 비지니스 처리 로직을 분리하는 용도 혹은 재사용 가능한 비지니스 로직을 API, Web 같이 서로 다른 앱에서도 공유할 수 있도록 만들어졌습니다. <code class="language-text">lib/interactor</code> 에 해당 클래스명으로 작성합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/interactor/user_sign_up.rb</span>\n<span class="token keyword">require</span> <span class="token string">"hanami/interactor"</span>\n<span class="token keyword">require</span> <span class="token string">"bcrypt"</span>\n\n<span class="token keyword">class</span> <span class="token class-name">UserSignUp</span>\n  include <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Interactor</span>\n  include <span class="token constant">BCrypt</span>\n\n  expose <span class="token symbol">:user</span>\n\n  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">,</span> encryptor<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> repo<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">)</span>\n    <span class="token variable">@user_attr</span> <span class="token operator">=</span> user_attr\n    <span class="token variable">@encryptor</span> <span class="token operator">=</span> encryptor <span class="token operator">||</span> <span class="token constant">BCrypt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Password</span>\n    <span class="token variable">@repo</span> <span class="token operator">=</span> repo <span class="token operator">||</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n  <span class="token class-name">end</span>\n\n  <span class="token keyword">def</span> call\n    safe_user <span class="token operator">=</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>user_attr<span class="token punctuation">)</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token variable">@repo</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>safe_user<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">private</span>\n\n  attr_reader <span class="token symbol">:user_attr</span>\n\n  <span class="token keyword">def</span> <span class="token function">encrypt_user</span><span class="token punctuation">(</span>attributes<span class="token punctuation">)</span>\n    password <span class="token operator">=</span> <span class="token variable">@encryptor</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>attributes<span class="token punctuation">[</span><span class="token symbol">:password</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n    <span class="token punctuation">{</span> email<span class="token punctuation">:</span> user_attr<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">,</span> password_digest<span class="token punctuation">:</span> password <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>눈여겨 보실점은 <code class="language-text">expose</code> 밖에 없고 나머지는 일반적인 사용자 등록 로직으로 구성되어 있습니다. 인터렉터는 해당 클래스의 객체를 생성하고 <code class="language-text">call</code> 메서드로 연산을 수행하는데, 그 결과값을 <code class="language-text">expose</code> 로 내보내야 합니다. 참고로 <code class="language-text">expose</code> 로 내보내려는 값은 인스턴스 변수여야 합니다. 여기서는 <code class="language-text">@user</code> 가 되겠네요. 내보낸 결과물은 메서드처럼 <code class="language-text">.user</code> 로 가져올 수 있습니다.</p>\n<p>그런데 액션 부분에 <code class="language-text">result.user.show_info.to_json</code>  이라고 되어있는 부분이 있습니다. <code class="language-text">to_json</code> 은 리턴값이 JSON이어야 되니까 그렇다 치고, <code class="language-text">show_info</code> 는 어디에 있는 녀석일까요? 방금까지 우리는 사용자를 생성했습니다. 그리고 생성된 결과값이 User Entity(엔티티)인데, 엔티티에 메서드를 정의하여 원하는 정보를 가공하여 보여줄 수 있도록 만든 것입니다. 콘솔에서 한번 확인해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami console</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[2] pry(main)&gt; UserRepository.new.create(email: &#39;foo@baz.com&#39;, password_digest: &#39;some secret&#39;)\n[moneybook_api] [INFO] [2017-04-22 14:06:37 +0900] (0.003739s) INSERT INTO &quot;users&quot; (&quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (&#39;foo@baz.com&#39;, &#39;some secret&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;, &#39;2017-04-22 05:06:37.222355+0000&#39;) RETURNING &quot;id&quot;, &quot;email&quot;, &quot;password_digest&quot;, &quot;created_at&quot;, &quot;updated_at&quot;\n=&gt; #&lt;User:0x007fb6a6c49348\n @attributes=\n  {:id=&gt;3, :email=&gt;&quot;foo@baz.com&quot;, :password_digest=&gt;&quot;some secret&quot;, :created_at=&gt;2017-04-22 05:06:37 UTC, :updated_at=&gt;2017-04-22 05:06:37 UTC}&gt;</code></pre>\n      </div>\n<p>저렇게 임의의 사용자를 생성하니 User 엔티티가 리턴된 것을 볼 수 있습니다. Repository가 뭐고, Entity가 무엇인지는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0">제가 전에 작성한 하나미 소개 포스트를 참고해주세요.</a></p>\n<p>엔티티 클래스 파일의 위치는 <code class="language-text">lib/moneybook_api/entities</code> 입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/entities/user.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Entity</span>\n  <span class="token keyword">def</span> show_info\n    <span class="token keyword">self</span><span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>tap <span class="token punctuation">{</span> <span class="token operator">|</span>attributes<span class="token operator">|</span> attributes<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:password_digest</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이렇게 하여 사용자 생성 후 리턴 값에는 패스워드를 뺸 나머지 정보만 보이게 됩니다.</p>\n<h3 id="토큰-생성하기"><a href="#%ED%86%A0%ED%81%B0-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 생성하기</h3>\n<p>이제부터가 본격적인 JWT 인증을 구현하는 부분입니다. 생성한 사용자가 로그인을 시도하고 요청한 이메일과 비밀번호가 맞다면 우리는 인증 토큰을 생성하여 돌려주게 되고, 사용자는 매번 로그인 할 필요 없이 그 토큰을 가지고 (유효기간이 만료할 때 까지) 자유로이 앱을 사용할 수 있게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/controllers/auth/sign_in.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignIn</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token constant">VALID_EMAIL_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:email</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">,</span> format<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token constant">VALID_EMAIL_REGEX</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      email <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">)</span>\n      password <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:user</span><span class="token punctuation">,</span> <span class="token symbol">:password</span><span class="token punctuation">)</span>\n\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n\n      <span class="token keyword">if</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>valid_password<span class="token operator">?</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>\n        token <span class="token operator">=</span> <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n\n        status <span class="token number">201</span><span class="token punctuation">,</span> token<span class="token punctuation">.</span>to_json\n      <span class="token keyword">else</span>\n        halt <span class="token number">401</span><span class="token punctuation">,</span> <span class="token string">\'Authentication Failed\'</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>유효성 검사를 하는 부분은 회원 등록 하는 액션에서도 적어놓았기 때문에 쉽게 알아보실 수 있을겁니다. 바로 아래에 <code class="language-text">params.get</code> 이라는 메서드는 <code class="language-text">Hash#dig</code> 메서드와 비슷한 용도를 가지고 있는데 <code class="language-text">params[:user][:email]</code> 같이 값을 검색하려다가 <code class="language-text">params[:user]</code> 가 <code class="language-text">nil</code> 인 경우 <code class="language-text">NoMethodError</code> 에러가 발생하는 일을 방지해줍니다. 대신 <code class="language-text">nil</code> 을 리턴합니다.</p>\n<p><code class="language-text">find_by_email</code> 같은 메서드는 레일즈를 하시는 분들이 보기엔 아주 친숙할겁니다. 하지만 우리는 이 메서드를 직접 구현해야 합니다. 레일즈로 개발하면서 느끼는 마법은 하나미에서는 일어나지 않습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/user_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">UserRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">find_by_email</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span>\n    users<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> email<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token symbol">:entity</span><span class="token punctuation">)</span><span class="token punctuation">.</span>one\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><strong>모든 하나미의 쿼리 메서드는 private 입니다. 콘솔에서 바로 테스트 할 수 없습니다.</strong> 테스트를 작성하거나, 원하는 쿼리를 메서드로 정의한 뒤에 콘솔에서 돌려봐야 합니다.</p>\n<p><code class="language-text">users</code> 는 리퍼지토리와 연결되어있는 테이블명을 나타내는 규약입니다. 만약 <code class="language-text">BookRepository</code> 에서 <code class="language-text">books</code> 라는 테이블의 내용을 가져오게 된다면 우리는 <code class="language-text">books.</code> 로 시작하는 메서드를 작성하게 됩니다. 자세한 내용은 하나미 모델의 구현체인 <a href="http://rom-rb.org">ROM</a>의 문서를 참고하시는게 좋습니다.</p>\n<p>레일즈를 개발하는 분들은 보통 쿼리의 결과가 각 모델의 객체로 나오기 때문에 이후에 각 엔티티마다 메서드를 바로 사용할 수 있을겁니다. 하지만 하나미에서는 <code class="language-text">as(:entity)</code> 옵션을 적용해주지 않으면 결과물이 단순한 <code class="language-text">ROM::Struct</code> 객체를 리턴하거나. <code class="language-text">ROM::Relation</code> 객체를 리턴하는 경우가 많습니다.</p>\n<p><code class="language-text">Struct</code> 객체는 Hash처럼 되어있어서, 쿼리의 결과 레코드를 그대로 쓰는 건 가능하지만 엔티티에 정의해놓은 메서드를 사용할 수 없습니다. <code class="language-text">Relation</code> 객체는 쿼리를 아직 실행하기 전에 ROM에서 쿼리를 준비해 놓는 객체입니다. 이 객체에 <code class="language-text">to_a</code> 나 <code class="language-text">each</code> 같은 메서드를 사용해서 자료를 가공할 때 쿼리를 실행하고, 그 때 엔티티를 다룰 수 있습니다.</p>\n<p>지금은 간단한 쿼리라서 <code class="language-text">.as(:entity)</code> 부분을 빼도 결과값을 맨 앞 한개만 출력하라는 <code class="language-text">one</code> 메서드 때문에 바로 User 엔티티가 출력될겁니다. 이후에 더 복잡한 쿼리를 작성하게 되는 일이 있을 때 제가 말씀드린 내용이 도움이 되었으면 좋겠습니다.</p>\n<p><code class="language-text">user.valid_password?</code> 메서드는 <code class="language-text">BCrypt</code> 젬을 이용하여 암호화했던 비밀번호를 해독하고, 맞는지 확인하는 역할을 합니다.</p>\n<p><code class="language-text">JwtIssuer</code> 클래스는 라이브러리로 활용하기 위해 <code class="language-text">lib/moneybook_api/services</code> 폴더에 작성했습니다. 여기에 작성해 두면 다른 앱이나 액션에서 자유롭게 사용할 수 있기 때문입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/services</span>\n<span class="token keyword">class</span> <span class="token class-name">JwtIssuer</span>\n  <span class="token constant">DEFAULT_EXPIRE_TIME</span> <span class="token operator">=</span> <span class="token number">86400</span> <span class="token comment"># 24 hours</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> exp <span class="token operator">=</span> <span class="token builtin">Time</span><span class="token punctuation">.</span>now<span class="token punctuation">.</span>to_i <span class="token operator">+</span> <span class="token constant">DEFAULT_EXPIRE_TIME</span><span class="token punctuation">)</span>\n    payload <span class="token operator">=</span> <span class="token punctuation">{</span> user_id<span class="token punctuation">:</span> user_id<span class="token punctuation">,</span> iss<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_ISSUER\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> exp<span class="token punctuation">:</span> exp <span class="token punctuation">}</span>\n    token <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">\'HS256\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> auth_token<span class="token punctuation">:</span> token <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n    <span class="token constant">JWT</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'JWT_SECRET\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>코드의 내용은 <a href="https://github.com/jwt/ruby-jwt/blob/master/README.md#algorithms-and-usage">JWT 젬의 사용법을 따라</a> 우리가 필요한 부분을 캡슐화한 정도입니다. 토큰 생성 시점에서 24시간의 기한을 주었고, <code class="language-text">iss</code> 옵션은 발행자 옵션인데, 임의로 <code class="language-text">localhost</code> 로 지정해두었습니다. <code class="language-text">ENV[&#39;JWT_SECRET&#39;]</code> 같이 지정되어있는 환경변수를 가져오는 방법은 프로젝트 폴더에 <code class="language-text">.env.development</code> 같이 되어있는 파일에다 작성는 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># .env.development\n# ...\nJWT_SECRET=&quot;some secret&quot;\n# ...</code></pre>\n      </div>\n<p>비밀번호 토큰은 여러분이 원하는대로 만든 다음에, <code class="language-text">Base64</code> 나 <code class="language-text">Digest</code> 클래스를 활용하여 암호화하시길 추천합니다.</p>\n<p>인코딩에 성공하면 컨트롤러 액션은 201 스테이터스와 함께 토큰 JSON을 리턴하게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl -X POST -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/json&quot; -d &#39;{ &quot;user&quot;: { &quot;email&quot;: &quot;foo@bar.com&quot;, &quot;foo&quot;: &quot;cherryblossom&quot; } }&#39; &quot;http://localhost:2300/api/auth/sign_in&quot;\n=&gt;\n{\n  &quot;auth_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0LCJpc3MiOiJsb2NhbGhvc3QiLCJleHAiOjE0OTI5NjM2NTV9.38-CWKZkOuWD_idEOhv1gAret6_qG_ue7kk0iPftJ_M&quot;\n}</code></pre>\n      </div>\n<p>이제 사용자가 매 요청을 할 때마다 이 토큰이 유효한지 검사하는 부분을 만들어야 하는데, 가계부 기록 작성과 관련된 API를 구현한 뒤에 마저 만들어 보겠습니다.</p>\n<h2 id="가계부-api-만들기"><a href="#%EA%B0%80%EA%B3%84%EB%B6%80-api-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>가계부 API 만들기</h2>\n<p>가계부 API는 간단한 REST 형식으로 만들 예정입니다.</p>\n<table>\n<thead>\n<tr>\n<th align="center">정의</th>\n<th align="center">내용</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">/records (GET)</td>\n<td align="center">모든 레코드를 가져온다</td>\n</tr>\n<tr>\n<td align="center">/records (POST)</td>\n<td align="center">레코드를 생성한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id (PATCH)</td>\n<td align="center">해당 레코드를 수정한다</td>\n</tr>\n<tr>\n<td align="center">/records/:record_id(DELETE)</td>\n<td align="center">해당 레코드를 삭제한다</td>\n</tr>\n</tbody>\n</table>\n<p>RESTful API 라면 보통 사용자가 가지고 있는 레코드를 표현해야 하니까 URL 어딘가에 <code class="language-text">user_id</code> 같은게 있어야 할 것 처럼 보입니다. 하지만 우리가 구현하고자 하는 서버에는 필요가 없습니다. JWT 토큰을 HTTP 헤더에 추가하여 요청을 하면, 서버가 토큰을 해석하여 <code class="language-text">user_id</code> 를 찾아내고 그 값을 기반으로 특정 사용자의 레코드를 검색하게 됩니다.</p>\n<h3 id="모델-생성--라우팅"><a href="#%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1--%EB%9D%BC%EC%9A%B0%ED%8C%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 생성 &#x26; 라우팅</h3>\n<p>일단 레코드 모델과 레코드를 생성하는 액션을 만들고 나서, 토큰 인증 과정을 덧붙이도록 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate model record</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/2017**_create_records.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:records</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n      foreign_key <span class="token symbol">:user_id</span><span class="token punctuation">,</span> <span class="token symbol">:users</span><span class="token punctuation">,</span> on_delete<span class="token punctuation">:</span> <span class="token symbol">:cascade</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:amount</span><span class="token punctuation">,</span>      <span class="token builtin">Integer</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:description</span><span class="token punctuation">,</span> <span class="token builtin">String</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>외부 키는 컬럼 이름과, 연결해 줄 테이블 이름을 지정해줍니다. 나머지 뒤에 있는 요소들은 <a href="http://hanamirb.org/guides/migrations/create-table/">공식 문서에 자세한 설명이 있으니</a> 참조바랍니다. 그리고 마이그레이션을 실행하면 됩니다.</p>\n<p>그 다음에 액션을 생성하고 라우트를 지정하겠습니다. 다른 <code class="language-text">records</code> 관련 액션을 미리 생성해두셔도 상관 없습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">bundle exec hanami generate action api records#create --skip-view</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/config/routes.rb</span>\n<span class="token comment"># ...</span>\nresources <span class="token symbol">:records</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>이 부분은 레일즈의 자동 라우팅과 아주 유사합니다. 라우팅이 어떻게 구성되었는지 확인하시려면 <code class="language-text">bundle exec hanami routes</code> 커맨드를 실행하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">    Name Method     Path                           Action\n\n         POST       /api/auth/sign_in    Api::Controllers::Auth::SignIn\n         POST       /api/auth/sign_up    Api::Controllers::Auth::SignUp\n records GET, HEAD  /api/records         Api::Controllers::Records::Index\n records POST       /api/records         Api::Controllers::Records::Create\n  record PATCH      /api/records/:id     Api::Controllers::Records::Update\n  record DELETE     /api/records/:id     Api::Controllers::Records::Destroy</code></pre>\n      </div>\n<h3 id="레코드-생성"><a href="#%EB%A0%88%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>레코드 생성</h3>\n<p>이제 세부 로직을 구현할 준비가 끝났으니 레코드 생성을 해 보겠습니다. 지금은 임의의 사용자를 지정하여 레코드를 생성하려 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n      user <span class="token operator">=</span> <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>first\n      amount <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:amount</span><span class="token punctuation">)</span>\n      description <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">,</span> <span class="token symbol">:description</span><span class="token punctuation">)</span>\n\n      record <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>\n        user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n        amount<span class="token punctuation">:</span> amount<span class="token punctuation">,</span>\n        description<span class="token punctuation">:</span> description\n      <span class="token punctuation">)</span>\n\n      status <span class="token number">201</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>패러매터가 유효하면 레코드를 생성하고 그 정보를 JSON으로 리턴하는 간단한 내용의 코드입니다. 이제 패러매터의 유효성은 둘째치고 모든 액션에 앞서 토큰의 유효성을 검사하는 모듈이 필요합니다. 이 파일을 어디에 정의하고 어떻게 사용하는지 <a href="http://hanamirb.org/guides/actions/share-code/">가이드에 잘 설명이 되어있는데</a>, 가이드의 내용을 활용하여 만들어보겠습니다.</p>\n<h3 id="토큰-인증"><a href="#%ED%86%A0%ED%81%B0-%EC%9D%B8%EC%A6%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>토큰 인증</h3>\n<p>컨트롤러에 공통적으로 사용되는 모듈은 해당 앱의 <code class="language-text">/controllers</code> 폴더에다 바로 작성하면 됩니다. 그리고 모든 컨트롤러 액션에 공통적으로 사용하고자 하면 <code class="language-text">application.rb</code> 파일을 수정해야 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/authentication.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span>\n  <span class="token keyword">module</span> <span class="token constant">Authentication</span>\n    <span class="token keyword">module</span> <span class="token constant">Skip</span>\n      <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:authenticate!</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> authenticate<span class="token operator">!</span>\n      halt <span class="token number">401</span> <span class="token keyword">unless</span> authenticated<span class="token operator">?</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> authenticated<span class="token operator">?</span>\n      <span class="token operator">!</span><span class="token operator">!</span>current_user\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> current_user\n      user_id <span class="token operator">=</span> validate_token <span class="token operator">?</span> validate_token<span class="token punctuation">[</span><span class="token string">\'user_id\'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">nil</span>\n      <span class="token constant">UserRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> validate_token\n      token_header <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">get_header</span><span class="token punctuation">(</span><span class="token string">\'HTTP_AUTHORIZATION\'</span><span class="token punctuation">)</span>\n      token <span class="token operator">=</span> token_header<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span><span class="token regex">/^Bearer\\s/</span><span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span>\n\n      <span class="token keyword">begin</span>\n        <span class="token constant">JwtIssuer</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>\n      <span class="token keyword">rescue</span>\n        <span class="token keyword">nil</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>몇 가지 이상한 녀석들이 나왔습니다. 일단 <code class="language-text">included</code> 메서드는 모듈이 특정 모듈이나 클래스에 <code class="language-text">include</code> 될 때 실행되는 훅(Hook)과 같은 메서드입니다. 인자 <code class="language-text">action</code> 은 이 모듈을 불러온 액션을 뜻합니다. 그리고 <code class="language-text">class_eval</code> 은 해당 클래스에 블락의 내용을 추가로 작성해주는 메서드라고 이해하시면 됩니다. 즉 이 모듈을 불러오는 클래스는 <code class="language-text">before :authenticate!</code> 라는 코드 라인이 추가되는겁니다. <code class="language-text">before</code> 는 레일즈의 <code class="language-text">before_action</code> 처럼 해당 액션을 실행하기 전에 먼저 실행되는 메서드를 정의합니다.</p>\n<p>마지막으로 <code class="language-text">request</code> 는 <code class="language-text">Rack::Request</code> 에 정의되어 있는 객체입니다 <a href="http://hanamirb.org/guides/actions/request-and-response/">가이드에 간단한 사용법이 있지만</a> 더 자세한 사용법을 보시려면 <a href="http://www.rubydoc.info/gems/rack/Rack/Request">직접 문서를 보셔야 합니다</a>.</p>\n<p>사용자는 발급받은 토큰을 매 HTTP 헤더에 실어서 보내야 합니다. 그 형식은 <code class="language-text">Authorization =&gt; Bearer {token}</code> 이 되도록 지정했습니다.</p>\n<p>이제 애플리케이션 설정 파일에서 이 모듈을 공통적으로 불러오게 하겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/application.rb</span>\n<span class="token comment"># ...</span>\nrequire_relative <span class="token string">\'./controllers/authentication\'</span>\n<span class="token comment"># ...</span>\n      controller<span class="token punctuation">.</span>prepare <span class="token keyword">do</span>\n        include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span> <span class="token comment"># included in all the actions</span>\n      <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>약 260번째 줄 부근에 해당 코드가 있습니다. 모든 컨트롤러 액션에 이 블록 안의 코드가 추가됩니다. 맨 윗줄에 <code class="language-text">require_relative</code> 로 파일을 불러오는 걸 잊어버리시면 안됩니다.</p>\n<p>그 다음 <code class="language-text">records#create</code> 액션의 코드를 수정해줍시다. 한 줄이면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/create.rb</span>\n<span class="token comment"># ...</span>\nuser <span class="token operator">=</span> current_user\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>테스트를 잘 작성해오셨다면 전혀 뜬금없이 회원 가입, 로그인 액션에서 오류가 납니다. 인증 토큰을 요구할 필요가 없는 액션에서도 토큰을 요구하고 있기 때문입니다. 하지만 위에 인증을 스킵할 수 있도록 오버라이드용 메서드를 정의해 두었으니 <code class="language-text">Api::Authentication::Skip</code> 모듈을 불러오기만 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/auth/sign_up.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Auth</span>\n  <span class="token keyword">class</span> <span class="token class-name">SignUp</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Authentication</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Skip</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h3 id="나머지-액션들-작성"><a href="#%EB%82%98%EB%A8%B8%EC%A7%80-%EC%95%A1%EC%85%98%EB%93%A4-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나머지 액션들 작성</h3>\n<p>이제 레코드를 만들고, 인증하는 과정을 만들었으니 나머지 액션들은 비교적 간단합니다. 간단하게 작성한 코드를 참고해주세요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      status <span class="token number">200</span><span class="token punctuation">,</span> get_records<span class="token punctuation">.</span>to_json\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span>\n\n    <span class="token keyword">def</span> get_records\n      records <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">by_user</span><span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token operator">|</span>record<span class="token operator">|</span> record<span class="token punctuation">.</span>to_h <span class="token punctuation">}</span>\n\n      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>tap <span class="token keyword">do</span> <span class="token operator">|</span>hash<span class="token operator">|</span>\n        hash<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token symbol">:records</span><span class="token punctuation">,</span> records<span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">by_user</code> 메서드는 <code class="language-text">RecordRepository</code> 에 정의되어 있습니다. 사실 레일즈 사용자분들이라면 모델에 <code class="language-text">has_many</code> 같은 메서드를 사용하여 1:N 관계를 정의하는 경우가 보편적일텐데요. 하나미도 <a href="http://hanamirb.org/guides/models/associations/">최근에 그런 기능을 지원하기 시작헀지만</a> 아직 실험적인 기능이기 때문에 직접 구현했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># lib/moneybook_api/repositories/record_repository.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">RecordRepository</span> <span class="token operator">&lt;</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Repository</span>\n  <span class="token keyword">def</span> <span class="token function">by_user</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>\n    records<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후의 결과물은 완성된 Hash나 Array가 아니라 <code class="language-text">Enumerator</code> 같은 객체라서 원하는 결과물을 반복 메서드를 사용하여 다양하게 다룰 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">require_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Update</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:amount</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:int?</span><span class="token punctuation">)</span>\n        <span class="token function">optional</span><span class="token punctuation">(</span><span class="token symbol">:description</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      halt <span class="token number">422</span><span class="token punctuation">,</span> <span class="token string">\'Invalid Parameters\'</span> <span class="token keyword">unless</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n\n      <span class="token keyword">begin</span>\n        updated_record <span class="token operator">=</span> repo<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">,</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token symbol">:record</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        status <span class="token number">200</span><span class="token punctuation">,</span> updated_record<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There was a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">SetRecord</code> 모듈도 <a href="http://hanamirb.org/guides/actions/share-code/">공식 가이드의 내용</a>을 참고하여 만들었습니다. Update와 Destroy 액션에서 공통적으로 레코드를 찾는 과정이 필요한데, 모듈에다 구현해두고 여러 액션에서 재활용할 수 있도록 만든겁니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/set_record.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">module</span> <span class="token constant">SetRecord</span>\n    <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">included</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>\n      action<span class="token punctuation">.</span>class_eval <span class="token keyword">do</span>\n        before <span class="token symbol">:set_record</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    <span class="token keyword">def</span> set_record\n      <span class="token variable">@record</span> <span class="token operator">=</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n      halt <span class="token number">404</span> <span class="token keyword">unless</span> <span class="token variable">@record</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/api/controllers/records/destroy.rb</span>\nrequire_relative <span class="token string">\'./set_record\'</span>\n\n<span class="token keyword">module</span> <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Records</span>\n  <span class="token keyword">class</span> <span class="token class-name">Destroy</span>\n    include <span class="token constant">Api</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n    include <span class="token constant">SetRecord</span>\n\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>repository<span class="token punctuation">:</span> <span class="token constant">RecordRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">)</span>\n      <span class="token variable">@repo</span> <span class="token operator">=</span> repository\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">begin</span>\n        repo<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n        status <span class="token number">204</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token string">\'Successfully Removed\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">rescue</span>\n        status <span class="token number">400</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'There is a problem during the process\'</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">private</span>\n\n    attr_reader <span class="token symbol">:repo</span><span class="token punctuation">,</span> <span class="token symbol">:record</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>축하합니다. 여러분은 하나미로 간단 API 서버를 가독성 높고 모듈화하기 용이한 루비 코드로 작성하였습니다.</p>\n<hr>\n<p>사실 더 개선할 부분들은 많습니다. 예를 들면 Interactor 를 활용한 로직 분리, 명확한 의존성 주입으로 테스트 효율 높이기 + 더 짜임새 있는 테스트 작성 등을 고려해야겠지요. 마침 <a href="https://github.com/nickgnd/hanami-jwt-example">비슷한 내용의 예제 코드가 아주아주 높은 퀄리티로 작성되어 있어서</a> 이번 튜토리얼을 구현해보면서 기본 개념을 익히신 다음에, 다른 예제를 참고하시면 큰 도움이 될 것이라 생각합니다.</p>\n<ul>\n<li>Source Code: <a href="https://github.com/emaren84/moneybook_api">Github</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2017-04-27-hanami-vuejs-moneybook-api-server/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-27",path:"/posts/hanami-vuejs-moneybook-api-server",title:"Hanamirb + Vue.js 로 간단 가계부 구현 (API 서버 편)",tags:["Ruby","Hanami","Vue.js"],category:"Hanami"}},{excerpt:"기존에  Learn Vue.js 2  강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다. application.rb…",html:'<p>기존에 <a href="https://laracasts.com/series/learn-vue-2-step-by-step/">Learn Vue.js 2</a> 강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다.</p>\n<h2 id="applicationrb-설정하기"><a href="#applicationrb-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>application.rb 설정하기</h2>\n<p>프로젝트를 작성하고 레일즈로 작성해놓았던 코드도 옮기고 한 건 좋은데 제대로 돌아가는 게 하나도 없었다. 브라우저 콘솔에 나타난 에러를 가만히 들여다보니 Content Security Policy를 미리 설정해둘 필요가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># application.rb</span>\n<span class="token comment"># ...</span>\n      security<span class="token punctuation">.</span>content_security_policy <span class="token string">%{\n        form-action \'self\';\n        frame-ancestors \'self\';\n        base-uri \'self\';\n        default-src \'none\';\n        script-src \'self\' \'unsafe-inline\' \'unsafe-eval\' https:;\n        connect-src \'self\';\n        img-src \'self\' https: data:;\n        style-src \'self\' \'unsafe-inline\' https:;\n        font-src \'self\';\n        object-src \'none\';\n        plugin-types application/pdf;\n        child-src \'self\';\n        frame-src \'self\';\n        media-src \'self\'\n      }</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">script-src</code> 부분에 주목해야한다. <code class="language-text">unsafe-inline</code> 뿐 아니라 <code class="language-text">unsafe-eval</code> 도 추가해주어야 한다. 그리고 애셋을 하나미에서 컴파일하지 않도록 설정해주어야 한다. 그렇지 않으면 자동적으로 하나미가 컴파일되지 않은 파일을 <code class="language-text">public</code> 폴더로 옮겨버린다. 나중에 다시 설정하는 법을 찾을 수 있을지 모르겠지만 <code class="language-text">fingerprint</code> 도 사용하지 않도록 체크해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">    <span class="token comment">##</span>\n    <span class="token comment"># DEVELOPMENT</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:development</span> <span class="token keyword">do</span>\n      <span class="token comment"># Don\'t handle exceptions, render the stack trace</span>\n      handle_exceptions <span class="token keyword">false</span>\n\n      assets <span class="token keyword">do</span>\n        compile <span class="token keyword">false</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n\t<span class="token comment"># ...</span>\n\n    <span class="token comment">##</span>\n    <span class="token comment"># PRODUCTION</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:production</span> <span class="token keyword">do</span>\n      <span class="token comment"># scheme \'https\'</span>\n      <span class="token comment"># host   \'example.org\'</span>\n      <span class="token comment"># port   443</span>\n\n      assets <span class="token keyword">do</span>\n        <span class="token comment"># Don\'t compile static assets in production mode (eg. Sass, ES6)</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://www.rubydoc.info/gems/hanami-assets#Configuration</span>\n        compile <span class="token keyword">false</span>\n        \n        <span class="token comment"># Use fingerprint file name for asset paths</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://hanamirb.org/guides/assets/overview</span>\n        fingerprint <span class="token keyword">false</span>\n        \n        <span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h2 id="yarn-init"><a href="#yarn-init" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn init</h2>\n<p>현재로서 <code class="language-text">npm</code> 보다 <code class="language-text">yarn</code> 이 더 나아보이니까 한번 적용해보았다. 이번 프로젝트와 관련된 모듈들은 다음의 커맨드로 설치하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 필수 모듈\n$ yarn add axios vue\n\n# 개발용 모듈\n$ yarn add webpack babel-core babel-loader babel-preset-es2015 --dev</code></pre>\n      </div>\n<h2 id="webpack-설정-파일-생성"><a href="#webpack-%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack 설정 파일 생성</h2>\n<p>다음은 webpack을 설정하는 파일을 작성할 차례이다. 처음엔 아주 간단한 부분만 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascript/app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// 타겟 파일 지정</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  \tpath<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 번들된 파일 저장 위치, path 모듈을 불러와야한다.</span>\n  \tfilename<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// bundle.js를 많이 쓰는 경향이 있는데 이번엔 app.js로 지정</span>\n  \tpublicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 설정을 해 주고 <code class="language-text">app.js</code> 파일이 엔트리 포인트가 되도록 각 모듈 사이의 <code class="language-text">import</code> 나 <code class="language-text">export</code> 를 지정해준다.</p>\n<p>번들된 파일을 생성하기 위해선 다음 커맨드를 입력해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node_modules/.bin/webpack --hide-modules\n# 계속 변화를 감지하기 위한 커맨드는 다음과 같다.\n$ node_modules/.bin/webpack --hide-modules --watch</code></pre>\n      </div>\n<p>하지만 저 커맨드를 굳이 매번 입력해 줄 필요는 없다. <code class="language-text">package.json</code> 파일에 스크립트를 설정해줄 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// package.json\n<span class="token punctuation">{</span>\n  // ...\n  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules"</span><span class="token punctuation">,</span>\n    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules --watch"</span><span class="token punctuation">,</span>\n    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=production webpack --hide-modules"</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">NODE_ENV</code> 에 대해서는 나중에 살펴 볼 것이다.</p>\n<p>하나미의 <code class="language-text">application.html.erb</code> 파일에서는 <code class="language-text">javascript</code> 뷰 헬퍼로 자바스크립트 파일을 불러오는데, body  태그 마지막에 불러오도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p>대신 css 파일은 수동으로 옮겨주어야 할 것이다. <code class="language-text">scss</code> 같은 preprocessing이 필요한 파일들은 어떻게 처리하는지 아직 실험해보지 못했다. 어차피 전부 webpack으로 해결할 수 있다.</p>\n<p>하지만 막상 번들된 파일을 불러와도 크롬에서 에러를 뿜으면서 랜더링이 되지 않았다. 왜인지 살펴보니 뷰의 모든 구성요소를 컴포넌트로 만들지 않고(Runtime-only), 기존에 작성한 html에 속성을 적용하려면(Full version) <a href="https://kr.vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only">별도의 설정</a>을 해 주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'vue$\'</span><span class="token punctuation">:</span> <span class="token string">\'vue/dist/vue.esm.js\'</span> <span class="token comment">// \'vue/dist/vue.common.js\'  webpack 1용 입니다</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 생각하던대로 작동한다. 나중에 다른 프로젝트에서 Vue 컴포넌트로만 빌드를 하게 되면 이 설정은 입력할 필요가 없을 것이다.</p>\n<h2 id="환경-변수-관리"><a href="#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EA%B4%80%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>환경 변수 관리</h2>\n<p>윗부분에서 <code class="language-text">NODE_ENV</code> 와 관련된 스크립트를 언급했는데, 프로덕션 모드에서는 번들된 패키지를 더 압축해주고, 프로덕션 모드임을 지정해주는 설정이 가능하다. 별도로 패키지를 설정해 줄 필요는 없고, webpack 설정 파일 제일 아랫부분에 스크립트를 더 추가해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">\'production\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        warnings<span class="token punctuation">:</span> <span class="token boolean">false</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token string">\'process_env\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        NODE_ENV<span class="token punctuation">:</span> <span class="token string">\'"production"\'</span> <span class="token comment">// 오타가 아니고 따옴표 안에 겹따옴표 들어가는거 맞다</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="babel-적용하기"><a href="#babel-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>babel 적용하기</h2>\n<p>최신 버전 크롬은 ES6 문법 대부분을 지원하기 때문에 별 신경을 쓰지 않아도 되곘지만.. 그래도 바벨을 적용해두는게 좋을 것이다. </p>\n<p>위에서 필요한 모듈은 설치되어있으니 <code class="language-text">.babelrc</code> 파일부터 지정해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .babelrc\n<span class="token punctuation">{</span>\n  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">"modules"</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 바벨에서 제공하는 <a href="http://babeljs.io/docs/setup/#installation">공식 문서를 따라</a> webpack 설정 파일에 다음 코드를 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n      \ttest<span class="token punctuation">:</span> <span class="token regex">/\\.js$/</span><span class="token punctuation">,</span>\n      \texclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>\n      \tloader<span class="token punctuation">:</span> <span class="token string">"babel-loader"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제부터 webpack을 실행하면 바벨로 변환된 결과물이 나온다.</p>\n<h2 id="라이브러리-나누어서-적용하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EB%82%98%EB%88%84%EC%96%B4%EC%84%9C-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리 나누어서 적용하기</h2>\n<p>만약에 내가 자바스크립트 파일을 작성하다가 아주 일부분만 수정하고 다시 빌드를 해야하는 일이 있다고 할 때 계속 시간을 잡아먹는게 상당히 짜증날 것이다. 일단 기본적인 라이브러리는 내용이 변할 일이 없기 때문에 별도로 합쳐지도록 적용하고, 내가 실제로 작성하는 파일만 변화가 있을 때 다시 번들되도록 만들면 많은 시간을 단축할 수 있을 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascripts/app.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'vue\'</span><span class="token punctuation">,</span> <span class="token string">\'axios\'</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].js\'</span><span class="token punctuation">,</span> <span class="token comment">// entry에 지정된 name(app, vendor)로 번들된 파일이 생성된다.</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunckPlugin</span><span class="token punctuation">(</span>\n      <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'vendor\'</span> <span class="token punctuation">}</span> <span class="token comment">// vendor 파일 덩어리를 따로 보관하고 캐싱한다.</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이러고 나서 빌드를 마치고 나면 <code class="language-text">public/assets</code> 폴더에는 <code class="language-text">app.js</code>, <code class="language-text">vendor.js</code> 두 개의 파일이 생성된다. 당연하게 레이아웃 페이지에서 <code class="language-text">vendor.js</code> 파일도 로딩해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'vendor\', \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<h2 id="css-파일도-관리하자"><a href="#css-%ED%8C%8C%EC%9D%BC%EB%8F%84-%EA%B4%80%EB%A6%AC%ED%95%98%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 파일도 관리하자</h2>\n<p>이래저래 잘 작동하길래 슬슬 코드를 올려볼까 했더니 CSS 파일이 문제가 되었다. 물론 CSS 파일의 내용은 몇 줄 없지만, 매번 내용을 수정한 다음에 일일이 파일을 <code class="language-text">public</code> 폴더로 옮기는건 아주 비효율적이다. 당연히 webpack이 CSS 파일도 모아줄 수 있다.</p>\n<p>먼저 필요한 모듈을 설치한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ yarn add css-loader extract-text-webpack-plugin --dev</code></pre>\n      </div>\n<p>그리고 설정파일에 CSS 관련 모듈 규칙과 플러그인을 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'extract-text-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// ...</span>\n      <span class="token punctuation">{</span>\n        test<span class="token punctuation">:</span> <span class="token regex">/\\.css$/</span><span class="token punctuation">,</span>\n        loader<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          use<span class="token punctuation">:</span> <span class="token string">\'css-loader\'</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">\'styles.css\'</span><span class="token punctuation">)</span> <span class="token comment">// 원하는 이름으로 지정</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이후 webpack을 실행하면 <code class="language-text">public/assets</code> 폴더에 <code class="language-text">styles.css</code> 파일이 추가된다. 나머지는 레이아웃 파일에서 이 파일을 불러오도록 만들면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    &lt;%= stylesheet \'https://cdnjs.cloudflare.com/ajax/libs/bulma/0.3.1/css/bulma.min.css\' %>\n    &lt;%= stylesheet \'styles\' %>\n    <span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 내용을 기반으로 작성한 간단한 프로젝트는 <a href="https://github.com/emaren84/hanami-webpack-config-example">Github</a>에 업로드 되어있다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-04-09-hanami-webpack-config/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-09",path:"/posts/hanami-webpack-config",title:"하나미 프로젝트에서 webpack 설정하기",tags:["Ruby","Hanami","Javascript","Webpack"],category:"Webpack"}},{excerpt:"본 포스트는  Luca Guidi의 포스팅을  번역한 글입니다 문제를 설명하는데 나온 하나미(Hanami…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://lucaguidi.com/2016/12/27/isolate-global-state.html">Luca Guidi의 포스팅을</a> 번역한 글입니다</strong></li>\n<li><strong>문제를 설명하는데 나온 하나미(Hanami)에 대해서는 <a href="https://emaren84.github.io/blog/archivers/hanami-introduction">이 포스팅</a>을 참조해주세요</strong></li>\n<li><strong>전문 번역이 아니기에 부족한 표현이나 오역은 언제든지 지적해주세요</strong></li>\n</ul>\n<hr>\n<p>소프트웨어 프로그램에서 전역 상태를 사용하는건 개발하기엔 쉽지만 유지보수 할 때는 악몽이 된다. 예상치 못한 상황에서 발생하여 추적하기도 어려운 버그가 되기 쉽상이다.</p>\n<p>왜 그렇게 되는지, 그리고 어떻게 그 문제를 완화할 수 있을지 살펴보자.</p>\n<p><em>역주: 이 글에서 전역 상태는 전역 변수와 거의 동일한 의미로 사용되는 것으로 추정됩니다.</em></p>\n<h2 id="문제의-예시"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 예시</h2>\n<p>예를 들자면 하나미의 코드 베이스 안에서 우리는 환경 변수에 따라 어떻게 프레임워크가 설정되는지 테스트 할 필요가 있다.</p>\n<p>우리<em>(역주: 하나미 개발팀으로 보입니다)</em>는 보통 테스트를 이런 식으로 작성한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  before <span class="token keyword">do</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'RACK_ENV\'</span><span class="token punctuation">]</span>    <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_HOST\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n    <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_PORT\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    before <span class="token keyword">do</span>\n      <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">\'HANAMI_ENV\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'production\'</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span>\n    <span class="token class-name">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리는 보통 각각의 테스트를 실행하기 전에 모든 환경 변수를 초기화해왔다. 그리고 우리가 필요로 하는 특별한 상황(the edge case)에서만 하나씩 설정했다.</p>\n<p>이러한 접근 방식을 사용할 때의 <strong>문제는</strong> 이 방법이 루비 프로세스의 전역 상태를 <strong>더럽힌다는</strong> 것이다. 우리가 테스트 파일을 단독으로 실행할 때는  <code class="language-text">before</code> 블록이 환경 변수를 리셋하기 때문에 잘 작동한다.</p>\n<p>그러나 모든 테스트를 한번에 실행할 때, 테스트는 꼬이게 될 것이다. 환경 변수 초기화가 언제나 작동하진 않기 때문이다.</p>\n<p>만약 한 테스트가 <code class="language-text">ENV</code> 속성을 변환하고 나서 뒷정리를 하지 않으면, 그 다음 테스트는 기존의 <code class="language-text">ENV</code> 값의 변화를 <strong>물려받아서</strong> 우리가 기대하던대로 작동하지 않을 수 있다.</p>\n<p>때때로 위의 예시 처럼 눈에 띄는 부분에서 변화를 준 경우에는 우리가 <code class="language-text">after</code> 블록을 설정하여 뒷정리를 할 수 있다. 그러나 다른 때엔 변환한 것(the mutation)이 우리 눈에 보이지 않는 부분에서 부작용을 초래할 수 있다.</p>\n<p>이건 소스의 버그다. 그리고 이 버그는 엉킨 실타래처럼 되어 디버그하기 힘들다.</p>\n<p><strong>오랜 시간동안, 여러 가지 전역 상태의 조합하는 것은 하나미를 지속적 통합 개발(<a href="https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9">CI builds</a>)이 힘들도록 만들고 여러 버그를 일으켰다.</strong></p>\n<p>개발자로서의 내 경험으로 미루어보아(<em>역주: Luca Guidi는 숙련된 웹 개발자입니다</em>) 이런 형태의 문제를 완화할 수 있는 유일한 방법은 <strong>전역 상태를 격리하거나, 전역 상태를 사용하는 것을 아예 피하는 것이다.</strong> 우리는 <strong>가능한한 전역 상태를 사용하는 것을 줄이도록</strong> 하나미의 내부 구현을 바꾸고 있다.</p>\n<h2 id="문제의-해법"><a href="#%EB%AC%B8%EC%A0%9C%EC%9D%98-%ED%95%B4%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문제의 해법</h2>\n<p>앞서 이야기한 특별한 경우를 위해 우리는 환경 변수를 격리할 수 있는 새로운 객체를 선보였다. 이는 <code class="language-text">Hanami::Env</code> 라고 불린다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Env</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> env\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n      <span class="token variable">@env</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>구현 자체는 별 것 아니다: <code class="language-text">ENV</code> 에 접근하는 것을 캡슐화하는 것이다.</p>\n<p>우리는 환경 변수를 관리하기 위해 자체 인터페이스를 정의했다. 우리는 명시적인 구현(concrete implementation)을 사용하기보다(<code class="language-text">ENV</code>) 추상화(<code class="language-text">Hanami::Env</code>)에 의존하고 있다(<a href="https://ko.wikipedia.org/wiki/%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84_%EC%97%AD%EC%A0%84_%EC%9B%90%EC%B9%99">의존관계 역전 원칙 참고</a>). </p>\n<p><code class="language-text">Hanami::Environment</code> 는 프로젝트의 환경 변수를 설정하는 책임을 가지고 있는데, 우리는 이런 방식으로 사용한다:</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token constant">Hanami</span>\n  <span class="token keyword">class</span> <span class="token class-name">Environment</span>\n    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>\n      opts <span class="token operator">=</span> options<span class="token punctuation">.</span>to_h<span class="token punctuation">.</span>dup\n      <span class="token variable">@env</span> <span class="token operator">=</span> <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Env</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> opts<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">ENV</span><span class="token punctuation">)</span>\n\n      <span class="token comment"># ...</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>우리가 하나미 프로젝트를 사용할 때, <code class="language-text">:env</code> 옵션은 설정되지 않은 상태이다. 이로 인해 <code class="language-text">@env</code> 는 <code class="language-text">ENV</code> 를 참조하여 루비 프로세스의 진짜 환경 변수를 읽거나 쓰게 된다.</p>\n<p>이렇게 우리는 <code class="language-text">Hanami::Environment</code> 의 테스트 중에 많은 양의 코드를 단순화하고, <strong>공유되고 변화 가능한 상태(shared mutable state, 즉 <code class="language-text">ENV</code> 말이다)의 사용을 피할 수 있었다.</strong> 아래 코드에서 우리는 <code class="language-text">ENV</code> 와 유사하게 동작하는 <code class="language-text">:env</code> 를 객체의 옵션으로 전달하지만, 이 것은 실제로 <code class="language-text">ENV</code>가 아니다: 그냥 <code class="language-text">Hash</code> 이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">RSpec</span><span class="token punctuation">.</span>describe <span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Environment</span> <span class="token keyword">do</span>\n  context <span class="token string">"when HANAMI_ENV is set"</span> <span class="token keyword">do</span>\n    <span class="token function">let</span><span class="token punctuation">(</span><span class="token symbol">:env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token builtin">Hash</span><span class="token punctuation">[</span><span class="token string">"HANAMI_ENV"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"production"</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n\n    it <span class="token string">"tests something interesting"</span>\n      <span class="token variable">@env</span> <span class="token operator">=</span> described_class<span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> env<span class="token punctuation">)</span>  \n    <span class="token keyword">end</span>\n\n    <span class="token comment"># ...</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p><a href="https://ko.wikipedia.org/wiki/%EC%BA%A1%EC%8A%90%ED%99%94">캡슐화</a>와 <a href="http://solnic.eu/2013/12/17/the-world-needs-another-post-about-dependency-injection-in-ruby.html">의존성 주입</a>을 적절하게 사용하여, 각각의 테스트에서 발생할 수 있는 변화는 나머지 테스트에서는 보이지 않게 되었다. 결과적으로 안정적인 테스트 수행을 할 수 있게 되었고, 하나미 내부를 <a href="https://ko.wikipedia.org/wiki/SOLID">SOLID 디자인</a>에 맞게 구성할 수 있었다. </p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>보통 루비 프로젝트에서 <code class="language-text">dotenv</code> 같은 젬으로 환경 변수를 관리합니다. 사실 이 환경 변수라는 개념도 저에게 아직 모호한 개념이지만, 객체지향 프로그래밍의 핵심적인 주제인 캡슐화와 의존성 주입을 어떤 식으로 활용하는지 좋은 예를 보여준 것 같아 한번 번역해보게 되었습니다.</p>\n<p>특히 제가 요즘에야 테스트를 작성해보기 시작했는데, 테스트를 개별로 실행할 때는 몰라도 전체 테스트를 실행할 때 원인을 알 수 없는 오류가 생길 때가 종종 있었습니다. 이 글을 통해 약간의 힌트를 얻었다는 생각도 듭니다. </p>',
id:"/home/circleci/repo/src/pages/posts/2016-12-30-isolate-global-state-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-30",path:"/posts/isolate-global-state-kor",title:"[번역] 전역 상태를 격리하라",tags:["Ruby","Hanami","Testing","Translation"],category:"Translation"}},{excerpt:"본 포스팅은  루비 대림절 달력 을 위해 제작하였습니다 기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다 작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다 들어가며 아직 갓…",html:'<ul>\n<li><strong>본 포스팅은 <a href="http://ruby-korea.github.io/advent-calendar/">루비 대림절 달력</a>을 위해 제작하였습니다</strong></li>\n<li><strong>기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다</strong></li>\n<li><strong>작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다</strong></li>\n</ul>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>아직 갓 6개월 된 초보 개발자로서 이제 루비 온 레일즈(이하 레일즈)에 조금씩 익숙해지던 차에, 상사로부터 \'하나미라는 프레임워크가 있으니 한번 리서치를 해 보세요\' 라는 권유를 받았다. 그는 루비로 백엔드 서버들을 구축했지만 레일즈는 자신의 취향에 맞지 않다고 했고, 구조적으로도 하나미가 더 나아보인다고 이야기하였다.</p>\n<p>그리고 하나미 공식 가이드를 쭉 읽어본 나에게는 혼돈과 절망만 남았다. 루비 뿐 아니라 웹 개발의 기초 지식이 부족해서 그런지 도저히 이게 어떻게 돌아가는건지도 모르겠고, 레일즈에 대입해서 이해할 수 있는 것도 아니라는 생각이 들었다.</p>\n<p>다시 6개월을 다른 레일즈 프로젝트 제작, 리서치 작업을 하며 보내고 나니 회사에서는 본격적으로 레일즈 사용을 하지 않고 하나미를 사용하는 방향으로 가닥을 잡았다. 어쩌다가 레일즈라는 걸출한 웹 프레임워크를 두고 생소한 하나미라는 프레임워크를 사용하게 되었는지, 이번 기회를 통해 독자 분들의 관심을 이끄는 계기를 만들어보고자 한다.</p>\n<h2 id="변화가-일고-있는-레일즈-커뮤니티"><a href="#%EB%B3%80%ED%99%94%EA%B0%80-%EC%9D%BC%EA%B3%A0-%EC%9E%88%EB%8A%94-%EB%A0%88%EC%9D%BC%EC%A6%88-%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변화가 일고 있는 레일즈 커뮤니티</h2>\n<p>레일즈는 2005년에 처음 소개 된 이후 빠르고 쉬운 웹 애플리케이션 개발을 위한 도구로써 많은 개발자들의 사랑을 받아왔다.</p>\n<p>\'프로그래머의 단짝 친구\' 라고 소개할 정도로 쉽고 재미있는 언어인 루비를 기반으로 삼은 프레임워크이기도 하고, 꼭 루비 문법을 모두 꿰고 있어야 할 정도로 많은 지식을 알고 있지 않아도 금방 어지간한 웹 애플리케이션을 제작할 수 있다는 점이 주요 셀링 포인트라고 여겨진다.</p>\n<p>소위 \'Rails Magic\' 덕분에 form에 변수를 할당하는 것으로 경로 설정이 알아서 되거나 스캐폴딩만 해도 신기하게 돌아가는 애플리케이션을 보며 감탄했던 적이 한두 번이 아니었다.</p>\n<p>2016년 현재 레일즈는 버전 5까지 발매되었고, 더 많은 기능이 구현되어 있으며 커뮤니티는 많이 거대해졌다. 거대해진 레일즈 세계와 함께 그 음영을 느끼는 개발자들도 조금씩 늘어나게 되었다.</p>\n<p>예를 들어 보통 레일즈 애플리케이션을 오래 개발해온 사람들은 애플리케이션의 규모가 커질수록 유지보수하는게 힘들어진다는 점을 지적하고 있는데, 이를 해결하기 위해 <strong>Fat model, Skinny controller</strong> 등의 방법론이 제시되고 있지만 \'뭔가 문제가 있다\'는 의견들은 끊임없이 제시되고 있다.</p>\n<p>또한 DHH(David Heinemeier Hansson, 레일즈의 창시자)가 제시하고 있는 <a href="http://solnic.eu/2016/05/22/my-time-with-rails-is-up.html">\'Rails way\'에 반감을 가진 사람들이 점차 늘어나고</a> 루비로 웹 개발을 하는 것에 대해 <a href="http://rwdtow.stdout.in/">더 나은 방법을 찾는</a> 사람들이 점차 늘어나고 있다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 599px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 131.3856427378965%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABe2AlTSxFMuUv/8QAGRABAAIDAAAAAAAAAAAAAAAAAQACEBEw/9oACAEBAAEFAqmqxODj/8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQMBAT8BY//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Ain/xAAaEAADAQADAAAAAAAAAAAAAAAAAREQITFR/9oACAEBAAE/IYTxFLPKU5GXOpWf/9oADAMBAAIAAwAAABBv7vz/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EHDbIc//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxAp/8QAHhABAAICAQUAAAAAAAAAAAAAAQARITFBUWGBkaH/2gAIAQEAAT8QKn0nwj0BmUTlxMVEarzE8Q3EKIQbZTiXibZ3H3P/2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="현재 레일즈 커뮤니티"\n        title=""\n        src="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg"\n        srcset="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-28fc4.jpg 198w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-44f6c.jpg 395w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg 599w"\n        sizes="(max-width: 599px) 100vw, 599px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>현재 레일즈 커뮤니티의 묘사 - 출처: <a href="http://railshurts.com/current_state">http://railshurts.com/current_state</a></em></p>\n<p>이러한 분위기 속에서 \'Ruby way, not Rails\' 를 표방하는 루비 기반 웹 프레임워크가 등장하였으니, 바로 이번에 소개할 <a href="hanamirb.org">Hanami(하나미)</a>이다.</p>\n<h2 id="하나미가-뭐죠"><a href="#%ED%95%98%EB%82%98%EB%AF%B8%EA%B0%80-%EB%AD%90%EC%A3%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미가 뭐죠?</h2>\n<p>하나미는 이탈리아의 개발자 <a href="https://lucaguidi.com">Luca Guidi</a> 가 개발한 루비 MVC 웹 프레임워크이다. 2014년에 Lotus라는 이름으로 처음 등장하였으나, IBM의 Louts 상표권과 엮이는 문제가 있어 지금의 이름으로 변경하게 되었다.</p>\n<p>새로운 이름으로 <strong>하나미</strong>라는 이름을 쓰게 된 이유는 \'꽃구경\' 이라는 일본어 본래의 뜻에 걸맞게 함께 하는 커뮤니티의 중요성을 일깨운다는 점을 강조하기 위해서라고 한다. 루비의 창시자 Matz와(일본인이다) 루비 그 자체에 대한 찬사의 의미도 가지고 있다.</p>\n<p>하나미의 특징을 몇 가지 소개하자면 먼저 최대한 루비라는 언어를 직접적으로 사용하는 방식으로 구현되어 있다는 점이다. 다만 이 때문에 레일즈를 습득하는데 루비 지식이 크게 필요하지 않은 것과 다르게 일정 수준의 루비 언어의 이해를 요구한다.</p>\n<p>또한 Magic을 최대한 배제하고(하나미 Gitter 채팅방에서 혹은 몇몇 포스트에서 "I\'m now sick of rails magic!" 이라고 주장하는 사람들이 많이 보인다) 개발자가 최대한 자신이 무엇을 하고 있는지 인지하면서 앱을 제작하도록 유도한다.</p>\n<p>그리고 보통 Rails best practice 로 제시되는 요소들을 기본적으로 구현하고 있다.</p>\n<ul>\n<li>컨트롤러는 HTTP 콜만 다룬다 -> 액션에서 비지니스 로직을 분리하여 처리하기 위해 <code class="language-text">Interactor</code> 라는 모듈이 있다</li>\n<li>퍼시스턴스 로직과 도메인 로직을 분리한다 -> 하나미 모델은 기본적으로 도메인과 퍼시스턴스 레이어가 분리되어 있다</li>\n<li>루비 객체를 만들어서 제대로 OOP를 한다 -> 하나미는 OOP 개념을 잘 지키기 위해 노력한다. 또한 모듈화도 굉장히 쉽다</li>\n</ul>\n<p>하나미 가이드 페이지 첫머리에서 제시하는 <a href="http://hanamirb.org/guides/#why-choose-hanami-">\'하나미를 선택하는 이유\'</a> 를 가볍게 살펴보면 이렇게 말하고 있다.</p>\n<ul>\n<li>하나미는 가볍다 -> 상대적으로 짧은 코드, 웹 애플리케이션 개발에 필요한 필수적인 부분에 초점을 맞춤</li>\n<li>하나미는 구조적으로 건전하다 -> 컨트롤러 액션은 각각의 클래스로 분리되어 있으며 테스트하기 용이하다</li>\n<li>하나미는 스레드에 안전하다 -> (아직 이런 문제를 겪을만한 규모의 앱을 작성해본 적이 없어서 설명하기 어렵다)</li>\n</ul>\n<p>또한 하나미는 컨테이너 형태의 앱 구조를 기본적으로 제공한다. 덕분에 한 개의 프로젝트를 생성하여 API 서버와 웹 서버를 동시에 운용하는게 가능하다. 물론 레일즈로도 비슷한 구성을 할 수야 있겠지만 충돌 없는 구현을 위해 앱의 구조가 훨씬 복잡해질 가능성이 높다.</p>\n<h2 id="만들어-볼까요"><a href="#%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%BC%EA%B9%8C%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>만들어 볼까요</h2>\n<p>글을 길게 써 보았지만, 개발자들에겐 장황한 글보다 코드 몇 줄을 보는 것이 훨씬 이해가 빠를 것이다. 하나미의 공식 가이드를 따라가면서 눈여겨 볼 점들을 소개하겠다.</p>\n<h3 id="bookshelf-프로젝트-생성"><a href="#bookshelf-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bookshelf 프로젝트 생성</h3>\n<p>이번에 만들어볼 애플리케이션(이하 앱)은 <code class="language-text">Bookshelf</code> 라는 앱이다. 책의 제목과, 작가가 있고 이 책들의 리스트를 살펴보고 책을 추가할 수 있는 기능을 가지고 있다. 가이드에서 수정과 삭제는 다루고 있지 않아 조금 아쉬운 느낌이 들지만 기본적인 웹 개발(레일즈) 지식이 있다면 구현하는 것이 그렇게 어렵지는 않다.</p>\n<p>기본적으로 루비 버전은 2.3+ 을 권장한다. 또한 데이터베이스는 sqlite3를 사용할 예정이다.</p>\n<p>먼저 하나미로 프로젝트를 생성하기 위해서는 <code class="language-text">gem install hanami</code> 로 하나미가 설치되어 있어야 한다. 그 다음에는 새 프로젝트를 생성해본다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ hanami new bookshelf</code></pre>\n      </div>\n<p>생성된 프로젝트의 폴더 구조를 살펴보면 다음과 같다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ tree -L 2\n.\n├── Gemfile\n├── Rakefile\n├── apps\n│   └── web\n├── config\n│   ├── environment.rb\n│   └── initializers\n├── config.ru\n├── db\n│   ├── migrations\n│   └── schema.sql\n├── lib\n│   ├── bookshelf\n│   └── bookshelf.rb\n├── public\n└── spec\n    ├── bookshelf\n    ├── features_helper.rb\n    ├── spec_helper.rb\n    ├── support\n    └── web</code></pre>\n      </div>\n<p>여기서 특이한 점은 <code class="language-text">apps</code> 라는 폴더가 있다는 점인데 기본 컨테이너는 <code class="language-text">web</code> 이지만 사용자가 웹 브라우저로 보는 애플리케이션 이외에 같은 데이터베이스를 공유하는 api 서버 등을 따로 만들고자 하면 제네레이터로 따로 컨테이너를 생성할 수 있다. 그러면 같은 데이터베이스 사용하는 별개의 앱을 따로 구축할 수 있다는 장점이 있다. (물론 라우팅은 다르겠지만.. 이 부분은 <code class="language-text">mount</code> 옵션으로 처리할 수 있다) <a href="http://hanamirb.org/guides/getting-started/#hanami-architecture">- 참고</a></p>\n<p>각 앱들에는 별개의 설정 파일, 컨트롤러, 뷰, 라우트, 템플릿 파일 및 폴더가 있다.</p>\n<p>테스트는 사용자가 원하는 어떤 형태로도 이용할 수 있다.(minitest or rspec) 하나미에서는 minitest를 기본으로 사용하며 capybara 젬도 사용한다. 이번 포스팅에서는 테스트를 구현하는 부분은 넘어가고자 한다. 테스팅이 궁금한 분들은 공식 가이드를 참조하시라.</p>\n<h3 id="루트-페이지-만들기"><a href="#%EB%A3%A8%ED%8A%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루트 페이지 만들기</h3>\n<p>라우팅은 각 앱의 <code class="language-text">config/routes.rb</code> 파일에서 설정한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\n</code></pre>\n      </div>\n<p>그러면 home 컨트롤러의 index 액션을 실행해주기 위해 제네레이터로 액션을 생성해본다. 아직 하나미는 레일즈처럼 다양하고 세분화된 옵션의 CLI를 제공하진 않는다. 번거롭긴 하지만 개발에 큰 지장은 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web home#index\n    create  spec/web/controllers/home/index_spec.rb\n    create  apps/web/controllers/home/index.rb\n    create  apps/web/views/home/index.rb\n    create  apps/web/templates/home/index.html.erb\n    create  spec/web/views/home/index_spec.rb\n    insert  apps/web/config/routes.rb</code></pre>\n      </div>\n<p><code class="language-text">action</code> 뒤에 있는 <code class="language-text">web</code> 은 액션을 생성하고자 하는 컨테이너의 이름이다. 그 다음에 컨트롤러와 액션 이름을 적어주면 된다. 앱 구조가 단독 컨테이너 구조일 경우(<code class="language-text">hanami new</code> 커맨드로 앱 생성시 <code class="language-text">--arch=app</code> 옵션을 주어 단독 컨테이너 앱 생성도 가능하다)에는 바로 액션 이름만 작성해주어도 된다.</p>\n<p>아쉬운 점은 매 액션마다 저 명령어를 작성해주어야 한다는 점이다. <code class="language-text">hanami-scaffold</code> 라는 젬이 있지만 그닥 유지보수는 되지 않고 있어서 사용하는 것을 추천하지 않는다.</p>\n<p>컨트롤러는 폴더에 불과하며 그 폴더에 속한 각각의 액션 파일에 컨트롤러가 정의되어 있는 형태이다. 또한 뷰는 템플릿 파일(레일즈의 views 폴더 안에 있는 템플릿들)과 뷰 파일(레일즈에 비유하자면 뷰 헬퍼와 비슷)로 구성되어있다. 지금은 템플릿 파일에 간단하게 제목을 추가해보도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/home/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Bookshelf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><em>(주의) 템플릿 파일이 변경될 때에는 서버를 재실행할 필요가 없지만, 컨트롤러 등의 루비 파일이 변경될 때에는 서버를 재실행해야 한다.</em></p>\n<p>그리고 서버를 실행한 뒤 <code class="language-text">localhost:2300</code> 으로 접속해보면 심플하지만 Bookshelf라는 글씨가 보이는 페이지를 마주할 수 있다.\n(본 포스트에서는 빠른 진행을 위해 <code class="language-text">application.html.erb</code> 파일을 미리 수정해두었다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami server</code></pre>\n      </div>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 358px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 74.58100558659218%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQ4y81R32tSYRg+/8tyumBjEkxd5TKZRRlHnU70HM/x1/RibmArF5UXDRbtz/CmwfyVJ4i6qP6CdhEEbRmIO4pCA9F25Y+n93xk0MVawS468PB+7/c97/M833c446QeNuMlzC1chsGkw8WpafCORVgXbLhy1Yo5kxkms+UX5jTQ3njfbJmHTj+FC5MGTOj04Cwk6DLPw87fhOHaBBxWGyrZDFKrq0gmE3A6neB5Hi6XCy6qbrf7N4iiSMJmTM/MkLAB3G0i3aAh+3U77tziEQgEEBRExGIxhmQigXg8DkmSEA6HIQgC44wRDAbh9/vJkAw8HnAyEaVQCB6PG4IoQJZkJpDJZLC5mcEDQjqdprRJrKXWEIlEWCpZlplJiGa1tWYejUbBabG1RiIhLQEjiSEskUE0FodIabWhYCCI5WUfVihxJBKFz+dFIpEk8xUK44Fxdhb2RQe4fD6PcrmMUqkMRVGolqh/gVKxiEpFQZGqdlYsFNhZ5SenQL2ivGTr/N4ecrkcnu/ugsM5f5x6VMeH/X30ej2cnHzHwcEhvh0fo/rlEEeqik6ng/fv3qJa/coG+v0+BoPBqeDevH6FJa8Xz3Z28PjRQ6TvbiCbzWLryRY27t3H9vZTrKdS+PjpMxMcDIcYjUangut2u2g0GgQV9XodzWYTtVoNqtpAq9WiqqLdblOyARPUhv545X95n7PEmKBGGtI1zsJY7FwT/tVf/u8FfwCkJLVg24iPyAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf Title"\n        title=""\n        src="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png"\n        srcset="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-dc079.png 198w,\n/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png 358w"\n        sizes="(max-width: 358px) 100vw, 358px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="모델-구축하기"><a href="#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 구축하기</h3>\n<p>본격적으로 책들을 저장하고 출력하기 위해 데이터베이스 마이그레이션을 진행해 보도록 한다. 먼저 마이그레이션 파일을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate migration create_books</code></pre>\n      </div>\n<p>생성된 마이그레이션 파일은 이렇게 작성해 보았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/20161203083239_create_books.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:books</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:title</span><span class="token punctuation">,</span>  <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:author</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">primary_key</code> 가 반드시 <code class="language-text">id</code> 일 필요는 없다. 또한 <code class="language-text">String</code>, <code class="language-text">DateTime</code> 은 루비 타입이다(루비 클래스). 반드시 루비 타입을 사용할 필요는 없고 <code class="language-text">&quot;varchar(255)&quot;</code> 같이 데이터베이스 타입을 문자열로 직접 작성해주어도 된다.</p>\n<p>마이그레이션 파일 작성이 완료되면 테이블을 생성해주는 명령어를 입력한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami db prepare\n$ bundle exec hanami db migrate</code></pre>\n      </div>\n<p>그리고 <code class="language-text">Book</code> 모델을 생성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate model book\n      create  lib/bookshelf/entities/book.rb\n      create  lib/bookshelf/repositories/book_repository.rb\n      create  spec/bookshelf/entities/book_spec.rb\n      create  spec/bookshelf/repositories/book_repository_spec.rb</code></pre>\n      </div>\n<p>생성된 파일을 보면 조금 특이한 점을 볼 수 있는데 <code class="language-text">entities</code> 폴더와 <code class="language-text">repositories</code> 폴더가 따로 나뉘어져 있다는 점이다. <code class="language-text">Entity</code> 는 도메인 객체로, 실제 데이터베이스 쿼리 등으로 추출된 자료 객체를 일컫는다. <code class="language-text">Repository</code> 는 퍼시스턴스 계층과 <code class="language-text">Entity</code> 를 이어주는 역할을 한다. 여기서 <code class="language-text">Entity</code> 는 데이터베이스의 존재를 전혀 모르는 단순 루비 객체이며 테스트가 용이하고 가벼운 앱을 만드는데 도움이 된다.</p>\n<p>실제 콘솔에서 레코드를 다루어보면 이런 방식으로 동작한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami console\n&gt;&gt; repo = BookRepository.new\n=&gt; #&lt;BookRepository:... &gt;\n&gt;&gt; repo.all\n=&gt; []\n&gt;&gt; book = repo.create(title: &#39;TDD&#39;, author: &#39;Kent Beck&#39;)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;\n&gt;&gt; repo.find(book.id)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;</code></pre>\n      </div>\n<p><code class="language-text">Repository</code> (이하 리퍼지토리)에서 제공되는 메서드로 데이터베이스에 <code class="language-text">Entity</code> (이하 엔티티)를 조작할 수 있고, 엔티티에는 따로 속성 혹은 동작을 지정할 수 있다. 그래서 레일즈에서 사용하는 <code class="language-text">scope</code> 나 커스텀 쿼리가 작성된 메서드 등은 리퍼지토리 클래스에 분리해 둘 수 있다.</p>\n<h3 id="데이터를-표현하기"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%ED%91%9C%ED%98%84%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터를 표현하기</h3>\n<p>임의로 몇 개의 <code class="language-text">Book</code> 레코드를 생성해주고 리스트를 표현해보기 위해 새 컨트롤러 액션을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web books#index</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>All books<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;% if books.any? %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    &lt;% books.each do |book| %>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>book<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&lt;%= book.title %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;%= book.author %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    &lt;% end %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n&lt;% else %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>placeholder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>There are no books yet.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n&lt;% end %>\n</code></pre>\n      </div>\n<p>여기서 <code class="language-text">books</code> 는 어디서 온 것일까? 실제로 액션 부분은 이렇게 작성되어 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:books</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@books</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>all\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">expose</code> 메서드의 사용은 하나미의 규칙으로, <code class="language-text">expose</code> 로 지정한 변수만 템플릿으로 노출되며 그 변수는 <code class="language-text">call</code> 메서드 안에 인스턴스 변수로 존재해야 한다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 385px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 128.05194805194807%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAAC+0lEQVRIx61U/UtTURi+f0vq0n7oA0Q2P5L8ojLEocxtd03nvpztw2V/QBqmmRpYRjgrrIku06kUBEFQ6IhyZaap6Nb6oURJ3Jyi4rane44oaubHtQsP59z3nPc5z3PP+14mXnAc6fFCJKQJEXUmCqkJIkguZeNcRiYys7KQlp4BUWLSrkhMSkbM8ThEC2JxLFpAwYji4pCdeBYpF1MRkyCAuUCKxnIL9KVGWMwm6PU65IpzIRaLtyEvLw8KBQuhUISTp05DEHuCkjN5Egmyc3JwPusCLrNKyFg5dHo9R6SHwWBAaWkpnWs0GmjUGjoWFxdDJpNBLpeDVSjoSCCVysAolUoUKguRn59PTyQbCYHFYoHVaoXJaFwn42AoKYFWq4VarYZKpQLJZVkWEk4Uy+WqVAowZKGszAqj0QSz2QzjFSN0Wh10Oi2NEcuGEgOKioroISYuRubl5ddgMlug4AiTk1MglxbgqsUAxuPxYHJykmJqaoqCxDbiXq8XPp+Pvm9d2zone9ZjHjD4zw/T2+NEVdVNdHY50dXpwN2m++h29qCmuhp9vb2or2vAg2Yb3by2toZwOLwnGLd7EHa7HTbbQzja29DheIb2Dgfa7E/R43Si83k3Bt2fKCFJiEQieys8qBVCdiDLq6ur+D03h5mZGSwvL2NlZQWBQICOhCQUCm2SEXX7KnQN9KO27g4e2ZrRbGtBa+sTNDTUo+/Fy79s7ke2qXBhYQGLi0HMz89z8NPR7/cfWNU2QnJzxNZuz2GINgnHvo2iueUxrlfewPjEBA2SA7baPJTCVe7j//w1jbHxcc724jZlvBTuTNp6o7w6xcv1oGvAhaGhL3j7rh8jI6OI8LC6rbA3EkOh8JHsUsIgVzLT09OY44qbYHZ2FgEuxvsbvne5cKumBvW3a9F0rxGVFRV49frNodpt114mpbL+Nwlt1iUvhUtLS7RTSP/6/QFq90iEP3zf4Xa7MfR5CMPDX/Hh4yCCwSB/wn8t8L7ljXrbCb6kfwBgoxYXcTdGKQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf list"\n        title=""\n        src="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png"\n        srcset="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-54c53.png 198w,\n/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png 385w"\n        sizes="(max-width: 385px) 100vw, 385px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="새로운-책을-등록하기"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%B1%85%EC%9D%84-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 책을 등록하기</h3>\n<p>웹 페이지에서 새로운 책을 등록하기 위해서는 <code class="language-text">new</code>, <code class="language-text">create</code> 액션과 패러매터를 전달해 줄 <code class="language-text">Form</code> 이 필요할 것이다. 먼저 <code class="language-text">books#new</code>, <code class="language-text">books#create</code> 액션을 생성해 준 뒤에 라우팅을 조금 깔끔하게 다듬어주도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\nresources <span class="token symbol">:books</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:new</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>하나미는 REST를 기본적으로 지원한다. 2번째 줄에서 사용 된 <code class="language-text">resources</code> 는 보통 레일즈 라우트 파일에서 자주 보았던 그 <code class="language-text">resources</code> 메서드처럼 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami routes\n        Name Method     Path           Action\n\n        root GET, HEAD  /              Web::Controllers::Home::Index\n       books GET, HEAD  /books         Web::Controllers::Books::Index\n    new_book GET, HEAD  /books/new     Web::Controllers::Books::New\n       books POST       /books         Web::Controllers::Books::Create</code></pre>\n      </div>\n<p>다음은 <code class="language-text">new</code> 템플릿에 폼 헬퍼(Form helper) 를 이용하여 간단한 폼을 작성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/new.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Add book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;%=\n  form_for :book, routes.books_path do\n    div class: \'input\' do\n      label      :title\n      text_field :title\n    end\n\n    div class: \'input\' do\n      label      :author\n      text_field :author\n    end\n\n    div class: \'controls\' do\n      submit \'Create Book\'\n    end\n  end\n%>\n</code></pre>\n      </div>\n<p>폼 헬퍼의 구조가 레일즈의 <code class="language-text">form_for</code> 헬퍼와는 사뭇 다르다. 간단하게 차이점을 이야기하자면 하나미의 <code class="language-text">form_for</code> 는 레일즈의 <code class="language-text">form_tag</code> 헬퍼에 가깝다고 생각하면 된다. <a href="http://hanamirb.org/guides/helpers/forms/#technical-notes">하나미 가이드에 따르면</a> <code class="language-text">form_for do |f|</code> 형식으로 작성하는 것은 올바른 ERB 템플릿이 아니며, 하나미의 폼 헬퍼는 템플릿 엔진에 의존하지 않고 사용할 수 있도록(어느 템플릿 엔진을 사용하던 같은 루비 코드를 사용하도록) 구성되어 있다.</p>\n<p><code class="language-text">routes.books_path</code> 는 라우팅 헬퍼이며 상기 라우팅 구조에 있는 이름을 사용하여 <code class="language-text">routes</code> 뒤에 메서드 형식으로 붙여주면 자동으로 경로를 연결해준다.</p>\n<p>책을 생성하기 위한 <code class="language-text">create</code> 액션은 다음과 같이 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n      redirect_to routes<span class="token punctuation">.</span>books_path\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후 생성된 폼에 새로운 책을 등록해보니 문제없이 책이 생성되었다.</p>\n<h3 id="유효성-검사"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사</h3>\n<p>하나미는 유효성 검사를 모델이 아닌 컨트롤러 액션에서 처리한다. 물론 엔티티 클래스에 유효성 검사를 정의할 수 있지만, 유효성 검사는 입력 이후 가장 가까운 단계에서 이루어질 것을 권장하고 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:book</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:author</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">if</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n        <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n        redirect_to routes<span class="token punctuation">.</span>books_path\n      <span class="token keyword">else</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">422</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">params</code> 로 시작하는 유효성 검사는 엔티티를 정의해놓은 것 같은 역할을 할 수 있겠다. 자세한 내용은 <a href="http://hanamirb.org/guides/actions/parameters/">가이드</a>를 참고하면 손쉽게 작성할 수 있다.</p>\n<p>만약 패러매터가 유효하지 않다면 HTTP 상태 코드 422(Unprocessable Entity)를 리턴하고, 그에 알맞는 뷰를 다시 표현해 주어야 한다. 현재 <code class="language-text">create</code> 액션에는 아무런 템플릿도 작성되어있지 않고, 실제로는 <code class="language-text">new</code> 템플릿을 그대로 사용하면 되기 때문에 뷰 파일에 알맞는 템플릿을 정의해주면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/views/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Views</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">View</span>\n    template <span class="token string">\'books/new\'</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>지금까지 하나미를 통해 간단한 웹 애플리케이션을 개발하는 과정을 살펴보았다. 아주 기초적인 부분만 설명하였지만, 가이드를 살펴보고 하나미의 기능에 조금 더 익숙해진 뒤에는 github에 올라와 있는 몇몇 프로젝트 소스를 살펴보면서 하나미를 파악해보는 것을 추천한다.</p>\n<p>개인적으로 <a href="https://github.com/bruz/bookshelf-delivery-example">이 Github 저장소</a>를 방문해 보는 것을 추천한다. 하나미의 컨테이너 구조 및 컨트롤러 액션과 비지니스 로직을 구분하는 예를 잘 보여준 코드로 구성되어있다.(<code class="language-text">lib</code> 폴더 안에 있는 <code class="language-text">interactors</code> 폴더에 주목하라)</p>\n<p>본 포스팅에 사용된 코드는 <a href="https://github.com/emaren84/hanami-introduction">여기서</a> 확인해 볼 수 있다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>루비는 일반적 용도의 언어로써 충분히 완성도가 있는 언어이지만 상대적으로 다양한 분야에서 사용되는 파이썬에 비해 어느샌가 웹 개발에만 쓰이는 언어라는 선입견이 심어지게 되었다. 그리고 이러한 선입견의 중심엔 레일즈가 있다.</p>\n<p>레일즈가 등장하고 루비라는 언어가 크게 알려지는 데 기여한 것은 사실이다. 하지만 이 세상에 특정 문제 해결을 위한 단 하나의 정답은 거의 없다. 루비라는 언어 자체도 하나의 문제를 해결 하는데 다양한 방법을 제시하는 언어이기도 하다.</p>\n<p>하나미의 등장도 이런 맥락에서 바라볼 수 있다. 단순히 레일즈만이 루비로 웹 애플리케이션을 만드는 최고의 방법이 아니며, 하나미를 잘 활용하면 레일즈에 비해 유지보수가 쉽고, 더 성능이 좋은 웹 애플리케이션을 작성할 수도 있을 것이다.</p>\n<p>물론 하나미는 나온지 얼마 되지 않은 프레임워크이고, 기능 구현이 레일즈에 비해 상대적으로 부족한 점도 있다. <strong>특히 문서화가 되어있지 않아 소스 코드를 이리저리 살펴보아야 하는 부분들이 아직 많이 있다는 점이 아쉽다.</strong> 하지만 충분한 발전 가능성을 지니고 있고, 진정 루비라는 언어로 프로그래밍을 하는 재미를 주는 것이 매력적이기 때문에 루비 언어 자체를 좋아하는 사람들이라면 한번 사용해 볼 것을 추천한다.</p>\n<p>하나미의 정보를 더 얻고자 하는 분들에게는 다음의 링크를 살펴보면 된다.</p>\n<ul>\n<li><a href="http://hanamirb.org/guides/">하나미 공식 가이드</a> + <a href="https://github.com/hanami/hanami">소스 코드</a></li>\n<li><a href="https://gitter.im/hanami/chat">하나미 Gitter 채팅방</a></li>\n<li><a href="https://github.com/davydovanton/awesome-hanami">유용한 젬 및 링크 공유</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2016-12-03-hanami-introduction/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-03",path:"/posts/hanami-introduction",title:"레일즈(Ruby on Rails)와는 또 다른 루비 웹 프레임워크, Hanami(하나미)",tags:["Ruby","Rails","Hanami"],category:"Hanami"}}],Learning:[{excerpt:"이 글의 원문은  Simone Carletti가 작성하였습니다. 오역 지적 및 피드백은 더 나은 번역을 위한 밑거름이 됩니다. 저는 제 자신을 활발한  StackOverflow  사용자라고 생각합니다. 사이트 활동이 하루의 업무량에 크게 좌지우지되긴 하지만요. 2009년에 StackOverflow에 가입하여 이 글을 쓰는 시점(2016년 12월)까지,  저는 12만 4천의 명성치를 얻었고  상위 30…",html:'<ul>\n<li><strong>이 글의 원문은 <a href="https://simonecarletti.com/blog/2016/12/how-i-use-stackoverflow/">Simone Carletti가 작성하였습니다.</a></strong></li>\n<li><strong>오역 지적 및 피드백은 더 나은 번역을 위한 밑거름이 됩니다.</strong></li>\n</ul>\n<hr>\n<p>저는 제 자신을 활발한 <a href="https://stackoverflow.com/">StackOverflow</a> 사용자라고 생각합니다. 사이트 활동이 하루의 업무량에 크게 좌지우지되긴 하지만요. 2009년에 StackOverflow에 가입하여 이 글을 쓰는 시점(2016년 12월)까지, <a href="https://stackoverflow.com/users/123527/simone-carletti">저는 12만 4천의 명성치를 얻었고</a> 상위 300명의 사용자 랭킹에 올랐습니다.</p>\n<p>가끔씩 다른 프로그래머들이 <em>어떻게 이렇게 활발히 활동할 수 있나요?</em> 혹은 <em>정말 StackOverflow가 좋은건가요 아니면 그냥 눈에 띄고 싶어서 그러는건가요?</em>, <em>하루에 StackOverflow에서 얼마나 시간을 보내시나요?</em> 같은 질문을 하곤 합니다. 저는 이번 포스트를 통해 다양한 질문들을 모아 대답하고 <em>제가 StackOverflow를 어떻게 사용하는지</em> 설명해보고자 합니다.</p>\n<h2 id="정말-가치있는-일인가"><a href="#%EC%A0%95%EB%A7%90-%EA%B0%80%EC%B9%98%EC%9E%88%EB%8A%94-%EC%9D%BC%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정말 가치있는 일인가?</h2>\n<p>솔직히 말씀드리겠습니다. (거의) 모든 사람은 가치 없는 일에 매달리지 않습니다(nobody does something for nothing). 우리 모두는 어떤 행동이 가장 중요한지 기대치에 따라 결정을 내립니다.</p>\n<p>하지만 우리 모두 행동의 가치를 매기는 기준이 다릅니다. 어떤 사람은 돈을 받는게 유일한 보상이라고 여기기도 하고, 반대로 어떤 사람은 다른 이들의 눈에 띄거나 명성을 얻는게 돈을 버는 일보다 가치있다고 여깁니다. 특정인들에게 행복이란 단어는 부와 명예와 같은 의미이고, 나머지 사람들에게는 삶의 방식과 직접적으로 연관된 의미입니다.</p>\n<p>이 개념을 프로그래밍의 특정 주제에 적용할 수 있습니다. 바로 오픈 소스입니다. 저는 오픈 소스에 기여하는게 가치 없는 일이고, 그 이유가 <em>돈이 안되어서</em> 라고 말하는 사람들을 많이 보았습니다. 하지만 제게 <a href="https://github.com/weppos">오픈 소스에 기여</a>하는 이유를 물으신다면, 이 일이 저를 더 나은 프로그래머로 만들어주고 제 경력에 긍정적인 도움이 되기 때문이라고 대답할 겁니다. 제가 오늘 직업을 가지고 있는 이유 중 하나가 오픈 소스에 기여하기 때문이며, 뿐만 아니라 여지껏 대단한 사람들과 함께 놀라운 코딩 여정을 함께할 수 있는 기회도 얻었습니다.</p>\n<p>다시 StackOverflow 이야기로 돌아와서, 저는 StackOverflow 안에서 어떤 가치를 발견했기 때문에 참여하기 시작했습니다. 요즘 가입하는 대부분의 신규 사용자들과 달리, 저는 그 때 별다른 도움이 필요치 않았습니다. 사실 가입하고 몇달이 지나서야 처음 질문을 올릴 정도였으니까요.</p>\n<p>2009년에 저는 이미 꽤 쓸만한 개발자였습니다만, 제 활동의 대부분은 이탈리아 커뮤니티에 한정되어 있었습니다. 제가 StackOverflow에서 발견한 것은 바로 세계적인 커뮤니티 안에서 경험과 명성을 얻고, 눈에 띌 수 있는 기회였습니다.</p>\n<p>이렇게 제가 StackOverflow에 가입한 이유를 설명드렸습니다. 하지만 제가 7년이나 계속 답변들을 달게 된 이유는 더 있습니다.</p>\n<h2 id="끊임없는-두뇌-훈련"><a href="#%EB%81%8A%EC%9E%84%EC%97%86%EB%8A%94-%EB%91%90%EB%87%8C-%ED%9B%88%EB%A0%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>끊임없는 두뇌 훈련</h2>\n<p>제가 StackOverflow에 엄청난 양의 시간을 투자한 이유 중 단연 첫 번째는 끊임없는 두뇌 훈련을 위해서입니다.</p>\n<p>어떤 사람들은 두뇌 훈련을 위해 십자말풀이를 하거나, <a href="https://ko.wikipedia.org/wiki/%EC%8A%A4%EB%8F%84%EC%BF%A0">스도쿠</a>를 하기도 합니다. 개인적으로 저는 알고리즘, 데이터 마이닝, 프로그래밍 언어와 같이 각기 다른 분야에 걸쳐있는 작은 프로그래밍 문제들을 해결하면서 두뇌 훈련을 하는게 좋습니다.</p>\n<p>그래서 일반적으로 가능한 구현의 변수가 많거나 많은 양의 계층에 걸쳐진 문제같이(예를 들자면 Ruby on Rails와 관련된 질문인데 뷰, 컨트롤러, 데이터베이스의 코드가 다 담겨있는 경우) 큰 규모의 질문은 무시합니다. 대신 작고 잘 정의되어있는 질문은 10분 안에 충분히 답을 할 수 있어서 좋아합니다.</p>\n<h2 id="디버깅-기술-향상"><a href="#%EB%94%94%EB%B2%84%EA%B9%85-%EA%B8%B0%EC%88%A0-%ED%96%A5%EC%83%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>디버깅 기술 향상</h2>\n<p>적절하게 소프트웨어의 일부를 디버그하는 능력은 소프트웨어 엔지니어에게 아주 가치있는 기술 중 하나입니다.</p>\n<p>만약 자신의 코드를 디버깅하는게 힘들다면, 다른 사람의 코드를 디버깅하는 일은 더욱 힘들겁니다. 게다가 실제로 만날 수도 없는 상태이다보니, 의사소통이 훨씬 더 복잡해집니다. 여러분은 디버깅에 필요한 정보를 빨리 얻기 위해 최대한 적절한 질문을 떠올려야 합니다.</p>\n<p>StackOverflow의 질문들은 \'언제나 디버깅할 거리는 무수히 많다\'는 점을 보여줍니다. 시간을 들여 답변하기에 적절한 질문을 고르는 기술도 익히게 됩니다.</p>\n<p>때로는 제가 쓰지 않는 라이브러리나 제가 모르는 내용을 디버깅하는 질문에 뛰어들기도 합니다. 이를 통해 저는 <a href="https://simonecarletti.com/blog/2009/09/inside-ruby-on-rails-reading-StackOverflowurce-code/">계속 다른 사람의 코드를 읽는 훈련을 했습니다.</a> 웃긴 이야기를 하나 해 드리겠습니다. 제가 사용하고 있는 특정 라이브러리에 관한 해결책을 찾고 있을 때, 저는 제가 겪었던 문제와 정확히 똑같은 질문을 StackOverflow에서 찾았고 그 질문은 제대로 답변도 달려있었습니다. 별 이상한 점은 없었습니다. 그 답변을 달았던 사람이 저였다는걸 깨닫기 전까지는 말이죠! 비슷한 일이 몇번 있었습니다.</p>\n<h2 id="새로운-언어를-배우고-자신의-진도를-확인하기"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%96%B8%EC%96%B4%EB%A5%BC-%EB%B0%B0%EC%9A%B0%EA%B3%A0-%EC%9E%90%EC%8B%A0%EC%9D%98-%EC%A7%84%EB%8F%84%EB%A5%BC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 언어를 배우고 자신의 진도를 확인하기</h2>\n<p>저는 새로운 프로그래밍 언어나 기술을 배우기 좋아합니다. 이때는 절대로 StackOverflow를 사용하지 않고, 책이나 온라인 자료에 의지합니다. 하지만 StackOverflow는 자신의 진도를 테스트하는데 아주 좋은 수단이라는 사실을 깨달았습니다.</p>\n<p>불과 몇주 전에 자신이 배우기 시작한 분야에 다른 사람이 질문을 올렸는데, 그 질문에 답변을 할 수 있다면 엄청나게 뿌듯한 기분이 듭니다.</p>\n<p>요즘에는 StackOverflow에 올라온 질문에 답변을 달고, 그 답변이 채택되는 일이 그렇게 간단하지 않습니다. 엄청난 수의 전문가들이 매일 접속해있으니까요. 간단한 질문은 빠르면 몇 분 이내에 답변이 달리기도 하고, 심지어 여러분이 문제를 다 읽기도 전에 답변이 달릴 때도 있습니다. 대신 더 복잡한 질문은 시간이 걸리겠지만, 새로운 주제를 배우고 있는 상태에서 건드리기엔 너무 어렵습니다.</p>\n<p>따라서 적절한 질문을 선택한 뒤, 합리적인 시간 안에 올바른 해결책을 제시하는 일은 새로운 주제를 배우면서 진도를 테스트하는 좋은 방법입니다.</p>\n<p>저는 개인적으로 세 단계의 학습 과정을 가지고 있습니다.</p>\n<ol>\n<li>첫 번째 단계로 열심히 학습하는 동안 간단한 질문들을 읽고 답변을 떠올리지만, <em>실제로는 답변하지 않습니다.</em></li>\n<li>두 번째로 충분한 지식 기반을 쌓았을 때, 좀 쉬운 질문에만 답변을 쓰려고 하거나 이미 알맞은 해결책이 존재한다면 링크를 제공하기도 합니다. <em>제가 정말 이 답이 맞다고 자신있게 생각한다면</em> 직접 답변을 달기도 합니다. 저는 손쉽게 +1을 얻고자 하는게 아니기 때문에 진짜 적절한 해결책이라는 자신이 없다면 답변을 달지 않습니다. 보통 두 번째 단계가 가장 긴 단계인데, 이후 세 번째 단계로 자연스레 이어지게 됩니다.</li>\n<li>세 번째는 해당 주제에 상당한 양의 지식을 갖게 되고, 관련된 대부분의 질문에 대답을 하거나 디버깅할 수 있는 단계입니다. 물론 이 단계에 이르기까지 많은 시간이 들 뿐 아니라, 모든 프로그래밍 관련 주제에서 이 단계까지 다다를 필요는 없을 겁니다.</li>\n</ol>\n<p>일반적으로 두 번째 단계를 목표로 하셔야 합니다. 특정 주제에 관한 질문을 이해하고 괜찮은 수준의 답변을 할 수 있을 정도가 되어야 합니다. 비록 대부분의 경우 여러분이 올바른 해결책을 떠올리기까지 걸리는 시간이 다른 숙련된 개발자들에 비해 느리다고 하더라도 괜찮습니다. 답변을 다는 시간을 줄이는 능력은 더 많은 경험에서 우러나오기 마련인데, 반드시 시간 줄이기를 목표로 삼을 필요는 없습니다.</p>\n<h2 id="사용자-지원"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A7%80%EC%9B%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 지원</h2>\n<p>가끔 누군가가 <a href="https://dnsimple.com/">DNSimple(작성자가 몸 담고 있는 서비스)</a>과 관련된 질문을 올릴 때도 있습니다. 대부분의 질문은 자신의 소프트웨어를 연결하거나 도메인을 등록하는 등 DNSimple이 하나의 구성요소인 경우가 많습니다.</p>\n<p>질문에 이미 제시된 답변이 없는 경우 저는 가능한 한 대화에 끼어들어 답을 제공하려 합니다. 만약 필요한 지식을 모르고 있다면 다른 DNSimple 팀원을 불러 그 사람과 함께 알맞은 해결책을 작성해봅니다.</p>\n<p>저는 StackOverflow에서 <a href="https://stackoverflow.com/questions/tagged/dnsimple">dnsimple</a> 태그를 구독해두었습니다. 그리고 때로는 <a href="https://serverfault.com/">ServerFault</a>와 <a href="https://webmasters.stackexchange.com/">Webmasters Stack Exchange</a>에서 <code class="language-text">dnsimple</code> 키워드를 찾아보기도 합니다.</p>\n<h2 id="온라인-평판"><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%ED%8F%89%ED%8C%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>온라인 평판</h2>\n<p>작년에 저는 <em>온라인 평판</em>을 쌓는 것이 중요하다는 이야기를 많이 들었습니다. 이게 SEM(Search Engine Marketing) 회사들이 다른 회사들더러 온라인 활동에 투자하도록 꼬드기는 가장 일반적인 방법 중 하나입니다.</p>\n<p>온라인 평판은 마찬가지로 사람에게도 중요합니다. 특히 여러분의 주 활동 영역이 어떻게든 컴퓨터나 프로그래밍, 혹은 인터넷이랑 직접적인 연관이 있는 분야라면 말입니다.</p>\n<p>StackOverflow는 <a href="https://en.wikipedia.org/wiki/Show,_don&#x27;t_tell"><em>말하지 말고 행동으로 보이라</em></a> 는 접근 방식으로 온라인 평판을 쌓는 아주 좋은 방법입니다. StackOverflow에 있는 질문에 적절히 답을 하면서 여러분은 자신의 경험을 내보일 수 있습니다. 경험이 있는 척 하거나 다른 사람에게 무엇을 잘 한다고 말만 하고 다니는 것보다 훨씬 직접적입니다. 물론 다른 결과가 나올 수도 있습니다. 질문과 답변은 공개되어있고 몇 년 뒤에도 지워지지 않기 때문에, 자신의 기술 혹은 소통 능력의 약점을 드러낼 수 있기 때문입니다.</p>\n<p>예전부터 저는 최소한 두 가지 유형의 StackOverflow 프로필을 가지고 있는 사람들과 이야기해왔습니다. 첫 번째는 자신들의 온라인 평판에 긍정적인 영향을 미치는 방식으로 소통을 해온 사람들이고, 두 번째는 자신이 <em>너무 멍청하다고</em> 자책하며 질문을 올리는 사람들이었습니다.</p>\n<p>기억하세요. 바보같은 질문은 없습니다. 아무리 질문이 쉽다 하더라도 정말 중요한 것은 질문하는 방식(그리고 여러분이 적절한 답을 찾아보거나 최소한 노력이라도 했는지) 입니다. 저는 특정 분야에 제가 지식이 부족하다는 이야기를 하면서 질문하는데 아무런 거리낌이 없습니다. 제가 <a href="https://dba.stackexchange.com/">DBA</a>나 <a href="https://vi.stackexchange.com/">Vim</a> 사이트에 올린 질문들은 대부분 제 자신이 해당 분야의 전문가가 아니지만, 더 배우고 발전하고자 하는 의지를 보이고 있습니다.</p>\n<h2 id="온라인-노출도"><a href="#%EC%98%A8%EB%9D%BC%EC%9D%B8-%EB%85%B8%EC%B6%9C%EB%8F%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>온라인 노출도</h2>\n<p>온라인 평판이 여러분의 프로필을 발전시키는데 직접적으로 연관되어 있다면, 온라인 노출도는 여러분이 온라인에서 보여지는 횟수를 뜻합니다.</p>\n<p>Github는 프로그래머에게 온라인 평판(인터뷰에 지원할 때 자신의 오픈 소스 기여를 링크로 제공할 수 있기 때문에)과 온라인 노출도를 기르는 최적의 장소입니다. 하지만 Github와 비교하면 StackOverflow는 일반적으로 검색 엔진에서 많이 보이게 됩니다. 저는 여지껏 검색 엔진을 이용해서 StackOverflow에 있는 문제와 해결책을 찾는 데 어려움을 겪었다는 프로그래머를 본 적이 없습니다.</p>\n<p>StackOverflow는 검색 엔진에서 높은 우선순위를 가지고 있기 때문에, StackOverflow에서 명성을 얻는 일은 아마 여러분의 온라인 노출도에 직접적, 간접적으로 영향을 주게 됩니다. 직접적으로는 StackOverflow의 랭킹이 올라가고, 간접적으로 여러분이 답변을 달았던 질문이 검색 엔진의 결과 페이지에 나타나기 때문입니다.</p>\n<h2 id="영어-배움터"><a href="#%EC%98%81%EC%96%B4-%EB%B0%B0%EC%9B%80%ED%84%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영어 배움터</h2>\n<p>저는 영어 원어민이 아닙니다. 영어로 글을 쓰는 일은 저에게 여전히 어렵고, 이탈리아어로 쓰는 일보다 훨씬 어려우며, 다른 사람이 영어로 쓴 글을 읽는 일보다 더욱 어렵습니다.</p>\n<p>StackOverflow는 제 영어 쓰기 실력을 기르는데 아주 좋은 기회를 제공해줍니다. 누구나 제 답변을 수정하거나 오타를 교정할 수 있기 때문입니다. StackOverflow는 모든 변경 사항의 이력을 가지고 보존하기 떄문에, 저는 언제나 제 글에 다른 사람들이 도움을 준 부분을 살펴볼 수 있습니다. 실수로부터 배우는 일은 저에게 아주 좋은 방법입니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>StackOverflow에 있는 질문에 답변을 작성하는 것은 <em>일반적으로</em> 저에게 기쁜 경험입니다. 저의 태도와 개인적인 역량에 긍정적인 영향을 주기 때문입니다. 하지만 긍정적인 경험이 짜증나는 일이 되도록 하지 않기 위해 이 일을 의무로 여기지 않고 있습니다.</p>\n<p>저는 최소 몇시간 혹은 최소 몇일에 한번 답변을 해야한다거나, 하루에 얼마만큼의 명성을 쌓아야 한다고 목표치를 정해놓지 않았습니다. 마지막으로 로그인한 시간이 좀 지났다 하더라도 찝찝한 기분이 들지도 않습니다.</p>\n<p>저는 하루 일과와 StackOverflow에 머물러 있는 시간의 균형을 유지하려고 노력합니다. 주로 테스트나 배포가 끝나길 기다리는 동안 하루에 30분에서 한 시간정도만 머물러 있습니다.</p>\n<p>StackOverflow에 기여하는 일은 두뇌를 단련하고, 소프트웨어 엔지니어로서 자신의 기술을 끌어올리며, 저의 온라인 평판과 노출도를 항샹시키는 긍정적인 부가 효과도 있습니다. 이 모든 이유가 제가 7년 동안 질문에 답하기 위해 <em>투자한</em> 시간을 정당화합니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>글 내용이 꽤 길어서 힘들었지만 유익한 내용이었습니다. 저를 비롯한 많은 개발자들이 StackOverflow에서 이미 답변된 질문 위주로 검색을 하고, 답을 얻어서 문제를 해결할 생각은 하겠지만 직접 질문을 올리거나 답변을 작성할 생각은 별로 해 본적이 없을겁니다. 영어라는 장벽 때문이겠지요. 거기다 \'바빠 죽겠는데 이런데 글 쓰고 앉아있을 시간이 어디 있겠느냐\' 같은 생각도 할 수 있겠네요.</p>\n<p>이 글을 읽고 나니 StackOverflow를 적극적으로 사용하는 일은 Github으로 참여하는 오픈 소스 생태계와 비슷한 점이 많다고 느꼈습니다. 보통은 자신의 코드가 직접적으로 남는 Github쪽을 선호하겠지만, 오히려 무리해서 \'<a href="https://blog.outsider.ne.kr/1193">일일 커밋</a>\'을 하기보단 차근차근 StackOverflow에 적극적으로 참여하는 것도 개발자의 실력을 갈고닦는데 큰 도움이 되겠습니다.</p>\n<p>그리고 다른 어느 부분보다 글의 결론 부분이 와 닿았습니다. 우리는 보통 각자의 생업이 있고, 아무리 좋은 의도를 가진 행동도 의무가 되어야 할 필요는 없다고 생각합니다. 스타워즈의 요다 선생이 <strong>"Do. Or do not. There is no try."</strong> 라고 말씀하셨지만, 이번 경우에는 정 반대로 생각해보면 마음이 한결 편해집니다. <strong>"아예 안하는 것 보다는 시도라도 해 보는게 낫지 않을까"</strong></p>',id:"/home/circleci/repo/src/pages/posts/2017-04-15-how-i-use-stackoverflow-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-15",path:"/posts/how-i-use-stackoverflow-kor",title:"[번역] 내가 StackOverflow를 사용하는 방법",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 포스트는  Alex Kotliarskyi 의  글 을 번역한 것입니다. 오역 지적 및 피드백은 언제나 환영합니다. 저는 드디어  Cheng Lou 가 ReactConf'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요. 요약:  언어가 있으면  메타언어 (고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE…",html:'<ul>\n<li><strong>이 포스트는 <a href="http://frantic.im/">Alex Kotliarskyi</a>의 <a href="http://frantic.im/meta-language">글</a>을 번역한 것입니다.</strong></li>\n<li><strong>오역 지적 및 피드백은 언제나 환영합니다.</strong></li>\n</ul>\n<hr>\n<p>저는 드디어 <a href="https://twitter.com/_chenglou">Cheng Lou</a>가 ReactConf\'17에서 발표한 내용을 이해했습니다. 20분정도 시간을 내실 수 있다면 이 영상을 먼저 봐 주세요.</p>\n<iframe width="560" height="315" src="https://www.youtube.com/embed/_0T5OSSzxms" frameborder="0" allowfullscreen></iframe>\n<p><strong>요약:</strong> 언어가 있으면 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%ED%83%80_%EC%96%B8%EC%96%B4">메타언어</a>(고차 언어)도 있다. 여기서 언어는 실제 소스 코드이고, 메타 언어는 그 위에 있는 모든 것(테스트, 주석, IDE 기능, 문서, 예제, 튜토리얼, 블로그 글, 책, 비디오, 컨퍼런스 등의 기술 발표 등)을 뜻한다. 우리는 언어를 배우기 위해 메타언어를 사용한다. 우리가 메타언어의 개념을 언어 자체로 끌어내리면, 우리가 다루는 개념은 더욱 유연해지고 점차 새로운 메타언어를 만들어나갈 수 있게 된다. 새로운 메타언어는 같은 에너지를 쏟아도 기존 메타언어에 비해 더 고차원적이고 풍부한 형태를 가질 수 있게 된다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 49.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQoz4WS226DMAyG+/7vtk2atHU3k3qBOLQhQCFRIHb+OZmg6WFdJCsG2Z9/O97hjxNCSDcRgewE6hQWrTCfTuB5vorJ/d3qxPuRERNsPeL0UsEWGjwO4GW5y1m/d7eV8orxNwuwqRy+9xPOZ4KjAE7xF8g80wWY05n5TiFLy9Vo8aE6vNUtDnpaWQkaWIDuAdAYg+PxKCrOKMsSRVHAOQe/eCin8Dl8JRsWLXM1opI3yOL+UZgeQixIEnnG5Gqo4R2t2OhKmFkJ8ALxMz+f4TboGCwt+b6GPbyC+gbwtHb723IUkAMfPX1+fFQ6jkDTgMoK3PeJtXUmBRdD1wpzWJxbL0ld18F7n8xYi0FmG/IOcp/Dc2DbtlBKFln2LdooCrXW2xhu9y/P/wHyLxHJM3AJqAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="The Flow"\n        title=""\n        src="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png"\n        srcset="/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-d16f8.png 198w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-f21b1.png 395w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-ffc88.png 790w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-81e7e.png 1185w,\n/static/2017-04-04-1b52eac1f90484ea982f2dbab689b235-c6d11.png 1200w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<p>이 그림의 이해를 돕기 위해 다양한 예제를 준비해왔습니다.</p>\n<h2 id="어셈블리-명령어-→-변수명"><a href="#%EC%96%B4%EC%85%88%EB%B8%94%EB%A6%AC-%EB%AA%85%EB%A0%B9%EC%96%B4-%E2%86%92-%EB%B3%80%EC%88%98%EB%AA%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어셈블리 명령어 → 변수명</h2>\n<p>우주 산업 분야에서 행성으로부터의 <a href="https://ko.wikipedia.org/wiki/%ED%83%88%EC%B6%9C_%EC%86%8D%EB%8F%84">탈출 속도(escape velocity)</a>를 구하기 위해 사용되는 코드 일부를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-assembly"><code class="language-assembly">.SUB_0_21:\n    ; Computes escape velocity\n    ; register xmm0 - planet mass\n    ; retister xmm1 - planet radius\n    mulsd   xmm0, qword ptr [rip + .LCPI0_0]\n    divsd   xmm0, xmm1\n    xorps   xmm1, xmm1\n    sqrtsd  xmm1, xmm0\n    ucomisd xmm1, xmm1\n    jp      .LBB0_2\n    movapd  xmm0, xmm1\n    ret\n.LBB0_2:\n    jmp     sqrt                    ; TAILCALL\n.LCPI0_0:\n    .quad   4459223850755291651     ; double 1.334816E-10</code></pre>\n      </div>\n<p>코드의 상당수가 메타언어에 기대고 있습니다. 이 코드에 대한 주석이나 문서(여기엔 보이지 않지만) 말입니다. 위 코드와 비교해서 C로 작성된 예를 살펴보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> GRAVITY_CONSTANT 6.67408e-11</span>\n<span class="token keyword">double</span> <span class="token function">escape_velocity</span><span class="token punctuation">(</span><span class="token keyword">double</span> mass<span class="token punctuation">,</span> <span class="token keyword">double</span> radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> GRAVITY_CONSTANT <span class="token operator">*</span> mass <span class="token operator">/</span> radius<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그저 변수에 이름을 지정해주었을 뿐인데 메타언어에 기대고 있던 정보를 언어 자체로 끌어내릴 수 있게 됐습니다.</p>\n<h2 id="변수명-→-심화-타입advanced-types"><a href="#%EB%B3%80%EC%88%98%EB%AA%85-%E2%86%92-%EC%8B%AC%ED%99%94-%ED%83%80%EC%9E%85advanced-types" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변수명 → 심화 타입(Advanced Types)</h2>\n<p>C 버전의 코드는 어셈블리로 작성된 코드보다 훨씬 많은 정보를 가지고 있고, 메타언어도 더 높은 수준으로 이루어져 있습니다. 이제 우리는 반복 작성을 하거나 코드 안의 내용이 무엇인지 문서화할 필요가 없어졌습니다. 이 함수가 2개의 인자를 받아야 하며 첫 번째 인자는 질량, 두 번째 인자는 반경이라는 내용 말입니다.</p>\n<p>하지만 아직 문맥상 코드에 부족한 부분이 있습니다. 이 함수가 어느 단위 위에서 동작하는지 알 수가 없다는 겁니다. 당장은 라이브러리의 문서(메타언어)에 기댈 수 밖에 없습니다.</p>\n<p>우리는 인자 이름을 <code class="language-text">mass_kilograms</code>, <code class="language-text">radius_meters</code> 같은 이름으로 바꾸는 간단한 트릭을 써 볼수 있지만, 언어 자체에서 \'이 함수는 반드시 킬로그램과 미터를 입력해야한다\'고 보장해주는 장치가 없습니다.</p>\n<p>이제 더 복잡한 타입을 지원하는 언어의 예를 살펴보겠습니다. 저는 OCaml을 사용하겠지만 대부분의 ML-계열 언어들(하스켈, 스위프트 등)은 이런 기능을 지원합니다. (<a href="https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/units-of-measure">그리고 F#은 아예 단위에 대해 가장 높은 우선 순위로 지원을 하고 있습니다.</a>)</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">=</span> <span class="token number">6.67408e-11</span>\n\n<span class="token keyword">type</span> mass <span class="token operator">=</span> Kilograms <span class="token keyword">of</span> float\n<span class="token keyword">type</span> length <span class="token operator">=</span> Meters <span class="token keyword">of</span> float\n<span class="token keyword">type</span> velocity <span class="token operator">=</span> MetersPerSecond <span class="token keyword">of</span> float\n\n<span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token punctuation">(</span>Kilograms mass<span class="token punctuation">)</span> <span class="token punctuation">(</span>Meters radius<span class="token punctuation">)</span> <span class="token operator">=</span>\n    MetersPerSecond <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*.</span> gravity<span class="token punctuation">_</span>constant <span class="token operator">*.</span> mass <span class="token operator">/.</span> radius <span class="token operator">|></span> sqrt<span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p><em>실은 지구로부터의 탈출 속도를 계산할 때 제 구현체에서 버그를 발견했습니다. 질량을 엉뚱한 단위로 입력하고 있었어요.</em></p>\n<p>위의 코드에서 <code class="language-text">length</code> 와 <code class="language-text">mass</code> 는 단순한 숫자가 아니라 1급 객체(first class citizen)입니다. 덕분에 더욱 안전하고 유지보수가 용이하며 코드를 발전시키기 쉬워졌지요. 예를 들어 우리가 야드파운드법을 지원하고자 한다면(왜 그래야하는지는 모르겠지만), <code class="language-text">mass</code> 타입을 이렇게 바꾸면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">type</span> mass <span class="token operator">=</span>\n  <span class="token operator">|</span> Kilograms <span class="token keyword">of</span> float\n  <span class="token operator">|</span> Pounds <span class="token keyword">of</span> float\n</code></pre>\n      </div>\n<p>이러면 타입 체커가 기존 코드에서 새 단위를 적용하기 위해 수정해야 할 부분을 낱낱이 지적해줄 겁니다.</p>\n<h2 id="사용되지-않을-경우deprecation와-다른-메타정보들"><a href="#%EC%82%AC%EC%9A%A9%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%84-%EA%B2%BD%EC%9A%B0deprecation%EC%99%80-%EB%8B%A4%EB%A5%B8-%EB%A9%94%ED%83%80%EC%A0%95%EB%B3%B4%EB%93%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용되지 않을 경우(Deprecation)와 다른 메타정보들</h2>\n<p>우리가 기존의 탈출 속도보다 훨씬 정확한 값을 구할 수 있는 새로운 공식을 발견했다고 칩시다. 그렇다면 기존의 함수가 더 이상 사용되지 않는다고 표시하려면 어떻게 해야할까요?</p>\n<p>이럴 때 보통 주석이나 문서를 추가하거나 Medium에 글을 쓰는 등 메타언어를 구축할 것입니다. 하지만 메타언어로 구성된 정보들을 코드 자체로 끌어내리는게 훨씬 더 생산적인 방법입니다.</p>\n<p>전에 썼던 트릭처럼 C 함수의 이름을 바꾸어 <code class="language-text">escape_velocity</code> 를 <code class="language-text">escape_velocity_DEPRECATED</code> 나 <a href="https://github.com/facebook/react/blob/80bff5397bf854750dbe7c286f61654ea58938c5/src/umd/ReactUMDEntry.js#L21">이렇게 괴상한 이름으로 바꿀 수도 있습니다</a>. 하지만 이는 우리의 API가 변경되면서 클라이언트의 코드가 동작하지 않게 되고, 표준적인 방법도 아닙니다(누구나 자신만의 접미사를 붙일 수 있으니까요). 그리고 새로이 사용해야 할 메서드를 제대로 추천하지 않고 있습니다.</p>\n<p>만약 언어 자체가 이 메타정보를 알아서 알려주는 기능을 지원한다면 어떨까요?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ocaml"><code class="language-ocaml"><span class="token keyword">let</span> escape<span class="token punctuation">_</span>velocity <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">[</span><span class="token operator">@</span>ocaml<span class="token punctuation">.</span>deprecated <span class="token string">"Please use `quantum_escape` instead"</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<h2 id="추가-예시"><a href="#%EC%B6%94%EA%B0%80-%EC%98%88%EC%8B%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>추가 예시</h2>\n<p>지금까지 메타적 공간에 있던 많은 정보를 언어 자체에 심어주는 하나의 방법을 보여드렸습니다. 다른 예들을 보여드리겠습니다.</p>\n<p><strong><a href="https://ko.wikipedia.org/wiki/%EB%B9%84%EC%A7%80%ED%84%B0_%ED%8C%A8%ED%84%B4">방문자 패턴(Visitor Pattern)</a>과 <code class="language-text">for</code> 루프 → map/filter/reduce:</strong> 제가 대학에 다닐 땐 방문자 패턴을 배웠지만, 이젠 이 패턴이 많은 언어에서 기본 라이브러리로 손쉽게 제공되고 있습니다.</p>\n<p><strong>상태(state) 불러오기:</strong> 저는 종종 사람들이 리액트 컴포넌트를 만들면서 상태를 이렇게 설정해두는 것을 보게 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript">state <span class="token operator">=</span> <span class="token punctuation">{</span>\n  data<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  error<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n  loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이 경우 <code class="language-text">loading</code> 이 <code class="language-text">false</code> 라면 <code class="language-text">data</code> 나 <code class="language-text">error</code> 중에 하나가 <code class="language-text">null</code> 이 되어서는 안된다는 안내를 하려면 메타언어를 사용할 수 밖에 없습니다. 그 대신 우리는 Flow나 타입스크립트(Typescript)를 사용하여 언어 단위에서 제약을 걸 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-typescript"><code class="language-typescript"><span class="token keyword">type</span> State <span class="token operator">=</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'loading\'</span> <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'done\'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> Object <span class="token punctuation">}</span> <span class="token operator">|</span>\n  <span class="token punctuation">{</span> progress<span class="token punctuation">:</span> <span class="token string">\'error\'</span><span class="token punctuation">,</span> error<span class="token punctuation">:</span> Error <span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>리덕스(Redux)와 불변성(Immutability):</strong> 현재는 문서, 블로그 포스트, 비디오, 컨퍼런스 발표 등에서 리덕스를 사용할 때 변수나 객체에 직접적으로 변화를 주지 않을 것을(lack of direct mutation) 전제하고 있습니다. 만약 자바스크립트가 기본적으로 불변 데이터 타입과 타입 선언(type annotations)을 제공한다면 위에서 말하는 전제를 코드에서 바로 표현할 수 있지 않을까요?</p>\n<p><strong>프로미스(Promises)와 옵저버블(Observables):</strong> 자바스크립트에서 프로미스 패턴은 라이브러리에서 제공하는 기능이었지만 이제 코어 기능으로 자리잡았습니다. <a href="https://github.com/tc39/proposal-observable">옵저버블</a>에도 같은 과정이 진행중입니다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>아무리 메타언어를 언어로 끌어내린다 하더라도 사람 사이에 의사소통하는 부분을 해결할 수는 없다는 것을 새겨두시는게 좋습니다. 하지만 언어의 진화와 함께 우리는 더 효과적인 의사소통의 기회를 열어가고 있습니다.</p>\n<p>반드시 어딘가엔 복잡한 부분이 존재합니다. 만약 언어가 아주 단순하다면, 복잡한 부분은 메타언어에 머무르게 됩니다.</p>\n<p>참고로  <a href="https://www.youtube.com/watch?v=4anAwXYqLG8">Sebastian Markbåge의 최소한의 API 표현 범위(minimal API surface area)에 관한 발표와</a>, <a href="https://www.youtube.com/watch?v=V1po0BT7kac">Jared Forsyth의 타입 시스템에 대한 발표</a>를 살펴보세요. 아 그리고 영화 <a href="http://movie.daum.net/moviedb/main?movieId=105570">컨택트(Arrival, 2016)</a>도 꼭 보세요. 강추합니다!</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>처음 이 글을 접하게 된 계기는 이 코드 때문이었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// explicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n\n<span class="token comment">// implicit</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x<span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>보고 계시는 자바스크립트 코드에서 위쪽에 제시된 코드가 평균적으로 최대 15%까지 처리 속도가 빠르다고 합니다. <a href="https://twitter.com/dhh/status/846627223176167424">DHH는 트위터에서</a> \'어차피 15%라고 해봤자 실제로는 몇 밀리초 이하일텐데 왜 기계에게 맞추려고 하느냐\' 같은 내용의 비판을 쏟아내었지요. 코드를 어떻게 작성하실건지는 여러분의 취향에 맡기겠습니다.</p>\n<p>하지만 오늘 제가 드리고픈 말씀은 아래 트윗에 다 있기 때문에 후기를 짧게 줄이고자 합니다.</p>\n<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/dhh">@dhh</a> Code is not a conversation between a dev and a machine.&#13;&#13;Code is a conversation between a developer AND THE NEXT DEVELOPER.</p>&mdash; Don Schenck (@DonSchenck) <a href="https://twitter.com/DonSchenck/status/846675893909180416">March 28, 2017</a></blockquote>\n<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>',
id:"/home/circleci/repo/src/pages/posts/2017-04-04-understanding-taming-the-meta-language-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-04",path:"/posts/understanding-taming-the-meta-language-kor",title:"[번역] 메타언어 길들이기",tags:["Programming","Learning","Translation"],category:"Translation"}},{excerpt:"본 포스트는  Gerald Weinberg 의  포스팅 의 번역본입니다 피드백은 언제나 환영합니다 제가 처음 이 질문을 Quora에서 보았을 때, 이미 4…",html:'<ul>\n<li><strong>본 포스트는 <a href="https://en.wikipedia.org/wiki/Gerald_Weinberg">Gerald Weinberg</a>의 <a href="http://secretsofconsulting.blogspot.kr/2017/02/should-i-learn-c-or-python.html">포스팅</a>의 번역본입니다</strong></li>\n<li><strong>피드백은 언제나 환영합니다</strong></li>\n</ul>\n<hr>\n<p>제가 처음 이 질문을 Quora에서 보았을 때, 이미 47개 정도의 답변이 달려있었고 대부분의 답은 잘못되어 있었습니다. 하지만 이 많은 답변들은 여러분에게 무언가 시사하는 바가 있습니다. 프로그래밍 언어를 선택하는 것은 기술적이라기보단 종교적인 질문에 가깝다는 겁니다. 사실 당신이 전문적인 프로그래머가 되고자 한다면 두 언어를 동시에 배워야 합니다.</p>\n<p>우리가 프로그래밍을 가르칠 때는 언제나 두 언어를 동시에 가르칩니다. 과제는 반드시 두 가지(혹은 그 이상의) 언어로 작성되어야 하며, 왜 언어마다 해결법이 다른지, 혹은 왜 같은지 설명하는 에세이를 같이 첨부하도록 합니다. 이 방법으로 여러분의 전문적 코딩 지식과 성숙도를 발전시킬 수 있습니다.</p>\n<p>일부 답변자들은 프로그래밍 언어는 도구에 불과하다고 주장합니다. 만약 그 비유가 맞다면, 목수가 되고자 하는 사람들이 이런 질문을 할 때 어떻게 대답해야 할까요?</p>\n<blockquote>\n<p>"제가 톱질하는 법을 배워야 할까요? 아니면 나사돌리개 쓰는 법을 배워야 할까요?"</p>\n</blockquote>\n<p>둘 중에 하나만 배운 사람이 최고 수준의 목수가 될 수 있을까요?</p>\n<p>그러니 이 결론이 날 리 없고 유사종교스러운 논란을 멀리하는 대신에, 여러분의 소중한 시간을 가능한한 많은 프로그래밍 언어를 배우는데 쓰도록 하십시오. 최소한 다섯 개에서 여섯 개 정도를 배우세요. 모든 언어를 반드시 사용할 필요는 없지만, 언어별로 다른 접근방식을 알게 되면 이런 바보같은 말은 하지 않게 될 것입니다: </p>\n<blockquote>\n<p>"저는 X라는 언어만 알고 있어요, 그리고 여전히 이 언어가 세상에서 가장 뛰어난 언어라고 생각합니다."</p>\n</blockquote>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>요즘은 시간이 너무나 빨리 지나가버려서 1주일에 한 개 정도 번역을 하겠다는 다짐을 지키지 못하게 되는 때가 잦습니다. 다시 번역에 시동을 걸면서 이번에는 짧지만 의미있는 글을 번역해보았습니다.</p>\n<p>우연히 이 글을 보게 되었을 때 \'이 나이 지긋한 어르신은 누구신가\' 하고 찾아보니 명망있는 IT 컨설턴트시더군요. 병환으로 사경을 헤메신 적이 있다고 하는데 아직까지는 잘 계십니다. 최근 트윗을 보니 병원에 다시 투병중이신가 봅니다. 쾌차하시길 바랍니다.</p>\n<p>\'프로그래밍 언어는 도구에 불과하다\' 라는 말을 다른 분에게 들었을 때는 이 글에서 이야기하고자 하는 뉘앙스와 약간 달랐습니다. \'개발에 필요한 원리를 숙지하고, 실무에서 필요한(혹은 가장 빠르게 적용 가능한) 언어를 익혀서 금방금방 적용할 수 있어야 한다.\' 라는 뜻으로 말씀을 하셨었지요. 어느 쪽이든, 결론적으로 다양한 언어를 접하는 것은 프로그래머로서 사고의 폭을 넓히기 때문에 도움이 된다는 뜻이라고 생각합니다.</p>\n<p>취지는 좋지만 현실적인 문제를 생각해보면.. 시간이 부족하다는 장벽이 있겠지요. 이럴 때는 조급한 마음가짐을 잠시 내려놓고 배움의 호흡을 길게 가져가야 할 것 같습니다. 제가 이 글의 번역을 하겠다고 허락을 구하기 위해 메일을 보낼 때 주고받았던 메일 일부를 발췌해 보았습니다.</p>\n<blockquote>\n<p>Rinae: (중략) 저는 루비와 자바스크립트라도 동시에 익혀나가고 있습니다. 하지만 쉽지는 않네요.</p>\n<p>Gerald: 음, 그 두개면, 충분히 제가 추천한 방식대로 하고 있군요. 앞서 언급했듯이 같은 일을 양쪽 언어로 구현해보세요. 그렇다고 무조건 구체적으로 작성할 필요도 없지만, 최소한 서로 다른 두 언어가 어떻게 다른지 이해하고 최소한의 스케치라도 디자인할 수 있을 정도가 되어야 합니다.</p>\n<p>그리고 이렇게 하는 게 아주 어렵다고 느껴진다면 최소한 앞의 두 언어가 익숙해질 때 까지는 세 번째 언어를 배우지 않도록 하세요.</p>\n</blockquote>\n<blockquote>\n<p>Rinae: 새로 배울 언어를 추천해주실 수 있나요?</p>\n<p>Gerald: 기존에 알고 있던 언어와 가능한한 다른 언어를 고르세요. 다른 언어를 고르기 위해 인터넷에서 찾아보거나 프로그래머 지인들에게 그 사람들이 알고 있는 언어를 물어보세요. 그 대신에 지금 알고 있는 언어와 너무 비슷한 언어를 고르게 된다면 헷갈리기만 할 겁니다<em>(역주: 언어의 문법이 다른 정도만 헷갈리고 나머지는 별 의미 없을 것이라는 의미로 보입니다)</em>.</p>\n</blockquote>\n<p>이 글의 저자는 이후에 다른 글 <a href="http://secretsofconsulting.blogspot.kr/2017/02/how-long-can-i-remain-ruby-java-c.html">\'How Long Can I Remain a [Ruby, Java, C++, Python, …]  Programmer?\'</a> 를 작성하여 더 깊게 생각할 거리를 던져주었습니다. 이 글의 후속편이라고 할 수 있겠지만, 굳이 번역하지는 않을거라 한번 읽어보시면 좋겠습니다. 저 글의 한줄 요약을 남겨드리자면 이렇습니다.</p>\n<blockquote>\n<p>"특정 언어의 프로그래머로 몇년 먹고살 수 있을지 전전긍긍하지 말고 ‘Programmer’ or ‘Problem-solver’ 같은 사람이 되어 살아남을 생각을 하라\'\'</p>\n</blockquote>',id:"/home/circleci/repo/src/pages/posts/2017-03-11-should-i-learn-c++-or-python-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-03-11",path:"/posts/should-i-learn-cpp-or-python-kor",title:"[번역] C++와 Python 중 무엇을 먼저 배울까?",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 포스트는  Ian C. Anderson…",html:'<ul>\n<li><strong>이 포스트는 <a href="https://twitter.com/IanCAnderson">Ian C. Anderson</a>의 <a href="https://robots.thoughtbot.com/beginners-mind">글</a>을 번역한 것입니다</strong></li>\n<li><strong>번역에 관한 감상 및 피드백은 작성자에게 큰 도움이 됩니다</strong></li>\n</ul>\n<hr>\n<p>저는 루비 프로그래머입니다. 저는 이 언어를 즐겨 쓰며, 직업적으로 소프트웨어를 만들면서 루비가 저의 호기심과 흥미를 충족시켜준다고 믿고 있습니다. 저는 매일 끊임없이 루비와 레일즈에 대해 배우고 있지만 이 언어와 플랫폼에 대해서는 잘 이해하고 있습니다.</p>\n<p>그러다가 최근에 하스켈을 배우기 시작했습니다. <a href="https://thoughtbot.com/">Thoughtbot</a>의 하스켈 프로젝트에 기여하고 싶었고, 제 시야를 확장해보고 싶었기 때문입니다.</p>\n<p>하스켈은 근본적으로 루비와 다릅니다. 순수한 함수형 언어이며 엄격한 정적 타입을 요구합니다. 루비가 동적 타입을 가지고 있고 함수형과는 거리가 먼 객체지향 언어라는 것과는 다릅니다. 제가 함수형 언어를 다루는 수준은 아주 미약합니다. 그래서 함수형 언어의 여러 개념과 하스켈이란 언어 자체가 저에게는 생소합니다.</p>\n<p>현 시점에서 하스켈 세계는 신비롭고 경이롭게 느껴집니다. 그래서 그런지 배우고자 하는 사람들에게는 동기부여와 흥분되는 기분을 가져다 줄 겁니다.</p>\n<h2 id="무한한-가능성"><a href="#%EB%AC%B4%ED%95%9C%ED%95%9C-%EA%B0%80%EB%8A%A5%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무한한 가능성</h2>\n<blockquote>\n<p>초심자의 마음속에는 많은 가능성이 자리잡고 있다, 그러나 전문가들은 그 가능성이 적다.(In the beginner’s mind there are many possibilities, but in the expert’s there are few.)</p>\n<p>— <em>Shunryu Suzuki, <a href="https://www.amazon.com/Zen-Mind-Beginners-Shunryu-Suzuki/dp/1590308492">Zen Mind, Beginner\'s Mind.</a></em></p>\n</blockquote>\n<p>이 인용문은 당신이 공부하고 있는 주제에 익숙해질 수록 점점 좁은 시야를 가지게 되는 것을 경계하고 있습니다. 저의 경우엔 문제 해결을 위한 만능 도구로서 루비를 갈고 닦으면서도, 언제나 제 기술적 선택에 만족하지 않도록 신경씁니다. 언제든지 더 나은 방법이 있다고 <em>믿으며</em> 그 방법을 찾아야 합니다.</p>\n<h2 id="전문가의-모순"><a href="#%EC%A0%84%EB%AC%B8%EA%B0%80%EC%9D%98-%EB%AA%A8%EC%88%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전문가의 모순</h2>\n<blockquote>\n<p>모순되게도 마치 좁은 시야와 선입견을 가지게 되는 것처럼, 아주 탄탄하게 쌓아올린 전문 지식은 퍼포먼스의 저하를 초래할 수 있다.(Paradoxically, the very underpinning of expertise can entail degradation in performance as well, such as tunnel vision and biases.)</p>\n<p>— <em>Itiel E. Dror, <a href="https://core.ac.uk/download/pdf/1717017.pdf">The paradox of human expertise: Why experts get it wrong</a></em></p>\n</blockquote>\n<p>지식이 늘어날 수록 무엇이 어떻게 동작하는 지에 대해 추측하는 일도 늘어납니다. 이런 선입견들은 전문가로서 효율적으로 정보를 처리하고 문제를 푸는데 능숙하게 만들어 줄 수도 있습니다. 그러나 "기본적인(defaults)" 해답은 전문가들에게 주어진 문제를 해결하기 위한 더 적절한 답을 고민하지 못하게 만들 수 있습니다. 전문가들의 뇌는 특정 분야에 특화되어 있습니다. 말하자면 좁고 엄격한 마음가짐을 가지게 된다는 겁니다.</p>\n<h2 id="정신적-기민함의-가치"><a href="#%EC%A0%95%EC%8B%A0%EC%A0%81-%EA%B8%B0%EB%AF%BC%ED%95%A8%EC%9D%98-%EA%B0%80%EC%B9%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정신적 기민함의 가치</h2>\n<blockquote>\n<p>지능의 척도는 변화할 수 있는 능력이다.(The measure of intelligence is the ability to change.)</p>\n<p>— <em>Albert Einstein</em></p>\n</blockquote>\n<p>저는 thoughbot의 <a href="https://thoughtbot.com/playbook#research">Research Trello board</a>가 생각났습니다. 우리는 이 장소를 우리가 진행하는 일이나 기술 스택의 변화를 실험하는 장소로 사용합니다. 우리는 어떤 툴을 사용하고 어떻게 사용하는지에 대해 고집스럽게 굴지만<em>(역주: 예를 들면 Thoughtbot의 개발자들은 대부분 Vim을 사용한다고 합니다)</em>, 언젠가 더 좋은 도구가 있다면 기꺼이 갈아탈 용의가 있습니다.  과학적 방법을 통해 지속적으로 우리 자신의 가설에 도전하는 것은, 우리가 주어진 문제를 해결하기 위해 현재와 미래에 걸쳐 최선의 도구와 기술을 사용하고 있다는 확신을 들게 합니다. 기술 분야에서 변화는 피할수 없습니다. 그러므로 이런 정신적 기민함은 굉장히 가치있는 자산입니다.</p>\n<h2 id="당신의-지혜-주머니를-키워라"><a href="#%EB%8B%B9%EC%8B%A0%EC%9D%98-%EC%A7%80%ED%98%9C-%EC%A3%BC%EB%A8%B8%EB%8B%88%EB%A5%BC-%ED%82%A4%EC%9B%8C%EB%9D%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>당신의 지혜 주머니를 키워라</h2>\n<blockquote>\n<p>… 몇몇 경우에 지혜롭게 모나드의 힘을 적용하면 우리는 중첩된 콜백을 풀어낼 수 있고, 코드의 일부분을 재사용가능하게 만들며, 전반적으로 우리의 프로그램을 더 좋게 만듭니다.</p>\n<p>— Tom Stuart, <a href="http://codon.com/refactoring-ruby-with-monads">Refactoring Ruby with Monads</a></p>\n</blockquote>\n<p><a href="https://en.wikipedia.org/wiki/Monad_(functional_programming)">모나드</a>는 함수형 프로그래밍의 추상 개념인데 하스켈에서 필수적입니다. <a href="http://codon.com/refactoring-ruby-with-monads">Tom의 발표</a>에서 모나드를 이용하여 이상한 루비 코드 덩어리들을 멋진 해법으로 바꾸는 세 가지 실전적인 예시를 볼 수 있습니다. Tom의 코드가 그가 경험한 함수형 프로그래밍의 도움을 받았다는 것은 자명합니다. 그는 평상시의 문제를 해결하기 위해 다른 개념을 빌려올 수 있다는 것을 보여주었습니다. 이상적인 루비 코딩 스타일을 유지하면서요.</p>\n<p>제가 하스켈 전문가가 될 수 있을까요? 아니면 제가 하스켈 프로젝트를 풀 타임으로 다루게 될까요? <a href="https://robots.thoughtbot.com/if-you-gaze-into-nil-nil-gazes-also-into-you">아마도요</a>. 만약 아니라고 해도 하스켈을 배운 경험이 무의미하다고 생각하진 않을 겁니다. 저는 제 지혜 주머니를 키우고 있고(I am adding to my bag of tricks), 그래서 다각도로 문제를 해결해볼 수 있습니다. 제가 어떤 레일즈 앱의 기능을 구현할 때 함수형 프로그래밍의 접근 방식이 저의 평소 객체지향적 코드보다 더 나을지 생각해 볼 것입니다.</p>\n<p>전문가가 되기 위해 분투하는 것은 가치있는 일입니다. 그 비결은 끊임없이 특정 경우에 더 나을 수도 있는 대안을 찾아가면서, 더욱 많은 지식과 경험을 흡수하는 것입니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>저도 루비 프로그래머입니다(쑥스럽지만 원본 글 첫머리를 빌려서 한마디 적어봅니다). 매일 새로운 것을 1이라도 알면 그 뒤에 알아야 할 것들이 10이 넘는 하루하루를 보내고 있습니다. 하지만 나름 재미있지요. 당장 저의 주력 언어라고 말 할 수 있는 루비는 아직 잘 다룬다고 생각하지 않아서 더 깊게, 깊게 파고들어야 한다고 생각하고 있었습니다.</p>\n<p>물론 이 글에서 말하고자 하는 주제는 이미 알고 있었습니다만 언제나 \'아직은 다른 언어나 개념을 접하기엔 좀 부족해..\' 라는 생각을 하면서 고개를 돌리지 않고 있습니다. 올해 안에는 적어도 Elixir나 Scala에 도전해보고 싶긴 합니다. 물론 루비 이외에 다른 도전은 언제나 하고 있지요. 바로 자바스크립트입니다.</p>\n<p>저에게는 너무나 변화가 빠른 언어이고, 겉으로 보기에는 별거 없어 보이지만 다루고자 하면 굉장히 복잡하고(+골때리고) 코드를 잘 짜기 위한 고민을 계속 해도 잘 되지 않는 언어입니다. 지금은 이 두 언어를 번갈아 익히는 것 만으로도 벅차네요.</p>\n<p>제가 본격적으로 제 자신을 \'개발자\' 라고 지칭할만한 일을 하게 된지 이제 1년이 되었습니다. 이 시점에서 이번 글은 다시 한번 끊임없는 향상심에 대해 환기시켜주는 글이었습니다. 다음 해에는 어떤 글을 남길 수 있을지 제 자신에게 조금 더 기대를 걸어봅니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-02-20-beginners-mind-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-20",path:"/posts/beginners-mind-kor",title:"[번역] 초심자의 마음가짐",tags:["Learning","Translation"],category:"Translation"}},{excerpt:"이 글은  Joël Quenneville 의  글 을 번역한 것입니다 번역 및 내용에 관한 피드백은 언제나 환영합니다 수 년에 걸쳐 저는  Elm 을 배워왔습니다. 보통 저는 새로운 언어를 배울 때 이러저러한 과정을 거칩니다: 튜토리얼을 따라가본다 많은 토이 프로젝트를 만든다 블로그 글을 읽는다 해당 언어의 주간 뉴스레터를 구독한다 그런데 기대하지 않던 순간에 제 고정관념을 바꾸는 일이 생겼습니다. 저는  elm-lang…",html:'<ul>\n<li>이 글은 <a href="https://twitter.com/joelquen">Joël Quenneville</a>의 <a href="https://robots.thoughtbot.com/learning-by-helping">글</a>을 번역한 것입니다</li>\n<li>번역 및 내용에 관한 피드백은 언제나 환영합니다</li>\n</ul>\n<hr>\n<p>수 년에 걸쳐 저는 <a href="http://elm-lang.org">Elm</a>을 배워왔습니다. 보통 저는 새로운 언어를 배울 때 이러저러한 과정을 거칩니다:</p>\n<ul>\n<li>튜토리얼을 따라가본다</li>\n<li>많은 토이 프로젝트를 만든다</li>\n<li>블로그 글을 읽는다</li>\n<li>해당 언어의 주간 뉴스레터를 구독한다</li>\n</ul>\n<p>그런데 기대하지 않던 순간에 제 고정관념을 바꾸는 일이 생겼습니다.</p>\n<p>저는 <a href="https://elmlang.herokuapp.com">elm-lang 슬랙 커뮤니티</a>에 가입하여 <code class="language-text">#beginners</code> 채널을 둘러보기 시작했습니다. 대부분의 질문이 "X를 위한 문법이 뭐죠?" 이거나 "Y를 하려면 어떻게 하죠?" 같은 질문이었습니다. 대부분은 공식 문서에 답이 적혀있는 질문들이었습니다.</p>\n<p>소프트웨어 산업에서 짬이 찬 대부분의 사람들과 같이, 저는 몇가지 기술을 연마해왔습니다:</p>\n<ul>\n<li>구글을 뒤적인다</li>\n<li>문서를 읽는다</li>\n<li>가설을 테스트하기 위한 작은 실험을 디자인한다</li>\n</ul>\n<p>![]({{ site.baseurl }}/assets/2017-02-13-sc1.png)</p>\n<p>사람들에게 그냥 "제발 그놈의 메뉴얼을 읽어보세요(<a href="https://ko.wikipedia.org/wiki/RTFM">RTFM</a>)", "구글은 여러분의 친구입니다" 혹은 "REPL(콘솔)에서 한번 쳐보세요" 같은 말을 하는게 편할 수도 있습니다. 그러나 이는 공감하기 힘들거나 자각하기 힘든 답변이 됩니다. 여러분이 당연하게 여기는 기술들은 다른 사람에게는 그렇지 않습니다. 특히 <code class="language-text">#beginners</code>  채널 같은곳에서 질문을 하는 사람들에게는요.</p>\n<p>그 대신에 저는 문서를 찾아서 해당 질문에 대해 적절한 답이 될 수 있는 부분의 링크를 공유해 주었습니다. 필요하다면 설명도 곁들였습니다. 그러면서 단순히 문법이나 함수에 대해 찾아주는 것을 넘어 더 개념적인 질문을 돕기 시작 했습니다:</p>\n<blockquote>\n<p>왜 컴파일러는 이벤트 핸들러를 위한 스니펫으로 타입 <code class="language-text">Html a</code> 를 쓰는 것을 좋아하지 않을까요?</p>\n</blockquote>\n<blockquote>\n<p><code class="language-text">&lt;select&gt;</code> 에다 이벤트를 어떻게 집어넣을 수 있나요?</p>\n</blockquote>\n<blockquote>\n<p><code class="language-text">type User = User String Int</code> 같은 중복은 어떻게 처리되나요?</p>\n</blockquote>\n<p>결과적으로 저는 빠르게 Elm의 문법과 코어 라이브러리에 관한 지식을 다질 수 있었습니다. 그리고 최근에 생겨난 <a href="https://robots.thoughtbot.com/elms-universal-pattern">패턴</a>에 대해 살펴보기 시작했습니다. 제가 전혀 몰랐던 라이브러리에 관해 도울 수도 있게 되었습니다.</p>\n<p>간단하게 <a href="https://ko.wikipedia.org/wiki/%ED%8D%BC%EC%A7%95">퍼즈 테스터</a>를 만들려면 어떻게 해야할까요? <code class="language-text">map</code> 작동에 대해서 알아야겠군요. JSON 디코더 3개를 엮으려 하신다구요? 아마 <code class="language-text">Json.Decode.map3</code> 함수가 있을걸요?</p>\n<p>점점 이런 작업이 편해지면서, 저는 단순히 문서만 살펴보는게 아니라 소스를 파고들어 왜 특정 행동이 특정 방법으로 작동하는지 설명하고자 하였습니다.</p>\n<p>시간이 흘러, 자주 질문이 들어온다고 느끼는 주제에 대해서 블로그 글도 작성했습니다. 이를테면 <a href="https://robots.thoughtbot.com/building-custom-dom-event-handlers-in-elm">\'커스텀 DOM 이벤트 핸들러를 작성하는 방법\'</a>처럼요.</p>\n<p>이러한 과정을 거치는 동안 <a href="https://robots.thoughtbot.com/beginners-mind">초심자의 마음가짐</a>을 유지하는 것은 중요합니다. 때때로, 질문에 대답하는 것은 함께 배워나가는 과정이었습니다. 저는 처음에는 답을 몰랐거나 아주 모호하게 이해하고 있었을 뿐이었지만 토론을 거쳐가면서 지식을 발전시킬 수 있었습니다. 다른 때엔 제가 대답할수 없었지만 지금은 알게 된 개념에 대해 설명하려고 노력했습니다. 겸손함과 \'잘 모르겠습니다\' 라고 말하는 능력은 질문 받는 상황(these situations)을 배움의 기회로 바꿀 수 있습니다.</p>\n<p>다른사람에게 조언하거나 도움을 주기 위해 "전문가"가 될 때까지 기다리지 마세요. 당신이 초보자라 하더라도 그 결과는 엄청납니다(The payoffs are massive). 끊임없이 배우고, 끊임없이 지식을 나누세요.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>사실 저는 Elm을 들어는 봤지만 제대로 사용해본 적은 없습니다. 함수형 프로그래밍의 개념에 대해서 가볍게 알아보고자 할 때 이러한게 있다 까지는 보았고, 호기심에 가벼운 튜토리얼을 따라가보았지만 아직 저에겐 너무 어려웠습니다.</p>\n<p>하지만 이 글의 내용은 Elm이랑 크게 관련 있는 것은 아니고, 개발자로서 끊임없이 배움의 과정을 걷는 사람들에게 생각할 거리를 준다는 느낌을 받아 번역을 해 보았습니다. 그래서 위의 Elm관련 번역은 부적절한 번역일 수 있으니 Elm을 사용해본 분들의 많은 조언 부탁드립니다.</p>\n<p>저 자신도 RORLAB 슬랙의 <code class="language-text">#question_answer</code> 채널에 질문이 올라오면 당장 제가 모르는 내용이라도 검색을 해 봅니다. 제가  답변했던 내용들 일부는 제가 실제로 해 본 것도 아니고, 구글에서 적절하게 검색하여 찾은 내용이지만 해당 질문을 한 회원은 문제를 해결할 수 있었습니다. 그러면서 제가 몰랐던 지식도 조금씩 알아나갈 수 있었고 개발 문서만 보는 것을 넘어서 소스를 들여다 보는데 거부감이 많이 줄어들게 되었습니다.</p>\n<p>이 글의 핵심은 마지막 문장이라 생각합니다. 저도 당연히 \'번역의 전문가\'가 아님에도 이러저러한 글을 번역해서 올리고 있습니다. 분명 더 예전에 번역했던 글들의 퀄리티를 생각하면 다시 하고 싶지만..시간상.. 넘어가도록 하고, 조금씩 찾아가고 물어가면서 퀄리티를 향상시키고자 하고 있습니다. 제가 작성하는 코드도 그렇게 되었으면 하는 바람입니다.</p>\n<p>다음에는 <a href="https://robots.thoughtbot.com/beginners-mind">\'초심가의 마음가짐\'</a>에 대한 글을 번역해보려 합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2017-02-13-learning-by-helping-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-13",path:"/posts/learning-by-helping-kor",title:"[번역] 도우면서 배우기",tags:["Learning","Translation"],category:"Translation"}}],Webpack:[{excerpt:"기존에  Learn Vue.js 2  강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다. application.rb…",html:'<p>기존에 <a href="https://laracasts.com/series/learn-vue-2-step-by-step/">Learn Vue.js 2</a> 강좌를 보면서 Form 제출에 대한 프로젝트를 레일즈로 작성하는 부분까지 따라했었는데, 이번에 다시 익혀보면서 백엔드 구축을 하나미로 작성해보았다. 그 과정에서 webpack을 밑바닥부터 설정하는 에피소드를 참고하여 하나미를 기반으로 설정해 보았다.</p>\n<h2 id="applicationrb-설정하기"><a href="#applicationrb-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>application.rb 설정하기</h2>\n<p>프로젝트를 작성하고 레일즈로 작성해놓았던 코드도 옮기고 한 건 좋은데 제대로 돌아가는 게 하나도 없었다. 브라우저 콘솔에 나타난 에러를 가만히 들여다보니 Content Security Policy를 미리 설정해둘 필요가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># application.rb</span>\n<span class="token comment"># ...</span>\n      security<span class="token punctuation">.</span>content_security_policy <span class="token string">%{\n        form-action \'self\';\n        frame-ancestors \'self\';\n        base-uri \'self\';\n        default-src \'none\';\n        script-src \'self\' \'unsafe-inline\' \'unsafe-eval\' https:;\n        connect-src \'self\';\n        img-src \'self\' https: data:;\n        style-src \'self\' \'unsafe-inline\' https:;\n        font-src \'self\';\n        object-src \'none\';\n        plugin-types application/pdf;\n        child-src \'self\';\n        frame-src \'self\';\n        media-src \'self\'\n      }</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p><code class="language-text">script-src</code> 부분에 주목해야한다. <code class="language-text">unsafe-inline</code> 뿐 아니라 <code class="language-text">unsafe-eval</code> 도 추가해주어야 한다. 그리고 애셋을 하나미에서 컴파일하지 않도록 설정해주어야 한다. 그렇지 않으면 자동적으로 하나미가 컴파일되지 않은 파일을 <code class="language-text">public</code> 폴더로 옮겨버린다. 나중에 다시 설정하는 법을 찾을 수 있을지 모르겠지만 <code class="language-text">fingerprint</code> 도 사용하지 않도록 체크해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby">    <span class="token comment">##</span>\n    <span class="token comment"># DEVELOPMENT</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:development</span> <span class="token keyword">do</span>\n      <span class="token comment"># Don\'t handle exceptions, render the stack trace</span>\n      handle_exceptions <span class="token keyword">false</span>\n\n      assets <span class="token keyword">do</span>\n        compile <span class="token keyword">false</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n\t<span class="token comment"># ...</span>\n\n    <span class="token comment">##</span>\n    <span class="token comment"># PRODUCTION</span>\n    <span class="token comment">#</span>\n    configure <span class="token symbol">:production</span> <span class="token keyword">do</span>\n      <span class="token comment"># scheme \'https\'</span>\n      <span class="token comment"># host   \'example.org\'</span>\n      <span class="token comment"># port   443</span>\n\n      assets <span class="token keyword">do</span>\n        <span class="token comment"># Don\'t compile static assets in production mode (eg. Sass, ES6)</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://www.rubydoc.info/gems/hanami-assets#Configuration</span>\n        compile <span class="token keyword">false</span>\n        \n        <span class="token comment"># Use fingerprint file name for asset paths</span>\n        <span class="token comment">#</span>\n        <span class="token comment"># See: http://hanamirb.org/guides/assets/overview</span>\n        fingerprint <span class="token keyword">false</span>\n        \n        <span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h2 id="yarn-init"><a href="#yarn-init" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn init</h2>\n<p>현재로서 <code class="language-text">npm</code> 보다 <code class="language-text">yarn</code> 이 더 나아보이니까 한번 적용해보았다. 이번 프로젝트와 관련된 모듈들은 다음의 커맨드로 설치하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># 필수 모듈\n$ yarn add axios vue\n\n# 개발용 모듈\n$ yarn add webpack babel-core babel-loader babel-preset-es2015 --dev</code></pre>\n      </div>\n<h2 id="webpack-설정-파일-생성"><a href="#webpack-%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack 설정 파일 생성</h2>\n<p>다음은 webpack을 설정하는 파일을 작성할 차례이다. 처음엔 아주 간단한 부분만 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascript/app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// 타겟 파일 지정</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  \tpath<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 번들된 파일 저장 위치, path 모듈을 불러와야한다.</span>\n  \tfilename<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span> <span class="token comment">// bundle.js를 많이 쓰는 경향이 있는데 이번엔 app.js로 지정</span>\n  \tpublicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이렇게 설정을 해 주고 <code class="language-text">app.js</code> 파일이 엔트리 포인트가 되도록 각 모듈 사이의 <code class="language-text">import</code> 나 <code class="language-text">export</code> 를 지정해준다.</p>\n<p>번들된 파일을 생성하기 위해선 다음 커맨드를 입력해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ node_modules/.bin/webpack --hide-modules\n# 계속 변화를 감지하기 위한 커맨드는 다음과 같다.\n$ node_modules/.bin/webpack --hide-modules --watch</code></pre>\n      </div>\n<p>하지만 저 커맨드를 굳이 매번 입력해 줄 필요는 없다. <code class="language-text">package.json</code> 파일에 스크립트를 설정해줄 수 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// package.json\n<span class="token punctuation">{</span>\n  // ...\n  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules"</span><span class="token punctuation">,</span>\n    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=development webpack --hide-modules --watch"</span><span class="token punctuation">,</span>\n    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"NODE_ENV=production webpack --hide-modules"</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><code class="language-text">NODE_ENV</code> 에 대해서는 나중에 살펴 볼 것이다.</p>\n<p>하나미의 <code class="language-text">application.html.erb</code> 파일에서는 <code class="language-text">javascript</code> 뷰 헬퍼로 자바스크립트 파일을 불러오는데, body  태그 마지막에 불러오도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<p>대신 css 파일은 수동으로 옮겨주어야 할 것이다. <code class="language-text">scss</code> 같은 preprocessing이 필요한 파일들은 어떻게 처리하는지 아직 실험해보지 못했다. 어차피 전부 webpack으로 해결할 수 있다.</p>\n<p>하지만 막상 번들된 파일을 불러와도 크롬에서 에러를 뿜으면서 랜더링이 되지 않았다. 왜인지 살펴보니 뷰의 모든 구성요소를 컴포넌트로 만들지 않고(Runtime-only), 기존에 작성한 html에 속성을 적용하려면(Full version) <a href="https://kr.vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only">별도의 설정</a>을 해 주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      <span class="token string">\'vue$\'</span><span class="token punctuation">:</span> <span class="token string">\'vue/dist/vue.esm.js\'</span> <span class="token comment">// \'vue/dist/vue.common.js\'  webpack 1용 입니다</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>이렇게 하면 생각하던대로 작동한다. 나중에 다른 프로젝트에서 Vue 컴포넌트로만 빌드를 하게 되면 이 설정은 입력할 필요가 없을 것이다.</p>\n<h2 id="환경-변수-관리"><a href="#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EA%B4%80%EB%A6%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>환경 변수 관리</h2>\n<p>윗부분에서 <code class="language-text">NODE_ENV</code> 와 관련된 스크립트를 언급했는데, 프로덕션 모드에서는 번들된 패키지를 더 압축해주고, 프로덕션 모드임을 지정해주는 설정이 가능하다. 별도로 패키지를 설정해 줄 필요는 없고, webpack 설정 파일 제일 아랫부분에 스크립트를 더 추가해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">\'production\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        warnings<span class="token punctuation">:</span> <span class="token boolean">false</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  \n  module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token string">\'process_env\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        NODE_ENV<span class="token punctuation">:</span> <span class="token string">\'"production"\'</span> <span class="token comment">// 오타가 아니고 따옴표 안에 겹따옴표 들어가는거 맞다</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2 id="babel-적용하기"><a href="#babel-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>babel 적용하기</h2>\n<p>최신 버전 크롬은 ES6 문법 대부분을 지원하기 때문에 별 신경을 쓰지 않아도 되곘지만.. 그래도 바벨을 적용해두는게 좋을 것이다. </p>\n<p>위에서 필요한 모듈은 설치되어있으니 <code class="language-text">.babelrc</code> 파일부터 지정해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json">// .babelrc\n<span class="token punctuation">{</span>\n  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">"modules"</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 바벨에서 제공하는 <a href="http://babeljs.io/docs/setup/#installation">공식 문서를 따라</a> webpack 설정 파일에 다음 코드를 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n      \ttest<span class="token punctuation">:</span> <span class="token regex">/\\.js$/</span><span class="token punctuation">,</span>\n      \texclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>\n      \tloader<span class="token punctuation">:</span> <span class="token string">"babel-loader"</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이제부터 webpack을 실행하면 바벨로 변환된 결과물이 나온다.</p>\n<h2 id="라이브러리-나누어서-적용하기"><a href="#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EB%82%98%EB%88%84%EC%96%B4%EC%84%9C-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>라이브러리 나누어서 적용하기</h2>\n<p>만약에 내가 자바스크립트 파일을 작성하다가 아주 일부분만 수정하고 다시 빌드를 해야하는 일이 있다고 할 때 계속 시간을 잡아먹는게 상당히 짜증날 것이다. 일단 기본적인 라이브러리는 내용이 변할 일이 없기 때문에 별도로 합쳐지도록 적용하고, 내가 실제로 작성하는 파일만 변화가 있을 때 다시 번들되도록 만들면 많은 시간을 단축할 수 있을 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token string">\'./apps/web/assets/javascripts/app.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'vue\'</span><span class="token punctuation">,</span> <span class="token string">\'axios\'</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">\'/public/assets\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].js\'</span><span class="token punctuation">,</span> <span class="token comment">// entry에 지정된 name(app, vendor)로 번들된 파일이 생성된다.</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'./public\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunckPlugin</span><span class="token punctuation">(</span>\n      <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'vendor\'</span> <span class="token punctuation">}</span> <span class="token comment">// vendor 파일 덩어리를 따로 보관하고 캐싱한다.</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>이러고 나서 빌드를 마치고 나면 <code class="language-text">public/assets</code> 폴더에는 <code class="language-text">app.js</code>, <code class="language-text">vendor.js</code> 두 개의 파일이 생성된다. 당연하게 레이아웃 페이지에서 <code class="language-text">vendor.js</code> 파일도 로딩해주어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"><span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      &lt;%= yield %>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n\n    &lt;%= javascript \'vendor\', \'app\' %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token comment">&lt;!-- ... --></span>\n</code></pre>\n      </div>\n<h2 id="css-파일도-관리하자"><a href="#css-%ED%8C%8C%EC%9D%BC%EB%8F%84-%EA%B4%80%EB%A6%AC%ED%95%98%EC%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 파일도 관리하자</h2>\n<p>이래저래 잘 작동하길래 슬슬 코드를 올려볼까 했더니 CSS 파일이 문제가 되었다. 물론 CSS 파일의 내용은 몇 줄 없지만, 매번 내용을 수정한 다음에 일일이 파일을 <code class="language-text">public</code> 폴더로 옮기는건 아주 비효율적이다. 당연히 webpack이 CSS 파일도 모아줄 수 있다.</p>\n<p>먼저 필요한 모듈을 설치한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ yarn add css-loader extract-text-webpack-plugin --dev</code></pre>\n      </div>\n<p>그리고 설정파일에 CSS 관련 모듈 규칙과 플러그인을 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'extract-text-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// ...</span>\n      <span class="token punctuation">{</span>\n        test<span class="token punctuation">:</span> <span class="token regex">/\\.css$/</span><span class="token punctuation">,</span>\n        loader<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          use<span class="token punctuation">:</span> <span class="token string">\'css-loader\'</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// ...</span>\n    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">\'styles.css\'</span><span class="token punctuation">)</span> <span class="token comment">// 원하는 이름으로 지정</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>이후 webpack을 실행하면 <code class="language-text">public/assets</code> 폴더에 <code class="language-text">styles.css</code> 파일이 추가된다. 나머지는 레이아웃 파일에서 이 파일을 불러오도록 만들면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n    &lt;%= stylesheet \'https://cdnjs.cloudflare.com/ajax/libs/bulma/0.3.1/css/bulma.min.css\' %>\n    &lt;%= stylesheet \'styles\' %>\n    <span class="token comment">&lt;!-- ... --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p>위 내용을 기반으로 작성한 간단한 프로젝트는 <a href="https://github.com/emaren84/hanami-webpack-config-example">Github</a>에 업로드 되어있다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-04-09-hanami-webpack-config/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-04-09",path:"/posts/hanami-webpack-config",title:"하나미 프로젝트에서 webpack 설정하기",tags:["Ruby","Hanami","Javascript","Webpack"],category:"Webpack"}}],Debugging:[{excerpt:"본 포스트는  Aaron Patterson 의  포스트 의 번역본입니다. 기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다. 피드백은 언제나 환영합니다. 저는 콘솔 디버거입니다  (역주1: 원 제목의 'puts debuggerer'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging…",html:'<ul>\n<li>본 포스트는 <a href="https://twitter.com/tenderlove">Aaron Patterson</a>의 <a href="https://tenderlovemaking.com/2016/02/05/i-am-a-puts-debuggerer.html">포스트</a>의 번역본입니다.</li>\n<li>기본적인 루비 및 레일즈 지식을 가지고 있는 독자 대상의 글입니다.</li>\n<li>피드백은 언제나 환영합니다.</li>\n</ul>\n<hr>\n<p>저는 콘솔 디버거입니다 <em>(역주1: 원 제목의 \'puts debuggerer\'를 의역하였습니다. 루비의 puts는 전달받은 인자를 표준 출력(stdout)해주는 메서드입니다. 이후에도 puts debugging은 모두 콘솔 디버깅으로 번역하겠습니다)</em>. 진짜 디버거( <code class="language-text">pry</code> , <code class="language-text">byebug</code> 등)를 사용하는 사람들을 폄하하고자 이 이야기를 하는게 아닙니다. 진짜 디버거는 아주 좋다고 생각하지만, 저는 하나라도 제대로 배울 시간을 들이지 못했습니다. 매번 한 개라도 써보려고 하다가 결국엔 한동안 사용하지 않고, 다시 사용방법을 배워야만 합니다. 어쨌든, 이번 기회에 여러분에게 콘솔 디버깅을 할 때 사용하는 트릭을 좀 알려드리고자 합니다. 저는 이 트릭들을 무언가가 어떻게 작동하는지 이해가 되지 않을때나 작동 원리를 더 알고싶을 때 사용합니다. 아래에 이야기하게 될 대부분의 것들은 <em>절대로</em> 최선의 방법(best practice)가 아니며 여러분들은 디버깅 세션이 끝나면 절대 이 코드들을 남겨두어선 안됩니다. 그러나 여러분이 <strong>무엇을 디버깅하던지</strong> 아주 유용하다고 생각합니다. 정말로 뭐든지요. 전역 변수, 메서드 재정의, 조건문 추가, 불러오기 경로 수정, 몽키 패칭, 콜 스택 출력 등 <strong>뭐든지요</strong>.</p>\n<p>저는 이 포스트에서 최대한 실제 접하는 예시들을 보여드리고 싶었습니다. 하지만 대부분의 예시들은 제가 레일즈의 보안 이슈를 디버깅하려고 할 때 나온 것들이라서, 이 코드의 테크닉은 재활용하셔도 좋지만 <strong>코드 전체를 그대로 쓰시면 안됩니다.</strong> 제가 디버깅하려는 코드들은 정상적으로 동작하지 않습니다. 거기다 이 코드를 사용하시는걸 원치도 않습니다.</p>\n<p>매 섹션에 제가 겪었던 문제들을 제목으로 적어두었으며, 내용 부분에 제가 사용한 해결책을 적어두었습니다.</p>\n<h2 id="어디에-문제가-있는진-알겠는데-어떻게-거기까지-가야할지-모르겠다"><a href="#%EC%96%B4%EB%94%94%EC%97%90-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%9E%88%EB%8A%94%EC%A7%84-%EC%95%8C%EA%B2%A0%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B1%B0%EA%B8%B0%EA%B9%8C%EC%A7%80-%EA%B0%80%EC%95%BC%ED%95%A0%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다</h2>\n<p>가끔 저는 문제가 어딨는지는 알지만 어떻게 그 부분까지 가는지 모르는 이슈들을 디버깅할 때가 있습니다. 이럴 때마다 저는 <code class="language-text">puts caller</code> 를 넣어서 콜 스택을 끄집어냅니다.</p>\n<p>예를 들어 제가 이런 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span> h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span> <span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>여기서 저는 기본 블록이 어떻게 호출되는지 알고 싶을 때 이렇게 합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>위의 코드는 90개의 해시 태그를 출력하고 콜 스택을 출력한 뒤에, 나머지 90개의 해시 태그를 출력할 겁니다. 해시 태그는 여러번 호출될 때를 대비해서 콜 스택을 쉽게 구분하기 위해 넣어두었습니다. 참고로 이걸 "해시 태그"라고 부르는건 여러분을 골려주려고 그러는 겁니다.</p>\n<p>저는 이 방법을 꽤 자주 사용하기 때문에 Vim 단축키를 지정해두었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">&quot; puts the caller\nnnoremap &lt;leader&gt;wtf oputs &quot;#&quot; * 90&lt;c-m&gt;puts caller&lt;c-m&gt;puts &quot;#&quot; * 90&lt;esc&gt;</code></pre>\n      </div>\n<p>이렇게 하면 <code class="language-text">&lt;leader&gt;wtf</code> 키 조합으로 커서가 있는 위치 바로 밑에 디버깅 코드를 삽입합니다.</p>\n<h3 id="콜-스택을-한-번만-출력하고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%95%9C-%EB%B2%88%EB%A7%8C-%EC%B6%9C%EB%A0%A5%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 한 번만 출력하고 싶어</h3>\n<p>그냥 콜 스택을 출력한 뒤에 <code class="language-text">exit!</code> 를 사용하거나, <code class="language-text">raise</code> 를 호출하세요. <code class="language-text">raise</code> 는 예외를 출력할거고, 어쨌든 콜 스택을 볼 수 있을겁니다.</p>\n<h3 id="콜-스택을-특정-경우에만-보고-싶어"><a href="#%EC%BD%9C-%EC%8A%A4%ED%83%9D%EC%9D%84-%ED%8A%B9%EC%A0%95-%EA%B2%BD%EC%9A%B0%EC%97%90%EB%A7%8C-%EB%B3%B4%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>콜 스택을 특정 경우에만 보고 싶어</h3>\n<p>이건 그냥 디버깅 코드니까 여러분이 하고싶은대로 하시면 됩니다. 예를 들어 제가 해시에 무언가를 추가할 때마다 콜 스택을 호출하고 싶다고 한다면, 이렇게 하면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">LOOKUP</span>\t\t<span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>h<span class="token punctuation">,</span> k<span class="token operator">|</span>\n  <span class="token keyword">unless</span> k<span class="token punctuation">.</span>blank<span class="token operator">?</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    h<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">Type</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>어차피 전 이 코드를 없애버릴거니까 어떤 이상한 조건문도 마음대로 추가할 수 있지요!</p>\n<h2 id="메서드를-호출했는데-이게-어디에-있는건지-모르겠다"><a href="#%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메서드를 호출했는데, 이게 어디에 있는건지 모르겠다</h2>\n<p>메서드를 호출했는데 그 메서드가 어디에 구현되어있는지 모를 때, 저는 <code class="language-text">source_location</code> 메서드와 함께 <code class="language-text">method</code> 메서드를 사용합니다. 예를 들어 (레일즈) 컨트롤러 안에 있는 액션이 <code class="language-text">render</code> 메서드를 호출하고 있을 때, 저는 그 메서드를 어디서 호출하는지 알고 싶었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿔보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>호출해보도록 하지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ curl http://localhost:3000/users/xxxx</code></pre>\n      </div>\n<p>그러면 로그에는 이렇게 출력됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/instrumentation.rb&quot;, 40]\nCompleted 500 Internal Server Error in 35ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제 저는 <code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L40">instrumentation.rb 파일의 40번째 줄</a>에 있다는 것을 알게 되었습니다.</p>\n<h2 id="code-classlanguage-textsupercode-메서드를-호출했는데-그게-어디에-있는건지-모르겠다"><a href="#code-classlanguage-textsupercode-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EA%B7%B8%EA%B2%8C-%EC%96%B4%EB%94%94%EC%97%90-%EC%9E%88%EB%8A%94%EA%B1%B4%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">super</code> 메서드를 호출했는데 그게 어디에 있는건지 모르겠다</h2>\n<p><code class="language-text">render</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/instrumentation.rb#L43">super를 호출한다는 걸</a> 알게 되었습니다만, 저는 그게 어디에 구현되어있는지 모릅니다. 이 경우에 <code class="language-text">method</code> 의 리턴 값에 <code class="language-text">super_method</code> 를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  render params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>위의 코드를 이렇게 바꿉니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p <span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:render</span><span class="token punctuation">)</span><span class="token punctuation">.</span>super_method<span class="token punctuation">.</span>source_location\n  redner params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>같은 요청을 해 보면 이런 결과를 얻을 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#show as */*\n  Parameters: {&quot;id&quot;=&gt;&quot;xxxx&quot;}\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_controller/metal/rendering.rb&quot;, 34]\nCompleted 500 Internal Server Error in 34ms (ActiveRecord: 0.0ms)</code></pre>\n      </div>\n<p>이제야 <code class="language-text">super</code> 가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_controller/metal/rendering.rb#L34">여기로 가는 게</a> 보입니다. 이 메서드는 마찬가지로 <code class="language-text">super</code> 를 호출하지만, 그냥 위의 작업을 반복하여(아니면 그냥 loop를 쓰면 됩니다!) 제가 진짜 알아보고자 하는 메서드를 찾을 수 있습니다.</p>\n<h2 id="code-classlanguage-textmethodcode-메서드의-구현체를-찾고자-한다면"><a href="#code-classlanguage-textmethodcode-%EB%A9%94%EC%84%9C%EB%93%9C%EC%9D%98-%EA%B5%AC%ED%98%84%EC%B2%B4%EB%A5%BC-%EC%B0%BE%EA%B3%A0%EC%9E%90-%ED%95%9C%EB%8B%A4%EB%A9%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">method</code> 메서드의 구현체를 찾고자 한다면?</h2>\n<p>때때로 <code class="language-text">method</code> 를 이용한 트릭이 작동하지 않을 때가 있습니다. 제가 알아보려는 객체가 자신만의 <code class="language-text">method</code> 메서드를 구현하고 있기 때문입니다. 예를 들어 저는 <code class="language-text">request</code> 객체에 <code class="language-text">headers</code> 메서드가 구현된 위치를 찾고자 할 때 이런 코드를 사용했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  p request<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>제가 요청을 보내면 이런 에러가 뜹니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">ArgumentError (wrong number of arguments (given 1, expected 0)):\n  app/controllers/users_controller.rb:5:in `index&#39;</code></pre>\n      </div>\n<p>이 경우는 <code class="language-text">request</code> 객체가 자신만의 <code class="language-text">method</code> 를 따로 구현하고 있기 때문입니다. <code class="language-text">headers</code>  메서드를 찾아내기 위해 메서드를 <code class="language-text">Kernel</code> 로부터 분리하고 <code class="language-text">request</code> 객체에 다시 바인드 한 뒤 실행해보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>요청을 다시 해보면 결과가 다르게 나옵니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Processing by UsersController#index as */*\n[&quot;/Users/aaron/git/rails/actionpack/lib/action_dispatch/http/request.rb&quot;, 201]</code></pre>\n      </div>\n<p>이제서야 <code class="language-text">headers</code> 메서드가 <a href="https://github.com/rails/rails/blob/6fcc3c47eb363d0d3753ee284de2fbc68df03194/actionpack/lib/action_dispatch/http/request.rb#L201">여기에</a> 구현되어 있다는 것을 발견했습니다.</p>\n<p>심지어 <code class="language-text">method</code> 메서드의 구현체를 찾을 수도 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> index\n  method <span class="token operator">=</span> <span class="token constant">Kernal</span><span class="token punctuation">.</span><span class="token function">instance_method</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span>\n  p method<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token symbol">:method</span><span class="token punctuation">)</span><span class="token punctuation">.</span>source_location\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="또-뭔가-호출했는데-이게-어딨는지-모르겠다"><a href="#%EB%98%90-%EB%AD%94%EA%B0%80-%ED%98%B8%EC%B6%9C%ED%96%88%EB%8A%94%EB%8D%B0-%EC%9D%B4%EA%B2%8C-%EC%96%B4%EB%94%A8%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>(또) 뭔가 호출했는데 이게 어딨는지 모르겠다</h2>\n<p>가끔 당장 사용하고 있는 메서드가 실제로는 문제의 본질이 아닐 수 있습니다. 그래서 <code class="language-text">method</code> 메서드를 사용하는 트릭은 별 도움이 안될 겁니다. 이럴 때엔 저는 <code class="language-text">TracePoint</code> 라고 하는 더 큰 추적기(a larger hammer)를 사용합니다. <code class="language-text">render</code> 메서드로부터 호출 된 <em>모든</em> 메서드의 리스트를 추출하기 위해 다시 한번 예를 들어보겠습니다. 리스트에 보이는 메서드들은 <code class="language-text">render</code> 메서드가 직접 호출한 것은 아니지만 어딘가로부터 호출 된 것입니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># GET /users</span>\n<span class="token comment"># GET /users.json</span>\n<span class="token keyword">def</span> index\n  <span class="token variable">@users</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>all\n  tp <span class="token operator">=</span> <span class="token constant">TracePoint</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token symbol">:call</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>x<span class="token operator">|</span>\n    p x\n  <span class="token keyword">end</span>\n  tp<span class="token punctuation">.</span>enable\n  render <span class="token string">\'index\'</span>\n<span class="token keyword">ensure</span>\n  tp<span class="token punctuation">.</span>disable\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>저기 위치한 <code class="language-text">TracePoint</code> 는 모든 "호출(<code class="language-text">:call</code>)" 이벤트마다 작동하고, 블록은 메서드 이름과 호출된 위치를 출력할 것입니다. 여기서 "호출" 이라 함은 루비 메서드가 호출되는 경우를 말합니다(C 메서드는 제외). 만약 C 메서드가 호출되는 것을 보고 싶으시다면 <code class="language-text">:c_call</code> 을 사용하세요. 이 예시는 <em>엄청난 양의</em> 결과가 출력될겁니다. 저는 호출될 메서드가 꽤 적거나, 도대체 어디부터 찾아봐야 할지 모를 때 이 방법을 사용합니다.</p>\n<h2 id="예외가-일어나는-것은-알겠지만-어디서-발생하는지-모르겠다"><a href="#%EC%98%88%EC%99%B8%EA%B0%80-%EC%9D%BC%EC%96%B4%EB%82%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%95%8C%EA%B2%A0%EC%A7%80%EB%A7%8C-%EC%96%B4%EB%94%94%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>예외가 일어나는 것은 알겠지만, 어디서 발생하는지 모르겠다</h2>\n<p>예외가 발생할 때 <em>실제로</em> 어디서 예외가 발생했는지 모를 때가 있습니다. 이 예시는 레일즈 3.0.0을 기준으로 작성되었지만(참고로 이 문제는 수정되었습니다), 일단 이런 코드가 있다고 해보죠.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> <span class="token constant">Logger</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token variable">$stdout</span>\n<span class="token constant">User</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>execute <span class="token string">"oh no!"</span>\n</code></pre>\n      </div>\n<p>SQL은 작동하지 않을 테고, 예외가 일어날 겁니다. 그렇다면 예외가 어떻게 발생하는지 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>여러분이 추적 내역(backtrace) 을 읽어보셨다면 <em>(역주2: backtrace하면 역추적 이라는 말이 직역하기는 좋지만, 보통 루비에서 backtrace를 떠올릴 때 콘솔에 뜨는 십수 줄의 추적 내역이 연상될 때가 많아서 추적 내역으로 번역하였습니다)</em>, 예외가 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L202">abstract_adapter.rb의 202번째 줄</a>에서 발생했다는 것을 알 수 있습니다. 그러나 이 코드는 <a href="https://github.com/rails/rails/blob/9891ca8/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb#L199-L202">예외가 발생한 상황에서 다시 예외를 일으키도록</a> 되어있는게 보일 겁니다. 그렇다면 실제로는 어디서 예외가 일어난 걸까요? 정답을 찾기 위해 <code class="language-text">puts</code> 를 사용하거나 루비의 <code class="language-text">-d</code> 플래그를 사용할 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ bundle exec ruby -d script/rails runner test.rb</code></pre>\n      </div>\n<p><code class="language-text">-d</code> 플래그는 경고를 활성화하고 모든 예외 발생을 출력합니다. 네, 실제로는 엄청나게 많은 양의 결과물이 출력되겠지요. 그러나 끝부분을 살펴보시면 이렇게 되어있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `NameError&#39; at activesupport-3.0.0/lib/active_support/core_ext/module/remove_method.rb:3 - method `_validators&#39; not defined in Class\nException `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error\nException `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error\n  SQL (0.1ms)  oh no!\nSQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nException `ActiveRecord::StatementInvalid&#39; at railties-3.0.0/lib/rails/commands/runner.rb:48 - SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no!\nactiverecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:202:in `rescue in log&#39;: SQLite3::SQLException: near &quot;oh&quot;: syntax error: oh no! (ActiveRecord::StatementInvalid)\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/abstract_adapter.rb:194:in `log&#39;\n\tfrom activerecord-3.0.0/lib/active_record/connection_adapters/sqlite_adapter.rb:135:in `execute&#39;\n\tfrom test.rb:6:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `eval&#39;\n\tfrom railties-3.0.0/lib/rails/commands/runner.rb:48:in `&lt;top (required)&gt;&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `require&#39;\n\tfrom railties-3.0.0/lib/rails/commands.rb:39:in `&lt;top (required)&gt;&#39;\n\tfrom script/rails:6:in `require&#39;\n\tfrom script/rails:6:in `&lt;main&gt;&#39;</code></pre>\n      </div>\n<p>실제 예외는 여기서 발생했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at sqlite3-1.3.11/lib/sqlite3/database.rb:91 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>그리고 여기서 다시 예외가 일어났지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">Exception `SQLite3::SQLException&#39; at activesupport-3.0.0/lib/active_support/notifications/instrumenter.rb:24 - near &quot;oh&quot;: syntax error</code></pre>\n      </div>\n<p>예외가 발생할 때 래핑된 뒤 다시 예외가 발생하는 경우에는 <em>반드시</em> 본래의 추적 내역을 노출해야 합니다. 그러므로 이 경우는 명백히 버그지만, 실제로 버그는 고쳐졌으며, 우리는 언젠가 또 이런 경우가 발생했을 때 해결하는 법을 알게 되었습니다.</p>\n<h3 id="커맨드-라인-도구를-code-classlanguage-text-dcode-플래그와-함께-사용하여-실행"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C-%EB%9D%BC%EC%9D%B8-%EB%8F%84%EA%B5%AC%EB%A5%BC-code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EC%99%80-%ED%95%A8%EA%BB%98-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%8B%A4%ED%96%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드 라인 도구를 <code class="language-text">-d</code> 플래그와 함께 사용하여 실행</h3>\n<p>위의 기술을 RSpec 테스트에 적용하고 싶으시다면 이렇게 하시면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -d -S rspec</code></pre>\n      </div>\n<h3 id="code-classlanguage-text-dcode-플래그는-사용하고-싶은데-프로세스를-실행하는-방법을-모르겠다"><a href="#code-classlanguage-text-dcode-%ED%94%8C%EB%9E%98%EA%B7%B8%EB%8A%94-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80%EB%8D%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%9D%84-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">-d</code> 플래그는 사용하고 싶은데 프로세스를 실행하는 방법을 모르겠다</h3>\n<p>Rake 테스트 작업은 기본적으로 <a href="https://github.com/ruby/rake/blob/3c4fe3e25e5ab6b052f9e81bc2920ca4b4fc1094/lib/rake/testtask.rb#L105">서브 프로세스 안에서 당신의 테스트를 실행합니다</a>. 말인 즉슨 <code class="language-text">ruby -d -S rake</code> 같은 커맨드를 입력해도 서브 프로세스 안에 있는 여러분의 테스트에는 플래그가 적용되지 않는다는 뜻입니다. 이 경우 저는 <code class="language-text">RUBYOPT</code> 환경 변수를 사용합니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC okokok (master)]$ RUBYOPT=-d bundle exec rake test</code></pre>\n      </div>\n<p><code class="language-text">RUBYOPT</code> 환경 변수는 쉘에서 실행된 모든 루비 프로그램에 적용되고, 심지어 rake로부터 호출 된 서브 쉘에도 적용됩니다. 이를 응용하면 <code class="language-text">rspec</code> 커맨드를 이렇게 다시 써볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=-d rspec</code></pre>\n      </div>\n<h2 id="이-객체는-어디에서-온-걸까"><a href="#%EC%9D%B4-%EA%B0%9D%EC%B2%B4%EB%8A%94-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%98%A8-%EA%B1%B8%EA%B9%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이 객체는 어디에서 온 걸까?</h2>\n<p>보통은 콜 스택을 출력하여 객체가 어디에서 왔는지 찾습니다. 하지만 가끔 객체가 콜 스택 바깥에 위치한 경우도 있습니다. 이럴 때는 객체가 어디에서 호출된 건지 찾기 힘듭니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  puts caller\n  puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  p x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>이전에 "어디에 문제가 있는진 알겠는데, 어떻게 거기까지 가야할지 모르겠다" 파트에서 <code class="language-text">caller</code> 를 사용하는 방법, "wtf  트릭" <em>(역주3: 글쓴이는 해당 방법을 소개할 때 Vim 단축키를 <code class="language-text">&lt;leader&gt;wtf</code> 으로 설정하였습니다. 그래서 이를 "wtf trick"으로 명명한 것으로 보입니다)</em>을 보여드렸습니다.  여기서 저는 <code class="language-text">x</code> 라는 값이 어떻게 할당되었는지 신경쓰였는데요, <code class="language-text">foo</code> 메서드를 따라가다보면 <code class="language-text">baz</code> 메서드에서 값을 가져오는 것을 볼 수 있습니다. 거대한 코드 베이스에서는 형제 트리에서 모든 호출과 로직을 따라가는게 아주 어렵습니다(코드를 자료구조의 그래프라고 생각한다면, <code class="language-text">foo</code> 메서드는 두 개의 자손이 있는 겁니다. <code class="language-text">baz</code> 와 <code class="language-text">bar</code> 이죠. 그래서 <code class="language-text">baz</code>가 <code class="language-text">bar</code> 의 형제라고 여길 수 있습니다). 저는 게으르기 때문에 객체가 어디서 왔는지 찾기 위해 모든 메서드를 뒤지고 싶지 않았습니다. 그래서 저는 루비의 객체 할당 추적기(object allocation tracer)를 사용하는걸 좋아합니다. 루비의 할당 추적기는 루비 2.1버전부터 사용할 수 있습니다(확실한 것은 아닙니다). 제가 이 방법을 사용할 때는 가능한 빨리 <code class="language-text">require</code> 한 뒤에 활성화합니다. 그러면 제가 찾고자 하는 할당 위치를 찾을 수 있지요.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n\n<span class="token keyword">def</span> foo\n  x <span class="token operator">=</span> baz\n  bar x\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> bar x\n  p <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> baz<span class="token punctuation">;</span> zot<span class="token punctuation">;</span>\t\t<span class="token keyword">end</span>\n<span class="token keyword">def</span> zot<span class="token punctuation">;</span> <span class="token builtin">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>\t<span class="token class-name">end</span>\n\nfoo\n</code></pre>\n      </div>\n<p>프로그램을 실행하면 이런 결과를 얻습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby x.rb\n{&quot;x.rb&quot;=&gt;14}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p><code class="language-text">x</code> 객체가 해당 파일의 14번째 줄에 있다는 것을 알게 되었습니다. 그러면 해당 라인으로 가서 "wtf 트릭" 을 반복하거나 프로그램에 무슨 문제가 있는지 발견할 때 까지 이 방법을 반복합니다.</p>\n<p>저는 보통 객체 추적을 가능한 빠르게 시작합니다. 제 객체가 어디에 할당되었는지 모르니까요. 이런 추적은 프로그램의 속도를 떨어뜨리지만, 디버깅 중에는 신경쓸 필요가 없습니다.</p>\n<h2 id="나는-code-classlanguage-textrequirecode-를-진짜-진짜-빨리-하고-싶어"><a href="#%EB%82%98%EB%8A%94-code-classlanguage-textrequirecode-%EB%A5%BC-%EC%A7%84%EC%A7%9C-%EC%A7%84%EC%A7%9C-%EB%B9%A8%EB%A6%AC-%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%96%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나는 <code class="language-text">require</code> 를 진짜 진짜 빨리 하고 싶어</h2>\n<p>바로 위에 보여드린 기술은 오로지 객체가 <code class="language-text">trace_object_allocations_start</code> 메서드가 호출되고 난 뒤에 할당된 이후의 정보만 제공합니다. 파일이 <code class="language-text">require</code> 되는 순간에 객체가 할당되어서, 도대체 무슨 파일이고 <em>어디에 있는지</em> 모를 때가 있습니다. 그래서  프레임워크 안에 있는 어떤 파일이라도 로드되기 전에 코드를 좀 실행시킬 필요가 있습니다. 이럴 때 저는 <code class="language-text">-r</code> 플래그를 사용한 뒤 스크립트를 작성합니다.</p>\n<p>우리가 <code class="language-text">User::BLACKLISTED_CLASS_METHODS</code> 의 할당 위치를 찾는 코드를 작성했다고 칩시다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'active_record\'</span>\n\n<span class="token constant">AciveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>establish_connection adapter<span class="token punctuation">:</span> <span class="token string">\'sqlite3\'</span><span class="token punctuation">,</span> databse<span class="token punctuation">:</span> <span class="token string">\':memory:\'</span>\n\n<span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">.</span>connection<span class="token punctuation">.</span>instance_eval <span class="token keyword">do</span>\n  create_table <span class="token symbol">:users</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span><span class="token punctuation">;</span> <span class="token keyword">end</span>\np <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourcefile</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">ObjectSpace</span><span class="token punctuation">.</span><span class="token function">allocation_sourceline</span><span class="token punctuation">(</span><span class="token constant">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">BLACKLISTED_CLASS_METHODS</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>그런데 우리는 이 어떤 파일이 이 상수를 할당했는지 모르고, 찾는 방법을 떠올리고 싶지도 않을 때가 있습니다(네, 이건 좀 억지로 꾸며낸 경우입니다). 이럴 때 <code class="language-text">y.rb</code> 라는 파일을 작성해 보겠습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'objspace\'</span>\n<span class="token constant">ObjectSpace</span><span class="token punctuation">.</span>trace_object_allocations_start\n</code></pre>\n      </div>\n<p>그리고 저는 루비의 커맨드 라인 인자를 넣어서 이 파일을 실행할 때 바로 <code class="language-text">require</code> 하도록 만들었습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">[aaron@TC tlm.com (master)]$ ruby -I. -ry x.rb\n{&quot;/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/activerecord-5.0.0.beta1/lib/active_record/attribute_methods.rb&quot;=&gt;35}\n[aaron@TC tlm.com (master)]$</code></pre>\n      </div>\n<p>인자들을 찬찬히 살펴보면 <code class="language-text">-I.</code> 는 ". 를 불러오기 경로로 추가하고", <code class="language-text">-ry</code> 는 <code class="language-text">require &#39;y&#39;</code> 와 같으며, 이후에 <code class="language-text">x.rb</code> 를 실행하는 겁니다. 그러니 <code class="language-text">.</code> 가 불러오기 경로로 추가되었고, <code class="language-text">x.rb</code> 가 실행되기도 전에 <code class="language-text">y.rb</code> 파일이 <code class="language-text">require</code> 되었습니다. 그 결과로 <code class="language-text">BLACKLISTED_CLASS_METHODS</code> 가 <code class="language-text">attribute_methods.rb</code> 의 35번째 줄에 에 할당되어 있다는 사실을 알 수 있습니다. 만약 서브 프로세스 안에서 실행되는 코드에 이 기술을 적용하고자 한다면 <code class="language-text">RUBYOPT</code> 를 함께 쓰면 됩니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ RUBYOPT=&#39;-I. -ry&#39; rake test</code></pre>\n      </div>\n<h2 id="객체가-어딘가에서-수정되었는데mutated-그-위치를-모르겠다"><a href="#%EA%B0%9D%EC%B2%B4%EA%B0%80-%EC%96%B4%EB%94%98%EA%B0%80%EC%97%90%EC%84%9C-%EC%88%98%EC%A0%95%EB%90%98%EC%97%88%EB%8A%94%EB%8D%B0mutated-%EA%B7%B8-%EC%9C%84%EC%B9%98%EB%A5%BC-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>객체가 어딘가에서 수정되었는데(mutated), 그 위치를 모르겠다</h2>\n<p>객체를 살펴보다 보면 이게 수정되고 있다는건 알겠는데, 어디서 수정되고 있는 지 모를 때가 있습니다. 이 때는 객체에 <code class="language-text">freeze</code> 를 호출한 뒤에, 테스트를 실행해보고, 어디서 예외가 발생하는지 살펴보면 됩니다. 그 예로, 제가 <a href="https://github.com/rails/rails/blob/38b5af6595338cb2212980062d9aaf51241878cc/activesupport/lib/active_support/concurrency/share_lock.rb#L28">어디에서 특정 변수가 수정되는지 알고 싶을 때</a>가 있습니다. 코드를 살펴보니 이 변수가 수정된다는 것은 알고 있었지만, 어디서부터 수정이 일어나는지 알지 못했습니다. 그래서 코드를 이렇게 수정해봤습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> initialize\n  <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n  <span class="token variable">@cv</span> <span class="token operator">=</span> new_cond\n\n  <span class="token variable">@sharing</span> <span class="token operator">=</span> <span class="token builtin">Hash</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n  <span class="token variable">@sharing</span><span class="token punctuation">.</span>freeze\n  <span class="token variable">@waiting</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n  <span class="token variable">@exclusive_thread</span> <span class="token operator">=</span> <span class="token keyword">nil</span>\n  <span class="token variable">@exclusive_depth</span> <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 나서 레일즈 서버를 실행하면 예외가 발생하며 추적 내역이 보여집니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">active_support/concurrency/share_lock.rb:151:in `delete&#39;: can&#39;t modify frozen Hash (RuntimeError)\n\tfrom active_support/concurrency/share_lock.rb:151:in `yield_shares&#39;\n\tfrom active_support/concurrency/share_lock.rb:79:in `block in stop_exclusive&#39;</code></pre>\n      </div>\n<p>이제 처음에 수정이 발생한 곳을 발견했습니다. 만약 이 부분이 여러분이 찾고자 하는 부분이 아니라면 작성해둔 <code class="language-text">freeze</code> 를 삭제한 뒤에 내역을 따라가서 수정된 부분 이후에 다시 덧붙이면 됩니다.</p>\n<h2 id="교착-상태deadlock에-빠졌는데-어디서-문제가-생겼는지-모르겠다"><a href="#%EA%B5%90%EC%B0%A9-%EC%83%81%ED%83%9Cdeadlock%EC%97%90-%EB%B9%A0%EC%A1%8C%EB%8A%94%EB%8D%B0-%EC%96%B4%EB%94%94%EC%84%9C-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%83%9D%EA%B2%BC%EB%8A%94%EC%A7%80-%EB%AA%A8%EB%A5%B4%EA%B2%A0%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>교착 상태(deadlock)에 빠졌는데, 어디서 문제가 생겼는지 모르겠다</h2>\n<p>저에게 스레드와 관련된 이슈가 발생했고, 문제를 어디에서 해결해야할 지 몰랐을 때, 저는 살아있는 스레드를 검사해보기 위해 코드를 좀 추가했습니다. 예를 들어 저는 <a href="https://github.com/rails/rails/issues/23503">이 이슈를 디버깅하고 있었습니다</a>. 애플리케이션 서버가 막혀있는데, 대체 어디서 문제가 발생했는지 몰랐습니다. 그래서 어디서 스레드가 막혀있는지 찾기 위해 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token builtin">Thread</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    p t\n    puts t<span class="token punctuation">.</span>backtrace\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 이렇게 실행했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ ruby -I. -rx bin/rails s</code></pre>\n      </div>\n<p>이제 앱 서버가 막혔을 때, 컨트롤+T 키를 누르면(죄송하지만 OS X에서만 작동합니다, 리눅스에서는 <code class="language-text">kill</code> 을 사용해야 합니다), 모든 스레드의 추적 내역을 볼 수 있습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">##########################################################################################\n#&lt;Thread:0x007f90bc07cb38 run&gt;\nomglolwut/x.rb:7:in `backtrace&#39;\nomglolwut/x.rb:7:in `block (2 levels) in &lt;top (required)&gt;&#39;\nomglolwut/x.rb:4:in `each&#39;\nomglolwut/x.rb:4:in `block in &lt;top (required)&gt;&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `join&#39;\ngems/puma-2.16.0/lib/rack/handler/puma.rb:43:in `run&#39;\ngems/rack-2.0.0.alpha/lib/rack/server.rb:296:in `start&#39;\nrails/commands/server.rb:78:in `start&#39;\nrails/commands/commands_tasks.rb:90:in `block in server&#39;\nrails/commands/commands_tasks.rb:85:in `tap&#39;\nrails/commands/commands_tasks.rb:85:in `server&#39;\nrails/commands/commands_tasks.rb:49:in `run_command!&#39;\nrails/command.rb:20:in `run&#39;\nrails/commands.rb:19:in `&lt;top (required)&gt;&#39;\nbin/rails:4:in `require&#39;\nbin/rails:4:in `&lt;main&gt;&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b668@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/reactor.rb:136 sleep&gt;\nlib/puma/reactor.rb:29:in `select&#39;\nlib/puma/reactor.rb:29:in `run_internal&#39;\nlib/puma/reactor.rb:138:in `block in run_in_thread&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b500@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:216 sleep&gt;\nlib/puma/thread_pool.rb:219:in `sleep&#39;\nlib/puma/thread_pool.rb:219:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b3c0@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:187 sleep&gt;\nlib/puma/thread_pool.rb:190:in `sleep&#39;\nlib/puma/thread_pool.rb:190:in `block in start!&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bef3b258@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/server.rb:296 sleep&gt;\nlib/puma/server.rb:322:in `select&#39;\nlib/puma/server.rb:322:in `handle_servers&#39;\nlib/puma/server.rb:296:in `block in run&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90c1ef9a08@/Users/aaron/.rbenv/versions/ruby-trunk/lib/ruby/gems/2.4.0/gems/puma-2.16.0/lib/puma/thread_pool.rb:61 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:132:in `wait_until&#39;\naction_dispatch/http/response.rb:170:in `block in await_commit&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\naction_dispatch/http/response.rb:169:in `await_commit&#39;\naction_controller/metal/live.rb:270:in `process&#39;\naction_controller/metal.rb:193:in `dispatch&#39;\naction_controller/metal.rb:265:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:50:in `dispatch&#39;\naction_dispatch/routing/route_set.rb:32:in `serve&#39;\n##########################################################################################\n##########################################################################################\n#&lt;Thread:0x007f90bd1d5f38@/Users/aaron/git/rails/actionpack/lib/action_controller/metal/live.rb:279 sleep&gt;\nlib/ruby/2.4.0/monitor.rb:111:in `sleep&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:111:in `wait&#39;\nlib/ruby/2.4.0/monitor.rb:123:in `wait_while&#39;\nactive_support/concurrency/share_lock.rb:57:in `block (2 levels) in start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:154:in `yield_shares&#39;\nactive_support/concurrency/share_lock.rb:56:in `block in start_exclusive&#39;\nlib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize&#39;\nactive_support/concurrency/share_lock.rb:51:in `start_exclusive&#39;\nactive_support/concurrency/share_lock.rb:113:in `exclusive&#39;\nactive_support/dependencies/interlock.rb:12:in `loading&#39;\nactive_support/dependencies.rb:37:in `load_interlock&#39;\nactive_support/dependencies.rb:369:in `require_or_load&#39;\nactive_support/dependencies.rb:529:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\nactive_support/dependencies.rb:561:in `load_missing_constant&#39;\nactive_support/dependencies.rb:212:in `const_missing&#39;\napp/controllers/users_controller.rb:9:in `index&#39;\n##########################################################################################</code></pre>\n      </div>\n<p>가독성을 위해 결과물을 조금 잘라냈습니다만, 여러분은 이제 각각의 스레드가 무엇을 하는지 볼 수 있습니다. 그리고 어느 스레드 두 개가 교착 상태에 빠졌는지 쉽게 발견할 수 있습니다(정답은 마지막 두 개입니다).</p>\n<h2 id="특정한-시간에만-언제-메서드가-실행되는지-알고-싶다"><a href="#%ED%8A%B9%EC%A0%95%ED%95%9C-%EC%8B%9C%EA%B0%84%EC%97%90%EB%A7%8C-%EC%96%B8%EC%A0%9C-%EB%A9%94%EC%84%9C%EB%93%9C%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94%EC%A7%80-%EC%95%8C%EA%B3%A0-%EC%8B%B6%EB%8B%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특정한 시간에만 언제 메서드가 실행되는지 알고 싶다</h2>\n<p>일정 시간 뒤에 메서드가 언제 실행되었는지 알고 싶을 때가 있습니다. 저는 애플리케이션이 <em>구동된 뒤에</em>  <code class="language-text">start_exclusive</code> 메서드가 언제 호출되는지 알고 싶었습니다. 이럴 때 위에 보여드린 <code class="language-text">trap</code> 트릭과 전역 변수를 조합하여 해결했습니다.</p>\n<p>먼저 <code class="language-text">start_exclusive</code> 를 이렇게 수정했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">start_exclusive</span><span class="token punctuation">(</span>purpose<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> compatible<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> no_wait<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token variable">$foo</span>\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n    puts caller\n    puts <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">90</span>\n  <span class="token keyword">end</span>\n  <span class="token comment"># ..</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 <code class="language-text">x.rb</code> 라는 파일을 작성했습니다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token function">trap</span><span class="token punctuation">(</span><span class="token symbol">:INFO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  puts <span class="token string">"turning on debugging!"</span>\n  <span class="token variable">$foo</span> <span class="token operator">=</span> <span class="token keyword">true</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>그리고 앱 서버를 구동하고 모든 요소가 준비되면 컨트롤+T를 눌러서 제 전역 변수를 <code class="language-text">true</code> 로 바꿉니다. 그리고 로그 메세지들을 살펴볼 수 있게 됩니다.</p>\n<h2 id="끝"><a href="#%EB%81%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>끝</h2>\n<p>이게 제가 지금 생각해 낼 수 있는 방법의 전부입니다. 그리고 <a href="http://www.schneems.com/2016/01/25/ruby-debugging-magic-cheat-sheet.html">Richard의 puts 디버깅에 관한 글도 읽어보세요</a>. 좋은 하루 되시길. 끝.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>간만에 엄청나게 긴 양의 글을 번역했습니다. 그래도 맘 잡고 하니 생각보다 오래 걸리지도 않고, 초벌번역의 퀄리티도 조금씩 올라가고 있다고 느끼고 있습니다.</p>\n<p>이번에 소개해 드린 글은 콘솔에 디버깅 하는 방법을 소개하는 글입니다. 보통은 디버깅 툴로 <code class="language-text">byebug</code>, <code class="language-text">pry-byebug</code> 등을 사용하실 겁니다. 저도 어지간한 디버깅을 그렇게 처리하고 있지만.. 본문의 내용처럼 좀 깊은 부분을 들여다볼 때는 일일히 깊숙하게 파고들기 힘들 때가 많습니다. 좀 더 자신이 사용하고 있는 코드의 깊은 부분을 들여보고자 할 때 아주 유용한 테크닉이 될 것이라 생각합니다.</p>\n<p>번역된 챕터 제목들의 말투가 조금 이상하다고 느끼실텐데, 들어가는 글에서 원 저자가 \'어차피 블로그 포스트니까 신경 안쓰고 말투를 편하게 한다\'는 식으로 쓰여있길래 그 느낌을 가능한 한 살려서 작성해보았습니다.</p>\n<p>글을 읽다 보면 레일즈같은 거대한 오픈 소스에 기여하는 분들은 \'어떻게 이 방대한 코드를 다 고려하면서 개발을 하는걸까?\' 하는 생각에 더욱 존경심이 들더군요. 레일즈 뿐 아니라 다른 오픈소스 프레임웍들도 마찬가지입니다. 언젠가는 오픈소스에 기여했다는 족적을 꼭 남겨 보고 싶습니다.</p>\n<p>현재 Hanami 기반으로 개발을 하고 있다보니 문서화가 덜 되어 \'소스를 까볼\' 일이 많은데 이런 기술을 더 유용하게 사용해볼 수 있겠습니다. 이 글을 보는 다른 분들은 어떻게 \'프로그램의 소스를 살펴 보시는지\' 궁금하기도 하고, 더 유용한 디버깅 팁이 있는지도 궁금해집니다.</p>',
id:"/home/circleci/repo/src/pages/posts/2017-03-19-I-am-a-puts-debuggerer-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-03-19",path:"/posts/i-am-a-puts-debuggerer-kor",title:"[번역] 나는 'puts' 디버거다",tags:["Ruby","Debugging","Translation"],category:"Translation"}}],"Remote Job":[{excerpt:"Ruby on Rails(이하 레일즈) 를 쓰는 사람이라면 DHH(데이비드 하이네마이어 한슨)의 이름을 모르는 사람은 거의 없을 것이다. 레일즈 프레임워크의 창시자일 뿐 아니라 거침 없는 입담과 자신만의 확고한 방식으로 레일즈라는 거대한 프로젝트를 이끌고 있는 개발자이기 때문이다. 사실 나도 그냥 DHH의 이름을 들으면 떠오르는 점은 ‘레일즈의 창시자’ 정도밖에 없었다. 덧붙이면 그 전에는 PHP…",html:'<p>Ruby on Rails(이하 레일즈) 를 쓰는 사람이라면 DHH(데이비드 하이네마이어 한슨)의 이름을 모르는 사람은 거의 없을 것이다. 레일즈 프레임워크의 창시자일 뿐 아니라 거침 없는 입담과 자신만의 확고한 방식으로 레일즈라는 거대한 프로젝트를 이끌고 있는 개발자이기 때문이다.</p>\n<p>사실 나도 그냥 DHH의 이름을 들으면 떠오르는 점은 ‘레일즈의 창시자’ 정도밖에 없었다. 덧붙이면 그 전에는 PHP로 개발을 하다가 너무 답답해하던 중 루비라는 언어를 접하고, 사랑에 빠져(말 그대로이다. 이는 DHH가 <a href="https://harfangk.github.io/2017/01/27/quora-qna-session-with-david-heinemeier-hansson-jan-25-2017-ko.html">2017년 1월에 Quora에서 진행한 AMA</a>에서 사용한 표현이다.) 레일즈를 개발하게 되었다는 것 정도를 알고 있었다.</p>\n<p>그러다 위에 링크한 DHH의 AMA를 읽게 되었고, 글을 다 읽고 나니 ‘이 사람은 대체 어떤 사람이고, 무슨 생각을 하고 있을까? 배울 점이 있다면 배우고 싶다’ 라는 생각이 들었다. 그렇게 접하게 된 대표적인 저서가 이 <strong>Remote</strong>이다.</p>\n<p>이 책은 ‘원격근무’ 라는 것이 어떤 것인지 소개하면서 흔히 알려진 오해들을 바로잡고, 어떤 방식으로 원격근무를 적용하면 좋을 지 안내하는 가이드 역할을 하는 책이다. 실제로 DHH가 설립한 회사 37signals(현 Basecamp, 이들이 운영하고 있는 원격 근무 서비스의 이름과 같다)는 전면적인 원격 근무 체제를 도입하고 있고, 아주 성공적으로 운영하고 있는 회사 중 하나이다.</p>\n<p>‘원격 근무는 회사에 가지 않고 집에서 작업하기 때문에 관리자의 통제가 힘들다’라는 게 일반적으로 원격 근무를 바라보는 사람들의 생각일 것이다. 하지만 오히려 관리자의 통제가 정말로 필요한 경우는 어떤 것인지 다시 한번 생각해보아야 한다. 근태 관리인가? 아니면 생산성인가? ‘관리자가 직접 직원을 볼 수 없기 때문에 통제가 힘들다’ 는 것은 근태 위주의 생각이고, 근로자가 자신이 가능한한 최적의 환경에서 최고의 생산성을 낼 수 있는 작업방식으로 회사 일에 기여를 하면 자연스레 회사와 근로자 모두에게 이득이 될 것이다.</p>\n<p>더불어 출퇴근 시간으로 하루에 일정 시간을 소비하고, 시간 뿐 아니라 출퇴근 지옥 속에서 정신력까지 소모하는 생활을 살아가는 시대에 ‘출퇴근 문제’를 도려내면 삶이 얼마나 편하게 바뀔 지 상상해보라. 저절로 편안한 기분이 든다.</p>\n<p>요즘은 다양한 도구가 많이 개발되어 있어서(Basecamp, 각종 메신저, 구글 닥스 등) 세계 각지에 떨어진 사람들도 <strong>언어만 통하면</strong> 서로 협력하여 업무를 진행하는데 전혀 무리가 없다. 물론 다시 한번 강조하지만 언어가 통하는게 중요하다. 해외의 회사에 원격근무자로 취직을 한다 하더라도 주로 <strong>영어 쓰기</strong>가 큰 장벽이 될 것이다.</p>\n<p>원격근무자를 고용하는 회사에서 고려할 사항 뿐 아니라 원격근무로 일하는 사람도 고려해야 할 사항들이 여러가지 있다. 보통 집에서 혹은 근처 카페에서 작업을 한다고 하면 딴 짓을 하거나 게으르게 행동하여 생산성이 떨어질까 걱정하는 경우가 많은데, 오히려 이 책은 ‘과도하게 일에 몰입하지 않도록 주의하라’고 경고한다. 나 자신도 비슷한 일을 경험한 적이 있어서 크게 공감되었다. 간단한 작업을 돕고 마무리 지으려고 했는데, 카페에서 화장실 한번 가지 못하고 5시간을 앉아있던 뒤에야 간신히 일어날 수 있었다. 회사에서 있었다면 어떤 식으로든 몸을 일으켜 움직이는게 쉬웠을 것이다.</p>\n<p>마지막으로 이 책은 원격근무를 하는데 필요한 중요한 요소 중 하나는 \'동기’임을 강조한다. 관리자 입장에서도 원격근무자의 업무 성과가 제대로 나오지 않는 경우에 주어진 업무가 제대로 구성되어있고 동기를 부여하는 업무인지 확인하라고 말하고 있고, 원격근무자에게도 스스로를 탓하기 보다 근무환경을 다시 한 번 살펴보라고 권한다.</p>\n<p>겉으로 보기엔 형태가 달라 보이지만 거대한 오픈소스 프로젝트도 원격근무의 좋은 예가 될 수 있다. 얼굴도 마주한 적 없는 다양한 사람들이 거대한 프로젝트를 완성시켜나가는 모습은 경이롭다.</p>\n<blockquote>\n<p>우리가 개발한 웹프레임워크인 루비온레일스는 십여 년이 넘는 기간 동안 새로운 기능을 넣고 코드 품질을 개선하면서 진화시켜왔다. 이는 전 세계 십여 개 국가, 수백 개 도시에서 3천 명이 넘는 개발자들(이들은 서로 만난 적도 없는 사람들이다)이 오랜 기간 코드를 발전시킨 결과다.</p>\n<p>원격근무를 도입하는 과정에 의심이 들거나 장애물을 만날 때는 이렇게 생각하면 도움이 된다. “전 세계의 3천 명이 넘는 개발자들을 관리하고 조율하는 프로젝트도 있는데, 이 정도쯤이야!” 아마 골치 아픈 문제가 곧 해결될 수 있으리라는 안도감을 느낄 것이다.</p>\n<p>--- p183, p184</p>\n</blockquote>\n<p>모든 직종이 원격근무를 적극적으로 도입할 수는 없다. 하지만 개발자라는 직업은 지금 시대에 원격근무를 하기에 가장 탁월한 직업이라고 생각한다. 출근하러 집을 나서는 순간부터 \'아 집에 돌아가고 싶다’ 라는 생각이 들게 되는 삶 보다 자신이 하는 일을 진정 즐기면서 회사와 함께 상생할 수 있도록 원격근무를 적절히 도입하는 사례가 점점 늘어나는 모습이 기대된다. 나 또한 원격근무라는걸 제대로 해보고 싶다.</p>\n<hr>\n<ul>\n<li>책 링크: <a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=50265443">알라딘</a></li>\n</ul>',id:"/home/circleci/repo/src/pages/posts/2017-02-26-reading-remote/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2017-02-26",path:"/posts/remote-the-book-review",title:"‘Remote - 사무실 따윈 필요 없어!’ 를 읽고",tags:["Reading","Remote Job"],category:"Review"}}],Rails:[{excerpt:"이 포스팅은  Justin Weiss의 블로그 포스팅 을 허가 아래 번역한 글입니다 본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다 표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요 Thom Parkin…",html:'<ul>\n<li><strong>이 포스팅은 <a href="https://www.justinweiss.com/articles/the-easiest-way-to-get-into-open-source/">Justin Weiss의 블로그 포스팅</a>을 허가 아래 번역한 글입니다</strong></li>\n<li><strong>본 번역물의 저작권은 따로 없으며 인용하실 때 출처를 밝혀주신다면 무척 고맙겠습니다</strong></li>\n<li><strong>표현이 부족한 부분이나 오타를 발견하시면 댓글이나 트위터를 통해 알려주세요</strong></li>\n</ul>\n<hr>\n<p>Thom Parkin이 <a href="http://www.justinweiss.com/blog/2014/10/28/how-to-go-beyond-documentation-and-learn-a-new-library/#comment-1657912979">제 지난번 글에 아주 중요한 지적을 해 주었습니다.</a></p>\n<blockquote>\n<p>좋은 조언입니다. 그러나 당신은 아주 중요하고 결정적인 포인트를 하나 놓쳤어요. 지금 하고 있는 이야기는 오픈 소스에 관한 이야기이기 때문에 당신이 한번 어떤 기능이나 함수가 문서화가 잘 안되어있다는 것을 발견한다면, <strong>당신은 그 문서를 업데이트 하고 풀 리퀘스트(Pull Request)를 제출해야 합니다.</strong> 그렇게 전체 커뮤니티가 도움을 받게 되고 더불어 당신은 그런 참여를 통해 어느 정도의 "코더 평판(coder cred)"을 얻게 됩니다.</p>\n</blockquote>\n<p><strong>나는 Thom이 이 점을 언급해주어서 기뻤습니다. 이는 아주 중요한 것이기 때문입니다.</strong> 문서를 수정하는 것은 당신이 사용하고 좋아하는 프로젝트에 기여를 시작할 수 있는 가장 쉬운 방법입니다.</p>\n<p>제가 Rails, Rubinus, Elixir에 처음 기여했던 것들은 모두 문서 수정이었습니다. 저는 작은 수정들을 가해왔습니다. 문장을 더 명확하게 하고, 코드를 직접 읽어야만 발견할 수 있는 부분들을 설명하는 작업을 하거나, 심지어 단지 포맷이 잘못된 부분을 수정하기도 했습니다. 이 모든 것들은 좀 커다란 오픈 소스 프로젝트들을 돕는 가장 빠르고 쉬운 방법들입니다. 비록 이 일들이 제가 프로젝트에 유일하게 기여한 것들이지만, 여전히 미래의 사용자들을 돕고 있습니다. 심지어 미래의 제 자신도요. 그게 바로 오픈소스죠(And that’s what open source is all about).</p>\n<h2 id="왜-문서를-수정하는-것이-그렇게-좋은-방법인가"><a href="#%EC%99%9C-%EB%AC%B8%EC%84%9C%EB%A5%BC-%EC%88%98%EC%A0%95%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-%EA%B7%B8%EB%A0%87%EA%B2%8C-%EC%A2%8B%EC%9D%80-%EB%B0%A9%EB%B2%95%EC%9D%B8%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왜 문서를 수정하는 것이 그렇게 좋은 방법인가</h2>\n<p>Rails같이 거대한 프로젝트에선 문서를 수정하는 것이 가장 부담이 덜 되는 기여 방법입니다.</p>\n<ul>\n<li><strong>당신은 버그를 수정하기 위해 프로젝트를 세팅할 필요가 없습니다.</strong> 당신은 그저 문서를 업데이트 하는 것이기 때문에 테스트를 돌리거나 앱을 돌릴 필요가 없습니다. 심지어 당신은 자신의 컴퓨터에 프로젝트를 클론할 필요도 없습니다 - Github에서 바로 수정할 수 있어요!</li>\n<li><strong>관리자(Maintainer)가 당신의 풀 리퀘스트에 수정을 요청한다면, 보통 어법(wording)이나 취향 때문일 겁니다.</strong> 이런 변경점은 당신의 코드가 비판받는 것 보다 받아들이기 쉽습니다. 그리고 만들기도 쉽습니다. 왜냐면 당신은 테스트나 코드를 업데이트 할 필요가 없으니까요. 단지 단어들만 업데이트하면 됩니다.</li>\n<li><strong>문서화(Documentation)는 프로젝트 관리자에게는 힘든 일입니다. 그래서 업데이트는 큰 도움이 됩니다.</strong> 종종 코드의 작성자들은 자신의 코드와 너무 밀접해 있어서, 어느 부분이 혼란스러운 부분인지 잘 이해하지 못합니다. 그들은 다른, 혹은 뉴비 개발자들이 어느 부분의 문서에 도움이 필요한지 말해주길 원합니다. 당신의 프로젝트를 초보자의 시점으로 보는 건 연습이 필요합니다. 모두가 그런 기술을 가진 것은 아니거든요.</li>\n<li><strong>마지막으로, 당신은 프로젝트에 부담없는 변화를 주면서도 관리자와 관계를 형성할 수 있습니다.</strong> 당신은 프로젝트의 방향을 바꾸는 게 아닙니다. 예를 들면 당신이 전체 기능에 기여하는 것 처럼요. 그래서 당신의 변경점은 관리자가 리뷰하기 쉽고, 그들은 보통 당신에게 더 빠르게 답변 할 것입니다. 당신의 머지 요청은 "이게 정말 좋은 생각일까요?" 같은 말에 가로막히지 않을 것입니다.</li>\n</ul>\n<p>당신은 그 관계를 유지하면서 점차 신뢰받는 기여자로 보이기 시작할 것입니다. 당신의 풀 리퀘스트는 더 빠르게 리뷰될 것이고, 당신들이(당신과 관리자) 더 복잡한 기능 요청이나 버그 수정에 대해 자세하게 이야기를 나누기도 쉬워집니다.</p>\n<p>당신의 첫 기여를 <strong>시작하기도 쉽고, 하기도 쉽고, 머지도 더 빠르게 되는</strong> 문서 수정으로 해 보시는 게 어떨까요?</p>\n<h2 id="업데이트-된-문서에-다시-기여하는-방법"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%90%9C-%EB%AC%B8%EC%84%9C%EC%97%90-%EB%8B%A4%EC%8B%9C-%EA%B8%B0%EC%97%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트 된 문서에 다시 기여하는 방법</h2>\n<p>버그 수정과 마찬가지로 문서 업데이트에 기여하는 데는 유의할 점이 있습니다: <strong>둘 다 공통적으로 \'잘못되었다고 느껴지는 것들(things that feel wrong)\'에 많이 신경을 써야 한다는 점입니다.</strong> 당신은 주의를 기울여야 합니다.</p>\n<p>보통 코드가 당신이 기대하던대로 동작하지 않을 때가 문서를 업데이트 해야 할 시기입니다. 만약 당신이 코드를 직접 수정하여 문제를 해결한다면, 마찬가지로 다른 사람들에게 이에 대해 알려야 할 겁니다. 혹은 당신이 읽고 있는 문서의 잘못된 형식이나 오타가 신경쓰일 수도 있습니다. 당신이 고치지 않는다면 누가 할까요?</p>\n<p>당신이 어디를 변경하고 어떻게 말로 표현해야하는지 좋은 아이디어가 떠올랐다면, 그 부분을 변경하고 한번 Github에 풀 리퀘스트를 올려보세요.</p>\n<p>만약 당신이 문서를 업데이트 하는 가장 좋은 방법을 계속 구상중이라면 Github에 이슈를 열어보세요. 이런 식으로요:</p>\n<blockquote>\n<p>"저기요, 이건 제가 보기에 좀 헷갈리네요. 제가 이런 식으로 업데이트하는 걸 생각해 봤는데요: ... 어떻게 생각하세요? 제가 더 넣어야 할 내용이 있을까요?"</p>\n</blockquote>\n<p>이렇게 당신은 모두를 만족시키는 표현법을 함께 제안할 수 있습니다.</p>\n<p>마지막으로 당신이 답변을 얻지 못하더라도 주눅들지 마세요. 큰 프로젝트는 여러 일들이 진행됩니다. 그래서 당신의 기여는 그 사이 어딘가로 쏙 빠져버리기 쉽지요. <strong>일주일 안팎으로 당신이 아무런 답변을 듣지 못한다면, 관리자에게 다시 물어보세요.</strong></p>\n<p>보통 당신이 라이브러리를 사용하게 되면 무엇보다 먼저 마주치는 것이 문서입니다. 그러므로 문서를 자세하고 명료하게 만드는 것은 중요합니다.</p>\n<p>그러니 당신이 쓰는 코드가 혼란스러울 때나 직접 소스를 들여다 보아야 할 때, 다음 사람을 위해 보기 쉽게 만들어주세요. 간단한 업데이트를 작성하고 다시 기여하세요. 이것이 제가 알고있는 오픈 소스 기여자가 되는 가장 쉬운 방법입니다.</p>\n<hr>\n<h2 id="번역-후기"><a href="#%EB%B2%88%EC%97%AD-%ED%9B%84%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>번역 후기</h2>\n<p>첫 번역이라 부족한 점이 아주 많았습니다. 영어로 된 글을 읽는 것이 그래도 어느 정도는 읽을만 하다고 생각했는데, 다른 사람이 한글로 된 번역문을 읽으려면 훨씬 번역을 잘 해야하고, 우리말 문장도 매끄럽게 작성하도록 온 신경을 기울여야 한다는 점을 깨닫는 계기가 되었습니다.</p>\n<p>사실 번역을 시작해보게 된 계기는 단순합니다. 본 글의 저자인 <a href="http://www.justinweiss.com">Justin Weiss</a>의 블로그 포스팅들이 마음에 들어서 책(Practicing Rails)도 구매하고, 뉴스레터도 구독하면서 최근 뉴스레터의 내용들이 참 도움이 많이 된다고 생각하였습니다. 그래서 메일로 최근에 온 뉴스레터를 한글로 번역하여 공유해도 되겠냐고 물어보았지요.</p>\n<p>그는 조만간 그 뉴스레터를 블로그로 포스팅할 예정이고 그 포스팅이 첫 번째로 공개되는 포스팅이었으면 한다고 답변을 주었습니다. 즉 아직은 올릴 수 없다는 말이겠지요. 메일을 조금 더 주고받다가 저는 그의 좋은 포스팅들 중 첫 번역을 이 글로 시작하기로 협의했습니다.</p>\n<p>차차 Justin의 포스팅 이외에도 괜찮은 글들을 제가 번역할 기회가 주어진다면 조금씩 올려볼 예정입니다. 감사합니다.</p>',id:"/home/circleci/repo/src/pages/posts/2016-12-19-the-easiest-way-to-get-into-open-source-kor/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-09",path:"/posts/the-easiest-way-to-get-into-open-source-kor",title:"[번역] 오픈 소스에 참여하는 가장 쉬운 방법",tags:["Translation","Rails","OSS"],category:"Translation"}},{excerpt:"본 포스팅은  루비 대림절 달력 을 위해 제작하였습니다 기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다 작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다 들어가며 아직 갓…",html:'<ul>\n<li><strong>본 포스팅은 <a href="http://ruby-korea.github.io/advent-calendar/">루비 대림절 달력</a>을 위해 제작하였습니다</strong></li>\n<li><strong>기본적인 루비 언어 및 루비 온 레일즈의 이해도가 있는 독자를 대상으로 작성하였습니다</strong></li>\n<li><strong>작성자의 지식이 부족하여 설명이 부족하거나 잘못된 정보가 있다면 제보 부탁드립니다</strong></li>\n</ul>\n<h2 id="들어가며"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h2>\n<p>아직 갓 6개월 된 초보 개발자로서 이제 루비 온 레일즈(이하 레일즈)에 조금씩 익숙해지던 차에, 상사로부터 \'하나미라는 프레임워크가 있으니 한번 리서치를 해 보세요\' 라는 권유를 받았다. 그는 루비로 백엔드 서버들을 구축했지만 레일즈는 자신의 취향에 맞지 않다고 했고, 구조적으로도 하나미가 더 나아보인다고 이야기하였다.</p>\n<p>그리고 하나미 공식 가이드를 쭉 읽어본 나에게는 혼돈과 절망만 남았다. 루비 뿐 아니라 웹 개발의 기초 지식이 부족해서 그런지 도저히 이게 어떻게 돌아가는건지도 모르겠고, 레일즈에 대입해서 이해할 수 있는 것도 아니라는 생각이 들었다.</p>\n<p>다시 6개월을 다른 레일즈 프로젝트 제작, 리서치 작업을 하며 보내고 나니 회사에서는 본격적으로 레일즈 사용을 하지 않고 하나미를 사용하는 방향으로 가닥을 잡았다. 어쩌다가 레일즈라는 걸출한 웹 프레임워크를 두고 생소한 하나미라는 프레임워크를 사용하게 되었는지, 이번 기회를 통해 독자 분들의 관심을 이끄는 계기를 만들어보고자 한다.</p>\n<h2 id="변화가-일고-있는-레일즈-커뮤니티"><a href="#%EB%B3%80%ED%99%94%EA%B0%80-%EC%9D%BC%EA%B3%A0-%EC%9E%88%EB%8A%94-%EB%A0%88%EC%9D%BC%EC%A6%88-%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변화가 일고 있는 레일즈 커뮤니티</h2>\n<p>레일즈는 2005년에 처음 소개 된 이후 빠르고 쉬운 웹 애플리케이션 개발을 위한 도구로써 많은 개발자들의 사랑을 받아왔다.</p>\n<p>\'프로그래머의 단짝 친구\' 라고 소개할 정도로 쉽고 재미있는 언어인 루비를 기반으로 삼은 프레임워크이기도 하고, 꼭 루비 문법을 모두 꿰고 있어야 할 정도로 많은 지식을 알고 있지 않아도 금방 어지간한 웹 애플리케이션을 제작할 수 있다는 점이 주요 셀링 포인트라고 여겨진다.</p>\n<p>소위 \'Rails Magic\' 덕분에 form에 변수를 할당하는 것으로 경로 설정이 알아서 되거나 스캐폴딩만 해도 신기하게 돌아가는 애플리케이션을 보며 감탄했던 적이 한두 번이 아니었다.</p>\n<p>2016년 현재 레일즈는 버전 5까지 발매되었고, 더 많은 기능이 구현되어 있으며 커뮤니티는 많이 거대해졌다. 거대해진 레일즈 세계와 함께 그 음영을 느끼는 개발자들도 조금씩 늘어나게 되었다.</p>\n<p>예를 들어 보통 레일즈 애플리케이션을 오래 개발해온 사람들은 애플리케이션의 규모가 커질수록 유지보수하는게 힘들어진다는 점을 지적하고 있는데, 이를 해결하기 위해 <strong>Fat model, Skinny controller</strong> 등의 방법론이 제시되고 있지만 \'뭔가 문제가 있다\'는 의견들은 끊임없이 제시되고 있다.</p>\n<p>또한 DHH(David Heinemeier Hansson, 레일즈의 창시자)가 제시하고 있는 <a href="http://solnic.eu/2016/05/22/my-time-with-rails-is-up.html">\'Rails way\'에 반감을 가진 사람들이 점차 늘어나고</a> 루비로 웹 개발을 하는 것에 대해 <a href="http://rwdtow.stdout.in/">더 나은 방법을 찾는</a> 사람들이 점차 늘어나고 있다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 599px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 131.3856427378965%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABe2AlTSxFMuUv/8QAGRABAAIDAAAAAAAAAAAAAAAAAQACEBEw/9oACAEBAAEFAqmqxODj/8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQMBAT8BY//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABUQAQEAAAAAAAAAAAAAAAAAAAEw/9oACAEBAAY/Ain/xAAaEAADAQADAAAAAAAAAAAAAAAAAREQITFR/9oACAEBAAE/IYTxFLPKU5GXOpWf/9oADAMBAAIAAwAAABBv7vz/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEQ/9oACAEDAQE/EHDbIc//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxAp/8QAHhABAAICAQUAAAAAAAAAAAAAAQARITFBUWGBkaH/2gAIAQEAAT8QKn0nwj0BmUTlxMVEarzE8Q3EKIQbZTiXibZ3H3P/2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="현재 레일즈 커뮤니티"\n        title=""\n        src="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg"\n        srcset="/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-28fc4.jpg 198w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-44f6c.jpg 395w,\n/static/2016-12-03-sc1-f0f9a1c45e0435424b34e6518f9574d9-f36a6.jpg 599w"\n        sizes="(max-width: 599px) 100vw, 599px"\n      />\n    </span>\n  </span>\n  </p>\n<p><em>현재 레일즈 커뮤니티의 묘사 - 출처: <a href="http://railshurts.com/current_state">http://railshurts.com/current_state</a></em></p>\n<p>이러한 분위기 속에서 \'Ruby way, not Rails\' 를 표방하는 루비 기반 웹 프레임워크가 등장하였으니, 바로 이번에 소개할 <a href="hanamirb.org">Hanami(하나미)</a>이다.</p>\n<h2 id="하나미가-뭐죠"><a href="#%ED%95%98%EB%82%98%EB%AF%B8%EA%B0%80-%EB%AD%90%EC%A3%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나미가 뭐죠?</h2>\n<p>하나미는 이탈리아의 개발자 <a href="https://lucaguidi.com">Luca Guidi</a> 가 개발한 루비 MVC 웹 프레임워크이다. 2014년에 Lotus라는 이름으로 처음 등장하였으나, IBM의 Louts 상표권과 엮이는 문제가 있어 지금의 이름으로 변경하게 되었다.</p>\n<p>새로운 이름으로 <strong>하나미</strong>라는 이름을 쓰게 된 이유는 \'꽃구경\' 이라는 일본어 본래의 뜻에 걸맞게 함께 하는 커뮤니티의 중요성을 일깨운다는 점을 강조하기 위해서라고 한다. 루비의 창시자 Matz와(일본인이다) 루비 그 자체에 대한 찬사의 의미도 가지고 있다.</p>\n<p>하나미의 특징을 몇 가지 소개하자면 먼저 최대한 루비라는 언어를 직접적으로 사용하는 방식으로 구현되어 있다는 점이다. 다만 이 때문에 레일즈를 습득하는데 루비 지식이 크게 필요하지 않은 것과 다르게 일정 수준의 루비 언어의 이해를 요구한다.</p>\n<p>또한 Magic을 최대한 배제하고(하나미 Gitter 채팅방에서 혹은 몇몇 포스트에서 "I\'m now sick of rails magic!" 이라고 주장하는 사람들이 많이 보인다) 개발자가 최대한 자신이 무엇을 하고 있는지 인지하면서 앱을 제작하도록 유도한다.</p>\n<p>그리고 보통 Rails best practice 로 제시되는 요소들을 기본적으로 구현하고 있다.</p>\n<ul>\n<li>컨트롤러는 HTTP 콜만 다룬다 -> 액션에서 비지니스 로직을 분리하여 처리하기 위해 <code class="language-text">Interactor</code> 라는 모듈이 있다</li>\n<li>퍼시스턴스 로직과 도메인 로직을 분리한다 -> 하나미 모델은 기본적으로 도메인과 퍼시스턴스 레이어가 분리되어 있다</li>\n<li>루비 객체를 만들어서 제대로 OOP를 한다 -> 하나미는 OOP 개념을 잘 지키기 위해 노력한다. 또한 모듈화도 굉장히 쉽다</li>\n</ul>\n<p>하나미 가이드 페이지 첫머리에서 제시하는 <a href="http://hanamirb.org/guides/#why-choose-hanami-">\'하나미를 선택하는 이유\'</a> 를 가볍게 살펴보면 이렇게 말하고 있다.</p>\n<ul>\n<li>하나미는 가볍다 -> 상대적으로 짧은 코드, 웹 애플리케이션 개발에 필요한 필수적인 부분에 초점을 맞춤</li>\n<li>하나미는 구조적으로 건전하다 -> 컨트롤러 액션은 각각의 클래스로 분리되어 있으며 테스트하기 용이하다</li>\n<li>하나미는 스레드에 안전하다 -> (아직 이런 문제를 겪을만한 규모의 앱을 작성해본 적이 없어서 설명하기 어렵다)</li>\n</ul>\n<p>또한 하나미는 컨테이너 형태의 앱 구조를 기본적으로 제공한다. 덕분에 한 개의 프로젝트를 생성하여 API 서버와 웹 서버를 동시에 운용하는게 가능하다. 물론 레일즈로도 비슷한 구성을 할 수야 있겠지만 충돌 없는 구현을 위해 앱의 구조가 훨씬 복잡해질 가능성이 높다.</p>\n<h2 id="만들어-볼까요"><a href="#%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%BC%EA%B9%8C%EC%9A%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>만들어 볼까요</h2>\n<p>글을 길게 써 보았지만, 개발자들에겐 장황한 글보다 코드 몇 줄을 보는 것이 훨씬 이해가 빠를 것이다. 하나미의 공식 가이드를 따라가면서 눈여겨 볼 점들을 소개하겠다.</p>\n<h3 id="bookshelf-프로젝트-생성"><a href="#bookshelf-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bookshelf 프로젝트 생성</h3>\n<p>이번에 만들어볼 애플리케이션(이하 앱)은 <code class="language-text">Bookshelf</code> 라는 앱이다. 책의 제목과, 작가가 있고 이 책들의 리스트를 살펴보고 책을 추가할 수 있는 기능을 가지고 있다. 가이드에서 수정과 삭제는 다루고 있지 않아 조금 아쉬운 느낌이 들지만 기본적인 웹 개발(레일즈) 지식이 있다면 구현하는 것이 그렇게 어렵지는 않다.</p>\n<p>기본적으로 루비 버전은 2.3+ 을 권장한다. 또한 데이터베이스는 sqlite3를 사용할 예정이다.</p>\n<p>먼저 하나미로 프로젝트를 생성하기 위해서는 <code class="language-text">gem install hanami</code> 로 하나미가 설치되어 있어야 한다. 그 다음에는 새 프로젝트를 생성해본다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ hanami new bookshelf</code></pre>\n      </div>\n<p>생성된 프로젝트의 폴더 구조를 살펴보면 다음과 같다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ tree -L 2\n.\n├── Gemfile\n├── Rakefile\n├── apps\n│   └── web\n├── config\n│   ├── environment.rb\n│   └── initializers\n├── config.ru\n├── db\n│   ├── migrations\n│   └── schema.sql\n├── lib\n│   ├── bookshelf\n│   └── bookshelf.rb\n├── public\n└── spec\n    ├── bookshelf\n    ├── features_helper.rb\n    ├── spec_helper.rb\n    ├── support\n    └── web</code></pre>\n      </div>\n<p>여기서 특이한 점은 <code class="language-text">apps</code> 라는 폴더가 있다는 점인데 기본 컨테이너는 <code class="language-text">web</code> 이지만 사용자가 웹 브라우저로 보는 애플리케이션 이외에 같은 데이터베이스를 공유하는 api 서버 등을 따로 만들고자 하면 제네레이터로 따로 컨테이너를 생성할 수 있다. 그러면 같은 데이터베이스 사용하는 별개의 앱을 따로 구축할 수 있다는 장점이 있다. (물론 라우팅은 다르겠지만.. 이 부분은 <code class="language-text">mount</code> 옵션으로 처리할 수 있다) <a href="http://hanamirb.org/guides/getting-started/#hanami-architecture">- 참고</a></p>\n<p>각 앱들에는 별개의 설정 파일, 컨트롤러, 뷰, 라우트, 템플릿 파일 및 폴더가 있다.</p>\n<p>테스트는 사용자가 원하는 어떤 형태로도 이용할 수 있다.(minitest or rspec) 하나미에서는 minitest를 기본으로 사용하며 capybara 젬도 사용한다. 이번 포스팅에서는 테스트를 구현하는 부분은 넘어가고자 한다. 테스팅이 궁금한 분들은 공식 가이드를 참조하시라.</p>\n<h3 id="루트-페이지-만들기"><a href="#%EB%A3%A8%ED%8A%B8-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>루트 페이지 만들기</h3>\n<p>라우팅은 각 앱의 <code class="language-text">config/routes.rb</code> 파일에서 설정한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\n</code></pre>\n      </div>\n<p>그러면 home 컨트롤러의 index 액션을 실행해주기 위해 제네레이터로 액션을 생성해본다. 아직 하나미는 레일즈처럼 다양하고 세분화된 옵션의 CLI를 제공하진 않는다. 번거롭긴 하지만 개발에 큰 지장은 없다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web home#index\n    create  spec/web/controllers/home/index_spec.rb\n    create  apps/web/controllers/home/index.rb\n    create  apps/web/views/home/index.rb\n    create  apps/web/templates/home/index.html.erb\n    create  spec/web/views/home/index_spec.rb\n    insert  apps/web/config/routes.rb</code></pre>\n      </div>\n<p><code class="language-text">action</code> 뒤에 있는 <code class="language-text">web</code> 은 액션을 생성하고자 하는 컨테이너의 이름이다. 그 다음에 컨트롤러와 액션 이름을 적어주면 된다. 앱 구조가 단독 컨테이너 구조일 경우(<code class="language-text">hanami new</code> 커맨드로 앱 생성시 <code class="language-text">--arch=app</code> 옵션을 주어 단독 컨테이너 앱 생성도 가능하다)에는 바로 액션 이름만 작성해주어도 된다.</p>\n<p>아쉬운 점은 매 액션마다 저 명령어를 작성해주어야 한다는 점이다. <code class="language-text">hanami-scaffold</code> 라는 젬이 있지만 그닥 유지보수는 되지 않고 있어서 사용하는 것을 추천하지 않는다.</p>\n<p>컨트롤러는 폴더에 불과하며 그 폴더에 속한 각각의 액션 파일에 컨트롤러가 정의되어 있는 형태이다. 또한 뷰는 템플릿 파일(레일즈의 views 폴더 안에 있는 템플릿들)과 뷰 파일(레일즈에 비유하자면 뷰 헬퍼와 비슷)로 구성되어있다. 지금은 템플릿 파일에 간단하게 제목을 추가해보도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/home/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Bookshelf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n</code></pre>\n      </div>\n<p><em>(주의) 템플릿 파일이 변경될 때에는 서버를 재실행할 필요가 없지만, 컨트롤러 등의 루비 파일이 변경될 때에는 서버를 재실행해야 한다.</em></p>\n<p>그리고 서버를 실행한 뒤 <code class="language-text">localhost:2300</code> 으로 접속해보면 심플하지만 Bookshelf라는 글씨가 보이는 페이지를 마주할 수 있다.\n(본 포스트에서는 빠른 진행을 위해 <code class="language-text">application.html.erb</code> 파일을 미리 수정해두었다)</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami server</code></pre>\n      </div>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 358px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 74.58100558659218%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQ4y81R32tSYRg+/8tyumBjEkxd5TKZRRlHnU70HM/x1/RibmArF5UXDRbtz/CmwfyVJ4i6qP6CdhEEbRmIO4pCA9F25Y+n93xk0MVawS468PB+7/c97/M833c446QeNuMlzC1chsGkw8WpafCORVgXbLhy1Yo5kxkms+UX5jTQ3njfbJmHTj+FC5MGTOj04Cwk6DLPw87fhOHaBBxWGyrZDFKrq0gmE3A6neB5Hi6XCy6qbrf7N4iiSMJmTM/MkLAB3G0i3aAh+3U77tziEQgEEBRExGIxhmQigXg8DkmSEA6HIQgC44wRDAbh9/vJkAw8HnAyEaVQCB6PG4IoQJZkJpDJZLC5mcEDQjqdprRJrKXWEIlEWCpZlplJiGa1tWYejUbBabG1RiIhLQEjiSEskUE0FodIabWhYCCI5WUfVihxJBKFz+dFIpEk8xUK44Fxdhb2RQe4fD6PcrmMUqkMRVGolqh/gVKxiEpFQZGqdlYsFNhZ5SenQL2ivGTr/N4ecrkcnu/ugsM5f5x6VMeH/X30ej2cnHzHwcEhvh0fo/rlEEeqik6ng/fv3qJa/coG+v0+BoPBqeDevH6FJa8Xz3Z28PjRQ6TvbiCbzWLryRY27t3H9vZTrKdS+PjpMxMcDIcYjUangut2u2g0GgQV9XodzWYTtVoNqtpAq9WiqqLdblOyARPUhv545X95n7PEmKBGGtI1zsJY7FwT/tVf/u8FfwCkJLVg24iPyAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf Title"\n        title=""\n        src="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png"\n        srcset="/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-dc079.png 198w,\n/static/2016-12-03-sc2-3a065f050faf7e4f996a919b015fb34b-8524e.png 358w"\n        sizes="(max-width: 358px) 100vw, 358px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="모델-구축하기"><a href="#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 구축하기</h3>\n<p>본격적으로 책들을 저장하고 출력하기 위해 데이터베이스 마이그레이션을 진행해 보도록 한다. 먼저 마이그레이션 파일을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate migration create_books</code></pre>\n      </div>\n<p>생성된 마이그레이션 파일은 이렇게 작성해 보았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># db/migrations/20161203083239_create_books.rb</span>\n<span class="token constant">Hanami</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Model</span><span class="token punctuation">.</span>migration <span class="token keyword">do</span>\n  change <span class="token keyword">do</span>\n    create_table <span class="token symbol">:books</span> <span class="token keyword">do</span>\n      primary_key <span class="token symbol">:id</span>\n\n      column <span class="token symbol">:title</span><span class="token punctuation">,</span>  <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:author</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n\n      column <span class="token symbol">:created_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n      column <span class="token symbol">:updated_at</span><span class="token punctuation">,</span> <span class="token constant">DateTime</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">primary_key</code> 가 반드시 <code class="language-text">id</code> 일 필요는 없다. 또한 <code class="language-text">String</code>, <code class="language-text">DateTime</code> 은 루비 타입이다(루비 클래스). 반드시 루비 타입을 사용할 필요는 없고 <code class="language-text">&quot;varchar(255)&quot;</code> 같이 데이터베이스 타입을 문자열로 직접 작성해주어도 된다.</p>\n<p>마이그레이션 파일 작성이 완료되면 테이블을 생성해주는 명령어를 입력한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami db prepare\n$ bundle exec hanami db migrate</code></pre>\n      </div>\n<p>그리고 <code class="language-text">Book</code> 모델을 생성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate model book\n      create  lib/bookshelf/entities/book.rb\n      create  lib/bookshelf/repositories/book_repository.rb\n      create  spec/bookshelf/entities/book_spec.rb\n      create  spec/bookshelf/repositories/book_repository_spec.rb</code></pre>\n      </div>\n<p>생성된 파일을 보면 조금 특이한 점을 볼 수 있는데 <code class="language-text">entities</code> 폴더와 <code class="language-text">repositories</code> 폴더가 따로 나뉘어져 있다는 점이다. <code class="language-text">Entity</code> 는 도메인 객체로, 실제 데이터베이스 쿼리 등으로 추출된 자료 객체를 일컫는다. <code class="language-text">Repository</code> 는 퍼시스턴스 계층과 <code class="language-text">Entity</code> 를 이어주는 역할을 한다. 여기서 <code class="language-text">Entity</code> 는 데이터베이스의 존재를 전혀 모르는 단순 루비 객체이며 테스트가 용이하고 가벼운 앱을 만드는데 도움이 된다.</p>\n<p>실제 콘솔에서 레코드를 다루어보면 이런 방식으로 동작한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami console\n&gt;&gt; repo = BookRepository.new\n=&gt; #&lt;BookRepository:... &gt;\n&gt;&gt; repo.all\n=&gt; []\n&gt;&gt; book = repo.create(title: &#39;TDD&#39;, author: &#39;Kent Beck&#39;)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;\n&gt;&gt; repo.find(book.id)\n=&gt; #&lt;Book:... @attribute={:id =&gt; 1, :title =&gt; &quot;TDD&quot;, :author =&gt; &quot;Kent Beck&quot; ... }&gt;</code></pre>\n      </div>\n<p><code class="language-text">Repository</code> (이하 리퍼지토리)에서 제공되는 메서드로 데이터베이스에 <code class="language-text">Entity</code> (이하 엔티티)를 조작할 수 있고, 엔티티에는 따로 속성 혹은 동작을 지정할 수 있다. 그래서 레일즈에서 사용하는 <code class="language-text">scope</code> 나 커스텀 쿼리가 작성된 메서드 등은 리퍼지토리 클래스에 분리해 둘 수 있다.</p>\n<h3 id="데이터를-표현하기"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%ED%91%9C%ED%98%84%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터를 표현하기</h3>\n<p>임의로 몇 개의 <code class="language-text">Book</code> 레코드를 생성해주고 리스트를 표현해보기 위해 새 컨트롤러 액션을 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami generate action web books#index</code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/index.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>All books<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;% if books.any? %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    &lt;% books.each do |book| %>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>book<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&lt;%= book.title %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;%= book.author %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    &lt;% end %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n&lt;% else %>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>placeholder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>There are no books yet.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n&lt;% end %>\n</code></pre>\n      </div>\n<p>여기서 <code class="language-text">books</code> 는 어디서 온 것일까? 실제로 액션 부분은 이렇게 작성되어 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/index.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Index</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:books</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@books</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>all\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">expose</code> 메서드의 사용은 하나미의 규칙으로, <code class="language-text">expose</code> 로 지정한 변수만 템플릿으로 노출되며 그 변수는 <code class="language-text">call</code> 메서드 안에 인스턴스 변수로 존재해야 한다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 385px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 128.05194805194807%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAAC+0lEQVRIx61U/UtTURi+f0vq0n7oA0Q2P5L8ojLEocxtd03nvpztw2V/QBqmmRpYRjgrrIku06kUBEFQ6IhyZaap6Nb6oURJ3Jyi4rane44oaubHtQsP59z3nPc5z3PP+14mXnAc6fFCJKQJEXUmCqkJIkguZeNcRiYys7KQlp4BUWLSrkhMSkbM8ThEC2JxLFpAwYji4pCdeBYpF1MRkyCAuUCKxnIL9KVGWMwm6PU65IpzIRaLtyEvLw8KBQuhUISTp05DEHuCkjN5Egmyc3JwPusCLrNKyFg5dHo9R6SHwWBAaWkpnWs0GmjUGjoWFxdDJpNBLpeDVSjoSCCVysAolUoUKguRn59PTyQbCYHFYoHVaoXJaFwn42AoKYFWq4VarYZKpQLJZVkWEk4Uy+WqVAowZKGszAqj0QSz2QzjFSN0Wh10Oi2NEcuGEgOKioroISYuRubl5ddgMlug4AiTk1MglxbgqsUAxuPxYHJykmJqaoqCxDbiXq8XPp+Pvm9d2zone9ZjHjD4zw/T2+NEVdVNdHY50dXpwN2m++h29qCmuhp9vb2or2vAg2Yb3by2toZwOLwnGLd7EHa7HTbbQzja29DheIb2Dgfa7E/R43Si83k3Bt2fKCFJiEQieys8qBVCdiDLq6ur+D03h5mZGSwvL2NlZQWBQICOhCQUCm2SEXX7KnQN9KO27g4e2ZrRbGtBa+sTNDTUo+/Fy79s7ke2qXBhYQGLi0HMz89z8NPR7/cfWNU2QnJzxNZuz2GINgnHvo2iueUxrlfewPjEBA2SA7baPJTCVe7j//w1jbHxcc724jZlvBTuTNp6o7w6xcv1oGvAhaGhL3j7rh8jI6OI8LC6rbA3EkOh8JHsUsIgVzLT09OY44qbYHZ2FgEuxvsbvne5cKumBvW3a9F0rxGVFRV49frNodpt114mpbL+Nwlt1iUvhUtLS7RTSP/6/QFq90iEP3zf4Xa7MfR5CMPDX/Hh4yCCwSB/wn8t8L7ljXrbCb6kfwBgoxYXcTdGKQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Bookshelf list"\n        title=""\n        src="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png"\n        srcset="/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-54c53.png 198w,\n/static/2016-12-03-sc3-58eb0336ccd6468d50eb76c6d049377e-3fe9a.png 385w"\n        sizes="(max-width: 385px) 100vw, 385px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="새로운-책을-등록하기"><a href="#%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%B1%85%EC%9D%84-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>새로운 책을 등록하기</h3>\n<p>웹 페이지에서 새로운 책을 등록하기 위해서는 <code class="language-text">new</code>, <code class="language-text">create</code> 액션과 패러매터를 전달해 줄 <code class="language-text">Form</code> 이 필요할 것이다. 먼저 <code class="language-text">books#new</code>, <code class="language-text">books#create</code> 액션을 생성해 준 뒤에 라우팅을 조금 깔끔하게 다듬어주도록 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/config/routes.rb</span>\nroot to<span class="token punctuation">:</span> <span class="token string">\'home#index\'</span>\nresources <span class="token symbol">:books</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:new</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">]</span>\n</code></pre>\n      </div>\n<p>하나미는 REST를 기본적으로 지원한다. 2번째 줄에서 사용 된 <code class="language-text">resources</code> 는 보통 레일즈 라우트 파일에서 자주 보았던 그 <code class="language-text">resources</code> 메서드처럼 사용하면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ bundle exec hanami routes\n        Name Method     Path           Action\n\n        root GET, HEAD  /              Web::Controllers::Home::Index\n       books GET, HEAD  /books         Web::Controllers::Books::Index\n    new_book GET, HEAD  /books/new     Web::Controllers::Books::New\n       books POST       /books         Web::Controllers::Books::Create</code></pre>\n      </div>\n<p>다음은 <code class="language-text">new</code> 템플릿에 폼 헬퍼(Form helper) 를 이용하여 간단한 폼을 작성해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-markup"><code class="language-markup"># apps/web/templates/books/new.html.erb\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Add book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>\n\n&lt;%=\n  form_for :book, routes.books_path do\n    div class: \'input\' do\n      label      :title\n      text_field :title\n    end\n\n    div class: \'input\' do\n      label      :author\n      text_field :author\n    end\n\n    div class: \'controls\' do\n      submit \'Create Book\'\n    end\n  end\n%>\n</code></pre>\n      </div>\n<p>폼 헬퍼의 구조가 레일즈의 <code class="language-text">form_for</code> 헬퍼와는 사뭇 다르다. 간단하게 차이점을 이야기하자면 하나미의 <code class="language-text">form_for</code> 는 레일즈의 <code class="language-text">form_tag</code> 헬퍼에 가깝다고 생각하면 된다. <a href="http://hanamirb.org/guides/helpers/forms/#technical-notes">하나미 가이드에 따르면</a> <code class="language-text">form_for do |f|</code> 형식으로 작성하는 것은 올바른 ERB 템플릿이 아니며, 하나미의 폼 헬퍼는 템플릿 엔진에 의존하지 않고 사용할 수 있도록(어느 템플릿 엔진을 사용하던 같은 루비 코드를 사용하도록) 구성되어 있다.</p>\n<p><code class="language-text">routes.books_path</code> 는 라우팅 헬퍼이며 상기 라우팅 구조에 있는 이름을 사용하여 <code class="language-text">routes</code> 뒤에 메서드 형식으로 붙여주면 자동으로 경로를 연결해준다.</p>\n<p>책을 생성하기 위한 <code class="language-text">create</code> 액션은 다음과 같이 작성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n      redirect_to routes<span class="token punctuation">.</span>books_path\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>이후 생성된 폼에 새로운 책을 등록해보니 문제없이 책이 생성되었다.</p>\n<h3 id="유효성-검사"><a href="#%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>유효성 검사</h3>\n<p>하나미는 유효성 검사를 모델이 아닌 컨트롤러 액션에서 처리한다. 물론 엔티티 클래스에 유효성 검사를 정의할 수 있지만, 유효성 검사는 입력 이후 가장 가까운 단계에서 이루어질 것을 권장하고 있다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/controllers/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Controllers</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Action</span>\n\n    expose <span class="token symbol">:book</span>\n\n    params <span class="token keyword">do</span>\n      <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:book</span><span class="token punctuation">)</span><span class="token punctuation">.</span>schema <span class="token keyword">do</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n        <span class="token function">required</span><span class="token punctuation">(</span><span class="token symbol">:author</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filled</span><span class="token punctuation">(</span><span class="token symbol">:str?</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n      <span class="token keyword">if</span> params<span class="token punctuation">.</span>valid<span class="token operator">?</span>\n        <span class="token variable">@book</span> <span class="token operator">=</span> <span class="token constant">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:book</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n        redirect_to routes<span class="token punctuation">.</span>books_path\n      <span class="token keyword">else</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">422</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">params</code> 로 시작하는 유효성 검사는 엔티티를 정의해놓은 것 같은 역할을 할 수 있겠다. 자세한 내용은 <a href="http://hanamirb.org/guides/actions/parameters/">가이드</a>를 참고하면 손쉽게 작성할 수 있다.</p>\n<p>만약 패러매터가 유효하지 않다면 HTTP 상태 코드 422(Unprocessable Entity)를 리턴하고, 그에 알맞는 뷰를 다시 표현해 주어야 한다. 현재 <code class="language-text">create</code> 액션에는 아무런 템플릿도 작성되어있지 않고, 실제로는 <code class="language-text">new</code> 템플릿을 그대로 사용하면 되기 때문에 뷰 파일에 알맞는 템플릿을 정의해주면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># apps/web/views/books/create.rb</span>\n<span class="token keyword">module</span> <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Views</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Books</span>\n  <span class="token keyword">class</span> <span class="token class-name">Create</span>\n    include <span class="token constant">Web</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">View</span>\n    template <span class="token string">\'books/new\'</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>지금까지 하나미를 통해 간단한 웹 애플리케이션을 개발하는 과정을 살펴보았다. 아주 기초적인 부분만 설명하였지만, 가이드를 살펴보고 하나미의 기능에 조금 더 익숙해진 뒤에는 github에 올라와 있는 몇몇 프로젝트 소스를 살펴보면서 하나미를 파악해보는 것을 추천한다.</p>\n<p>개인적으로 <a href="https://github.com/bruz/bookshelf-delivery-example">이 Github 저장소</a>를 방문해 보는 것을 추천한다. 하나미의 컨테이너 구조 및 컨트롤러 액션과 비지니스 로직을 구분하는 예를 잘 보여준 코드로 구성되어있다.(<code class="language-text">lib</code> 폴더 안에 있는 <code class="language-text">interactors</code> 폴더에 주목하라)</p>\n<p>본 포스팅에 사용된 코드는 <a href="https://github.com/emaren84/hanami-introduction">여기서</a> 확인해 볼 수 있다.</p>\n<h2 id="결론"><a href="#%EA%B2%B0%EB%A1%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결론</h2>\n<p>루비는 일반적 용도의 언어로써 충분히 완성도가 있는 언어이지만 상대적으로 다양한 분야에서 사용되는 파이썬에 비해 어느샌가 웹 개발에만 쓰이는 언어라는 선입견이 심어지게 되었다. 그리고 이러한 선입견의 중심엔 레일즈가 있다.</p>\n<p>레일즈가 등장하고 루비라는 언어가 크게 알려지는 데 기여한 것은 사실이다. 하지만 이 세상에 특정 문제 해결을 위한 단 하나의 정답은 거의 없다. 루비라는 언어 자체도 하나의 문제를 해결 하는데 다양한 방법을 제시하는 언어이기도 하다.</p>\n<p>하나미의 등장도 이런 맥락에서 바라볼 수 있다. 단순히 레일즈만이 루비로 웹 애플리케이션을 만드는 최고의 방법이 아니며, 하나미를 잘 활용하면 레일즈에 비해 유지보수가 쉽고, 더 성능이 좋은 웹 애플리케이션을 작성할 수도 있을 것이다.</p>\n<p>물론 하나미는 나온지 얼마 되지 않은 프레임워크이고, 기능 구현이 레일즈에 비해 상대적으로 부족한 점도 있다. <strong>특히 문서화가 되어있지 않아 소스 코드를 이리저리 살펴보아야 하는 부분들이 아직 많이 있다는 점이 아쉽다.</strong> 하지만 충분한 발전 가능성을 지니고 있고, 진정 루비라는 언어로 프로그래밍을 하는 재미를 주는 것이 매력적이기 때문에 루비 언어 자체를 좋아하는 사람들이라면 한번 사용해 볼 것을 추천한다.</p>\n<p>하나미의 정보를 더 얻고자 하는 분들에게는 다음의 링크를 살펴보면 된다.</p>\n<ul>\n<li><a href="http://hanamirb.org/guides/">하나미 공식 가이드</a> + <a href="https://github.com/hanami/hanami">소스 코드</a></li>\n<li><a href="https://gitter.im/hanami/chat">하나미 Gitter 채팅방</a></li>\n<li><a href="https://github.com/davydovanton/awesome-hanami">유용한 젬 및 링크 공유</a></li>\n</ul>',
id:"/home/circleci/repo/src/pages/posts/2016-12-03-hanami-introduction/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-12-03",path:"/posts/hanami-introduction",title:"레일즈(Ruby on Rails)와는 또 다른 루비 웹 프레임워크, Hanami(하나미)",tags:["Ruby","Rails","Hanami"],category:"Hanami"}},{excerpt:"MealMeetUpTask 구현 이번엔 개별 구성원의 상태를 변경해주는 메서드를 작성해야 한다.\n유저의 정보를 받고, 그 사람의 MealLog를 업데이트 해 주고, 마지막으로 MealMeetUpTask도 업데이트 해 주는 과정으로 이어질 것이다. Task - menu 작업을 하기에 앞서 작성해놓은 API…",html:'<h2 id="mealmeetuptask-구현"><a href="#mealmeetuptask-%EA%B5%AC%ED%98%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MealMeetUpTask 구현</h2>\n<p>이번엔 개별 구성원의 상태를 변경해주는 메서드를 작성해야 한다.\n유저의 정보를 받고, 그 사람의 MealLog를 업데이트 해 주고, 마지막으로 MealMeetUpTask도 업데이트 해 주는 과정으로 이어질 것이다.</p>\n<h3 id="task---menu"><a href="#task---menu" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task - menu</h3>\n<p>작업을 하기에 앞서 작성해놓은 API에 더 부족한 부분은 없는지 고려해보기로 하였다.\n(지금도 충분히 미완성이지만) 여태까지의 구현은 대부분 이 명세서를 보고 똑같이 데이터가 들어오면 저장을 하고, 같은 형태로 자료를 내보내는 데 초점을 맞추고 있었기 때문이다.\n하지만 명세서만 보고 맹목적으로 기능구현을 하다가 중복 처리 등을 놓치는 실수를 하게 되었으니 조심해야 한다.</p>\n<p>메뉴를 등록하는 과정을 순서대로 구성해보면 이런 방식으로 이루어질 것이라 예상한다.</p>\n<ol>\n<li>패러미터의 유효성을 검사한다 -> 400 or 401에러</li>\n<li>유효한 패러미터임이 확인되면 MeetUp을 조회한다</li>\n<li>MeetUp에 해당 유저가 있는지 조회한다 -> 없다면 400에러</li>\n<li>유저가 존재하면 MealLog와 Task를 업데이트한다.</li>\n<li>업데이트한 데이터를 기반으로 리턴 데이터(JSON)를 어댑터로 내보낸다.</li>\n</ol>\n<p><em>과정을 떠올리면서 갑자기 생각난 것이 왠지 <code class="language-text">meetup#create</code> 하면서 이미 등록된 User가 맴버로 들어갔을 때 해당 MeetUp에 연결되는 새로운 Log와 Task를 생성하고 연결해주는 작업을 제대로 수행했는지 잘 기억이 안난다. 나중에 확인해봐야겠다.</em></p>\n<p>4번의 경우에는 테이블 구조가 생각보다 복잡하게 얽혀 있다는 점을 감안하여 User, Log, Task 테이블들을 <code class="language-text">join</code> 한 다음 <code class="language-text">user_id</code>, <code class="language-text">meal_meet_up_id</code> 가 일치하는 Log, Task를 검색하고 갱신하도록 만들면 될 것이라고 생각한다.\n지금이야 적은 데이터를 다루니까 굳이 테이블을 조인해가면서 검색할 필요가 없다고 여길 수도 있지만, 만약에 사용성이 있어서 한 유저가 여러번 사용을 한 다고 가정하면 한 유저가 각기 다른 MeetUp에 등록되는 일이 당연히 있을 것이다. 그 부분을 간과하지 않도록 노력해야겠다.</p>\n<hr>\n<p>먼저 패러미터의 유효성을 검사하는 부분을 생각하다 보니, 기존에 있던 패러미터 검사 메서드들은 패러미터를 두개씩 검사하였지만, 이번에는 검사할 패러미터가 늘어났다(3~4개).\n거기다 메뉴를 추가하는 액션과 status만 업데이트하는 액션은 검사할 패러미터가 다르기에 하나의 <code class="language-text">check_params</code> 메서드로 모든 조건을 만족할 수는 없게 되었다. 패러미터마다 일일이 <code class="language-text">empty?</code> 를 넣어 확인해보고, 그걸 <code class="language-text">and</code> 나 <code class="language-text">or</code> 로 줄줄이 잇는 것은 꽤 복잡하고 불필요한 작업이다.</p>\n<p>그런데 구현하면서 전보다 조금은 나은 형태로 검사를 할 수 있는 아이디어가 떠올랐다. 검사할 패러매터들을 전부 배열에 넣은 뒤에 경우에 따라 <code class="language-text">any?</code> 혹은 <code class="language-text">all?</code> 메서드를 사용하여 검사를 하는 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># 기존 검사방법</span>\n<span class="token keyword">def</span> params_valid<span class="token operator">?</span>\n    <span class="token operator">!</span>member_params<span class="token punctuation">[</span><span class="token symbol">:messenger_room_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span> <span class="token operator">&amp;&amp;</span>\n        <span class="token operator">!</span>member_params<span class="token punctuation">[</span><span class="token symbol">:member_ids</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> params_authorizable<span class="token operator">?</span>\n    <span class="token operator">!</span>email_invalid<span class="token operator">?</span><span class="token punctuation">(</span>member_params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>\n        <span class="token operator">!</span>member_params<span class="token punctuation">[</span><span class="token symbol">:messenger</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n<span class="token keyword">end</span>\n\n<span class="token comment"># 새로운 검사방법</span>\n<span class="token keyword">def</span> params_valid<span class="token operator">?</span>\n    <span class="token punctuation">[</span>task_params<span class="token punctuation">[</span><span class="token symbol">:price</span><span class="token punctuation">]</span><span class="token punctuation">,</span> task_params<span class="token punctuation">[</span><span class="token symbol">:menu</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>all<span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">|</span>e<span class="token operator">|</span> <span class="token operator">!</span>e<span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> params_authorizable<span class="token operator">?</span>\n    <span class="token operator">!</span>email_invalid<span class="token operator">?</span><span class="token punctuation">(</span>task_params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>\n    <span class="token punctuation">[</span>task_params<span class="token punctuation">[</span><span class="token symbol">:messenger</span><span class="token punctuation">]</span><span class="token punctuation">,</span> task_params<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        task_params<span class="token punctuation">[</span><span class="token symbol">:messenger_room_id</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>all<span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">|</span>e<span class="token operator">|</span> <span class="token operator">!</span>e<span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>여러번 반복할 일을 많이 줄여서 조금이 더 깔끔한 코드가 작성되었다.</p>\n<p>다음은 메뉴를 기록하고 Task의 상태를 업데이트 하기 위해 필요한 정보들을 조회하고, 정보가 존재하는지 찾아야한다.\n해당 MeetUp을 찾는 것은 당연하고, User와 조합하여 찾는 Log, Task가 있는지 찾아야한다. 이 작업은 joins를 사용하면 될 것으로 생각하고, 콘솔에서 연습삼아 데이터 조회를 시도해보았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">tasks = MealMeetUpTask.joins(:meal_meet_up, :meal_log) # has_many, belongs_to에 따라 단수, 복수 유의\ntasks.where(meal_meet_ups: { id: 1}, meal_logs: { user_id: 4} ) # 자료추출 성공. 두 값에 모두 해당하는 task만 나온다.\n\nlogs = MealLogs.joins(:user, :meal_meet_up_tasks)\nlogs.where(meal_meet_up_tasks: { meal_meet_up_id: 1 }, users: { id: 1 })</code></pre>\n      </div>\n<p>이런식으로 자료를 가져와서 기록하면 될 것으로 보인다. 예시로 작성해본 join은 저렇게 광범위하게 하기 보단, 특정 MeetUp, 특정 User를 찾도록 먼저 where를 입력한 뒤에 <code class="language-text">joins</code> 를 사용하면 더욱 효과적일 것이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">MealLog.where(user_id: 1).joins(:meal_meet_up_tasks).where(meal_meet_up_tasks: {meal_meet_up_id: 1})</code></pre>\n      </div>\n<hr>\n<p>마지막 기록을 하고 잠시 작업을 손 못 대고 있다가 다시 시작하려니 개념을 많이 잊어버서 꽤 혼란스러웠다.\n다시 복습삼아 노트에 적어보니 Log를 찾으려면 다음과 같은 생각들이 떠올랐다.</p>\n<ul>\n<li>Log와 Task는 1:1 관계이다</li>\n<li>User와 MeetUp 정보만으로 Log와 Task를 찾는 과정이 조금 복잡하다</li>\n</ul>\n<p>일단 Log 모델에서 <code class="language-text">has_many</code> 로 관계를 설정해 둔 것을 <code class="language-text">has_one</code> 으로 변경하였다.\nLog를 먼저 찾아야 할지 Task를 먼저 찾아야 할지가 문제인데 Log를 먼저 찾는 시나리오를 떠올려 보기로 했다.</p>\n<ol>\n<li>User1이 MeetUp1에 등록되어있다. MeetUp에 User1이 등록될 때 Log1, Task1을 생성하였다.</li>\n<li>MealMeetUpTask 컨트롤러에서는 User1의 id와 MeetUp1의 id를 패러미터로 넘긴다.</li>\n<li>여기서 User1이 가진 Log 중 Log의 Task를 조회한다. 어떻게 조회하냐면 Task의 meet<em>up</em>id가 1인 로그를 가져오는 것이다. Log-Task는 1:1 관계이기 때문에 그렇게 복잡하지 않다.</li>\n<li>Log를 업데이트 하고 나면 연결된 Task를 업데이트한다.</li>\n</ol>\n<p>가정을 실험해 보기 위해 MeetUp을 두개 생성하고 같은 맴버들을 집어넣으려고 했는데 새 MeetUp에는 맴버가 한명도 들어가지 않는 오류가 발생해서 이를 먼저 해결해야겠다.</p>\n<hr>\n<h3 id="맴버-등록-버그-수정"><a href="#%EB%A7%B4%EB%B2%84-%EB%93%B1%EB%A1%9D-%EB%B2%84%EA%B7%B8-%EC%88%98%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>맴버 등록 버그 수정</h3>\n<ul>\n<li>MeetUp를 여러 개 생성하고 나서 같은 맴버를 다른 MeetUp에 등록할 시 등록이 안된다.</li>\n<li>MeetUp에 맴버를 등록할 때 만약에 해당 맴버가 없으면 User의 <code class="language-text">init_member</code> 메서드로 연결되는데, 이 메서드는 단순히 전체 DB에서 중복되는 맴버가 있는지 검사하고 아예 없을때만 User를 새로 생성하는 역할을 한다.</li>\n<li>문제를 해결하려면 DB에 같은 맴버가 있지만 다른 MeetUp에 등록할 시 처리를 따로 해 주어야겠다.</li>\n</ul>\n<p>모델 구조가 내가 생각하던 것 보다 복잡하다보니 문제 해결을 위한 아이디어가 바로 떠오르지 않는게 아쉽다. 유저를 등록할 때의 경우의 수를 다시 상정해보면</p>\n<ul>\n<li>Meetup과 member를 모두 처음 등록하는 경우: 문제 없음. 그냥 해당 MeetUp의 Task 명단에 맴버가 없으니 바로 새로운 User > Log > Task 생성</li>\n<li>Meetup 한개에 Member가 추가 등록되는 경우: 문제 없음. DB에 등록되어 있지 않은 User면 똑같이 User > Log > Task 생성</li>\n<li>MeetUp 갯수에 상관 없이 DB에 등록된 적 있는 User를 등록하려고 할 때: 이 때가 문제. 현재는 단순히 User가 존재하지 않으면 새로 생성하는것 까지만 한다.</li>\n</ul>\n<p>그럼 세번째 문제를 해결하기 위해 필요한 것은 <strong>User가 있는지 검사하고</strong>, <strong>있다면 해당 User가 MeetUp에 등록되어있는지 검사하고</strong>, <strong>MeetUp에 등록되어있지 않다면 해당 MeetUp과 연결되는 Log, Task를 생성</strong> 하는 과정일 것이다.</p>\n<p>결국 User 모델을 조금 수정해주어서 해결할 수 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/user.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token comment"># 새로운 맴버 등록시 필요한 일련의 과정들</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">init_member</span><span class="token punctuation">(</span>member_uid<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    user <span class="token operator">=</span> <span class="token function">find_by</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> member_uid<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> user<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>\n      result <span class="token operator">=</span> <span class="token function">enroll_new_user</span><span class="token punctuation">(</span>member_uid<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    <span class="token keyword">elsif</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">find_enrolled_meetup</span><span class="token punctuation">(</span>meetup<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>empty<span class="token operator">?</span>\n      result <span class="token operator">=</span> <span class="token function">enroll_exist_user</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n    result <span class="token comment"># Admin 등록을 위해 user정보가 리턴되어야 함</span>\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># DB에 기록되어있지 않은 맴버를 새로 생성</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">enroll_new_user</span><span class="token punctuation">(</span>member_uid<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    user <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> member_uid<span class="token punctuation">)</span>\n    user_log <span class="token operator">=</span> <span class="token constant">MealLog</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    <span class="token constant">UserMessenger</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span> messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">)</span>\n    <span class="token constant">MealMeetUpTask</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>meal_log_id<span class="token punctuation">:</span> user_log<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                          meal_meet_up_id<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                          task_status<span class="token punctuation">:</span> task_code<span class="token punctuation">)</span>\n    user\n  <span class="token keyword">end</span>\n\n  <span class="token comment"># DB에 등록된 적 있는 맴버가 새로운 MeetUp에 등록되는 경우</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">enroll_exist_user</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    user_log <span class="token operator">=</span> <span class="token constant">MealLog</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    <span class="token constant">MealMeetUpTask</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>meal_log_id<span class="token punctuation">:</span> user_log<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                          meal_meet_up_id<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                          task_status<span class="token punctuation">:</span> task_code<span class="token punctuation">)</span>\n    user\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n  <span class="token comment"># 해당 user의 MeetUp등록 여부를 찾기 위해 Log > Task 연결하여 검색</span>\n  <span class="token keyword">def</span> <span class="token function">find_enrolled_meetup</span><span class="token punctuation">(</span>meetup_id<span class="token punctuation">)</span>\n    meal_logs<span class="token punctuation">.</span><span class="token function">joins</span><span class="token punctuation">(</span><span class="token symbol">:meal_meet_up_task</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>meal_meet_up_tasks<span class="token punctuation">:</span>\n                                              <span class="token punctuation">{</span> meal_meet_up_id<span class="token punctuation">:</span> meetup_id <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>MeetUp에 User가 등록되어있는 지 여부는 MeetUp에 속한 Task가 있는지 여부로 구분하였다. 맴버가 등록된 적이 없으면 MeetUp에 해당하는 Log, Task를 작성한 적이 없을 테니까.\n수정해놓고 중간에 admin 등록하는 부분이 꼬이긴 했는데 해당 user를 반드시 리턴해주어야 그 정보로 admin을 등록하도록 설정해 두었기 때문이다.</p>\n<p><code class="language-text">find_enrolled_meetup</code> 메서드가 실제로 User 모델과는 관련이 좀 적어보이지만, 적어도 User에 등록된 Log를 가져오는 것 부터 시작하니 괜찮을 것이다.</p>\n<h3 id="다시-task---menu"><a href="#%EB%8B%A4%EC%8B%9C-task---menu" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다시 Task - Menu</h3>\n<p>버그를 수정하면서 <code class="language-text">find_enrolled_meetup</code> 을 만들어서 뜻밖의 밑작업이 완료되었으니 나머지는 실질적으로 메뉴 추가가 가능하도록 만들면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># meet_up_tasks_controller.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> menu\n    <span class="token variable">@meetup</span> <span class="token operator">=</span> find_meetup\n    <span class="token variable">@meal_log</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">update_menu</span><span class="token punctuation">(</span><span class="token variable">@meetup</span><span class="token punctuation">,</span> task_params<span class="token punctuation">)</span>\n    <span class="token function">render_201</span><span class="token punctuation">(</span><span class="token function">menu_response</span><span class="token punctuation">(</span><span class="token variable">@meal_log</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n\n<span class="token comment"># models/user.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">update_menu</span><span class="token punctuation">(</span>meetup<span class="token punctuation">,</span> user_info <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    user <span class="token operator">=</span> <span class="token function">find_by</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> user_info<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    user_log <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">find_enrolled_meetup</span><span class="token punctuation">(</span>meetup<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token comment"># 해당 MeetUp에 속하는 MealLog</span>\n    user_log<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>menu_name<span class="token punctuation">:</span> user_info<span class="token punctuation">[</span><span class="token symbol">:menu</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">:</span> user_info<span class="token punctuation">[</span><span class="token symbol">:price</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    user_log\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>그런데 이상하게 정보 업데이트가 되지 않는 문제가 있어서 확인해보니 <code class="language-text">find_enrolled_meetup</code> 의 결과가 배열로 리턴되는 것이었다. 어차피 나올 값은 하나밖에 없는데..\n알고보니 결과를 검색할 때 <code class="language-text">where</code> 를 사용하면 배열로 리턴되고, <code class="language-text">find_by</code> 를 쓰면 검색 결과의 첫 번째 결과를 리턴한다고 한다. 막연하게 결과값이 하나만 나오는 건 알고 있었는데 이제 제대로 활용해야지.</p>\n<p>결과값을 리턴하는 JSON을 만들 때 기존에는 해당하는 값을 일일이 DB에서 꺼내오는 방식의 메서드를 작성했었는데, 막상 \'굳이 그럴 필요가 있나?\' 라는 생각이 들었다. 멘토님은 \'어떻게 구현하는게 좋은 설계일까?\' 고민해보고 실제 상황이 닥치면 그 상황에 맞는 최적의 솔루션을 도출하는 연습이 필요하다고 조언해주셨다.</p>\n<p>지금 당장은 이정도 검색을 한다고 부하가 걸리는 수준이 아니고 나중에 변화가 생길 수도 있는 점을 고려하여 기존 방식대로 DB에서 해당 값을 가져오는 방식을 택했다.</p>\n<h3 id="api-명세-수정"><a href="#api-%EB%AA%85%EC%84%B8-%EC%88%98%EC%A0%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API 명세 수정</h3>\n<p>야밤의 토론을 통해 API 명세가 좀 문제가 있다는 점을 깨달았다. 애초에 이메일을 패러미터로 받을 필요가 별로 없고, 메신저 종류와 <code class="language-text">service_uid</code> 를 기본으로 받는 형태로 DB 구조와 현재 메서드를 전부 수정해야한다.</p>\n<p>명세서는 수정하였고, DB는 딱히 수정하지 않고 내부 로직만 변경하여도 충분할 것 같다.</p>\n<p>API를 좀 다듬어서 작성하고 나니 코드를 변경하는게 쉬워졌는데, 작성하는 코드에 일관성이 부여되기 때문이다.\n패러미터의 유효성을 검사하는 부분과, MeetUp을 검색하는 메서드를 <code class="language-text">application_controller</code> 하나에 두고 관리할 수 있게 되었다.\n또한 <code class="language-text">routes.rb</code> 에 미리 <code class="language-text">format</code> 을 json으로 지정해두어서 일일이 <code class="language-text">respond_to</code> 를 사용하지 않고 오류 경우의 수에 따라 에러 메세지를 각기 다르게 출력할 수 있도록 변경하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># application_controller.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> find_meetup\n    <span class="token variable">@meetup</span> <span class="token operator">=</span> <span class="token constant">MealMeetUp</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>messenger_room_id<span class="token punctuation">:</span>\n                                 params<span class="token punctuation">[</span><span class="token symbol">:data</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token symbol">:messenger_room_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n\n\n<span class="token comment"># members_controller.rb</span>\n<span class="token comment"># ...</span>\n    <span class="token keyword">def</span> check_meetup\n      meetup <span class="token operator">=</span> find_meetup\n      <span class="token keyword">if</span> meetup<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot find meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> meetup<span class="token punctuation">.</span>status<span class="token punctuation">.</span>value <span class="token operator">!=</span> <span class="token string">\'created\'</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot add members to this meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> member_params<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'there is no member to enroll\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>이런식으로 find_meetup은 어느 컨트롤러에서 호출하여 같은 결과값을 얻고, 경우의 수에 따라 다른 에러를 표시하도록 적용하였다.</p>\n<h3 id="task---update"><a href="#task---update" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task - Update</h3>\n<p>Update 액션은 menu를 만들 때 미리 작성해둔 메서드들 덕에 생각보다 금방 완성되었다.\nUser 모델에 <code class="language-text">find_enrolled_meetup</code> 을 사용하면 해당 유저와 유저가 참여한 MeetUp에 맞는 MealLog를 가져온다. 거기에 바로 1:1로 연결되어있는 Task를 꺼내고, 그 Task를 업데이트 해주는 식으로 코드를 작성하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/user.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">update_task_status</span><span class="token punctuation">(</span>meetup<span class="token punctuation">,</span> user_info <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    task_code <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_task_status</span><span class="token punctuation">(</span>user_info<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id\n    user <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> user_info<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    task <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">find_enrolled_meetup</span><span class="token punctuation">(</span>meetup<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>meal_meet_up_task\n    task<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>task_status<span class="token punctuation">:</span> task_code<span class="token punctuation">)</span>\n    task\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<h2 id="맴버-삭제-기능-추가"><a href="#%EB%A7%B4%EB%B2%84-%EC%82%AD%EC%A0%9C-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>맴버 삭제 기능 추가</h2>\n<p>처음에 미처 계획에 없었던 \'MeetUp에 추가된 맴버를 삭제하는 기능\'을 추가하기로 하였다.\n어찌 보면 당연히 있어야 하는 기능인데 실수로 넣지 않았다고 생각하는 쪽이 빠를 수도 있겠다.</p>\n<p>맴버를 MeetUp에서 삭제하는 것은 유저를 통채로 삭제할 필요는 없겠지만, 해당하는 MealLog, MeetUpTask는 삭제해줄 필요가 있겠다. 만약에 다시 등록할 때는 새로 만들어줘야 하는게 맞다고 생각하니까.</p>\n<p>기존에 구현해 둔 <code class="language-text">find_enrolled_meetup</code> 을 사용하면 해당 MeetUp에 속해있는 MealLog가 리턴되니까 이 로그를 삭제하도록 하고, 로그에 연결된 Task도 자동으로 삭제되도록 조치해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/meal_log.rb</span>\n<span class="token keyword">class</span> <span class="token class-name">MealLog</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>\n  has_one <span class="token symbol">:meal_meet_up_task</span><span class="token punctuation">,</span> dependent<span class="token punctuation">:</span> <span class="token symbol">:destroy</span>\n  belongs_to <span class="token symbol">:user</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>맴버 삭제를 하기 전에 패러미터에 따라 고려해야 할 사항은 다음과 같다.</p>\n<ul>\n<li>해당하는 MeetUp이 존재하는가?</li>\n<li>admin_uid가 입력되었는가? -> 오류(admin은 삭제 불가능)</li>\n<li>삭제하고자 하는 맴버가 해당 MeetUp에 등록되어 있는가?</li>\n</ul>\n<p>위 조건을 모두 만족한다면 정상적으로 해당 유저의 MealLog, Task를 삭제해주면 될 것이다.</p>\n<p>맴버를 추가할 때와 삭제할 때 한꺼번에 패러미터를 검사하는 메서드를 만들면 좋겠는데, 약간 차이가 있기 때문에 조금 비슷한 부분이 있더라도 따로 작성하게 되었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># members_controller.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> delete_member\n    target_member <span class="token operator">=</span> member_params<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s\n    <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">delete_member</span><span class="token punctuation">(</span>target_member<span class="token punctuation">,</span> <span class="token variable">@meetup</span><span class="token punctuation">)</span>\n    <span class="token function">render_200</span><span class="token punctuation">(</span><span class="token function">member_response</span><span class="token punctuation">(</span>find_meetup<span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n<span class="token comment"># ...</span>\n    <span class="token keyword">def</span> check_add_member\n      meetup <span class="token operator">=</span> find_meetup\n      <span class="token keyword">if</span> meetup<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot find meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> meetup<span class="token punctuation">.</span>status<span class="token punctuation">.</span>value <span class="token operator">!=</span> <span class="token string">\'created\'</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot add members to this meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> member_params<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'there is no member to enroll\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> check_delete_member\n      meetup <span class="token operator">=</span> find_meetup\n      member_id <span class="token operator">=</span> member_params<span class="token punctuation">[</span><span class="token symbol">:member_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s\n      <span class="token keyword">if</span> meetup<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot find meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> meetup<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>service_uid <span class="token operator">==</span> member_id\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot delete admin member\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> <span class="token function">get_members_list</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span><span class="token punctuation">.</span>include<span class="token operator">?</span><span class="token punctuation">(</span>member_id<span class="token punctuation">)</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot find the member_id in this meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n               status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n\n\n<span class="token comment"># models/user.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">delete_member</span><span class="token punctuation">(</span>member_uid<span class="token punctuation">,</span> meetup<span class="token punctuation">)</span>\n    user <span class="token operator">=</span> <span class="token function">find_by</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> member_uid<span class="token punctuation">)</span>\n    target_log <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">find_enrolled_meetup</span><span class="token punctuation">(</span>meetup<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    target_log<span class="token punctuation">.</span>destroy\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>얼떨결에 <code class="language-text">find_enrolled_meetup</code> 메서드가 대부분의 문제를 손쉽게 해결해주었다. 단순하게 joins 구문만 적절하게 이용해 주었을 뿐인데. MealLog에 설정해둔 <code class="language-text">dependency</code> 도 잘 작동하였다.</p>\n<h2 id="입력받은-가격을-분배하기"><a href="#%EC%9E%85%EB%A0%A5%EB%B0%9B%EC%9D%80-%EA%B0%80%EA%B2%A9%EC%9D%84-%EB%B6%84%EB%B0%B0%ED%95%98%EA%B8%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>입력받은 가격을 분배하기</h2>\n<p>이 앱의 제일 핵심기능인 \'n빵 / 각자 입력하여 얼마를 내야 하는지 알리기\' 기능이 여태까지 빠져 있었다.</p>\n<ul>\n<li>n빵 / 각자 입력을 나누는 스테이터스 코드</li>\n<li>MeetUp의 total<em>price가 없으면 맴버의 메뉴 등록을 막기 (먼저 total</em>price가 등록되어있어야함)</li>\n<li>모든 맴버가 가격 입력을 완료하면 MeetUp의 상태를 <code class="language-text">completed</code> 로 변경</li>\n</ul>\n<p>이런 기능이 추가적으로 구현될 필요가 있는데 먼저 코드테이블에 자료를 입력하는 seed파일을 수정하여 price를 지우고 <code class="language-text">price_avg</code>, <code class="language-text">price_sep</code> 두 가지 상태로 나누었다.</p>\n<p>그리고 MeetUp을 업데이트 할 때 <code class="language-text">price_avg</code> 상태일 때만 N빵 가격을 계산해서 각각 유저들의 Log에 해당 가격을 입력하도록 만들어 두었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/meal_meet_up.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> <span class="token function">update_status</span><span class="token punctuation">(</span>total_price<span class="token punctuation">,</span> meetup_status<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> meetup_status <span class="token operator">==</span> <span class="token string">\'price_avg\'</span>\n      <span class="token function">price_avg</span><span class="token punctuation">(</span>total_price<span class="token punctuation">)</span>\n    <span class="token keyword">else</span>\n      <span class="token function">update</span><span class="token punctuation">(</span>total_price<span class="token punctuation">:</span> total_price<span class="token punctuation">.</span>to_i<span class="token punctuation">,</span>\n             meetup_status<span class="token punctuation">:</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_meetup_status</span><span class="token punctuation">(</span>meetup_status<span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n\n  <span class="token keyword">def</span> <span class="token function">price_avg</span><span class="token punctuation">(</span>total_price<span class="token punctuation">)</span>\n    avg_price <span class="token operator">=</span> total_price <span class="token operator">/</span> meal_meet_up_tasks<span class="token punctuation">.</span>count\n    meal_meet_up_tasks<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>task<span class="token operator">|</span>\n      task<span class="token punctuation">.</span>meal_log<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>price<span class="token punctuation">:</span> avg_price<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>모든 맴버가 가격을 입력하도록 하는 메서드는 맴버가 상태를 업데이트 하는 메서드 마지막 부분에 따로 심어두었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/meal_meet_up_task.rb</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> check_completed\n    result <span class="token operator">=</span> meal_meet_up<span class="token punctuation">.</span>meal_meet_up_tasks<span class="token punctuation">.</span>all<span class="token operator">?</span> <span class="token keyword">do</span> <span class="token operator">|</span>task<span class="token operator">|</span>\n      task<span class="token punctuation">.</span>status<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">\'paid\'</span>\n    <span class="token keyword">end</span>\n    completed_code <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_meetup_status</span><span class="token punctuation">(</span><span class="token string">\'completed\'</span><span class="token punctuation">)</span>\n    meal_meet_up<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>status<span class="token punctuation">:</span> completed_code<span class="token punctuation">)</span> <span class="token keyword">if</span> result\n  <span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h3 id="n빵-분배하고-난-뒤에-고려하지-못한-것들"><a href="#n%EB%B9%B5-%EB%B6%84%EB%B0%B0%ED%95%98%EA%B3%A0-%EB%82%9C-%EB%92%A4%EC%97%90-%EA%B3%A0%EB%A0%A4%ED%95%98%EC%A7%80-%EB%AA%BB%ED%95%9C-%EA%B2%83%EB%93%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>n빵 분배하고 난 뒤에 고려하지 못한 것들</h3>\n<ul>\n<li>MeetUp의 상태가 <code class="language-text">price_avg</code> 일 때 개별 맴버들이 메뉴를 수정하는 것을 차단해야했다</li>\n<li>맴버들이 가격만 수정하려고 하는데도 메뉴도 입력하라는 오류가 발생</li>\n<li>상태 업데이트 없이 MeetUp의 현재 상태를 점검할 수 있도록 하는 API 추가</li>\n</ul>\n<p>점점 처리해야하는 에러 경우의 수들이 늘어나면서 rubocop에 걸리기가 쉬워지고 있다.\n에러 처리도 파트별로 나누어야 할지, 더 쪼갤 수 있는 방법이 있을지 고민해보아야 할 것 같다.</p>\n<p>위 두가지 버그성 문제들은 생각보다 간단하게 해결할 수 있었다. 첫 번째 문제와 두 번째 문제 모두 필터에서 걸러내는 경우의 수를 약간 조정해주는 정도로 해결되었고, 마지막 문제도 MeetUp을 그대로 조회하여 보여주기만 하면 되기 때문에 금방 처리하였다.</p>\n<p>이후에는 새 맴버를 추가받지 못하도록 고려하는 타이밍이 언제 이루어져야 하는가에 대한 문제가 있었는데</p>\n<ul>\n<li>세팅이 끝났다는 커맨드를 직접 날리려서 처리하거나 (DB에 새로운 필드 추가)</li>\n<li>맴버 추가가 잠기는 시점을 변경 (기존엔 MeetUp 상태가 \'created\'일 때만 맴버 추가 가능)</li>\n</ul>\n<p>조금 돌아가는 길이더라도 첫 번째가 깔끔하게 될 것이라 생각되어 새로운 필드 <code class="language-text">member_fixed</code> 를 MeetUp 모델에 추가하고, 메서드 수정을 가하기로 했다.</p>\n<ul>\n<li>MeetUp 모델에 member_fixed (BOOL) 필드 추가</li>\n<li>새 MeetUp 생성시 member_fixed (default false)</li>\n<li>MeetUp 모델 Update시 member_fixed 값 확인하도록 수정 (없으면 에러)</li>\n<li>맴버 등록 할 때 member_fixed가 true이면 에러 출력</li>\n<li>맴버 삭제시엔 굳이 그 여부 확인 안해도 될듯</li>\n</ul>\n<p>이렇게 비교적 간단히 해결할 문제로 생각했으나 맴버가 변경되는 시점에 따라 자동으로 금액 재조정을 해 주어야 할지 이미 금액을 지불한 인원의 경우엔 상태를 어떻게 처리해야 할지 정책적인 부분을 고려할 필요가 있어서 생각보다 굉장히 복잡한 문제였다.</p>\n<p>아마 초기에 기획, 설계 회의를 할 때 이 문제가 도마에 올랐었다가 얼렁뚱땅 미루어진 것 같았는데, 이번 작업에는 결국 수정을 포기하는 쪽으로 가기로 했다.</p>\n<p>자잘한 버그를 잡으면서 또 뼈저리게 느낀건데 패러미터로 들어온 타입과(보통 String) 내가 처리하려고 하는 타입(예를 들면 Integer)이 다르면 형변환을 제때제때 해 주어야 하는 것을 잊으면 안되겠다. 자꾸 그런 부분에서 버그가 발생하고 있다.</p>\n<p>또 발견된 버그는 총 금액보다 큰 값을 개별 맴버가 입력하려할 때 차단하는 수단이 없다는 점이다. 매번 발견되는 버그들에는 공통점이 있는데, 당장의 기능은 구현이 되어 있는데 유저가 프로그램 내부가 돌아가는 것을 고려하지 않고 자연스럽게 사용하다가 발생할 수 있는 모든 경우의 수를 전혀 고려하지 않고 있다는 점이다.</p>\n<blockquote>\n<p>음… 사실 그게 가장 고통스러우면서도 꼭 해야되는 부분입니다.\n머리에 쥐날때까지 모든 케이스를 다 고려할 수 있는 훈련을 계속해야 고급 개발자가 될 수 있죠.</p>\n</blockquote>\n<p>팀원분이 이런 조언을 해주셨으니 기능 하나를 구현할 때 그로 인해 발생할 수 있는 경우의 수를 최대한 고려해보도록 노력해야겠다.</p>\n<h2 id="meetup-상태-열람-show"><a href="#meetup-%EC%83%81%ED%83%9C-%EC%97%B4%EB%9E%8C-show" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MeetUp 상태 열람 (Show)</h2>\n<p>가격 분배 기능 구현 하면서 MeetUp의 상태를 열람하는 기능이 필요하다는 피드백이 있어 간단하게 구현을 했었다.\n그런데 그 정도로는 부족하고 MeetUp이 있으면 관련된 모든 정보를 가져오도록 수정해야할 필요가 있었다.</p>\n<p>또한 <code class="language-text">paying_sep</code>, <code class="language-text">paying_avg</code> 로 구분중이었던 지불 방법을 다른 필드로 분리해서 관리해야할 필요성도 발생하였다.</p>\n<p>먼저 MeetUp 모델에 <code class="language-text">pay_type</code> 컬럼을 추가하였다. 그리고 이번에는 CodeTable에 굳이 조회용 코드를 추가하지 않았는데, 이렇게 하는게 결국은 의미가 없다고 생각했기 때문이다.\n애초에 입력값은 직접 String으로 받고, 검색도 그 String으로 하고, 저장만 id로 하고 있는건데 저장 부분에선 약간 효율적일 수 있겠으나 검색 부분엔 큰 차이가 없어보였기 떄문이다.</p>\n<p><code class="language-text">pay_type</code> 가 추가되면서 적어도 확실한건 MeetUp을 Update 하는 상태는 변경되어야 한다는 점이다. 그리고 status가 <code class="language-text">paying</code> 일 때에는 반드시 <code class="language-text">pay_type</code>가 있도록 만들어야겠다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># meal_meet_up_controller.rb</span>\n<span class="token comment"># ...</span>\n    <span class="token comment"># 해당하는 meetup이 없거나 admin_uid가 불일치, pay_type이 올바르지 않으면 에러</span>\n    <span class="token keyword">def</span> check_meetup_update\n      meetup <span class="token operator">=</span> find_meetup\n      <span class="token keyword">if</span> meetup<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'cannot find meetup\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">400</span>\n      <span class="token keyword">elsif</span> meetup<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>service_uid <span class="token operator">!=</span> meetup_params<span class="token punctuation">[</span><span class="token symbol">:admin_uid</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_s\n        render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> error<span class="token punctuation">:</span> <span class="token string">\'invalid admin_uid\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">401</span>\n      <span class="token keyword">elsif</span> meetup<span class="token punctuation">.</span>status<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">\'paying\'</span> <span class="token operator">||</span> meetup_params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">\'paying\'</span>\n        validate_pay_type\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> validate_pay_type<span class="token operator">?</span>\n      <span class="token keyword">unless</span> <span class="token string">%w(n s)</span><span class="token punctuation">.</span>include<span class="token operator">?</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">[</span><span class="token symbol">:pay_type</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n        <span class="token function">render_error_400</span><span class="token punctuation">(</span><span class="token string">\'invalid pay type\'</span><span class="token punctuation">)</span>\n      <span class="token keyword">end</span>\n    <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>Show로 리턴하는 정보는 기본적으로 update시의 리턴+딸려있는 맴버들의 각종 정보이다. 그래서 먼저 update시의 리턴 정보를 가져온 다음에 필요한 정보를 덧붙이는 형태로 만들었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># meal_meet_up_helper.rb</span>\n<span class="token comment"># 컨트롤러가 너무 커져서 리턴용 json을 출력하는 메서드들을 다 헬퍼 모듈로 옮겼다.</span>\n<span class="token comment"># ...</span>\n  <span class="token keyword">def</span> <span class="token function">response_json_show</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span>\n    basic_data <span class="token operator">=</span> <span class="token function">response_json_update</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span>\n    members_info <span class="token operator">=</span> meetup<span class="token punctuation">.</span>meal_meet_up_tasks<span class="token punctuation">.</span>map <span class="token keyword">do</span> <span class="token operator">|</span>task<span class="token operator">|</span>\n      log <span class="token operator">=</span> task<span class="token punctuation">.</span>meal_log\n      <span class="token punctuation">{</span> member_uid<span class="token punctuation">:</span> log<span class="token punctuation">.</span>user<span class="token punctuation">.</span>service_uid<span class="token punctuation">,</span>\n        menu<span class="token punctuation">:</span> log<span class="token punctuation">.</span>menu_name<span class="token punctuation">,</span>\n        price<span class="token punctuation">:</span> log<span class="token punctuation">.</span>price<span class="token punctuation">,</span>\n        status<span class="token punctuation">:</span> task<span class="token punctuation">.</span>status<span class="token punctuation">.</span>value <span class="token punctuation">}</span>\n    <span class="token keyword">end</span>\n    basic_data<span class="token punctuation">[</span><span class="token symbol">:data</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>members_count<span class="token punctuation">:</span> members_info<span class="token punctuation">.</span>count<span class="token punctuation">,</span>\n                            members<span class="token punctuation">:</span> members_info<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>',
id:"/home/circleci/repo/src/pages/posts/2016-08-10-easylunch-api-devlog-3/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-08-10",path:"/posts/easylunch-api-devlog-3",title:"Easylunch Api 서버 제작기 - 3",tags:["Rails"],category:"Rails"}},{excerpt:"Members 구현 이번엔 생성된   에 새로운 맴버를 추가하는 기능을 구현할 것이다.\n필요한 메서드는    하나 뿐이라 생각보다 복잡하진 않을 것이라 생각된다. 먼저 Members 컨트롤러를 생성한다. 그리고 routes.rb 파일에 api 경로를 추가해준다. 텅텅 빈 Members 컨트롤러에는 기본적으로 들어갈 메서드들이 있다. Strong parameters 맴버들을 등록하기 위한 정보가 충분한지 검사 기본적인 약속 (email…",html:'<h2 id="members-구현"><a href="#members-%EA%B5%AC%ED%98%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Members 구현</h2>\n<p>이번엔 생성된 <code class="language-text">MealMeetUp</code> 에 새로운 맴버를 추가하는 기능을 구현할 것이다.\n필요한 메서드는  <code class="language-text">add_members</code> 하나 뿐이라 생각보다 복잡하진 않을 것이라 생각된다.</p>\n<p>먼저 Members 컨트롤러를 생성한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">rails g controller Members</code></pre>\n      </div>\n<p>그리고 routes.rb 파일에 api 경로를 추가해준다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># routes.rb\n# ...\npost &#39;/members&#39; =&gt; &#39;members#add_member&#39;, defaults: { format: &#39;json&#39; }</code></pre>\n      </div>\n<p>텅텅 빈 Members 컨트롤러에는 기본적으로 들어갈 메서드들이 있다.</p>\n<ul>\n<li>Strong parameters</li>\n<li>맴버들을 등록하기 위한 정보가 충분한지 검사</li>\n<li>기본적인 약속 (email, messenger) 정보가 제대로 작성되어 있는지 검사</li>\n<li>해당하는 <code class="language-text">messenger_room_id</code> 의 검색</li>\n</ul>\n<p>사실 Strong parameters를 제외한 나머지 기능들은 기존에 <code class="language-text">MealMeetUp</code> 을 구현할 때 만들었던 메서드들을 거의 그대로 써도 될 것이다.\n하지만 미묘한 차이가 있어서 지금은 새로 작성하고 나중에 리팩토링 할 때 합치기로 마음먹었다.</p>\n<p>작업을 하다보니 조금 애매하게 생각되는 부분이 \'멤버를 추가하면 DB에 어떻게 기록이 되어야 할까?\' 라는 부분이다.</p>\n<ol>\n<li>json으로 member_id를 받고, 그 아이디로 새로운 유저를 생성한다.</li>\n<li>그 유저에 해당하는 UserMessenger, UserLog를 생성한다.</li>\n<li>UserLog에 속하는 MealMeetUpTask를 생성한다.</li>\n<li>MealMeetUpTask의 meal<em>meet</em>up<em>id(외부키)는 현재 등록할 meal</em>meet_up으로 지정해준다.</li>\n</ol>\n<p>이렇게 하면 될 것 같은데, User의 컬럼을 <code class="language-text">id(기본키) / email</code> 로 지정해둔게 걸린다. 보통 메신저에서 제공하는 user의 고유 식별 정보를 넣는데 써야 할 것 같은데, 슬랙의 경우엔 이메일이 아닌 듯 하여 아예 컬럼명을 수정해야겠다.</p>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 790px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 55.52977571539057%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACE0lEQVQoz2VT2W4TQRDM/38EIEQiQpInIgI2DwihSBGXLzlrO7733vXa673m8KYorw9Afij1zKinprq650xKCSE0sUGWpfC8IaJoAsftw7IesVhMEARDxHEIpZgnBaPcQ+3xd38mpcZ0+huj0Xf4vg/DeI3J5Jy44NkbmPNLxlcwzQbKDSAFBRQaea6QJAXSVFTrPFOQkoRFIWHbQ6oYIQxXGA5JPm7CDwbw/D48RtfvwfHmWOcSM6uD0eQDK/iCyfQjpvMac75ibtVZmbUjzMhelqCKAZW9Z0IfmQShK+SqRJLnWEUJzEETxsMV5p072MYn2I+EUcOsfYtlYG4JBaXnFaHvD/D09JJK29AKhILWG+iNQhoniIKIuSmKVCJfC2TrghAVtvutHZVCz/Uo12FDZiy5Rc+6WIQOiW2emYiXK4hEYLmM6FmKZwCKLyotd1Ed4tbDTKPbqWEwegHLuYblXtOPS67f0bcbuMEVHHZbsezVaskHHLiuRaXrimA7JQdUhDnljxv3GH+7QdCoI2zVsWh/PsL7dQd3NkBElZblotu9ZTynPQYJnkkk/ics2PZ1EGMxD7CyQ0SmS3hYWt5+7dKjpLqQJhkb16LCe6q1SbA5VbiOYs7hT7b/AWE0hWZ3dKmJzRGH0nZDXPITlNXM/Ut2JEyTGK3mW/R6F7CtH9WvkWJfhhAnl+T+p5ye7wj/AFtbOpuebKd7AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="기존에 작성된 DB 다이어그램"\n        title=""\n        src="/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-ffc88.png"\n        srcset="/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-d16f8.png 198w,\n/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-f21b1.png 395w,\n/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-ffc88.png 790w,\n/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-81e7e.png 1185w,\n/static/2016-08-02-sc1-24c66a374eb8b785c331891b9eeaf950-14df9.png 1293w"\n        sizes="(max-width: 790px) 100vw, 790px"\n      />\n    </span>\n  </span>\n  </p>\n<hr>\n<p>슬랙에 팀원들의 의견을 물으니 UserMessenger 테이블에 email컬럼을 넣고, User의 email은 service_uid등으로 바꾸는게 좋겠다는 의견을 받았다.</p>\n<p>그렇게 생각하니 애매하게 보이던 맴버 추가 개념이 조금 명쾌해졌고, DB 컬럼을 먼저 수정해보기로 하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">ChangeUserAndMessenger</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Migration</span>\n  <span class="token keyword">def</span> change\n    rename_column <span class="token symbol">:users</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token symbol">:service_uid</span>\n    add_column <span class="token symbol">:user_messengers</span><span class="token punctuation">,</span> <span class="token symbol">:messenger_user_email</span><span class="token punctuation">,</span> <span class="token symbol">:string</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>다시 맴버 추가 과정을 구성한다면</p>\n<ol>\n<li>json으로 넘어온 member_ids에서 하나하나씩 유저를 추가한다.</li>\n<li>유저에 해당하는 UserMessenger, UserLog를 생성한다. 만약 이메일이 있다면 이메일도 추가한다.(Optional)</li>\n<li>UserLog에 속하는 MealMeetUpTask를 생성한다.</li>\n<li>그리고 각 유저의 MealMeetUpTask는 현재 이용중인 MealMeetUp에 속하게 된다.</li>\n</ol>\n<p>조금 직관적인 느낌은 떨어지게 보인다. 바로 유저가 MealMeetUp이라는 그룹과 연결되는 것이 아니니까.\n맴버 추가 과정을 하나의 메서드화하고, 리스폰스로 생성할 json도 메서드로 한번에 만들도록 하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">MembersController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>\n<span class="token comment"># ...</span>\n\n <span class="token keyword">def</span> <span class="token function">add_flow</span><span class="token punctuation">(</span>member<span class="token punctuation">,</span> meetup<span class="token punctuation">)</span>\n      user <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> member<span class="token punctuation">)</span>\n      user_log <span class="token operator">=</span> <span class="token constant">MealLog</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n      <span class="token constant">UserMessenger</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                           messenger_code<span class="token punctuation">:</span> load_messenger_code<span class="token punctuation">)</span>\n      <span class="token constant">MealMeetUpTask</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>meal_log_id<span class="token punctuation">:</span> user_log<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            meal_meet_up_id<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            task_status<span class="token punctuation">:</span> init_task_code<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_user_response</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span>\n      <span class="token punctuation">{</span> data<span class="token punctuation">:</span>\n        <span class="token punctuation">{</span> email<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>service_uid<span class="token punctuation">,</span>\n          messenger<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>messenger<span class="token punctuation">.</span>value<span class="token punctuation">,</span>\n          messenger_room_id<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>messenger_room_id<span class="token punctuation">,</span>\n          member_ids<span class="token punctuation">:</span> <span class="token function">get_members_list</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>\n    <span class="token keyword">end</span>\n<span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>사실 맨 밑의 member_ids는 좀 복잡하게 가져오더라도 맴버 추가에 성공한 id만 가져와야 하는게 맞을 것 같다.</p>\n<p>실제로 실행을 시켜 보니 member_ids라는 패러매터를 아예 가져오지 못했는데, 이는 패러매터의 형식이 배열로 되어 있어서 그렇다. 배열로 된 패러매터를 가져올 때는 스트롱 패러매터에서 형식을 지정해 주어야 한다</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">params.permit(:id =&gt; [])</code></pre>\n      </div>\n<p>service<em>uid로 컬럼명을 수정하면서 생긴 오류들을 잡아주고 차근차근 진행하고 있다가 확실히 response의 `member</em>ids` 를 제대로 MealMeetUp에 엮여있는 유저들만 가져오는게 맞다는 생각이 들었다.\n결국 가져와야 하는 것은</p>\n<p><strong>MealMeetUp에 속한 Task들 -> 각 Task를 가지고 있는 MealLog -> MealLog를 소유하고 있는 User의 service_uid</strong> 인 것이다.\nDB를 리셋하고 먼저 MealMeetUp을 하나 생성한 뒤에 유저 추가 과정을 거치니 잘 추가되었다.</p>\n<p>커밋을 한 뒤에 멘토님이 코드 리뷰와 함께 조언들을 해 주셨다.</p>\n<ul>\n<li>Fat Model, Skinny Controller</li>\n<li>컨트롤러는 최소한의 연결만 해주는 게 좋겠다.</li>\n<li>패러미터의 여부를 체크하는 것을 굳이 본 메서드에서 할 필요가 없어 보인다. -> before_action 사용</li>\n<li>member_ids의 유효성을 검사할 필요가 있다.</li>\n<li>메서드 이름은 다른사람이 이름만 보아도 무엇을 하는 작업인지 알 수 있어야 한다</li>\n<li>맴버 추가하는 일련의 과정을 담은 <code class="language-text">add_flow</code> 메서드를 user모델에 정의해서 쓸 필요가 있겠다 (<code class="language-text">init_member</code> 같은 이름으로)</li>\n</ul>\n<p>대개 리펙토링을 하면서 처리해야 하는 부분들이지만, 멤버 추가를 유저 모델에 정의하는 지금이라도 처리해야할 필요가 있다.\n기존에 MealMeetUp을 만들 때 자동으로 어드민 유저를 생성하는데, 어드민 유저도 같은 방에 포함되는 유저로서 MealLog, Messenger, Task 등록 등의 작업을 해 주어야 한다고 생각하기 때문이다.</p>\n<p>그런데 지금은 MealMeetUp 생성 당시 어드민 유저의 service<em>uid가 없기 때문에, 생성을 하자니 조금 애매한 부분이 있다.\n먼저 떠오르는 생각으로는 MealMeetUp 생성만 하고 어드민은 따로 Members 추가 시에 지정하는 방법이 있겠다. 아니면 처음 MealMeetUp 생성때부터 어드민이 될 사람의 service</em>uid를 받아야 한다.</p>\n<p><em>(추가)</em> 그냥 MealMeetUp 생성시에 어드민이 될 사람의 service_uid도 받는 방식으로 수정을 하기로 하였다.</p>\n<p>그리고 맴버가 추가된 MealMeetUp의 상태도 변화시켜서, 추가적인 유저 입력을 막을 수 있어야한다. 지금 방식대로라면 계속 유저를 추가하는대로 새로운 유저를 집어넣고 있는데, 이는 제대로된 방법이 아니다. <em>(처리 완료)</em></p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># members_controller.rb</span>\n\n<span class="token keyword">def</span> add_member\n    <span class="token variable">@meetup</span> <span class="token operator">=</span> find_meetup\n    entry_members <span class="token operator">=</span> member_params<span class="token punctuation">[</span><span class="token symbol">:member_ids</span><span class="token punctuation">]</span>\n    entry_members<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token punctuation">{</span> <span class="token operator">|</span>member<span class="token operator">|</span> <span class="token function">init_member</span><span class="token punctuation">(</span>member<span class="token punctuation">,</span> <span class="token variable">@meetup</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n\n    <span class="token comment"># 맴버가 추가된 MeetUp은 상태를 변경해준다.</span>\n    <span class="token variable">@meetup</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>meetup_status<span class="token punctuation">:</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_status</span><span class="token punctuation">(</span><span class="token string">\'paying\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n\n    <span class="token function">render_200</span><span class="token punctuation">(</span><span class="token function">add_user_response</span><span class="token punctuation">(</span><span class="token variable">@meetup</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<h2 id="refactoring-1"><a href="#refactoring-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Refactoring (1)</h2>\n<p>현재까지 개발한 부분을 adapter와 연동해보기 위해 조금 미진한 부분을 수정하고 허로쿠에 배포해보기로 하였다.\n가장 우선적으로 수정해야겠다고 생각하는 부분이 처음 MealMeetUp 생성시 어드민도 <code class="language-text">init_member</code> 를 해 주는 것인데, 맨 처음 MealMeetUp 생성을 구현했을 때 만든 부분에서 많은 수정을 해야겠다.</p>\n<ul>\n<li>MeetUp 생성시 먼저 메신저 종류, room_id만 써서 생성한다. (생성시엔 상태를 \'created\' 로 지정)</li>\n<li>service<em>uid 로 user를 생성 `init</em>member` 메서드로 필요한 데이터를 다 같이 생성한다(MealLog, Messenger, Task)</li>\n<li>생성 된 user가 어드민이 된다.</li>\n</ul>\n<p>먼저 <code class="language-text">init_member</code> 메서드를 User모델로 옮기고 조금 추가적인 정보를 받도록 한다.\n그리고 처음 MeetUp 생성시에 필요한 정보만 넣어서 일단 생성을 하고, 그 MeetUp과 어드민이 될 맴버를 연결한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># models/user.rb</span>\n<span class="token comment"># 새로운 맴버 등록시 필요한 일련의 과정들</span>\n<span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">init_member</span><span class="token punctuation">(</span>member_uid<span class="token punctuation">,</span> meetup<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> task_code<span class="token punctuation">)</span>\n    user <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>service_uid<span class="token punctuation">:</span> member_uid<span class="token punctuation">)</span>\n    user_log <span class="token operator">=</span> <span class="token constant">MealLog</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    <span class="token constant">UserMessenger</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">)</span>\n    <span class="token constant">MealMeetUpTask</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>meal_log_id<span class="token punctuation">:</span> user_log<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            meal_meet_up_id<span class="token punctuation">:</span> meetup<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            task_status<span class="token punctuation">:</span> task_code<span class="token punctuation">)</span>\n    user <span class="token comment"># 바로 user를 사용가능하도록 return</span>\n<span class="token keyword">end</span>\n\n\n<span class="token comment"># models/meal_meet_up.rb</span>\n<span class="token comment"># 빈 MeetUp 생성</span>\n<span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">init_meetup</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n    <span class="token function">create</span><span class="token punctuation">(</span>messenger_code<span class="token punctuation">:</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_messenger</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:messenger</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n            messenger_room_id<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:messenger_room_id</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            meetup_status<span class="token punctuation">:</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_status</span><span class="token punctuation">(</span><span class="token string">\'created\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n\n<span class="token comment"># controllers/meal_meet_up_controller.rb</span>\n<span class="token keyword">def</span> create\n    <span class="token variable">@admin</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">init_member</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">[</span><span class="token symbol">:messenger_user_id</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">@meetup</span><span class="token punctuation">,</span>\n                                <span class="token function">load_messenger_code</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">)</span><span class="token punctuation">,</span>\n                                <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_task</span><span class="token punctuation">(</span><span class="token string">\'unpaid\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>\n    <span class="token function">update_additional_info</span><span class="token punctuation">(</span><span class="token variable">@admin</span><span class="token punctuation">,</span> <span class="token variable">@meetup</span><span class="token punctuation">)</span>\n    <span class="token function">render_201</span><span class="token punctuation">(</span><span class="token function">response_json_create</span><span class="token punctuation">(</span><span class="token variable">@meetup</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> update\n    <span class="token variable">@meetup</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>total_price<span class="token punctuation">:</span> meetup_params<span class="token punctuation">[</span><span class="token symbol">:total_price</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n                    meetup_status<span class="token punctuation">:</span> <span class="token function">load_status_code</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token function">render_200</span><span class="token punctuation">(</span><span class="token function">response_json_update</span><span class="token punctuation">(</span><span class="token variable">@meetup</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 복잡하게 <code class="language-text">if~else</code> 로 엮여있던 <code class="language-text">create</code>, <code class="language-text">update</code> 액션을 <code class="language-text">members_controller</code> 에서 썼던 <code class="language-text">before_action</code> 의 필터링을 적용하여 크게 다이어트 해 주었다.</p>\n<p>처음에 MealMeetUp을 만들 땐 돌아만 가게 만드느라 억지로 해쉬를 자르고 붙이고 하는 작업을 했었는데, 실질적으로 필요한 요소들을 조금 더 고민하고 수정을 하니 실제로는 더 적은 양의 코드로도 작성이 가능하게 되었다.</p>\n<p>하지만 코드를 작성하고 나서 실제 구동하여 테스트를 해보니 부족한 부분이 많았는데, 먼저 한번 유저를 추가하고 나면 더 추가하지 못하게 설계 한 부분이 미스였고, MealMeetUp도 중복 검사를 제대로 하지 못하고 있던 것이다.</p>\n<p>전반적으로 처음 코드를 작성할 때 중복 처리에 대해 크게 고민을 하지 않고 만든게 원인이었다. 조금 더 신중하게 코드를 작성해야 했었는데..</p>\n<p>특히 before<em>action을 너무 남용한 부분이 있었는데 `meal</em>meet<em>up#create` 만 해도 그냥 패러미터가 들어오자마자 무조건 MealMeetUp을 생성하도록 before</em>action을 하나 만들어 놓으니 나중에는 중복 검사를 할때 자꾸 \'이미 만들어진 meetup\' 이라는 오류를 내뿜게 되었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">MealMeetUpController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>\n  include <span class="token constant">MealMeetUpHelper</span>\n  before_action <span class="token symbol">:check_params</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">]</span>\n  before_action <span class="token symbol">:check_meetup_update</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:update</span><span class="token punctuation">]</span>\n  before_action <span class="token symbol">:check_meetup_create</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:create</span><span class="token punctuation">]</span>\n  <span class="token comment"># before_action :init_meetup, only: [:create]</span>\n\n  <span class="token keyword">def</span> create\n    init_meetup\n    <span class="token comment"># ...</span>\n</code></pre>\n      </div>\n<p>이렇게 수정하여 먼저 중복된 meetup이 있는지 확인을 하고, 없으면 생성을 하는 과정을 거치도록 수정하니 잘 작동하였다.\n앞으로도 수정할 부분은 많이 있을 것이지만, 한줄 한줄 코드를 작성할 때 조금 더 과정에 대해 심혈을 기울여 생각할 필요성을 크게 느꼈다.</p>',id:"/home/circleci/repo/src/pages/posts/2016-08-02-easylunch-api-devlog-2/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-08-02",path:"/posts/easylunch-api-devlog-2",title:"Easylunch Api 서버 제작기 - 2",tags:["Rails"],category:"Rails"}},{excerpt:"Clone repository 금방 하지 못했던 easylunch api 서버 프로젝트를 작성하기 시작했다.\n프로젝트 생성과 Gem 세팅 등은 이미 되어 있어서 github에 있는 레포를 클론하였고\nIssue #10 으로 분류되어 있어서   브랜치를 생성하였다.\n이번에는 Bitbucket에서 작성했던 프로젝트와 다르게 development 브랜치를 두지 않고 이슈 브랜치에서 바로 master…",html:'<h2 id="clone-repository"><a href="#clone-repository" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Clone repository</h2>\n<p>금방 하지 못했던 easylunch api 서버 프로젝트를 작성하기 시작했다.\n프로젝트 생성과 Gem 세팅 등은 이미 되어 있어서 github에 있는 레포를 클론하였고\nIssue #10 으로 분류되어 있어서 <code class="language-text">ISS#10</code> 브랜치를 생성하였다.\n이번에는 Bitbucket에서 작성했던 프로젝트와 다르게 development 브랜치를 두지 않고 이슈 브랜치에서 바로 master로 합치는 방식으로 진행하는가 보다.</p>\n<h2 id="모델-작성"><a href="#%EB%AA%A8%EB%8D%B8-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모델 작성</h2>\n<p>먼저 슬랙에 올라와 있던 모델 도면을 참고하여 모델을 작성하였다.\n처음엔 별 생각 없이 모델 생성하면서 string이나 integer만 구분하여 각 컬럼을 입력하고 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">rails g model MealLog user_id:integer menu_name:string price:integer meal_time:datetime</code></pre>\n      </div>\n<p>이렇게 테이블을 작성하고 나서 모델에서 따로 <code class="language-text">belongs_to</code> 와 <code class="language-text">has_many</code> 를 입력해줄 생각이었다.\n그러다 저번에 다른 튜토리얼에서 우연히 본 references를 이용할 생각이 뒤늦게 들어서 마이그레이션 파일을 변경해 주기로 했다.</p>\n<p>마이그레이션 시 타입을 references로 지정해주면 model<em>id 생성과 함께 관계 설정을 해주는 코드(`belongs</em>to<code class="language-text">/</code>has_many`)가 자동으로 삽입된다.\n다만 이미 마이그레이션 파일이 작성된 뒤였기 때문에(실행은 하지 않음) 다음과 같이 마이그레이션 파일을 변경해주었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">CreateMealLogs</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Migration</span>\n  <span class="token keyword">def</span> change\n    create_table <span class="token symbol">:meal_logs</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>\n      t<span class="token punctuation">.</span>references <span class="token symbol">:user</span>\n      t<span class="token punctuation">.</span>string <span class="token symbol">:menu_name</span>\n      t<span class="token punctuation">.</span>integer <span class="token symbol">:price</span>\n      t<span class="token punctuation">.</span>datetime <span class="token symbol">:meal_time</span>\n\n      t<span class="token punctuation">.</span>timestamps null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n    add_index <span class="token symbol">:meal_logs</span><span class="token punctuation">,</span> <span class="token symbol">:user_id</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그리고 직접 관계를 맺어주는 것과 별개로 CodeTable때문에 외부 키를 입력해줄 필요가 있었다.\n외부 키를 추가할 때는 마이그레이션 파일에 add<em>foreign</em>key 메서드를 사용해야 한다. 이 경우엔 미리 생성된 컬럼을 지정해주고 싶었기 때문에 다음과 같이 삽입해야 했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">add_foreign_key :meal_meet_ups, :users, column: :admin_id</code></pre>\n      </div>\n<p>외부 키를 지정해주는 마이그레이션 파일은 다음과 같이 작성되었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">CreateMealMeetUps</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Migration</span>\n  <span class="token keyword">def</span> change\n    create_table <span class="token symbol">:meal_meet_ups</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>\n      t<span class="token punctuation">.</span>integer <span class="token symbol">:total_price</span>\n      t<span class="token punctuation">.</span>integer <span class="token symbol">:messenger_code</span>\n      t<span class="token punctuation">.</span>string <span class="token symbol">:messenger_room_id</span>\n      t<span class="token punctuation">.</span>integer <span class="token symbol">:admin_id</span>\n      t<span class="token punctuation">.</span>integer <span class="token symbol">:meetup_status</span>\n\n      t<span class="token punctuation">.</span>timestamps null<span class="token punctuation">:</span> <span class="token keyword">false</span>\n    <span class="token keyword">end</span>\n    add_foreign_key <span class="token symbol">:meal_meet_ups</span><span class="token punctuation">,</span> <span class="token symbol">:users</span><span class="token punctuation">,</span> column<span class="token punctuation">:</span> <span class="token symbol">:admin_id</span>\n    add_foreign_key <span class="token symbol">:meal_meet_ups</span><span class="token punctuation">,</span> <span class="token symbol">:code_tables</span><span class="token punctuation">,</span> column<span class="token punctuation">:</span> <span class="token symbol">:messenger_code</span>\n    add_foreign_key <span class="token symbol">:meal_meet_ups</span><span class="token punctuation">,</span> <span class="token symbol">:code_tables</span><span class="token punctuation">,</span> column<span class="token punctuation">:</span> <span class="token symbol">:meetup_status</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>다음은 MealMeetUp 생성과 변경을 처리하는 api 컨트롤러를 작성할 차례이다.</p>\n<h2 id="컨트롤러-작성"><a href="#%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC-%EC%9E%91%EC%84%B1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컨트롤러 작성</h2>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">rails g controller MealMeetUp create update</code></pre>\n      </div>\n<p>현재 시점에서 첫 번째로 구현하려는 기능은 MealMeetUp api이다. 새 MealMeetUp 생성과 수정을 구현할 예정인데\njson으로만 데이터를 주고받을 예정이니 <code class="language-text">routes.rb</code>에 디폴트 포맷을 지정해주기로 했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># routes.rb\npost &#39;meal_meet_ups&#39;  =&gt; &#39;meal_meet_up#create&#39;, defaults: { format: &#39;json&#39; }\npatch &#39;meal_meet_ups&#39; =&gt; &#39;meal_meet_up#update&#39;, defaults: { format: &#39;json&#39; }</code></pre>\n      </div>\n<p>그 다음에는 <a href="https://blog.8thlight.com/will-warner/2014/04/05/strong-parameters-in-rails.html">Strong parameter</a>를 지정하기 위해 meetup_params 메서드를 작성했다.</p>\n<p>입력받을 JSON은 다음과 같으므로 data 아래에 있는 나머지 키들을 전부 받을수 있는 값으로 설정해두었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n    <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"abc@example.com"</span><span class="token punctuation">,</span>\n        <span class="token property">"messenger"</span><span class="token operator">:</span> <span class="token string">"slack"</span><span class="token punctuation">,</span> // 약속된 code\n        <span class="token property">"messenger_room_id"</span><span class="token operator">:</span> <span class="token number">1459349928</span><span class="token punctuation">,</span> // optional<span class="token punctuation">,</span> 값을 얻을 수 없는 특정 메신저의 경우(ex- 카톡<span class="token punctuation">)</span> api 서버에서 유저의 아이디 정보로 검색\n        <span class="token property">"total_price"</span><span class="token operator">:</span> <span class="token number">50000</span><span class="token punctuation">,</span> // optional\n        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"paying"</span> // optional<span class="token punctuation">,</span> 값이 주어지지 않을 경우 state machine으로 작동\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h2 id="mealmeetup-create"><a href="#mealmeetup-create" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MealMeetUp Create</h2>\n<p>이 JSON을 가지고(예로 작성된 JSON은 정보 변경시에 받는 것이고 생성 시에는 <code class="language-text">total_price</code>와 <code class="language-text">status</code>는 받지 않는다. 대신 <code class="language-text">messenger_user_id</code>를 받는다) <code class="language-text">create</code> 메서드가 작동한다면 어떤 과정으로 구동하게 될까 생각해 보았다.</p>\n<ol>\n<li>meetup_params를 한번 거쳐서 허가된 매개변수만 받는다.</li>\n<li>\n<p>받은 변수들의 유효성을 검사한다</p>\n<ul>\n<li><code class="language-text">email</code>, <code class="language-text">messenger_user_id</code> 같은 인증 정보가 누락된 경우: 401에러</li>\n<li><code class="language-text">messenger</code>, <code class="language-text">messenger_room_id</code> 같이 방을 생성하기 위한 정보가 충분하지 않아 생성이 불가능할 때: 400에러</li>\n</ul>\n</li>\n<li>\n<p>유효성을 통과한 경우 먼저 User 객체 생성 + messenger_code 가져오기</p>\n<ul>\n<li>messenger 종류로 CodeTable에서 맞는 <code class="language-text">messenger_code</code> 가져오기 (이 시점에서 seed 파일로 코드테이블을 작성해놓아야 할 필요성을 느꼈다. 더군다나 이런식으로 찾을거면 코드테이블을 작성하는 의미가 있나?)</li>\n<li>email 주소로 새로운 유저 생성.</li>\n</ul>\n</li>\n<li>\n<p>MealMeetUp 생성</p>\n<ul>\n<li>앞선 과정에서 가져온 <code class="language-text">messenger_code</code></li>\n<li><code class="language-text">messenger_room_id</code></li>\n<li>앞서 생성된 user의 id를 <code class="language-text">admin_id</code>로 지정</li>\n<li>status는 null로 두고, null인 경우는 최초 생성인 것으로 간주하도록 하려고 했으나, 아무래도 "​created"라는 상태를 지정해 두는 것이 나아 보인다.</li>\n</ul>\n</li>\n</ol>\n<p>CodeTable을 작성하면서 한 가지 실수한 점이 있는데, 컬럼명에 \'type\'이라는 이름을 쓰면 레일즈에 기본적으로 정의되어있는 type과 충돌이 난다. 그래서 code_type으로 컬럼명을 변경하였다.</p>\n<p>각각 코드가 무엇을 의미하는지는 code_table.rb에 주석으로 달기로 하였다.</p>\n<p>한창 날코딩으로 작업을 하고, 얼렁뚱땅 create메서드를 작동시키는 것 까지는 성공했는데 돌이켜보니 DB 관계 설정을 하나도 해두지 않았다.\n생성과 구상까지만 하고 몇일을 보내버려서 그런지 생각보다 머리에 잘 들어오지 않아 애먹고 있다.</p>\n<p>매번 단순히 <code class="language-text">has_many</code>, <code class="language-text">belongs_to</code>정도만 남발하다가 본격적으로 직접 외부키로 관계를 맺어주려니 어렵게 느껴졌다. 이리저리 소스를 찾아서 구현해본 결과 이런 느낌으로 나온다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">MealMeetUp</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>\n  has_many <span class="token symbol">:meal_meet_up_logs</span>\n  has_many <span class="token symbol">:meal_meet_up_tasks</span>\n  belongs_to <span class="token symbol">:admin</span><span class="token punctuation">,</span> class_name<span class="token punctuation">:</span> <span class="token string">\'User\'</span><span class="token punctuation">,</span> foreign_key<span class="token punctuation">:</span> <span class="token string">\'admin_id\'</span>\n  belongs_to <span class="token symbol">:messenger</span><span class="token punctuation">,</span> class_name<span class="token punctuation">:</span> <span class="token string">\'CodeTable\'</span><span class="token punctuation">,</span> foreign_key<span class="token punctuation">:</span> <span class="token string">\'messenger_code\'</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>\n  has_many <span class="token symbol">:meal_meet_ups</span><span class="token punctuation">,</span> foreign_key<span class="token punctuation">:</span> <span class="token string">\'admin_id\'</span>\n  has_many <span class="token symbol">:meal_logs</span>\n  has_many <span class="token symbol">:user_messengers</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>어느 클래스에 있는 값을 가져올지 <code class="language-text">class_name</code>으로 지정해주고, 실제 어떤 메서드를 입력해서 가져올지(<code class="language-text">:admin</code>), 어떤 외부키를 지정해 두었는지 등으로 설정할 수 있다.</p>\n<p><code class="language-text">create</code>메서드가 작동 자체는 잘 하는 것 같은데 루보캅에서 메서드가 너무 길다고 하니까 조금 아쉽게 느껴진다. 더 줄일 부분이 분명히 있는데 어느 부분을 손대야할지 잘 감이 안잡히는 느낌이 든다. 기준이 10줄인데 14줄로 작성되어 있으니..</p>\n<p>인증 정보의 유효성 고려하다보니 깜빡한 것이, 이메일 유효성을 고려하지 않았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">VALID_EMAIL_ADDRESS = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i</code></pre>\n      </div>\n<p>M.Hartl의 튜토리얼에서 가져온 이 정규표현식으로 메서드를 만들어서 검증하기로 했다.</p>\n<h2 id="mealmeetup-update"><a href="#mealmeetup-update" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MealMeetUp Update</h2>\n<p>업데이트는 두가지 속성이 더 추가되는데, <code class="language-text">total_price</code>와 <code class="language-text">status</code>이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n    <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"abc@example.com"</span><span class="token punctuation">,</span>\n        <span class="token property">"messenger"</span><span class="token operator">:</span> <span class="token string">"slack"</span><span class="token punctuation">,</span>\n        <span class="token property">"messenger_room_id"</span><span class="token operator">:</span> <span class="token number">1459349928</span><span class="token punctuation">,</span>\n        <span class="token property">"total_price"</span><span class="token operator">:</span> <span class="token number">50000</span><span class="token punctuation">,</span>\n        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"paying"</span> // 현재까지 완료된 최종 상태\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>설마 했던 문제지만, 이번에도 create를 만들면서 별달리 다음 문제에 대해 고려를 안하다 보니까 리턴용 JSON 생성이 곤란하게 되었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">meal_meet_up_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n<span class="token punctuation">{</span> data<span class="token punctuation">:</span>\n    <span class="token punctuation">{</span> email<span class="token punctuation">:</span> data<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>email<span class="token punctuation">,</span>\n        messenger<span class="token punctuation">:</span> data<span class="token punctuation">.</span>messenger<span class="token punctuation">,</span>\n        messenger_room_id<span class="token punctuation">:</span> data<span class="token punctuation">.</span>messenger_room_id <span class="token punctuation">}</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>그래서 생각하건데 아예 모든 값이 다 들어가도록 json을 만들고,  create메서드에서 리턴할때만 특정 키를 뺀 채로 만들면 될 거라는 생각이 든다.</p>\n<p>공통적입 부분을 생각해보니, MealMeetUp 객체에 저장을 하기위해 추가적으로 들어가는 정보들을 조회하는 부분이 크게 중복된다. 그래서 이 기능도 나누어서 작성하였다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">get_more_info</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>\n    status <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span><span class="token punctuation">.</span>empty<span class="token operator">?</span> <span class="token operator">?</span> <span class="token string">\'created\'</span> <span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span>\n    messenger_code <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_messenger</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:messenger</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id\n    status_code <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span>id\n\n    user <span class="token operator">=</span> <span class="token keyword">if</span> status <span class="token operator">==</span> <span class="token string">\'created\'</span>\n            <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n            <span class="token keyword">else</span>\n            <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n            <span class="token keyword">end</span>\n\n    additional_data <span class="token operator">=</span> <span class="token punctuation">{</span> admin_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span> messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">,</span> status_code<span class="token punctuation">:</span> status_code <span class="token punctuation">}</span>\n\n    params<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>additional_data<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>막상 이것도 더 쪼갤 수 있을 테지만.. status<em>code, messenger</em>code, admin_id 삽입까지 처리하였다.\n마지막 줄에 최종적으로 원하는 데이터를 출력하는 부분이 애매한데, MeetUp 객체 생성/수정에 필요 없는 정보들이 너무 많았다. 그래서 조금 수정을 가했다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">params.merge(additional_data).reject { |key| [&#39;email&#39;, &#39;messenger&#39;, &#39;status&#39;, &#39;messenger_user_id&#39;].include?(key) }</code></pre>\n      </div>\n<p>거의 다 된거 같은게 갈수록 태산처럼 보인다. 이번에는 messenger<em>user</em>id가 UserMessenger 모델에 들어가야하는 값이라는걸 깨달았다. 당장 어디다 넣어야 할지도 모르겠는데.. 일단 <code class="language-text">get_more_info</code> 메서드를 조금 수정하여 처음 생성하는 MealMeetUp일 경우 새로운 UserMessenger 객체를 생성하는 것 까지 진행했다.</p>\n<p>지금까지 작업하여 돌아가기는 하지만 영 못마땅한 부분이 많다. 특히 반복적인 부분과 매끄럽게 보이지 않는 부분들이 너무 많은데, 본격적으로 수정을 하면 어디부터 손을 대야할지 해봐야 알 것이다. (루보캅 테스트 통과 못한 부분이 무려 22개)</p>\n<p>루보캅에서 주로 걸리는 문제는 ABC(Assignment Branch Condition) 사이즈가 너무 크다는 것이다. 한번에 이해는 하기 힘들었지만 변수를 많이 선언하고, 조건을 많이 걸고, 얽힌 메서드가 많을 수록 점수가 올라가는 기분이 든다.</p>\n<p>당장 위에 작성한 <code class="language-text">get_more_info</code> 메서드만 해도 기준을 1.5배 초과하고 있다. 당장 저 메서드를 수정하려면 어떻게 해야할까? 저 메서드가 어떤 기능을 수행하는지 나누어 보자.</p>\n<ul>\n<li>status 패러미터를 가져와서 패러미터가 없으면 \'created\'를 부여한다.</li>\n<li>messenger_code를 가져온다.</li>\n<li>status_code를 가져온다.</li>\n<li>status가 \'created\'이면 (즉 처음 MealMeetUp이 생성되는거면) 새로운 유저와 유저메신저 객체를 생성한다.</li>\n<li>생성된 유저의 Id와 messenger<em>code, status</em>code를 새로운 해시(addtional_data)로 만든다.</li>\n<li>기존의 패러미터에 addtional_data를 합친다.</li>\n</ul>\n<p>기능별로 하나하나 나눌 순 있다. 점점 메서드의 산이 되어가는 기분이지만..\n먼저 걸리는 점은 새로운 유저 생성, 그다음은 스테이터스 패러미터, 마지막은 추가 해시 생성이다.\n새로운 유저 생성 부분부터 분리해보자.</p>\n<p>무작정 분리한건 좋은데 이 메서드들을 어떻게 합쳐야 할지 감이 오지 않는다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> fetch_params\n    <span class="token variable">@params</span> <span class="token operator">=</span> <span class="token function">get_more_info</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">load_status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span>\n    status<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span> <span class="token operator">?</span> <span class="token string">\'created\'</span> <span class="token punctuation">:</span> status\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">load_status_code</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span>\n    <span class="token variable">@status_code</span> <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span>id\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">load_messenger_code</span><span class="token punctuation">(</span>messenger<span class="token punctuation">)</span>\n    <span class="token variable">@messenger_code</span> <span class="token operator">=</span> <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_messenger</span><span class="token punctuation">(</span>messenger<span class="token punctuation">)</span><span class="token punctuation">.</span>id\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">load_user</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> params<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> status <span class="token operator">==</span> <span class="token string">\'created\'</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token constant">UserMessenger</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            messenger_user_id<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:messenger_user_id</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n                            messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">)</span>\n    <span class="token keyword">else</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">get_more_info</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> status_code<span class="token punctuation">,</span> params<span class="token punctuation">)</span>\n    additional_data <span class="token operator">=</span> <span class="token punctuation">{</span> admin_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                        messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">,</span>\n                        meetup_status<span class="token punctuation">:</span> status_code <span class="token punctuation">}</span>\n\n    params<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>additional_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reject <span class="token keyword">do</span> <span class="token operator">|</span>key<span class="token operator">|</span>\n    <span class="token string">%w(email messenger status messenger_user_id)</span><span class="token punctuation">.</span>include<span class="token operator">?</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span>to_s<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>분명 get<em>more</em>info를 실행시키기 위해선 위에 정의해둔 메서드를 모두 쓸 필요가 있다.\n생각해보면 굳이 인자를 받을 필요가 없는데..? params는 어디서든지 쓸 수 있으니까.\n그 점에 착안하여 수정한 코드는 이렇다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> fetch_params\n    <span class="token variable">@params</span> <span class="token operator">=</span> <span class="token function">get_more_info</span><span class="token punctuation">(</span>load_user<span class="token punctuation">,</span> load_messenger_code<span class="token punctuation">,</span>\n                            load_status_code<span class="token punctuation">,</span> meetup_params<span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> load_status\n    params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span> <span class="token operator">?</span> <span class="token string">\'created\'</span> <span class="token punctuation">:</span> meetup_params<span class="token punctuation">[</span><span class="token symbol">:status</span><span class="token punctuation">]</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> load_status_code\n    <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_status</span><span class="token punctuation">(</span>load_status<span class="token punctuation">)</span><span class="token punctuation">.</span>id\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> load_messenger_code\n    <span class="token constant">CodeTable</span><span class="token punctuation">.</span><span class="token function">find_messenger</span><span class="token punctuation">(</span>meetup_params<span class="token punctuation">[</span><span class="token symbol">:messenger</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> load_user\n    params <span class="token operator">=</span> meetup_params\n    <span class="token keyword">if</span> load_status <span class="token operator">==</span> <span class="token string">\'created\'</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token constant">UserMessenger</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> <span class="token variable">@user</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                            messenger_user_id<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:messenger_user_id</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n                            messenger_code<span class="token punctuation">:</span> load_messenger_code<span class="token punctuation">)</span>\n    <span class="token keyword">else</span>\n    <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n    <span class="token variable">@user</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">get_more_info</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> messenger_code<span class="token punctuation">,</span> status_code<span class="token punctuation">,</span> params<span class="token punctuation">)</span>\n    additional_data <span class="token operator">=</span> <span class="token punctuation">{</span> admin_id<span class="token punctuation">:</span> user<span class="token punctuation">.</span>id<span class="token punctuation">,</span>\n                        messenger_code<span class="token punctuation">:</span> messenger_code<span class="token punctuation">,</span>\n                        meetup_status<span class="token punctuation">:</span> status_code <span class="token punctuation">}</span>\n\n    params<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>additional_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reject <span class="token keyword">do</span> <span class="token operator">|</span>key<span class="token operator">|</span>\n    <span class="token string">%w(email messenger status messenger_user_id)</span><span class="token punctuation">.</span>include<span class="token operator">?</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span>to_s<span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>다 수정했더니 이번엔 클래스가 너무 길단다. (104/100줄)\n줄일 부분 중 가장 크게 눈에 띄는 부분은 if-else문이 여러번 있는 것이다.\n아예 검증 자체를 처음부터 메서드화 + before_action을 적용하고, 검증을 통과한 녀석만 create, update가 실행되도록 만들려고 하였다.\n하지만 그 검증 메서드도 점점 몸집이 불어나더니 통과를 못하는 문제가 발생하였고, 야매로 해결한 방법은 helper에다가 넣을 만한 메서드를 옮겨놓고 <code class="language-text">include MealMeetUpHelper</code>를 삽입하는 것이었다.</p>',
id:"/home/circleci/repo/src/pages/posts/2016-07-24-easylunch-api-devlog/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-07-24",path:"/posts/easylunch-api-devlog-1",title:"Easylunch Api 서버 제작기 - 1",tags:["Rails"],category:"Rails"}}],Sinatra:[{excerpt:"Beginning of the Heonchek-hunter…",html:'<h2 id="beginning-of-the-heonchek-hunter"><a href="#beginning-of-the-heonchek-hunter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Beginning of the Heonchek-hunter</h2>\n<p>예전에 레일즈로 <strong>헌책 헌터</strong> 라는 이름의 웹앱을 한번 만들어 본 적이 있다.</p>\n<p>알라딘 중고서점에 원하는 책의 재고가 있는지 알아보고 해당 매장으로 가고 싶은데 일일이 매장을 하나하나 잡아서 검색해야하는게 너무 불편했었기 때문이다.</p>\n<p>잉여력이 넘치던 시절에는 서울 어지간한 지역에는 마음만 먹으면 방문할 수 있었기 때문에 꽤 유용한 아이디어라고 생각했는데, 지금은 딱히 그러기가 힘들다. 그래도 여러 개 매장의 중고책 재고를 검색하는데는 꽤 요긴하다는 생각이 든다.</p>\n<p>구현 원리는 생각보다 단순했지만 귀찮은 과정이었다. 알라딘 중고서점 검색 url은 하나만 제공되는데, 어떤 매장의 책을 검색하는지 구분하는 방법은 클라이언트가 가지고 있는 쿠키(cookie) 정보이다. 먼저 신촌점 페이지를 방문한 뒤에 검색을 하면 신촌점의 검색 결과가 나오고, 종로점 페이지를 방문한 뒤에 검색을 하면 종로점 검색 결과가 나오는 형식이다.</p>\n<p>다만 이 문제로 단순히 요청을 하고 결과를 받아오는 형식의 웹 크롤링을 해 주는 <code class="language-text">nokogiri</code> 젬은 쓸 수가 없었다. 이런저런 조사를 해 본 결과 <a href="https://github.com/sparklemotion/mechanize"><code class="language-text">mechanize</code></a> 젬이 웹사이트에 대한 자동 상호작용(automatic interaction)을 지원한다는 것을 발견하여 임의의 <code class="language-text">Mechanize</code> 객체가 가상으로 각 매장을 방문한 뒤에 책을 검색하고, 결과를 파싱해와서 html 페이지에 출력하는 방식의 구현에 성공했었다.</p>\n<h2 id="why-not-rails"><a href="#why-not-rails" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why not Rails?</h2>\n<p>여러가지 자잘한 문제가 있었지만, 일단 돌아가는 애플리케이션을 만들어서 쓰다 보니 조금 아쉽게 생각되는 점들이 있었다. 처음에야 가장 익숙한 웹 애플리케이션을 제작할 수 있는 도구인 레일즈로 제작을 하였지만, 여러 가지 이유에서 이 프로젝트를 제작하는데는 레일즈를 쓸 필요가 없었다.</p>\n<ol>\n<li><code class="language-text">rails new myapp</code> 를 입력하고 엔터를 치는 순간 나는 굳이 쓸 필요가 없는 파일들이 무더기로 생성된다. 미관상 마음에 들지 않는다.</li>\n<li>(지금 수준의 애플리케이션에는 차이가 크게 느껴지지 않겠지만) 레일즈는 다른 가벼운 웹 프레임워크에 비해 무겁다.</li>\n<li>DB가 필요없는 애플리케이션임에 불구하고 앱을 실행하기 위해서는 반드시 DB를 준비해야 한다. (Sqlite 등)</li>\n</ol>\n<p>제일 크게 느껴지는 문제는 1번 이었는데, 각종 컨트롤러 파일, 헬퍼 파일 등 나는 굳이 쓸 필요가 없는 파일들이 기본적으로 저장소에 자리잡고 있는게 마음에 들지 않았다.</p>\n<p>그리고 서울 지역 알라딘 중고매장 페이지를 모두 방문하고 정보를 긁어와야 하는 앱 구조상 동작이 꽤 느린데, 혹시나 더 가볍게 앱을 제작하면 속도가 더 빨라지지 않을까 하는 막연한 기대가 있었다.</p>\n<p>그래서 처음에는 요즘 야금야금 공부하고 있는 Node.js(노드) 로 크롤링 앱을 작성해볼까 했는데, 쿠키를 들고 리퀘스트를 보내는 등의 여러가지 시도를 하였음에도 불구하고 자꾸 결과가 나오지 않아 포기 상태이다. 루비에 비하면 월등히 빠른 처리 속도를 가지고 있는 노드를 활용해보려 했지만(싱글 스레드라는 단점이 있어도) 자꾸 500에러를 내뿜으니.. 나중에 다시 시도해보고자 한다.</p>\n<p>그래서 기존에 레일즈용으로 작성했던 로직을 가져와 또 다른 루비 웹 프레임워크인 시나트라로 다시 한번 더 나은 버전의 헌책 헌터를 구현해보기로 하였다.</p>\n<h2 id="what-is-sinatra"><a href="#what-is-sinatra" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Sinatra?</h2>\n<blockquote>\n<p>Sinatra is a <a href="https://en.wikipedia.org/wiki/Domain-specific_language">DSL</a> for quickly creating web applications in Ruby with minimal effort</p>\n</blockquote>\n<p>시나트라는 최소한의 노력으로 루비 기반 웹 애플리케이션을 신속하게 작성하기 위한 DSL이다.</p>\n<p>특히 Node.js 의 웹 프레임워크로 유명한 Express 에 영감을 준 것으로 잘 알려져 있다. 파이썬의 Flask와도 비슷하다는데 파이썬을 제대로 써 보지 않아서 모르겠다.</p>\n<p>Rack(루비 기반 웹 애플리케이션 개발을 위한 인터페이스 제공, Rack자체로도 웹 애플리케이션 개발은 가능하다) 기반으로 작성되어 있으며 흔히 생각하는 MVC 패턴을 구현한 웹 프레임워크는 아니다.</p>\n<p>RESTful 라우팅과 다양한 템플릿을 지원하고, 유저가 어느정도 직접 구현하면 레일즈로 만든 애플리케이션 부럽지 않은 웹 애플리케이션 제작이 가능하다. 보통 레일즈가 더 유명하고 편해서 그렇지.. 그렇지만 순수한 루비를 이용하는 느낌이 더 강해서 이쪽이 더 마음에 든다.</p>\n<p>데이터베이스와 연결하고자 하면 보통 ActiveRecord(그 레일즈의 ActiveRecord 맞다) 를 불러와 쓰거나, DataMapper 라는 젬을 이용한다고 한다.</p>\n<p>시나트라로 간단하게 Hello World를 출력하는 앱을 만든다면 한개의 파일, 약 4줄짜리 코드면 된다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># myapp.rb</span>\n<span class="token keyword">require</span> <span class="token string">\'sinatra\'</span>\n\nget <span class="token string">\'/\'</span> <span class="token keyword">do</span>\n  <span class="token string">\'Hello world!\'</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>당연 그 전에 시나트라 젬은 설치되어 있어야 한다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text"># Install sinatra gem\n$ gem install sinatra\n\n# Launch the application\n$ ruby myapp.rb  # View at http://localhost:4567</code></pre>\n      </div>\n<h2 id="how-to-improve"><a href="#how-to-improve" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to improve?</h2>\n<p>그럼 이 시나트라를 이용하여 어떻게 기존에 작성한 애플리케이션을 재구성할 수 있을까? 기존에 작성한 소스는 그냥 정적 페이지로만 구성하였다. <code class="language-text">index</code> 액션에서 검색어를 입력받고 <code class="language-text">search</code> 같은 액션에 패러미터를 보내어 검색 후 결과가 나오면 <code class="language-text">result</code> 페이지에서 출력해주는 방식이다.</p>\n<p>어차피 검색하고 결과를 출력하기만 하면 되는데 페이지 여러개를 만들 필요는 딱히 없겠다는 생각이 들었다. 그래서 이번에는</p>\n<ul>\n<li>컨트롤러와 검색 로직의 분리</li>\n<li>AJAX 통신으로 초기 페이지에서 결과 부분만 따로 랜더링</li>\n</ul>\n<p>이 두 가지 포인트를 우선적으로 구현하는 것을 목표로 애플리케이션을 제작해 보았다. Single Page Application이라고 AngularJS 등의 거창한 자바스크립트 프레임워크를 쓸 수준은 아니기에 단순히 jQuery AJAX로 구현할 예정이다.</p>\n<h2 id="work-with-sinatra"><a href="#work-with-sinatra" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Work with Sinatra</h2>\n<p>시나트라는 <code class="language-text">rails new</code> 같이 편리한 CLI(Command Line Interface) 가 없다. 정말 위에 적은대로 루비파일 하나만으로도 만들 수 있을 정도이다. 조금 검색을 해 보니 따로 정립된 프로젝트의 형태는 없지만, 배포를 염두에 둔다면 시나트라 애플리케이션 구동 설정을 하는데 <code class="language-text">config.ru</code> 파일을 작성하길 권장하고 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># config.ru</span>\n<span class="token keyword">require</span> <span class="token string">\'./app\'</span>\nrun <span class="token constant">Sinatra</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Application</span>\n</code></pre>\n      </div>\n<p>그리고 <code class="language-text">rackup</code> 커맨드로 애플리케이션을 실행시킨다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">$ rackup -p 4000</code></pre>\n      </div>\n<p>기본으로 설정된 애셋 파일은 <code class="language-text">/public</code> 폴더에, 뷰 파일을 <code class="language-text">/views</code> 파일에 랜더링된다고 적혀있으니 컨트롤러인 <code class="language-text">app.rb</code> 파일은 루트에 두고 필요한 폴더를 작성하고 자바스크립트와 CSS 파일은 <code class="language-text">public</code> 폴더에, ERB파일은 <code class="language-text">views</code> 폴더에 작성하였다.</p>\n<h3 id="controller"><a href="#controller" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller</h3>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">\'sinatra\'</span>\nrequire_relative <span class="token string">\'./lib/book_search\'</span>\n\nget <span class="token string">\'/\'</span> <span class="token keyword">do</span>\n  erb <span class="token symbol">:index</span>\n<span class="token keyword">end</span>\n\nget <span class="token string">\'/search\'</span> <span class="token keyword">do</span>\n  book_title <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:title</span><span class="token punctuation">]</span>\n\n  <span class="token variable">@results</span> <span class="token operator">=</span> <span class="token constant">BookSearch</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span><span class="token punctuation">.</span>search\n  erb <span class="token symbol">:result</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span> results<span class="token punctuation">:</span> <span class="token variable">@results</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>검색을 위한 클래스를 따로 작성하여 <code class="language-text">/lib</code> 폴더에 저장해두었다. 지금은 기존에 레일즈용으로 작성했던 로직을 거의 그대로 사용한 클래스인데, 여러가지 면에서 개선할 점들이 많다.</p>\n<p><code class="language-text">erb</code> 로 템플릿을 지정하고 심볼로 파일 이름을 지정하면 해당 이름의 템플릿을 찾아서 html 파일로 랜더링한다. 굳이 <code class="language-text">index.html.erb</code> 같은 이름이 아닌 <code class="language-text">index.erb</code> 로 작성하여도 잘 작동하는게 신기했다. 또한 이 부분은 나중에 <code class="language-text">result.erb</code> 파일에도 중요한 포인트로 작용한다.</p>\n<p><code class="language-text">locals</code> 옵션은 레일즈의 <code class="language-text">render partial</code> 이후 지역변수를 삽입해주는 것과 비슷하게 작용한 것 처럼 보여서 사용해보았다. 사실 굳이 쓰지 않고 그냥 <code class="language-text">@results</code> 를 그대로 사용해도 별 문제 없어 보인다.</p>\n<h3 id="searching-books"><a href="#searching-books" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Searching Books</h3>\n<p>맨 처음 레일즈용으로 앱을 작성할 당시에는 컨트롤러에 프라이빗 메서드 하나 작성해 두고 거기다 모든 과정을 다 처리했었다. 처음엔 \'나중에 리팩터링 하면 되지\' 하고 생각했지만 이렇게 아예 새로 만드는 방향까지 와 버렸다.</p>\n<p><code class="language-text">BookSearch</code> 라는 클래스를 하나 정의하여 거기에 매장 리스트, 매장 방문 URI, 검색 URI 등을 상수로 지정해 두고 시작하는 형태이다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span>\n  <span class="token variable">@book_title</span> <span class="token operator">=</span> book_title<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">\'euc-kr\'</span><span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\n  <span class="token variable">@agent</span> <span class="token operator">=</span> <span class="token constant">Mechanize</span><span class="token punctuation">.</span><span class="token keyword">new</span>\n  <span class="token variable">@result</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>인자로 받는 <code class="language-text">book_title</code> 은 인코딩을 반드시 바꾸어 주어야 한다. 알라딘 홈페이지는 EUC-KR 인코딩을 사용하기 때문이다. 국내 사이트는 정말 어쩔수가 없는건지.. <code class="language-text">@agent</code> 는 알라딘 서버와 연결 상호작용을 수행할 <code class="language-text">mechanize</code> 젬의 객체이다. 기존에는 매 검색마다 객체를 생성하도록 코드를 작성했었는데 전혀 그럴 필요가 없다는걸 뒤늦게 깨달았다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># ...</span>\n<span class="token keyword">def</span> search\n  <span class="token constant">STORE_LISTS</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>store_code<span class="token punctuation">,</span> store_name<span class="token operator">|</span>\n    <span class="token comment"># 개별 매장 검색 시작</span>\n    search_results <span class="token operator">=</span> <span class="token function">get_books</span><span class="token punctuation">(</span>store_code<span class="token punctuation">)</span>\n    <span class="token variable">@result</span><span class="token punctuation">[</span>store_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">serialize_info</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>\n  <span class="token keyword">end</span>\n\n  <span class="token variable">@result</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">private</span>\n\n<span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span>\n  store_index <span class="token operator">=</span> <span class="token variable">@agent</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span>\n  store_form <span class="token operator">=</span> store_index<span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">\'QuickSearch\'</span><span class="token punctuation">)</span>\n  store_form<span class="token punctuation">[</span><span class="token string">\'SearchWord\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">@book_title</span>\n\n  query_result <span class="token operator">=</span> <span class="token variable">@agent</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>store_form<span class="token punctuation">)</span>\n  query_result<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">\'EUC-KR\'</span>\n\n  query_result\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">get_books</span><span class="token punctuation">(</span>store_code<span class="token punctuation">)</span>\n  store_url <span class="token operator">=</span> <span class="token constant">URI</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">STORE_URI</span> <span class="token operator">+</span> store_code<span class="token punctuation">)</span>\n  <span class="token function">query</span><span class="token punctuation">(</span>store_url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'div.ss_book_box\'</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span>\n\n<span class="token keyword">def</span> <span class="token function">serialize_info</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>\n  <span class="token comment"># 검색 결과가 있다면 검색 시작, 아니면 빈 배열 입력</span>\n  <span class="token keyword">return</span> search_results <span class="token keyword">if</span> search_results<span class="token punctuation">.</span>empty<span class="token operator">?</span>\n\n  <span class="token comment"># 매장별 결과는 배열로 리턴 (각 배열의 요소는 해쉬)</span>\n  search_results<span class="token punctuation">.</span>map <span class="token keyword">do</span> <span class="token operator">|</span>book<span class="token operator">|</span>\n    book_info<span class="token punctuation">,</span> price_info <span class="token operator">=</span> book<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'div.ss_book_list\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0.</span><span class="token number">.1</span><span class="token punctuation">]</span> <span class="token comment"># Pattern matching</span>\n\n    title <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'a.bo_l b\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n    sub_title <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_f_g2\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n\n    author_list <span class="token operator">=</span> book_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'ul > li\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\' | \'</span><span class="token punctuation">)</span>\n\n    author<span class="token punctuation">,</span> publisher<span class="token punctuation">,</span> pub_date <span class="token operator">=</span> author_list<span class="token punctuation">[</span><span class="token number">0.</span><span class="token number">.2</span><span class="token punctuation">]</span>\n\n    price <span class="token operator">=</span> price_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_p2 b\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text\n    stock <span class="token operator">=</span> price_info<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">\'span.ss_p4 b\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text\n\n    <span class="token punctuation">{</span>\n      title<span class="token punctuation">:</span> title<span class="token punctuation">,</span>\n      sub_title<span class="token punctuation">:</span> sub_title<span class="token punctuation">,</span>\n      author<span class="token punctuation">:</span> author<span class="token punctuation">,</span>\n      publisher<span class="token punctuation">:</span> publisher<span class="token punctuation">,</span>\n      pub_date<span class="token punctuation">:</span> pub_date<span class="token punctuation">,</span>\n      price<span class="token punctuation">:</span> price<span class="token punctuation">,</span>\n      stock<span class="token punctuation">:</span> stock\n    <span class="token punctuation">}</span>\n  <span class="token keyword">end</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p><code class="language-text">query</code> 메서드는 생성한 에이전트로 중고매장 각 지점을 임의로 방문한 뒤에 생성된 쿠키를 들고 책을 검색하는 역할을 수행한다. 초반부에 서술했듯이 검색을 할 때 매장이름을 패러미터로 받는 것이 아니라 요청한 클라이언트가 들고있는 쿠키로 어느 매장의 책을 찾고자 하는지 조회하기 때문이다.</p>\n<p>중요한 점은 여기서도 출력된 결과물을 EUC-KR 인코딩으로 바꾸어주어야 한다는 것이다.</p>\n<p><code class="language-text">get_books</code> 는 각 매장 코드와 매장명을 가지고 있는 해시로 반복문을 돌 때 <code class="language-text">query</code> 메서드를 매번 다른 매장명으로 실행시키고 그 결과를 출력하는 부분을 담당한다. <code class="language-text">css</code> 는 <code class="language-text">nokogiri</code> 젬에서 지원하는 메서드로 파싱한 결과를 말 그대로 css 선택자처럼 사용하여 결과를 가져올 수 있도록 만든다. 선택자로 선택된 DOM들은 <code class="language-text">nokogiri</code>의 객체가 담긴 배열로 리턴된다. (nokogiri 젬은 웹 크롤링에 사용되는 대표적인 루비 젬이며 <code class="language-text">mechanize</code> 젬과 의존관계를 형성하고 있다.)</p>\n<p>그리고 이를 이용하여 <code class="language-text">serialize_info</code> 메서드를 실행하여 원하는 결과를 출력하는 방식이다. 각각 어떤 결과를 가져와야 하는지는 알라딘 검색을 직접 해 보고 크롬의 개발자 도구로 html 코드를 뒤져 찾아내었다.</p>\n<p>변수 할당에 패턴 매칭이 들어간 점도 눈여겨 볼 수 있다. 배열의 요소 하나하나를 변수에 할당한다고 한줄씩 코드를 작성하는 것 보다 배열의 범위와 그에 맞는 개수의 변수를 할당해주어 여러 줄로 작성할 코드를 손쉽게 한 줄로 줄일 수 있었다.</p>\n<h3 id="views"><a href="#views" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Views</h3>\n<p>뷰 파일들은 레일즈로 작성할 때 <code class="language-text">html.erb</code> 템플릿과 크게 차이는 없었다. 단순히 <code class="language-text">erb</code>  확장자만 넣어도 그대로 작동한다는 것만 빼면 컨트롤러 부분에서 보다시피 어떤 인자를 가져올 것인지 주입할 수도 있고, 템플릿을 바꾼다던지 할 수도 있다. 다만 내가 여지껏 깨닫지 못했던 흥미로운 요소가 있었다.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// public/script/app.js</span>\n<span class="token comment">// ...</span>\n  $<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">\'/search\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> bookTitle <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    $dimmer<span class="token punctuation">.</span><span class="token function">dimmer</span><span class="token punctuation">(</span><span class="token string">\'hide\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>indexPage <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'.ui.main.text.container\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>$result_partial<span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">\'result_container\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      $result_partial<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">\'result_container\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    $result_partial<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    $result_partial<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">\'slide down in\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\n</code></pre>\n      </div>\n<p>다음은 내가 책 검색을 비동기로 처리하기 위해 작성했던 AJAX 호출이다. 함수 자체야 별거 없는데 성공 후의 콜백에서 <code class="language-text">$result_partial.html(data);</code> 부분이 핵심이다. 저 <code class="language-text">data</code> 인자는 컨트롤러에서 어떤 방식으로 전달되었을까?</p>\n<div class="gatsby-highlight">\n      <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># app.rb</span>\n<span class="token comment"># ...</span>\nget <span class="token string">\'/search\'</span> <span class="token keyword">do</span>\n  book_title <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:title</span><span class="token punctuation">]</span>\n\n  <span class="token variable">@results</span> <span class="token operator">=</span> <span class="token constant">BookSearch</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>book_title<span class="token punctuation">)</span><span class="token punctuation">.</span>search\n  erb <span class="token symbol">:result</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span> results<span class="token punctuation">:</span> <span class="token variable">@results</span> <span class="token punctuation">}</span>\n<span class="token keyword">end</span>\n</code></pre>\n      </div>\n<p>액션 실행 후 리턴은 erb로 한다고 작성되어 있다. 말인 즉슨 랜더링 처리가 다 된 erb 파일을 콜백 함수의 <code class="language-text">data</code> 인자로 전달한다는 것이다. 보통 레일즈에서 작성했다면 <code class="language-text">respond_to</code> 메서드로 어떤 포맷에 반응하여 출력할지를 지정해주어야 했을 텐데, 오히려 그런 면에서 신경 쓸 필요가 전혀 없었다. 랜더링된 <code class="language-text">result.erb</code> 는 그냥 html 코드 덩어리나 다름없겠다는 생각에 jQuery의 <code class="language-text">html()</code> 함수에 넣어보았다. 아주 잘 작동하였다.</p>\n<p>여지껏 \'Rails way\' 로 작성한 AJAX 호출에 익숙해져 있다 보니 이런 방식으로 결과를 출력할 수 있다는게 새삼 새롭게 느껴졌다.</p>\n<h2 id="conclusion"><a href="#conclusion" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>\n<p>이번에는 아주 간단한 기능 위주로 작성해본 것지만, <a href="http://hanamirb.org">하나미</a> 를 시작으로 점점 레일즈를 벗어나 루비로 웹 애플리케이션을 작성하는데 익숙해지고, 더 재미를 느끼고 있다.</p>\n<p>앱 특성상 레일즈와 비교하여 검색 결과를 출력하는 속도가 압도적으로 빠르다고 느끼진 못했다. 아마 일반적인 형태의 홈페이지로 비교한다면 조금 다른 결과가 나올지도 모르겠다.</p>\n<p>특히 지금처럼 모든 웹 애플리케이션이 데이터베이스(혹은 모델)을 필요로 하는 것은 아니다. 이런 경우에는 레일즈보단 시나트라로 작성하는게 더 나아 보인다.</p>\n<p>앞으로도 더 복잡한 애플리케이션을 쉽게 잘 작성해보고 싶다. 공부해야할 것들이 너무나 많지만, 지금은 자바스크립트 위주의 공부부터 차근차근 도전중이다.</p>\n<p><strong>Source Code</strong>: <a href="https://github.com/emaren84/heoncheck-hunter-sinatra">https://github.com/emaren84/heoncheck-hunter-sinatra</a></p>',id:"/home/circleci/repo/src/pages/posts/2016-11-21-simple-spa-application-sinatra/index.md absPath of file >>> MarkdownRemark",frontmatter:{date:"2016-11-21",path:"/posts/simple-spa-application-with-sinatra",title:"시나트라(Sinatra)로 간단한 Single Page Application(SPA) 제작해 보기",tags:["Ruby","Sinatra"],category:"Ruby"}}]}}}}});
//# sourceMappingURL=path---tags-a13a6b5ad4dc41338ceb.js.map